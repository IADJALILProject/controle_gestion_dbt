[0m14:12:56.457659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C16D74EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C19A90470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C19A92E10>]}


============================== 14:12:56.463655 | da595f67-d6d9-480b-8787-de68650b4f56 ==============================
[0m14:12:56.463655 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:12:56.464655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:23.518663 [debug] [MainThread]: Starter project path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\include\starter_project
[0m14:13:23.550663 [info ] [MainThread]: 
Your new dbt project "controle_gestion_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:13:23.551644 [info ] [MainThread]: Setting up your profile.
[0m14:14:16.159601 [info ] [MainThread]: Profile controle_gestion_dbt written to C:\Users\lenovo\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:14:16.161801 [debug] [MainThread]: Command `dbt init` succeeded at 14:14:16.161801 after 79.93 seconds
[0m14:14:16.161801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C19C25AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C199A96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C193AFEF0>]}
[0m14:14:16.162800 [debug] [MainThread]: Flushing usage events
[0m14:14:16.691008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:00.278706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFFDCC470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B805329C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B80532990>]}


============================== 14:16:00.291700 | cdcfcd7b-fd02-46b9-ab3f-e2a02dfcc162 ==============================
[0m14:16:00.291700 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:16:00.293698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:00.347666 [info ] [MainThread]: dbt version: 1.9.1
[0m14:16:00.348666 [info ] [MainThread]: python version: 3.12.4
[0m14:16:00.349665 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m14:16:00.350664 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:16:00.770424 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m14:16:00.779418 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m14:16:00.785416 [info ] [MainThread]: Using dbt_project.yml file at C:\controle_gestion_dbt\dbt_project.yml
[0m14:16:00.819396 [info ] [MainThread]: adapter type: postgres
[0m14:16:00.821395 [info ] [MainThread]: adapter version: 1.9.0
[0m14:16:01.324107 [info ] [MainThread]: Configuration:
[0m14:16:01.326106 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:01.327106 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:16:01.329104 [info ] [MainThread]: Required dependencies:
[0m14:16:01.330104 [debug] [MainThread]: Executing "git --help"
[0m14:16:01.400063 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:01.401063 [debug] [MainThread]: STDERR: "b''"
[0m14:16:01.402062 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:01.403062 [info ] [MainThread]: Connection:
[0m14:16:01.405064 [info ] [MainThread]:   host: localhost
[0m14:16:01.407060 [info ] [MainThread]:   port: 5432
[0m14:16:01.409059 [info ] [MainThread]:   user: postgres
[0m14:16:01.410058 [info ] [MainThread]:   database: gestion
[0m14:16:01.411057 [info ] [MainThread]:   schema: public
[0m14:16:01.412057 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:01.414056 [info ] [MainThread]:   role: None
[0m14:16:01.415055 [info ] [MainThread]:   search_path: None
[0m14:16:01.416055 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:01.417054 [info ] [MainThread]:   sslmode: None
[0m14:16:01.418053 [info ] [MainThread]:   sslcert: None
[0m14:16:01.419053 [info ] [MainThread]:   sslkey: None
[0m14:16:01.420052 [info ] [MainThread]:   sslrootcert: None
[0m14:16:01.421052 [info ] [MainThread]:   application_name: dbt
[0m14:16:01.424052 [info ] [MainThread]:   retries: 1
[0m14:16:01.426049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:16:02.253839 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:02.531653 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:02.532653 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:02.533652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:02.637952 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m14:16:02.640951 [debug] [MainThread]: On debug: Close
[0m14:16:02.641949 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:16:02.643949 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:16:02.646947 [debug] [MainThread]: Command `dbt debug` succeeded at 14:16:02.645948 after 3.15 seconds
[0m14:16:02.647946 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:16:02.647946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFFDCC470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B80898650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B8004B470>]}
[0m14:16:02.648945 [debug] [MainThread]: Flushing usage events
[0m14:16:04.807349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:48.156387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126704F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021266ABBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212677B03B0>]}


============================== 14:29:48.157415 | 926755e4-fc9a-4a88-8a81-832ca9f513a7 ==============================
[0m14:29:48.157415 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:29:48.157415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:48.190813 [info ] [MainThread]: dbt version: 1.9.1
[0m14:29:48.206438 [info ] [MainThread]: python version: 3.12.4
[0m14:29:48.207665 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m14:29:48.207665 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:29:48.324114 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m14:29:48.324114 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m14:29:48.324114 [info ] [MainThread]: Using dbt_project.yml file at C:\controle_gestion_dbt\dbt_project.yml
[0m14:29:48.324114 [info ] [MainThread]: adapter type: postgres
[0m14:29:48.339741 [info ] [MainThread]: adapter version: 1.9.0
[0m14:29:48.340968 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:29:48.340968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '926755e4-fc9a-4a88-8a81-832ca9f513a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267F570B0>]}
[0m14:29:48.507426 [info ] [MainThread]: Configuration:
[0m14:29:48.524174 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:29:48.524174 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:29:48.524174 [info ] [MainThread]: Required dependencies:
[0m14:29:48.524174 [debug] [MainThread]: Executing "git --help"
[0m14:29:48.574060 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:29:48.574060 [debug] [MainThread]: STDERR: "b''"
[0m14:29:48.574060 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:29:48.574060 [info ] [MainThread]: Connection:
[0m14:29:48.574060 [info ] [MainThread]:   host: localhost
[0m14:29:48.574060 [info ] [MainThread]:   port: 5432
[0m14:29:48.574060 [info ] [MainThread]:   user: postgres
[0m14:29:48.574060 [info ] [MainThread]:   database: gestion
[0m14:29:48.574060 [info ] [MainThread]:   schema: public
[0m14:29:48.574060 [info ] [MainThread]:   connect_timeout: 10
[0m14:29:48.574060 [info ] [MainThread]:   role: None
[0m14:29:48.574060 [info ] [MainThread]:   search_path: None
[0m14:29:48.574060 [info ] [MainThread]:   keepalives_idle: 0
[0m14:29:48.574060 [info ] [MainThread]:   sslmode: None
[0m14:29:48.589685 [info ] [MainThread]:   sslcert: None
[0m14:29:48.590913 [info ] [MainThread]:   sslkey: None
[0m14:29:48.590913 [info ] [MainThread]:   sslrootcert: None
[0m14:29:48.590913 [info ] [MainThread]:   application_name: dbt
[0m14:29:48.590913 [info ] [MainThread]:   retries: 1
[0m14:29:48.590913 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:29:48.957242 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:29:49.123964 [debug] [MainThread]: Using postgres connection "debug"
[0m14:29:49.123964 [debug] [MainThread]: On debug: select 1 as id
[0m14:29:49.123964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:49.190497 [debug] [MainThread]: SQL status: SELECT 1 in 0.069 seconds
[0m14:29:49.190497 [debug] [MainThread]: On debug: Close
[0m14:29:49.190497 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:29:49.190497 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:29:49.190497 [debug] [MainThread]: Command `dbt debug` succeeded at 14:29:49.190497 after 1.25 seconds
[0m14:29:49.190497 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:29:49.190497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267B69C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212680038F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267949760>]}
[0m14:29:49.190497 [debug] [MainThread]: Flushing usage events
[0m14:29:49.206122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:14.798673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D14214470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D143B9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D143BA270>]}


============================== 14:36:14.798673 | 6923cfc3-fd6e-4181-8fb4-94af088cbcb7 ==============================
[0m14:36:14.798673 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:36:14.798673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:36:14.898547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:36:14.915043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6923cfc3-fd6e-4181-8fb4-94af088cbcb7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D1458CE60>]}
[0m14:36:15.148470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6923cfc3-fd6e-4181-8fb4-94af088cbcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D148962A0>]}
[0m14:36:15.248433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6923cfc3-fd6e-4181-8fb4-94af088cbcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D14738620>]}
[0m14:36:15.248433 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:36:15.515062 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:36:15.515062 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:36:15.515062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6923cfc3-fd6e-4181-8fb4-94af088cbcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D15B03560>]}
[0m14:36:16.681513 [error] [MainThread]: Encountered an error:
Compilation Error in model int_management_control (models\intermediate\int_management_control.sql)
  expected token ',', got 'toutes'
    line 4
      on_schema_change='sync_all_columns'   -- Synchronise toutes les colonnes automatiquement
[0m14:36:16.681513 [debug] [MainThread]: Command `dbt seed` failed at 14:36:16.681513 after 2.09 seconds
[0m14:36:16.681513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D143BA270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D149FB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D15CBE300>]}
[0m14:36:16.681513 [debug] [MainThread]: Flushing usage events
[0m14:36:16.701952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:28.910900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34DC94C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3456F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34DCB140>]}


============================== 14:38:28.927582 | c3c6bd45-30ee-4d56-93ec-bab796c49eda ==============================
[0m14:38:28.927582 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:38:28.927582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:38:29.078761 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:29.080741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3c6bd45-30ee-4d56-93ec-bab796c49eda', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34FE5EE0>]}
[0m14:38:29.294072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c6bd45-30ee-4d56-93ec-bab796c49eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34FE5C10>]}
[0m14:38:29.394055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c6bd45-30ee-4d56-93ec-bab796c49eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34E2E540>]}
[0m14:38:29.394055 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:29.793995 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:38:29.793995 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:38:29.793995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c6bd45-30ee-4d56-93ec-bab796c49eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34F927B0>]}
[0m14:38:32.176694 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_management_control (models\staging\stg_management_control.sql)
  expected token ',', got 'les'
    line 4
      on_schema_change='append'   -- Ajoute les colonnes nouvelles si le schéma change
[0m14:38:32.176694 [debug] [MainThread]: Command `dbt seed` failed at 14:38:32.176694 after 3.45 seconds
[0m14:38:32.176694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34C99AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B347183B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34F93EC0>]}
[0m14:38:32.176694 [debug] [MainThread]: Flushing usage events
[0m14:38:32.176694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:52.904265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90CB4A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90CB4A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90CB49D30>]}


============================== 14:38:52.904265 | 33dbc516-b579-4eb8-8f1d-e6182684c0a7 ==============================
[0m14:38:52.904265 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:38:52.904265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:53.021722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:53.021722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90BBEDCD0>]}
[0m14:38:53.220692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90C2F6330>]}
[0m14:38:53.324119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B909D84C50>]}
[0m14:38:53.332773 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:53.606725 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:38:53.607706 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:38:53.608519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90E1D0350>]}
[0m14:38:56.336573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.management_control_project.marts.management_control
[0m14:38:56.352730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90E960680>]}
[0m14:38:56.503252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:38:56.519741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:38:56.569771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90E8789B0>]}
[0m14:38:56.569771 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m14:38:56.569771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90E960EF0>]}
[0m14:38:56.569771 [info ] [MainThread]: 
[0m14:38:56.569771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:56.585395 [info ] [MainThread]: 
[0m14:38:56.587213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:56.588953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m14:38:59.169061 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:38:59.169061 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:38:59.169061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:59.219039 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m14:38:59.219039 [debug] [ThreadPool]: On list_gestion: Close
[0m14:38:59.219039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_marts'
[0m14:38:59.235669 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:38:59.235669 [debug] [ThreadPool]: On list_gestion_public_marts: BEGIN
[0m14:38:59.235669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:59.285735 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m14:38:59.285735 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:38:59.285735 [debug] [ThreadPool]: On list_gestion_public_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_marts"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:38:59.285735 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:38:59.285735 [debug] [ThreadPool]: On list_gestion_public_marts: ROLLBACK
[0m14:38:59.285735 [debug] [ThreadPool]: On list_gestion_public_marts: Close
[0m14:38:59.285735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_marts, now list_gestion_public)
[0m14:38:59.302363 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:38:59.302363 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m14:38:59.302363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:59.335694 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m14:38:59.335694 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:38:59.335694 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:38:59.352359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:38:59.352359 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m14:38:59.352359 [debug] [ThreadPool]: On list_gestion_public: Close
[0m14:38:59.352359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_snapshots)
[0m14:38:59.352359 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:38:59.367985 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m14:38:59.369087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:59.402310 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m14:38:59.402310 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:38:59.402310 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:38:59.419056 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:38:59.419056 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m14:38:59.419056 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m14:38:59.419056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m14:38:59.419056 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:38:59.419056 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m14:38:59.419056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:59.475793 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m14:38:59.475793 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:38:59.476789 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m14:38:59.484785 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:38:59.485877 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m14:38:59.485877 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m14:38:59.485877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m14:38:59.485877 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:38:59.485877 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m14:38:59.485877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:59.535661 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:38:59.535661 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:38:59.535661 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:38:59.535661 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:38:59.535661 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m14:38:59.535661 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m14:38:59.552341 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.552341 [debug] [MainThread]: On master: BEGIN
[0m14:38:59.552341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:59.702258 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m14:38:59.702258 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.702258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:38:59.702258 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:38:59.702258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90D1615E0>]}
[0m14:38:59.702258 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:59.718684 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.718892 [debug] [MainThread]: On master: BEGIN
[0m14:38:59.718892 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:38:59.718892 [debug] [MainThread]: On master: COMMIT
[0m14:38:59.718892 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.718892 [debug] [MainThread]: On master: COMMIT
[0m14:38:59.718892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:59.718892 [debug] [MainThread]: On master: Close
[0m14:38:59.718892 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m14:38:59.718892 [info ] [Thread-1 (]: 1 of 1 START seed file public.management_control ............................... [RUN]
[0m14:38:59.718892 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m14:38:59.718892 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m14:38:59.718892 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m14:38:59.770608 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m14:38:59.770608 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m14:38:59.770608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:59.819665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:38:59.819665 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m14:38:59.819665 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */

    create table "gestion"."public"."management_control" ("control_id" integer,"department_id" integer,"control_date" date,"expenses" integer,"revenue" integer,"status" text)
  
[0m14:38:59.836848 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.016 seconds
[0m14:38:59.853173 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m14:38:59.853173 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m14:38:59.853173 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.001 seconds
[0m14:38:59.873626 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m14:38:59.897923 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m14:38:59.898922 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m14:38:59.899922 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m14:38:59.901921 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:38:59.903934 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m14:38:59.908918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dbc516-b579-4eb8-8f1d-e6182684c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90A278500>]}
[0m14:38:59.909917 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.management_control ........................... [[32mINSERT 6[0m in 0.19s]
[0m14:38:59.911916 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m14:38:59.914914 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.915914 [debug] [MainThread]: On master: BEGIN
[0m14:38:59.915914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:59.981521 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m14:38:59.982522 [debug] [MainThread]: On master: COMMIT
[0m14:38:59.983520 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:59.984520 [debug] [MainThread]: On master: COMMIT
[0m14:38:59.986410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:59.987408 [debug] [MainThread]: On master: Close
[0m14:38:59.988407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:59.989407 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m14:38:59.989407 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m14:38:59.990406 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m14:38:59.991405 [info ] [MainThread]: 
[0m14:38:59.992405 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m14:38:59.994403 [debug] [MainThread]: Command end result
[0m14:39:00.055554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:39:00.059552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:39:00.071544 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m14:39:00.072544 [info ] [MainThread]: 
[0m14:39:00.073543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:00.075542 [info ] [MainThread]: 
[0m14:39:00.076542 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:00.079540 [debug] [MainThread]: Command `dbt seed` succeeded at 14:39:00.078540 after 7.31 seconds
[0m14:39:00.080539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90CB8CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90EA1A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90EA24140>]}
[0m14:39:00.081538 [debug] [MainThread]: Flushing usage events
[0m14:39:00.087713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:31.909908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5A79A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F59BCB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5A79B740>]}


============================== 14:39:31.909908 | 23008ce9-da01-48a2-88fc-46fe50bd3790 ==============================
[0m14:39:31.909908 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:39:31.909908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:39:32.027259 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:39:32.027259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5AC77A10>]}
[0m14:39:32.209668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5A15FDD0>]}
[0m14:39:32.310612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5A13C8F0>]}
[0m14:39:32.310612 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:32.591875 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:39:32.836778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:32.836778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:32.843792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.management_control_project.marts.management_control
[0m14:39:32.944838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5A799370>]}
[0m14:39:33.076224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:39:33.076224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:39:33.126217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5C353FB0>]}
[0m14:39:33.126217 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m14:39:33.126217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5BEBD580>]}
[0m14:39:33.126217 [info ] [MainThread]: 
[0m14:39:33.126217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:33.126217 [info ] [MainThread]: 
[0m14:39:33.126217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:33.145907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m14:39:33.238280 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:39:33.239278 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:39:33.239278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:33.392925 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.155 seconds
[0m14:39:33.392925 [debug] [ThreadPool]: On list_gestion: Close
[0m14:39:33.392925 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:39:33.392925 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:39:33.392925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.542832 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.142 seconds
[0m14:39:33.542832 [debug] [ThreadPool]: On list_gestion: Close
[0m14:39:33.542832 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:39:33.542832 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:39:33.542832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.592800 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m14:39:33.592800 [debug] [ThreadPool]: On list_gestion: Close
[0m14:39:33.592800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_public_staging)
[0m14:39:33.592800 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_staging"
"
[0m14:39:33.592800 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m14:39:33.592800 [debug] [ThreadPool]: On create_gestion_public_staging: BEGIN
[0m14:39:33.592800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.642703 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m14:39:33.642703 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m14:39:33.642703 [debug] [ThreadPool]: On create_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_staging"} */
create schema if not exists "public_staging"
[0m14:39:33.642703 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m14:39:33.659394 [debug] [ThreadPool]: On create_gestion_public_staging: COMMIT
[0m14:39:33.659394 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m14:39:33.659394 [debug] [ThreadPool]: On create_gestion_public_staging: COMMIT
[0m14:39:33.659394 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:39:33.659394 [debug] [ThreadPool]: On create_gestion_public_staging: Close
[0m14:39:33.659394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_gestion_public_staging, now create_gestion_public_intermediate)
[0m14:39:33.659394 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_intermediate"
"
[0m14:39:33.659394 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m14:39:33.659394 [debug] [ThreadPool]: On create_gestion_public_intermediate: BEGIN
[0m14:39:33.659394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.809641 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m14:39:33.809641 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m14:39:33.809641 [debug] [ThreadPool]: On create_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m14:39:33.809641 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:39:33.809641 [debug] [ThreadPool]: On create_gestion_public_intermediate: COMMIT
[0m14:39:33.809641 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m14:39:33.809641 [debug] [ThreadPool]: On create_gestion_public_intermediate: COMMIT
[0m14:39:33.809641 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m14:39:33.809641 [debug] [ThreadPool]: On create_gestion_public_intermediate: Close
[0m14:39:33.809641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_gestion_public_intermediate, now create_gestion_public_marts)
[0m14:39:33.809641 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_marts"
"
[0m14:39:33.826248 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_marts"
[0m14:39:33.826248 [debug] [ThreadPool]: On create_gestion_public_marts: BEGIN
[0m14:39:33.826248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:33.976390 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m14:39:33.976390 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_marts"
[0m14:39:33.976390 [debug] [ThreadPool]: On create_gestion_public_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_marts"} */
create schema if not exists "public_marts"
[0m14:39:33.976390 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:39:33.976390 [debug] [ThreadPool]: On create_gestion_public_marts: COMMIT
[0m14:39:33.976390 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_marts"
[0m14:39:33.976390 [debug] [ThreadPool]: On create_gestion_public_marts: COMMIT
[0m14:39:33.976390 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m14:39:33.976390 [debug] [ThreadPool]: On create_gestion_public_marts: Close
[0m14:39:33.976390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m14:39:33.992998 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:39:33.992998 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m14:39:33.992998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:34.042920 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m14:39:34.042920 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:39:34.042920 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:39:34.042920 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:39:34.042920 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m14:39:34.042920 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m14:39:34.058896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public)
[0m14:39:34.060147 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:39:34.060147 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m14:39:34.060147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:34.109680 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m14:39:34.109680 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:39:34.109680 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:39:34.109680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m14:39:34.109680 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m14:39:34.109680 [debug] [ThreadPool]: On list_gestion_public: Close
[0m14:39:34.109680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_snapshots)
[0m14:39:34.126453 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:39:34.126453 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m14:39:34.126453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:34.176220 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:39:34.176220 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:39:34.176220 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:39:34.176220 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:39:34.176220 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m14:39:34.176220 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m14:39:34.176220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_marts)
[0m14:39:34.192890 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:39:34.192890 [debug] [ThreadPool]: On list_gestion_public_marts: BEGIN
[0m14:39:34.192890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:34.226076 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:39:34.226076 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:39:34.241701 [debug] [ThreadPool]: On list_gestion_public_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_marts"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:39:34.242792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:39:34.242792 [debug] [ThreadPool]: On list_gestion_public_marts: ROLLBACK
[0m14:39:34.242792 [debug] [ThreadPool]: On list_gestion_public_marts: Close
[0m14:39:34.242792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_marts, now list_gestion_public_intermediate)
[0m14:39:34.242792 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:39:34.242792 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m14:39:34.242792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:34.292887 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m14:39:34.292887 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:39:34.292887 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m14:39:34.309546 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:39:34.309546 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m14:39:34.309546 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m14:39:34.309546 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.309546 [debug] [MainThread]: On master: BEGIN
[0m14:39:34.309546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:34.359412 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m14:39:34.359412 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.359412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:34.376129 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:39:34.376129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F580E2570>]}
[0m14:39:34.376129 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:34.376129 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.376129 [debug] [MainThread]: On master: BEGIN
[0m14:39:34.376129 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:39:34.376129 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.376129 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.376129 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.376129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:34.376129 [debug] [MainThread]: On master: Close
[0m14:39:34.376129 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m14:39:34.392912 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m14:39:34.392912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m14:39:34.392912 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m14:39:34.408808 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m14:39:34.410516 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m14:39:34.459855 [debug] [Thread-1 (]: Invalid value for on_schema_change (append) specified. Setting default value of ignore.
[0m14:39:34.476032 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m14:39:34.476032 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:39:34.476032 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m14:39:34.476032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:34.529009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:39:34.529009 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:39:34.529009 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_control
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m14:39:34.529009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « seeds.management_control » n'existe pas
LINE 24:     FROM "gestion"."seeds"."management_control"
                  ^

[0m14:39:34.529009 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: ROLLBACK
[0m14:39:34.529009 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m14:39:34.675739 [debug] [Thread-1 (]: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:39:34.675739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23008ce9-da01-48a2-88fc-46fe50bd3790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5AC017C0>]}
[0m14:39:34.675739 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_staging.stg_management_control  [[31mERROR[0m in 0.28s]
[0m14:39:34.675739 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m14:39:34.675739 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.stg_management_control' to be skipped because of status 'error'.  Reason: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql.
[0m14:39:34.675739 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m14:39:34.675739 [info ] [Thread-1 (]: 2 of 4 SKIP relation public_intermediate.int_management_control ................ [[33mSKIP[0m]
[0m14:39:34.691365 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m14:39:34.693601 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m14:39:34.694601 [info ] [Thread-1 (]: 3 of 4 SKIP relation public_marts.control_growth ............................... [[33mSKIP[0m]
[0m14:39:34.695600 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m14:39:34.697761 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m14:39:34.698760 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_marts.control_summary .............................. [[33mSKIP[0m]
[0m14:39:34.700609 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m14:39:34.700609 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.700609 [debug] [MainThread]: On master: BEGIN
[0m14:39:34.700609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:34.749038 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m14:39:34.749038 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.749038 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.749038 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.758686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:34.759686 [debug] [MainThread]: On master: Close
[0m14:39:34.760319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:34.760319 [debug] [MainThread]: Connection 'create_gestion_public_marts' was properly closed.
[0m14:39:34.760319 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m14:39:34.760319 [debug] [MainThread]: Connection 'model.management_control_project.stg_management_control' was properly closed.
[0m14:39:34.760319 [info ] [MainThread]: 
[0m14:39:34.760319 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m14:39:34.760319 [debug] [MainThread]: Command end result
[0m14:39:34.798745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:39:34.798745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:39:34.810354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m14:39:34.810354 [info ] [MainThread]: 
[0m14:39:34.810354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:39:34.810354 [info ] [MainThread]: 
[0m14:39:34.810354 [error] [MainThread]:   Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:39:34.810354 [info ] [MainThread]: 
[0m14:39:34.810354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:39:34.810354 [debug] [MainThread]: Command `dbt run` failed at 14:39:34.810354 after 3.06 seconds
[0m14:39:34.810354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F59BCB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5887FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5AC26AB0>]}
[0m14:39:34.810354 [debug] [MainThread]: Flushing usage events
[0m14:39:34.810354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:12.448273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30939A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30958CFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30958EB40>]}


============================== 14:41:12.448273 | e48219af-8684-4bfd-81a4-600f79727a8c ==============================
[0m14:41:12.448273 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:41:12.448273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:12.548864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:41:12.565349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B309823620>]}
[0m14:41:12.748089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3099A3F50>]}
[0m14:41:12.848067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30997E390>]}
[0m14:41:12.848067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:13.181260 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:41:13.348006 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:41:13.348006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30AD648F0>]}
[0m14:41:15.597383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.management_control_project.marts.management_control_project
[0m14:41:15.618572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30B2E1280>]}
[0m14:41:15.752163 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:41:15.757160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:41:15.791350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30B2E2240>]}
[0m14:41:15.791350 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m14:41:15.792350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30B3C8770>]}
[0m14:41:15.795349 [info ] [MainThread]: 
[0m14:41:15.796347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:15.797368 [info ] [MainThread]: 
[0m14:41:15.797368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:15.797368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m14:41:15.893360 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:41:15.893360 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:41:15.894359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:16.047243 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.156 seconds
[0m14:41:16.047243 [debug] [ThreadPool]: On list_gestion: Close
[0m14:41:16.047243 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:41:16.047243 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:41:16.047243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.097157 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.045 seconds
[0m14:41:16.097157 [debug] [ThreadPool]: On list_gestion: Close
[0m14:41:16.097157 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:41:16.097157 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:41:16.097157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.263832 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.156 seconds
[0m14:41:16.263832 [debug] [ThreadPool]: On list_gestion: Close
[0m14:41:16.263832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m14:41:16.263832 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:41:16.263832 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m14:41:16.263832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:16.320063 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m14:41:16.321065 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:41:16.321065 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:41:16.329057 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:41:16.330653 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m14:41:16.330653 [debug] [ThreadPool]: On list_gestion_public: Close
[0m14:41:16.330653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_intermediate)
[0m14:41:16.330653 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:41:16.330653 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m14:41:16.330653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.380422 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m14:41:16.380422 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:41:16.380422 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m14:41:16.380422 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:41:16.380422 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m14:41:16.380422 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m14:41:16.380422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m14:41:16.397230 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:41:16.397230 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m14:41:16.397230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.430486 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:41:16.446113 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:41:16.446856 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:41:16.447213 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:41:16.447213 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m14:41:16.447213 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m14:41:16.447213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_marts)
[0m14:41:16.447213 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:41:16.447213 [debug] [ThreadPool]: On list_gestion_public_marts: BEGIN
[0m14:41:16.447213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.497053 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m14:41:16.497053 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:41:16.497053 [debug] [ThreadPool]: On list_gestion_public_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_marts"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:41:16.513874 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:41:16.513874 [debug] [ThreadPool]: On list_gestion_public_marts: ROLLBACK
[0m14:41:16.513874 [debug] [ThreadPool]: On list_gestion_public_marts: Close
[0m14:41:16.513874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_marts, now list_gestion_public_staging)
[0m14:41:16.513874 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:41:16.513874 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m14:41:16.513874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:16.680423 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m14:41:16.680423 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:41:16.680423 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:41:16.680423 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:41:16.680423 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m14:41:16.680423 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m14:41:16.697091 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:16.697091 [debug] [MainThread]: On master: BEGIN
[0m14:41:16.697091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:16.730944 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m14:41:16.730944 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:16.730944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:16.747108 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:41:16.747108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3099A1FA0>]}
[0m14:41:16.747108 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:16.747108 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:16.747108 [debug] [MainThread]: On master: BEGIN
[0m14:41:16.747108 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:16.747108 [debug] [MainThread]: On master: COMMIT
[0m14:41:16.747108 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:16.747108 [debug] [MainThread]: On master: COMMIT
[0m14:41:16.747108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:16.747108 [debug] [MainThread]: On master: Close
[0m14:41:16.762735 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m14:41:16.763627 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m14:41:16.763627 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m14:41:16.763627 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m14:41:16.763627 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m14:41:16.763627 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m14:41:16.831139 [debug] [Thread-1 (]: Invalid value for on_schema_change (append) specified. Setting default value of ignore.
[0m14:41:16.847062 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m14:41:16.847062 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:41:16.847062 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m14:41:16.847062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:16.997093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m14:41:16.997093 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:41:16.997093 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_control
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m14:41:16.997093 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « seeds.management_control » n'existe pas
LINE 24:     FROM "gestion"."seeds"."management_control"
                  ^

[0m14:41:16.997093 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: ROLLBACK
[0m14:41:16.997093 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m14:41:16.997093 [debug] [Thread-1 (]: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:41:16.997093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48219af-8684-4bfd-81a4-600f79727a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B308CD8C80>]}
[0m14:41:16.997093 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_staging.stg_management_control  [[31mERROR[0m in 0.23s]
[0m14:41:17.012717 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m14:41:17.013899 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.stg_management_control' to be skipped because of status 'error'.  Reason: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql.
[0m14:41:17.013899 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m14:41:17.013899 [info ] [Thread-1 (]: 2 of 4 SKIP relation public_intermediate.int_management_control ................ [[33mSKIP[0m]
[0m14:41:17.013899 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m14:41:17.020476 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m14:41:17.021257 [info ] [Thread-1 (]: 3 of 4 SKIP relation public_marts.control_growth ............................... [[33mSKIP[0m]
[0m14:41:17.023025 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m14:41:17.023025 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m14:41:17.023025 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_marts.control_summary .............................. [[33mSKIP[0m]
[0m14:41:17.023025 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m14:41:17.023025 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:17.023025 [debug] [MainThread]: On master: BEGIN
[0m14:41:17.023025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:17.065901 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m14:41:17.079912 [debug] [MainThread]: On master: COMMIT
[0m14:41:17.080911 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:17.081770 [debug] [MainThread]: On master: COMMIT
[0m14:41:17.081770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:17.081770 [debug] [MainThread]: On master: Close
[0m14:41:17.081770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:17.081770 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m14:41:17.081770 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m14:41:17.081770 [debug] [MainThread]: Connection 'model.management_control_project.stg_management_control' was properly closed.
[0m14:41:17.081770 [info ] [MainThread]: 
[0m14:41:17.081770 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:41:17.081770 [debug] [MainThread]: Command end result
[0m14:41:17.115476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:41:17.115476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:41:17.131368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m14:41:17.131368 [info ] [MainThread]: 
[0m14:41:17.131368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:17.131368 [info ] [MainThread]: 
[0m14:41:17.131368 [error] [MainThread]:   Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:41:17.131368 [info ] [MainThread]: 
[0m14:41:17.131368 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:41:17.131368 [debug] [MainThread]: Command `dbt run` failed at 14:41:17.131368 after 4.89 seconds
[0m14:41:17.131368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30B850890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B309054EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30901D280>]}
[0m14:41:17.131368 [debug] [MainThread]: Flushing usage events
[0m14:41:17.148569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:59.892970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118533CAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011853226E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118530FB9B0>]}


============================== 14:46:59.897967 | cbf66267-4ac7-4429-9a73-e75ae289d319 ==============================
[0m14:46:59.897967 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:46:59.899967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:47:00.199796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011852D6CB30>]}
[0m14:47:00.292760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185352FAA0>]}
[0m14:47:00.294970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:47:00.571536 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:47:00.737458 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:47:00.738240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011854DFFF20>]}
[0m14:47:03.077924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.management_control_project.marts.management_control_project
[0m14:47:03.090830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011855392AE0>]}
[0m14:47:03.230732 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:47:03.235747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:47:03.274756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185542A840>]}
[0m14:47:03.274756 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m14:47:03.275756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011853870140>]}
[0m14:47:03.278756 [info ] [MainThread]: 
[0m14:47:03.279753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:03.280755 [info ] [MainThread]: 
[0m14:47:03.281752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:03.287751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m14:47:03.382694 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:47:03.383694 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:47:03.383694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:03.534390 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.151 seconds
[0m14:47:03.536410 [debug] [ThreadPool]: On list_gestion: Close
[0m14:47:03.540408 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:47:03.540408 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:47:03.541408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:03.586134 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.045 seconds
[0m14:47:03.588155 [debug] [ThreadPool]: On list_gestion: Close
[0m14:47:03.591134 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m14:47:03.592133 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m14:47:03.593151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:03.736321 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.143 seconds
[0m14:47:03.738338 [debug] [ThreadPool]: On list_gestion: Close
[0m14:47:03.741452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m14:47:03.748475 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:47:03.749476 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m14:47:03.749476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:03.894057 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m14:47:03.894057 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m14:47:03.895058 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:47:03.904296 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m14:47:03.906312 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m14:47:03.907295 [debug] [ThreadPool]: On list_gestion_public: Close
[0m14:47:03.908293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_marts)
[0m14:47:03.912311 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:47:03.913291 [debug] [ThreadPool]: On list_gestion_public_marts: BEGIN
[0m14:47:03.913291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:03.960013 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:47:03.961027 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_marts"
[0m14:47:03.961027 [debug] [ThreadPool]: On list_gestion_public_marts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_marts"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:47:03.970430 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m14:47:03.972447 [debug] [ThreadPool]: On list_gestion_public_marts: ROLLBACK
[0m14:47:03.972447 [debug] [ThreadPool]: On list_gestion_public_marts: Close
[0m14:47:03.973430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_marts, now list_gestion_public_staging)
[0m14:47:03.976428 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:47:03.977426 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m14:47:03.977426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:04.025899 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m14:47:04.025899 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m14:47:04.026900 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:47:04.036046 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:47:04.038059 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m14:47:04.038059 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m14:47:04.039063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m14:47:04.043042 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:47:04.044041 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m14:47:04.045041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:04.091512 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m14:47:04.092514 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m14:47:04.093513 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m14:47:04.102325 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:47:04.104343 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m14:47:04.104343 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m14:47:04.105342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m14:47:04.107341 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:47:04.108341 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m14:47:04.109341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:04.160150 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m14:47:04.160150 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m14:47:04.161150 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:47:04.170248 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:47:04.172247 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m14:47:04.172247 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m14:47:04.178243 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.179242 [debug] [MainThread]: On master: BEGIN
[0m14:47:04.179242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:04.226216 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m14:47:04.227216 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.228214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:47:04.238209 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:47:04.240208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118552D9D30>]}
[0m14:47:04.240208 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:04.241207 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.241207 [debug] [MainThread]: On master: BEGIN
[0m14:47:04.242207 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:47:04.243206 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.243206 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.244205 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.244205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:47:04.245205 [debug] [MainThread]: On master: Close
[0m14:47:04.247204 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m14:47:04.248203 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m14:47:04.250204 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m14:47:04.251204 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m14:47:04.262197 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m14:47:04.263195 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m14:47:04.348147 [debug] [Thread-1 (]: Invalid value for on_schema_change (append) specified. Setting default value of ignore.
[0m14:47:04.366137 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m14:47:04.367135 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:47:04.368134 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m14:47:04.369133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:04.413109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:47:04.414109 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m14:47:04.414109 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_control
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m14:47:04.416107 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « seeds.management_control » n'existe pas
LINE 24:     FROM "gestion"."seeds"."management_control"
                  ^

[0m14:47:04.416107 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: ROLLBACK
[0m14:47:04.417106 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m14:47:04.423103 [debug] [Thread-1 (]: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:47:04.426103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbf66267-4ac7-4429-9a73-e75ae289d319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011852D08B90>]}
[0m14:47:04.427102 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_staging.stg_management_control  [[31mERROR[0m in 0.17s]
[0m14:47:04.428101 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m14:47:04.429100 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.stg_management_control' to be skipped because of status 'error'.  Reason: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql.
[0m14:47:04.430099 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m14:47:04.431098 [info ] [Thread-1 (]: 2 of 4 SKIP relation public_intermediate.int_management_control ................ [[33mSKIP[0m]
[0m14:47:04.433098 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m14:47:04.434098 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m14:47:04.435098 [info ] [Thread-1 (]: 3 of 4 SKIP relation public_marts.control_growth ............................... [[33mSKIP[0m]
[0m14:47:04.436097 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m14:47:04.437097 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m14:47:04.438097 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_marts.control_summary .............................. [[33mSKIP[0m]
[0m14:47:04.439094 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m14:47:04.441093 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.442092 [debug] [MainThread]: On master: BEGIN
[0m14:47:04.442092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:04.491064 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m14:47:04.492064 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.493063 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.493063 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.494063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:47:04.494063 [debug] [MainThread]: On master: Close
[0m14:47:04.495062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:04.496062 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m14:47:04.496062 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m14:47:04.497060 [debug] [MainThread]: Connection 'model.management_control_project.stg_management_control' was properly closed.
[0m14:47:04.497060 [info ] [MainThread]: 
[0m14:47:04.499061 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m14:47:04.500060 [debug] [MainThread]: Command end result
[0m14:47:04.540038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m14:47:04.543037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m14:47:04.552030 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m14:47:04.554028 [info ] [MainThread]: 
[0m14:47:04.555028 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:04.556028 [info ] [MainThread]: 
[0m14:47:04.557027 [error] [MainThread]:   Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control"
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m14:47:04.558027 [info ] [MainThread]: 
[0m14:47:04.559026 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:47:04.562023 [debug] [MainThread]: Command `dbt run` failed at 14:47:04.561025 after 4.87 seconds
[0m14:47:04.562023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001184FE04E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185541D670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011853723B00>]}
[0m14:47:04.563023 [debug] [MainThread]: Flushing usage events
[0m14:47:04.568020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:48.373078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EDC7B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EDC79F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EDC78140>]}


============================== 15:20:48.379265 | ed1effa8-0420-49e8-8360-bd8fd9a49de4 ==============================
[0m15:20:48.379265 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:20:48.379898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:20:48.640770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed1effa8-0420-49e8-8360-bd8fd9a49de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EDF3A270>]}
[0m15:20:48.680414 [debug] [MainThread]: Command `dbt clean` succeeded at 15:20:48.680414 after 0.53 seconds
[0m15:20:48.682412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ED85CEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E7E92240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EB539490>]}
[0m15:20:48.684410 [debug] [MainThread]: Flushing usage events
[0m15:20:48.694405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:49.660949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A321DF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A321DF860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A2FEC4620>]}


============================== 15:23:49.671261 | fe839b9d-318b-4c6f-8c56-ba9049daf37e ==============================
[0m15:23:49.671261 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:23:49.676131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:49.986087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe839b9d-318b-4c6f-8c56-ba9049daf37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A321DFE90>]}
[0m15:23:50.031142 [debug] [MainThread]: Command `dbt clean` succeeded at 15:23:50.031142 after 0.69 seconds
[0m15:23:50.031142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3287FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A321DFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A320756A0>]}
[0m15:23:50.041209 [debug] [MainThread]: Flushing usage events
[0m15:23:50.631120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:59.360947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED430245F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED42B463C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED42F6A120>]}


============================== 15:23:59.371049 | 31f9f3ac-fb5c-4001-978d-d8caf0413304 ==============================
[0m15:23:59.371049 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:23:59.371049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:59.701016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED4338D1C0>]}
[0m15:23:59.791284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED43427440>]}
[0m15:23:59.791284 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:24:00.076065 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:24:00.081128 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:24:00.081128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED433083E0>]}
[0m15:24:02.439629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.management_control_project.marts.management_control
[0m15:24:02.457575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED44839BB0>]}
[0m15:24:02.621152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:24:02.621152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:24:02.661308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED44BD5220>]}
[0m15:24:02.661308 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:24:02.661308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED44C29910>]}
[0m15:24:02.661308 [info ] [MainThread]: 
[0m15:24:02.671246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:02.673523 [info ] [MainThread]: 
[0m15:24:02.673794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:24:02.673794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m15:24:02.831210 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:24:02.831210 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:24:02.831210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:02.890974 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m15:24:02.890974 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:24:02.890974 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:24:02.901236 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:24:02.901236 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:24:02.901236 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:24:02.901236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public)
[0m15:24:02.911038 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m15:24:02.911038 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m15:24:02.911038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:03.076460 [debug] [ThreadPool]: SQL status: BEGIN in 0.163 seconds
[0m15:24:03.076460 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m15:24:03.077473 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:24:03.086454 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:24:03.089451 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m15:24:03.089451 [debug] [ThreadPool]: On list_gestion_public: Close
[0m15:24:03.091452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_seeds)
[0m15:24:03.092679 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:24:03.092679 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:24:03.092679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:03.251184 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m15:24:03.251184 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:24:03.251184 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:24:03.261170 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:24:03.261170 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:24:03.261170 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:24:03.261170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m15:24:03.261170 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:24:03.271246 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:24:03.271246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:03.311039 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:24:03.311039 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:24:03.311039 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:24:03.321064 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:24:03.321064 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:24:03.321064 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:24:03.330973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m15:24:03.330973 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:24:03.330973 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:24:03.330973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:03.380921 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:24:03.380921 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:24:03.380921 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:24:03.391167 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:24:03.391167 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:24:03.391167 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:24:03.401171 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:03.401171 [debug] [MainThread]: On master: BEGIN
[0m15:24:03.401171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:03.555920 [debug] [MainThread]: SQL status: BEGIN in 0.154 seconds
[0m15:24:03.556919 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:03.557900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:24:03.569219 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:24:03.570219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f9f3ac-fb5c-4001-978d-d8caf0413304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED432E2000>]}
[0m15:24:03.571218 [debug] [MainThread]: On master: ROLLBACK
[0m15:24:03.572290 [debug] [MainThread]: On master: Close
[0m15:24:03.572290 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:24:03.572290 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:24:03.572290 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:24:03.586350 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:24:03.586350 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now seed.management_control_project.management_control)
[0m15:24:03.590871 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m15:24:03.590871 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:24:03.590871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.management_control_project.management_control, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m15:24:03.590871 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:24:03.601211 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m15:24:03.601211 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:24:03.601211 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:24:03.601211 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:24:03.601211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m15:24:03.601211 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:24:03.611066 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m15:24:03.620960 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:24:03.620960 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:24:03.620960 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:24:03.620960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m15:24:03.620960 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:24:03.620960 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m15:24:03.620960 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:24:03.620960 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:24:03.631260 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:24:03.631260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m15:24:03.631260 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:24:03.636286 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m15:24:03.636286 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:24:03.641326 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:24:03.641326 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:24:03.641326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now model.management_control_project.int_management_control)
[0m15:24:03.641326 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:24:03.641326 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:24:03.641326 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:24:03.641326 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:24:03.641326 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m15:24:03.641326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now snapshot.management_control_project.management_control_snapshot)
[0m15:24:03.650905 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m15:24:03.650905 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m15:24:03.650905 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m15:24:03.650905 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:24:03.650905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.management_control_project.management_control_snapshot, now test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c)
[0m15:24:03.650905 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:24:03.661266 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m15:24:03.661266 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:24:03.661266 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:24:03.661266 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:24:03.661266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m15:24:03.661266 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:24:03.661266 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m15:24:03.670960 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:24:03.670960 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:24:03.670960 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:24:03.670960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m15:24:03.670960 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:24:03.670960 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m15:24:03.670960 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:24:03.680940 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:24:03.680940 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:24:03.680940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m15:24:03.680940 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:24:03.680940 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m15:24:03.680940 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:24:03.680940 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:24:03.680940 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:24:03.680940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_stg_management_control_control_id.6000ea497a, now model.management_control_project.control_growth)
[0m15:24:03.691174 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:24:03.691174 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:24:03.691174 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:24:03.691174 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:24:03.691174 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:24:03.691174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:24:03.691174 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:24:03.701094 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:24:03.701094 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:24:03.701094 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:24:03.701094 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:24:03.701094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_summary, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m15:24:03.701094 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:24:03.710892 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m15:24:03.710892 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:24:03.710892 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:24:03.710892 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:24:03.710892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m15:24:03.710892 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:24:03.721355 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m15:24:03.721355 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:24:03.721355 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:24:03.721355 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m15:24:03.721355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.duplicate_control_entries)
[0m15:24:03.721355 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m15:24:03.721355 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m15:24:03.730986 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m15:24:03.730986 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m15:24:03.730986 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:24:03.730986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m15:24:03.730986 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:24:03.730986 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m15:24:03.741002 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:24:03.741002 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:24:03.741002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:03.741002 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:24:03.741002 [debug] [MainThread]: Connection 'test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b' was properly closed.
[0m15:24:03.741002 [debug] [MainThread]: Command end result
[0m15:24:03.771343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:24:03.781270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:24:03.781270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:24:03.790993 [debug] [MainThread]: Command `dbt compile` succeeded at 15:24:03.790993 after 4.58 seconds
[0m15:24:03.790993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED42E0A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED43427F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED433B2810>]}
[0m15:24:03.790993 [debug] [MainThread]: Flushing usage events
[0m15:24:04.331029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:15.480919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D11710D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D4BCAB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D4BCB4D0>]}


============================== 15:26:15.491070 | d7ae27fd-63c2-4ee5-918f-4b83f9f76492 ==============================
[0m15:26:15.491070 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:26:15.491070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:26:15.688290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ae27fd-63c2-4ee5-918f-4b83f9f76492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D1631E80>]}
[0m15:26:15.728316 [debug] [MainThread]: Command `dbt clean` succeeded at 15:26:15.728316 after 0.43 seconds
[0m15:26:15.728316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D11710D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D1631E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D456C7A0>]}
[0m15:26:15.730841 [debug] [MainThread]: Flushing usage events
[0m15:26:16.311272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:23.221284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898ECF4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028991719460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899171B740>]}


============================== 15:26:23.221284 | c08e1be8-846a-4e15-8f3d-ab33be24d932 ==============================
[0m15:26:23.221284 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:26:23.230888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:23.511033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028992DFD220>]}
[0m15:26:23.600962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028992EB7800>]}
[0m15:26:23.605985 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:26:23.881261 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:26:23.881261 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:26:23.881261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028992EDC9E0>]}
[0m15:26:26.910970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028992DFCE90>]}
[0m15:26:27.107213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:26:27.114209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:26:27.144874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899372F020>]}
[0m15:26:27.144874 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:26:27.145874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289933857C0>]}
[0m15:26:27.148900 [info ] [MainThread]: 
[0m15:26:27.148900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:27.150914 [info ] [MainThread]: 
[0m15:26:27.153641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:27.153641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m15:26:27.248866 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:26:27.250884 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:26:27.250884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:27.301003 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:26:27.301003 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:26:27.301003 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:26:27.301003 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:26:27.311025 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:26:27.311025 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:26:27.311025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m15:26:27.311025 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:26:27.311025 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:26:27.311025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.356091 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m15:26:27.361111 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:26:27.361111 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:26:27.369055 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:27.371039 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:26:27.372038 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:26:27.373038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:26:27.377054 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:26:27.378053 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:26:27.379052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.421129 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m15:26:27.421129 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:26:27.421129 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:26:27.421129 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:27.431262 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:26:27.431262 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:26:27.431262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m15:26:27.431262 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:26:27.431262 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:26:27.431262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.480802 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m15:26:27.480802 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:26:27.480802 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:26:27.480802 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:26:27.490831 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:26:27.490831 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:26:27.490831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m15:26:27.490831 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:26:27.490831 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:26:27.490831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.554352 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m15:26:27.555353 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:26:27.556352 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:26:27.563349 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:27.565223 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:26:27.566222 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:26:27.572218 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:27.572218 [debug] [MainThread]: On master: BEGIN
[0m15:26:27.573217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:27.617940 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m15:26:27.620963 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:27.620963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:27.620963 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:26:27.631103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08e1be8-846a-4e15-8f3d-ab33be24d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028991DA2210>]}
[0m15:26:27.631103 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:27.631103 [debug] [MainThread]: On master: Close
[0m15:26:27.631103 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:26:27.631103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:26:27.631103 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:26:27.646327 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:26:27.646327 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now seed.management_control_project.management_control)
[0m15:26:27.650862 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m15:26:27.650862 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:26:27.650862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.management_control_project.management_control, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m15:26:27.650862 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:26:27.661193 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m15:26:27.661193 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:26:27.661193 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m15:26:27.661193 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:26:27.661193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m15:26:27.661193 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:26:27.681133 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m15:26:27.686138 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:26:27.691164 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m15:26:27.691164 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:26:27.691164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m15:26:27.691164 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:26:27.696169 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m15:26:27.696169 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:26:27.701205 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m15:26:27.701205 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:26:27.701205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m15:26:27.701205 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:26:27.711295 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m15:26:27.711295 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:26:27.711295 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m15:26:27.711295 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:26:27.711295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now model.management_control_project.int_management_control)
[0m15:26:27.711295 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:26:27.721294 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:26:27.721294 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:26:27.721294 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:26:27.721294 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m15:26:27.725799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now snapshot.management_control_project.management_control_snapshot)
[0m15:26:27.725799 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m15:26:27.725799 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m15:26:27.730820 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m15:26:27.730820 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:26:27.730820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.management_control_project.management_control_snapshot, now test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c)
[0m15:26:27.730820 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:26:27.730820 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m15:26:27.730820 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:26:27.741331 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m15:26:27.741331 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:26:27.741331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m15:26:27.741331 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:26:27.741331 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m15:26:27.741331 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:26:27.751200 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m15:26:27.751200 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:26:27.751200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m15:26:27.751200 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:26:27.761302 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m15:26:27.761302 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:26:27.761302 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m15:26:27.761302 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:26:27.761302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m15:26:27.771109 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:26:27.776118 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m15:26:27.776118 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:26:27.781154 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m15:26:27.781154 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:26:27.781154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_stg_management_control_control_id.6000ea497a, now model.management_control_project.control_growth)
[0m15:26:27.781154 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:26:27.781154 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:26:27.790845 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:26:27.790845 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:26:27.795849 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:26:27.795849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:26:27.795849 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:26:27.800882 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:26:27.800882 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:26:27.800882 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:26:27.810976 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:26:27.810976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_summary, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m15:26:27.810976 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:26:27.818400 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m15:26:27.820933 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:26:27.820933 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m15:26:27.820933 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:26:27.825939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m15:26:27.825939 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:26:27.835974 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m15:26:27.835974 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:26:27.835974 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m15:26:27.841002 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m15:26:27.841002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.duplicate_control_entries)
[0m15:26:27.841002 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m15:26:27.846011 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m15:26:27.846011 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m15:26:27.846011 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m15:26:27.846011 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:26:27.846011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m15:26:27.851035 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:26:27.851035 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m15:26:27.856041 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:26:27.856041 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m15:26:27.856041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:27.856041 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:26:27.861057 [debug] [MainThread]: Connection 'test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b' was properly closed.
[0m15:26:27.861057 [debug] [MainThread]: Command end result
[0m15:26:27.892046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:26:27.899240 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:26:27.913838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:26:27.913838 [debug] [MainThread]: Command `dbt compile` succeeded at 15:26:27.913838 after 4.83 seconds
[0m15:26:27.913838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028991A94F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028991421F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289934C2D20>]}
[0m15:26:27.913838 [debug] [MainThread]: Flushing usage events
[0m15:26:28.441116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:35.780894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C63394F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C662E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C6041B80>]}


============================== 15:26:35.790852 | d512ce25-3900-4b0b-8ea7-d128d08ee9a1 ==============================
[0m15:26:35.790852 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:26:35.790852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:26:36.085812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C61D76E0>]}
[0m15:26:36.180758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C695BB60>]}
[0m15:26:36.182755 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:26:36.485608 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:26:36.769266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:36.770265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:36.861834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C6A739B0>]}
[0m15:26:37.006200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:26:37.011794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:26:37.051181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C7ECC470>]}
[0m15:26:37.051181 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:26:37.051181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C7EB7770>]}
[0m15:26:37.051181 [info ] [MainThread]: 
[0m15:26:37.051181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:37.051181 [info ] [MainThread]: 
[0m15:26:37.051181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:37.062205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:26:37.151771 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:26:37.151771 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:26:37.152770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:37.301022 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.150 seconds
[0m15:26:37.301022 [debug] [ThreadPool]: On list_gestion: Close
[0m15:26:37.301022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_public_seeds)
[0m15:26:37.301022 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_seeds"
"
[0m15:26:37.311250 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m15:26:37.311250 [debug] [ThreadPool]: On create_gestion_public_seeds: BEGIN
[0m15:26:37.311250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:37.351152 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m15:26:37.351152 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m15:26:37.351152 [debug] [ThreadPool]: On create_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_seeds"} */
create schema if not exists "public_seeds"
[0m15:26:37.361290 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m15:26:37.361290 [debug] [ThreadPool]: On create_gestion_public_seeds: COMMIT
[0m15:26:37.361290 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m15:26:37.361290 [debug] [ThreadPool]: On create_gestion_public_seeds: COMMIT
[0m15:26:37.361290 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:26:37.361290 [debug] [ThreadPool]: On create_gestion_public_seeds: Close
[0m15:26:37.371128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m15:26:37.380977 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:26:37.380977 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:26:37.380977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:37.420918 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m15:26:37.420918 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:26:37.420918 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:26:37.431173 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:37.431173 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:26:37.431173 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:26:37.431173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m15:26:37.441067 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:26:37.441067 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:26:37.441067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:37.489565 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m15:26:37.490565 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:26:37.490565 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:26:37.498607 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:37.500618 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:26:37.500618 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:26:37.501621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m15:26:37.505619 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:26:37.505619 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:26:37.506601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:37.662078 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m15:26:37.662078 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:26:37.662078 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:26:37.670986 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:26:37.670986 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:26:37.677753 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:26:37.678418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m15:26:37.680953 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:26:37.680953 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:26:37.680953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:37.831668 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m15:26:37.832669 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:26:37.832669 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:26:37.841200 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:26:37.841200 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:26:37.845218 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:26:37.845218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m15:26:37.845218 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:26:37.845218 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:26:37.845218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:37.900988 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:26:37.900988 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:26:37.900988 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:26:37.900988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:26:37.911550 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:26:37.911550 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:26:37.911550 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:37.911550 [debug] [MainThread]: On master: BEGIN
[0m15:26:37.911550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:37.961403 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m15:26:37.961403 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:37.961403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:37.978436 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:26:37.980950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C6AEF830>]}
[0m15:26:37.980950 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:37.980950 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:37.980950 [debug] [MainThread]: On master: BEGIN
[0m15:26:37.980950 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:26:37.980950 [debug] [MainThread]: On master: COMMIT
[0m15:26:37.980950 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:37.980950 [debug] [MainThread]: On master: COMMIT
[0m15:26:37.980950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:37.980950 [debug] [MainThread]: On master: Close
[0m15:26:37.980950 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m15:26:37.980950 [info ] [Thread-1 (]: 1 of 1 START seed file public_seeds.management_control ......................... [RUN]
[0m15:26:37.980950 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m15:26:37.990926 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m15:26:37.990926 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m15:26:38.036312 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:26:38.036312 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m15:26:38.036312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:38.080846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m15:26:38.080846 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:26:38.080846 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */

    create table "gestion"."public_seeds"."management_control" ("control_id" integer,"department_id" integer,"control_date" date,"expenses" float8,"revenue" float8,"status" text)
  
[0m15:26:38.100414 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m15:26:38.168950 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:26:38.169949 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public_seeds"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m15:26:38.173947 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m15:26:38.181311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m15:26:38.206314 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m15:26:38.206314 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:26:38.206314 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m15:26:38.206314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:26:38.212463 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m15:26:38.215259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd512ce25-3900-4b0b-8ea7-d128d08ee9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C5C78D10>]}
[0m15:26:38.216279 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_seeds.management_control ..................... [[32mINSERT 100[0m in 0.23s]
[0m15:26:38.217262 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m15:26:38.219260 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:38.219260 [debug] [MainThread]: On master: BEGIN
[0m15:26:38.220263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:38.273079 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m15:26:38.274079 [debug] [MainThread]: On master: COMMIT
[0m15:26:38.275078 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:38.276077 [debug] [MainThread]: On master: COMMIT
[0m15:26:38.276077 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:38.277076 [debug] [MainThread]: On master: Close
[0m15:26:38.278316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:38.278316 [debug] [MainThread]: Connection 'create_gestion_public_seeds' was properly closed.
[0m15:26:38.279310 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m15:26:38.279310 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m15:26:38.280326 [info ] [MainThread]: 
[0m15:26:38.281318 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m15:26:38.282308 [debug] [MainThread]: Command end result
[0m15:26:38.310889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:26:38.312590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:26:38.321112 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:26:38.321112 [info ] [MainThread]: 
[0m15:26:38.321112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:38.321112 [info ] [MainThread]: 
[0m15:26:38.321112 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:38.327717 [debug] [MainThread]: Command `dbt seed` succeeded at 15:26:38.327717 after 2.68 seconds
[0m15:26:38.328738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C5FBEB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C6AEFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C82E21E0>]}
[0m15:26:38.328738 [debug] [MainThread]: Flushing usage events
[0m15:26:38.871323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:27.730971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206376D61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206398276B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020639826390>]}


============================== 15:27:27.742088 | 5721eb8a-1562-4ee8-a267-c3f9a46b0136 ==============================
[0m15:27:27.742088 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:27:27.742088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:27:28.061210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A56A000>]}
[0m15:27:28.160929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A2929C0>]}
[0m15:27:28.165933 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:28.436171 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:27:28.661111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:28.661111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:28.781142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A613200>]}
[0m15:27:28.931051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:27:28.936059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:27:28.970912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063BA2B4D0>]}
[0m15:27:28.970912 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:27:28.970912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B810F20>]}
[0m15:27:28.981221 [info ] [MainThread]: 
[0m15:27:28.981221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:28.981221 [info ] [MainThread]: 
[0m15:27:28.981221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:28.981221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:27:29.086220 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:27:29.087219 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:27:29.087219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:29.139194 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.051 seconds
[0m15:27:29.141179 [debug] [ThreadPool]: On list_gestion: Close
[0m15:27:29.142177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_snapshots)
[0m15:27:29.143177 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "snapshots"
"
[0m15:27:29.151162 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m15:27:29.151162 [debug] [ThreadPool]: On create_gestion_snapshots: BEGIN
[0m15:27:29.151162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.305757 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m15:27:29.306755 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m15:27:29.306755 [debug] [ThreadPool]: On create_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_snapshots"} */
create schema if not exists "snapshots"
[0m15:27:29.308758 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:27:29.309776 [debug] [ThreadPool]: On create_gestion_snapshots: COMMIT
[0m15:27:29.310787 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m15:27:29.310787 [debug] [ThreadPool]: On create_gestion_snapshots: COMMIT
[0m15:27:29.314520 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:27:29.315520 [debug] [ThreadPool]: On create_gestion_snapshots: Close
[0m15:27:29.380265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m15:27:29.398634 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:27:29.399634 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:27:29.400634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:29.580956 [debug] [ThreadPool]: SQL status: BEGIN in 0.184 seconds
[0m15:27:29.580956 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:27:29.585473 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:27:29.591001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:27:29.591001 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:27:29.591001 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:27:29.597349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m15:27:29.600873 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:27:29.600873 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:27:29.600873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.647816 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:27:29.650847 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:27:29.650847 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:27:29.650847 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:27:29.661166 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:27:29.661166 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:27:29.663973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m15:27:29.663973 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:27:29.663973 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:27:29.663973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.713685 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:27:29.713685 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:27:29.713685 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:27:29.721216 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:27:29.721216 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:27:29.721216 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:27:29.721216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m15:27:29.731173 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:27:29.731173 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:27:29.731173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.785513 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:27:29.785513 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:27:29.785513 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:27:29.791028 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:27:29.791028 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:27:29.791028 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:27:29.791028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m15:27:29.797265 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:27:29.797265 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:27:29.797265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.847282 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:27:29.847282 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:27:29.847282 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:27:29.856308 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:27:29.856308 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:27:29.856308 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:27:29.863604 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:29.863604 [debug] [MainThread]: On master: BEGIN
[0m15:27:29.863604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:29.910899 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m15:27:29.913033 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:29.913654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:29.921169 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:27:29.921169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063BE984D0>]}
[0m15:27:29.921169 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:29.921169 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:29.921169 [debug] [MainThread]: On master: BEGIN
[0m15:27:29.921169 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:27:29.921169 [debug] [MainThread]: On master: COMMIT
[0m15:27:29.921169 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:29.921169 [debug] [MainThread]: On master: COMMIT
[0m15:27:29.921169 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:29.930255 [debug] [MainThread]: On master: Close
[0m15:27:29.931676 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m15:27:29.931676 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m15:27:29.931676 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m15:27:29.931676 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m15:27:29.941241 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m15:27:30.026309 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:27:30.026309 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        
    

    SELECT * 
    FROM "gestion"."public_staging"."stg_management_control"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:27:30.026309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:30.081318 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public_staging.stg_management_control » n'existe pas
LINE 21:     FROM "gestion"."public_staging"."stg_management_control"
                  ^

[0m15:27:30.081318 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m15:27:30.090864 [debug] [Thread-1 (]: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  la relation « public_staging.stg_management_control » n'existe pas
  LINE 21:     FROM "gestion"."public_staging"."stg_management_control"
                    ^
[0m15:27:30.090864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5721eb8a-1562-4ee8-a267-c3f9a46b0136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020639870F20>]}
[0m15:27:30.101165 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.management_control_snapshot ................ [[31mERROR[0m in 0.16s]
[0m15:27:30.101165 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m15:27:30.106171 [debug] [Thread-4 (]: Marking all children of 'snapshot.management_control_project.management_control_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  la relation « public_staging.stg_management_control » n'existe pas
  LINE 21:     FROM "gestion"."public_staging"."stg_management_control"
                    ^.
[0m15:27:30.106171 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:30.106171 [debug] [MainThread]: On master: BEGIN
[0m15:27:30.106171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:30.261011 [debug] [MainThread]: SQL status: BEGIN in 0.156 seconds
[0m15:27:30.261011 [debug] [MainThread]: On master: COMMIT
[0m15:27:30.261011 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:30.261011 [debug] [MainThread]: On master: COMMIT
[0m15:27:30.261011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:30.261011 [debug] [MainThread]: On master: Close
[0m15:27:30.261011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:30.261011 [debug] [MainThread]: Connection 'create_gestion_snapshots' was properly closed.
[0m15:27:30.261011 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m15:27:30.261011 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m15:27:30.271223 [info ] [MainThread]: 
[0m15:27:30.271223 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m15:27:30.271223 [debug] [MainThread]: Command end result
[0m15:27:30.301154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:27:30.301154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:27:30.311076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:27:30.311076 [info ] [MainThread]: 
[0m15:27:30.312907 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:30.314907 [info ] [MainThread]: 
[0m15:27:30.317219 [error] [MainThread]:   Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  la relation « public_staging.stg_management_control » n'existe pas
  LINE 21:     FROM "gestion"."public_staging"."stg_management_control"
                    ^
[0m15:27:30.319217 [info ] [MainThread]: 
[0m15:27:30.321217 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:30.323215 [debug] [MainThread]: Command `dbt snapshot` failed at 15:27:30.323215 after 2.74 seconds
[0m15:27:30.324212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A1FA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A3E0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063A3E05C0>]}
[0m15:27:30.325212 [debug] [MainThread]: Flushing usage events
[0m15:27:30.851060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:59.255897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025839A74530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583C2DB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583C2DB170>]}


============================== 15:27:59.260932 | 10fc5d27-d67c-44dd-8cbe-b9cde1e2935a ==============================
[0m15:27:59.260932 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:27:59.260932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:59.566072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583C632960>]}
[0m15:27:59.661571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583C10D1F0>]}
[0m15:27:59.663566 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:59.921013 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:28:00.153490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:00.155524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:00.246064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583CA2B200>]}
[0m15:28:00.404785 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:28:00.409800 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:28:00.441273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583DDF7E60>]}
[0m15:28:00.441273 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:28:00.441273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583DD8CBC0>]}
[0m15:28:00.441273 [info ] [MainThread]: 
[0m15:28:00.441273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:00.450938 [info ] [MainThread]: 
[0m15:28:00.450938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:00.458425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:28:00.549944 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:28:00.550943 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:28:00.550943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:00.601685 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.050 seconds
[0m15:28:00.604376 [debug] [ThreadPool]: On list_gestion: Close
[0m15:28:00.609623 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:28:00.610643 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:28:00.610643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:00.656752 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.046 seconds
[0m15:28:00.658618 [debug] [ThreadPool]: On list_gestion: Close
[0m15:28:00.661616 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:28:00.662615 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:28:00.662615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:00.713655 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.050 seconds
[0m15:28:00.714673 [debug] [ThreadPool]: On list_gestion: Close
[0m15:28:00.716655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_public_management_control)
[0m15:28:00.716655 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_management_control"
"
[0m15:28:00.724524 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m15:28:00.724524 [debug] [ThreadPool]: On create_gestion_public_management_control: BEGIN
[0m15:28:00.725524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:00.874622 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m15:28:00.874622 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m15:28:00.875622 [debug] [ThreadPool]: On create_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_management_control"} */
create schema if not exists "public_management_control"
[0m15:28:00.877621 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:28:00.878620 [debug] [ThreadPool]: On create_gestion_public_management_control: COMMIT
[0m15:28:00.879619 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m15:28:00.879619 [debug] [ThreadPool]: On create_gestion_public_management_control: COMMIT
[0m15:28:00.882940 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:28:00.882940 [debug] [ThreadPool]: On create_gestion_public_management_control: Close
[0m15:28:00.885956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m15:28:00.893690 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:28:00.893690 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:28:00.894690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:00.943508 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:28:00.943508 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:28:00.944507 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:28:00.951675 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:28:00.955364 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:28:00.955450 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:28:00.956450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m15:28:00.959449 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:28:00.960447 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:28:00.960447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:01.011117 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m15:28:01.011117 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:28:01.011117 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:28:01.023104 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:28:01.025618 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:28:01.025618 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:28:01.025618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m15:28:01.031136 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:28:01.031136 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:28:01.031136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:01.190792 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:28:01.190792 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:28:01.190792 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:28:01.201146 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:28:01.201146 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:28:01.204229 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:28:01.204979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m15:28:01.204979 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:28:01.211036 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:28:01.211036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:01.365322 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m15:28:01.366334 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:28:01.366851 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:28:01.377786 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m15:28:01.379783 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:28:01.379783 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:28:01.380783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m15:28:01.383781 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:28:01.383781 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:28:01.384781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:01.431222 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:28:01.431222 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:28:01.431222 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:28:01.438124 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:28:01.441150 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:28:01.441150 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:28:01.441150 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.441150 [debug] [MainThread]: On master: BEGIN
[0m15:28:01.441150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:01.491048 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m15:28:01.500932 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.500932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:01.510884 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:28:01.510884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583DDF5610>]}
[0m15:28:01.510884 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:01.510884 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.510884 [debug] [MainThread]: On master: BEGIN
[0m15:28:01.510884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:28:01.510884 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.510884 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.510884 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.510884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:01.510884 [debug] [MainThread]: On master: Close
[0m15:28:01.520820 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:28:01.521796 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:28:01.523049 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:28:01.523049 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:28:01.531087 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:28:01.531087 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:28:01.605211 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:28:01.611247 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:28:01.611247 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:28:01.611247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:01.661068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m15:28:01.661068 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:28:01.661068 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:28:01.671275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « seeds.management_control » n'existe pas
LINE 24:     FROM "gestion"."seeds"."management_control" 
                  ^

[0m15:28:01.672265 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: ROLLBACK
[0m15:28:01.673264 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:28:01.679260 [debug] [Thread-1 (]: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control" 
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m15:28:01.682264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10fc5d27-d67c-44dd-8cbe-b9cde1e2935a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583CA4C110>]}
[0m15:28:01.683259 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_staging.stg_management_control  [[31mERROR[0m in 0.16s]
[0m15:28:01.684258 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:28:01.685257 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.stg_management_control' to be skipped because of status 'error'.  Reason: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control" 
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql.
[0m15:28:01.686256 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:28:01.687706 [info ] [Thread-1 (]: 2 of 4 SKIP relation public_intermediate.int_management_control ................ [[33mSKIP[0m]
[0m15:28:01.689706 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:28:01.690705 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:28:01.693703 [info ] [Thread-1 (]: 3 of 4 SKIP relation public_management_control.control_growth .................. [[33mSKIP[0m]
[0m15:28:01.695200 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:28:01.695200 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:28:01.695200 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_management_control.control_summary ................. [[33mSKIP[0m]
[0m15:28:01.701223 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:28:01.701223 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.701223 [debug] [MainThread]: On master: BEGIN
[0m15:28:01.705001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:01.770801 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m15:28:01.771653 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.772650 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.773651 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.774651 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:28:01.775650 [debug] [MainThread]: On master: Close
[0m15:28:01.777648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:01.777648 [debug] [MainThread]: Connection 'create_gestion_public_management_control' was properly closed.
[0m15:28:01.778649 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m15:28:01.779647 [debug] [MainThread]: Connection 'model.management_control_project.stg_management_control' was properly closed.
[0m15:28:01.780647 [info ] [MainThread]: 
[0m15:28:01.781647 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m15:28:01.783646 [debug] [MainThread]: Command end result
[0m15:28:01.811197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:28:01.811197 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:28:01.825815 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:28:01.825815 [info ] [MainThread]: 
[0m15:28:01.825815 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:28:01.825815 [info ] [MainThread]: 
[0m15:28:01.825815 [error] [MainThread]:   Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la relation « seeds.management_control » n'existe pas
  LINE 24:     FROM "gestion"."seeds"."management_control" 
                    ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m15:28:01.830834 [info ] [MainThread]: 
[0m15:28:01.830834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m15:28:01.830834 [debug] [MainThread]: Command `dbt run` failed at 15:28:01.830834 after 2.72 seconds
[0m15:28:01.830834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583BEE4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583C59ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583DDDC080>]}
[0m15:28:01.830834 [debug] [MainThread]: Flushing usage events
[0m15:28:02.378542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:27.937950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C9B993D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C99380E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C9B9A150>]}


============================== 15:30:27.943731 | e1e0b24d-81d4-4582-98bc-08f35380a3d2 ==============================
[0m15:30:27.943731 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:30:27.944734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:30:28.286815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CA1EDFD0>]}
[0m15:30:28.382481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C955FE00>]}
[0m15:30:28.391010 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:28.789373 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:30:29.188288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:29.190288 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\staging\schema.yaml
[0m15:30:30.630974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CBACBBC0>]}
[0m15:30:30.771196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:30:30.780980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:30:30.824687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CBBF6480>]}
[0m15:30:30.825688 [info ] [MainThread]: Found 1 seed, 4 models, 1 snapshot, 12 data tests, 1 source, 432 macros
[0m15:30:30.826180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CBC9F230>]}
[0m15:30:30.830746 [info ] [MainThread]: 
[0m15:30:30.831740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:30.833997 [info ] [MainThread]: 
[0m15:30:30.834790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:30.839751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:30:30.948284 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:30:30.950281 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:30:30.950281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:31.000910 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.053 seconds
[0m15:30:31.000910 [debug] [ThreadPool]: On list_gestion: Close
[0m15:30:31.000910 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:30:31.000910 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:30:31.000910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.158421 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.149 seconds
[0m15:30:31.160441 [debug] [ThreadPool]: On list_gestion: Close
[0m15:30:31.162834 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:30:31.162834 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:30:31.162834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.219664 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.054 seconds
[0m15:30:31.222662 [debug] [ThreadPool]: On list_gestion: Close
[0m15:30:31.224663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m15:30:31.231006 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:30:31.231006 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:30:31.231006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:31.286847 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:30:31.287849 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:30:31.287849 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:30:31.295852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:30:31.295852 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:30:31.295852 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:30:31.295852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m15:30:31.300875 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:30:31.300875 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:30:31.300875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.463026 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:30:31.463026 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:30:31.463026 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:30:31.471058 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:30:31.481767 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:30:31.482749 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:30:31.482749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m15:30:31.485764 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:30:31.486764 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:30:31.486764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.531124 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:30:31.531124 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:30:31.531124 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:30:31.548257 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:30:31.549257 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:30:31.550256 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:30:31.551256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m15:30:31.554253 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:30:31.555253 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:30:31.555253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.600972 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m15:30:31.600972 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:30:31.600972 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:30:31.620067 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m15:30:31.623069 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:30:31.624065 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:30:31.625065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m15:30:31.628062 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:30:31.629583 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:30:31.630991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.683564 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m15:30:31.684563 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:30:31.685562 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:30:31.692557 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:30:31.694556 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:30:31.695556 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:30:31.700830 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.700830 [debug] [MainThread]: On master: BEGIN
[0m15:30:31.700830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:31.753192 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m15:30:31.754187 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.754187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:31.763422 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:30:31.763422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CBD695E0>]}
[0m15:30:31.763422 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:31.763422 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.770941 [debug] [MainThread]: On master: BEGIN
[0m15:30:31.770941 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:30:31.770941 [debug] [MainThread]: On master: COMMIT
[0m15:30:31.770941 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.770941 [debug] [MainThread]: On master: COMMIT
[0m15:30:31.770941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:31.770941 [debug] [MainThread]: On master: Close
[0m15:30:31.770941 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:30:31.770941 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:30:31.782524 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:30:31.783523 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:30:31.791518 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:30:31.793517 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:30:31.881469 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:30:31.917195 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:30:31.919194 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:30:31.920193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:32.001275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:30:32.001275 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:30:32.001275 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:30:32.019221 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.014 seconds
[0m15:30:32.043322 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:30:32.045288 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:30:32.047321 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:30:32.049231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:30:32.051232 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:30:32.055230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C94D4FB0>]}
[0m15:30:32.057229 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.27s]
[0m15:30:32.059228 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:30:32.059228 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:30:32.060227 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:30:32.062322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:30:32.063301 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:30:32.067507 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:30:32.071035 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:30:32.071035 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:30:32.078444 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:30:32.080443 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:30:32.081442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:32.136448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m15:30:32.137448 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:30:32.138447 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:30:32.151482 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m15:30:32.154480 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:30:32.154480 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:30:32.155479 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:30:32.156959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:30:32.157962 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:30:32.158961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC0E9790>]}
[0m15:30:32.159962 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.10s]
[0m15:30:32.161962 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:30:32.163191 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:30:32.164181 [info ] [Thread-1 (]: 3 of 4 START sql table model public_management_control.control_growth .......... [RUN]
[0m15:30:32.166180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:30:32.166902 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:30:32.170901 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:30:32.172899 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:30:32.192888 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:30:32.195112 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:30:32.197112 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:30:32.198028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:32.249302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m15:30:32.249302 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:30:32.250300 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
    CASE
        WHEN previous_month_net_profit IS NULL OR previous_month_net_profit = 0 THEN NULL
        ELSE ROUND((monthly_net_profit - previous_month_net_profit) / previous_month_net_profit * 100, 2)
    END
 AS growth_rate
FROM growth_calculation
  );
  
[0m15:30:32.255149 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction round(double precision, integer) n'existe pas
LINE 39:         ELSE ROUND((monthly_net_profit - previous_month_net_...
                      ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m15:30:32.256151 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m15:30:32.257151 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:30:32.264147 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 39:         ELSE ROUND((monthly_net_profit - previous_month_net_...
                        ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:30:32.265146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CB99E960>]}
[0m15:30:32.267146 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public_management_control.control_growth . [[31mERROR[0m in 0.10s]
[0m15:30:32.268144 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:30:32.269144 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:30:32.269144 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 39:         ELSE ROUND((monthly_net_profit - previous_month_net_...
                        ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m15:30:32.270144 [info ] [Thread-1 (]: 4 of 4 START sql table model public_management_control.control_summary ......... [RUN]
[0m15:30:32.272143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:30:32.273141 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:30:32.276140 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:30:32.279064 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:30:32.287060 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:30:32.288775 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:30:32.289778 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:30:32.289778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:32.430845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m15:30:32.430845 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:30:32.430845 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
)

SELECT *
FROM monthly_control
ORDER BY control_year, control_month
  );
  
[0m15:30:32.450023 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m15:30:32.456035 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:30:32.457035 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m15:30:32.458403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:32.461675 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:30:32.463066 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:30:32.463066 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:30:32.463066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:30:32.471105 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m15:30:32.481551 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:30:32.482551 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m15:30:32.484353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:30:32.486373 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:30:32.487354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e0b24d-81d4-4582-98bc-08f35380a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC4AEDB0>]}
[0m15:30:32.488354 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public_management_control.control_summary .... [[32mSELECT 12[0m in 0.22s]
[0m15:30:32.490352 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:30:32.492351 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:32.493350 [debug] [MainThread]: On master: BEGIN
[0m15:30:32.494351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:32.553933 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m15:30:32.553933 [debug] [MainThread]: On master: COMMIT
[0m15:30:32.554933 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:32.555932 [debug] [MainThread]: On master: COMMIT
[0m15:30:32.555932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:32.556931 [debug] [MainThread]: On master: Close
[0m15:30:32.557930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:32.557930 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:30:32.558931 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:30:32.558931 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:30:32.559930 [info ] [MainThread]: 
[0m15:30:32.560929 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m15:30:32.564928 [debug] [MainThread]: Command end result
[0m15:30:32.601032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:30:32.601032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:30:32.614633 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:30:32.615632 [info ] [MainThread]: 
[0m15:30:32.616630 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:32.617630 [info ] [MainThread]: 
[0m15:30:32.617630 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 39:         ELSE ROUND((monthly_net_profit - previous_month_net_...
                        ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:30:32.619628 [info ] [MainThread]: 
[0m15:30:32.620628 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:30:32.622628 [debug] [MainThread]: Command `dbt run` failed at 15:30:32.622628 after 4.90 seconds
[0m15:30:32.623627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C9EBE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C95920C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CBABF0E0>]}
[0m15:30:32.624625 [debug] [MainThread]: Flushing usage events
[0m15:30:33.288692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:50.241092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026885D79E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026885D7B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026885D78FE0>]}


============================== 15:38:50.241092 | c94a36db-cfe2-47fd-8744-404b33f1b455 ==============================
[0m15:38:50.241092 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:38:50.241092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:50.525896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268860A3C20>]}
[0m15:38:50.617020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026885A81D00>]}
[0m15:38:50.617020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:38:50.890813 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:38:51.168614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:38:51.169712 [debug] [MainThread]: Partial parsing: updated file: management_control_project://macros\calculate_growth.sql
[0m15:38:51.169712 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\marts\management_control\control_growth.sql
[0m15:38:51.831223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268864FE150>]}
[0m15:38:51.965765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:38:51.970807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:38:52.010933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002688775EC90>]}
[0m15:38:52.010933 [info ] [MainThread]: Found 1 seed, 4 models, 1 snapshot, 12 data tests, 1 source, 432 macros
[0m15:38:52.010933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268862008F0>]}
[0m15:38:52.010933 [info ] [MainThread]: 
[0m15:38:52.010933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:52.020845 [info ] [MainThread]: 
[0m15:38:52.022638 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:38:52.024785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:38:52.115577 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:38:52.115577 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:38:52.116577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:52.167390 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.051 seconds
[0m15:38:52.169373 [debug] [ThreadPool]: On list_gestion: Close
[0m15:38:52.175345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m15:38:52.182341 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:38:52.183340 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:38:52.183340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:52.220895 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m15:38:52.220895 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:38:52.220895 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:38:52.230944 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:38:52.230944 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:38:52.230944 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:38:52.230944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m15:38:52.240802 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:38:52.240802 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:38:52.240802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:52.380981 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m15:38:52.380981 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:38:52.380981 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:38:52.390921 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:38:52.390921 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:38:52.390921 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:38:52.390921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:38:52.401126 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:38:52.401126 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:38:52.401126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:52.561004 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:38:52.561004 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:38:52.561004 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:38:52.574849 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:38:52.576866 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:38:52.576866 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:38:52.577849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m15:38:52.582846 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:38:52.583845 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:38:52.583845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:52.748704 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m15:38:52.749705 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:38:52.751703 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:38:52.761321 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m15:38:52.763338 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:38:52.763338 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:38:52.764338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m15:38:52.767319 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:38:52.767319 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:38:52.768318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:52.810825 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:38:52.810825 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:38:52.821130 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:38:52.821130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:38:52.821130 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:38:52.821130 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:38:52.836245 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:52.836245 [debug] [MainThread]: On master: BEGIN
[0m15:38:52.836245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:52.881065 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m15:38:52.881065 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:52.881065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:38:52.890873 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:38:52.890873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002688817D670>]}
[0m15:38:52.890873 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:52.890873 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:52.890873 [debug] [MainThread]: On master: BEGIN
[0m15:38:52.901268 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:38:52.901268 [debug] [MainThread]: On master: COMMIT
[0m15:38:52.901268 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:52.901268 [debug] [MainThread]: On master: COMMIT
[0m15:38:52.901268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:52.901268 [debug] [MainThread]: On master: Close
[0m15:38:52.901268 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m15:38:52.901268 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m15:38:52.901268 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m15:38:52.901268 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m15:38:52.916114 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m15:38:52.988087 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:38:52.988087 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        
    

    SELECT * 
    FROM "gestion"."public_staging"."stg_management_control"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:38:52.988087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:53.031213 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m15:38:53.040846 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:38:53.040846 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:38:53.040846 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:38:53.040846 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m15:38:53.040846 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m15:38:53.040846 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:38:53.040846 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m15:38:53.051156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:38:53.052819 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:38:53.054199 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      
  
    

  create  table "gestion"."snapshots"."management_control_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        
    

    SELECT * 
    FROM "gestion"."public_staging"."stg_management_control"
    ) sbq



  );
  
  
[0m15:38:53.060922 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m15:38:53.088009 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m15:38:53.088009 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:38:53.089021 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m15:38:53.091020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:38:53.093023 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m15:38:53.096003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94a36db-cfe2-47fd-8744-404b33f1b455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026883678680>]}
[0m15:38:53.098003 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mSELECT 51[0m in 0.19s]
[0m15:38:53.100001 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m15:38:53.101001 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:53.102018 [debug] [MainThread]: On master: BEGIN
[0m15:38:53.103000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:53.260992 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m15:38:53.260992 [debug] [MainThread]: On master: COMMIT
[0m15:38:53.260992 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:53.260992 [debug] [MainThread]: On master: COMMIT
[0m15:38:53.260992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:53.260992 [debug] [MainThread]: On master: Close
[0m15:38:53.260992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:53.260992 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:38:53.260992 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:38:53.260992 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m15:38:53.271243 [info ] [MainThread]: 
[0m15:38:53.271243 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m15:38:53.271243 [debug] [MainThread]: Command end result
[0m15:38:53.376128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:38:53.381163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:38:53.390450 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:38:53.391466 [info ] [MainThread]: 
[0m15:38:53.392448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:53.393466 [info ] [MainThread]: 
[0m15:38:53.394447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:53.396680 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:38:53.396680 after 3.36 seconds
[0m15:38:53.396680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026886039AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026887652CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026888276C60>]}
[0m15:38:53.397659 [debug] [MainThread]: Flushing usage events
[0m15:38:54.007245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:35.984101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AE53890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AE52660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AE521B0>]}


============================== 15:41:35.989952 | d402184f-65ab-47bc-a9cc-a146804d17e5 ==============================
[0m15:41:35.989952 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:41:35.993988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:36.381815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21A3888F0>]}
[0m15:41:36.492948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AD0F320>]}
[0m15:41:36.492948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:41:36.831109 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:41:37.100800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:37.100800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:37.201058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21C18AE70>]}
[0m15:41:37.382559 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:41:37.387556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:41:37.443256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21C587D70>]}
[0m15:41:37.447254 [info ] [MainThread]: Found 1 seed, 4 models, 1 snapshot, 12 data tests, 1 source, 432 macros
[0m15:41:37.450253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21C4F3560>]}
[0m15:41:37.454249 [info ] [MainThread]: 
[0m15:41:37.455251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:37.456249 [info ] [MainThread]: 
[0m15:41:37.461153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:37.466163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:41:37.616841 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:41:37.616841 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:41:37.617841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:37.685275 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.067 seconds
[0m15:41:37.687280 [debug] [ThreadPool]: On list_gestion: Close
[0m15:41:37.691272 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:41:37.691950 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:41:37.693950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:37.746330 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.052 seconds
[0m15:41:37.748328 [debug] [ThreadPool]: On list_gestion: Close
[0m15:41:37.752326 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:41:37.753325 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:41:37.754326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:37.833619 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.079 seconds
[0m15:41:37.834618 [debug] [ThreadPool]: On list_gestion: Close
[0m15:41:37.837616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m15:41:37.847287 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:41:37.848287 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:41:37.848287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:37.901089 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m15:41:37.908722 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:41:37.909719 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:41:37.918714 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:41:37.920714 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:41:37.921712 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:41:37.922712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m15:41:37.927027 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:41:37.927027 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:41:37.929560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:38.085335 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m15:41:38.085335 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:41:38.086336 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:41:38.094302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m15:41:38.094302 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:41:38.100831 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:41:38.100831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m15:41:38.100831 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:41:38.100831 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:41:38.100831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:38.186327 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m15:41:38.187327 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:41:38.188326 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:41:38.209674 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m15:41:38.212672 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:41:38.214673 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:41:38.215672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m15:41:38.220667 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:41:38.221667 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:41:38.222666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:38.400791 [debug] [ThreadPool]: SQL status: BEGIN in 0.178 seconds
[0m15:41:38.400791 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:41:38.400791 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:41:38.412657 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:41:38.414636 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:41:38.415636 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:41:38.416651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m15:41:38.419635 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:41:38.420634 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:41:38.420634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:38.475382 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m15:41:38.476383 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:41:38.477382 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:41:38.484377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:41:38.486377 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:41:38.487376 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:41:38.492482 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:38.492482 [debug] [MainThread]: On master: BEGIN
[0m15:41:38.492482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:38.647317 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m15:41:38.648315 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:38.648315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:38.661397 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:41:38.661397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21833A240>]}
[0m15:41:38.661397 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:38.661397 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:38.661397 [debug] [MainThread]: On master: BEGIN
[0m15:41:38.661397 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:41:38.661397 [debug] [MainThread]: On master: COMMIT
[0m15:41:38.661397 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:38.661397 [debug] [MainThread]: On master: COMMIT
[0m15:41:38.661397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:41:38.661397 [debug] [MainThread]: On master: Close
[0m15:41:38.671014 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:41:38.671014 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:41:38.676183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:41:38.677183 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:41:38.686195 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:41:38.688175 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:41:38.796122 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.797120 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp154138736000"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:41:38.797120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:38.860493 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.063 seconds
[0m15:41:38.878389 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.879388 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:41:38.882388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:41:38.882388 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.883386 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154138736000'
        
      order by ordinal_position

  
[0m15:41:38.903736 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.019 seconds
[0m15:41:38.910732 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.911731 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:41:38.916729 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m15:41:38.933844 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.934843 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154138736000'
        
      order by ordinal_position

  
[0m15:41:38.938600 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m15:41:38.944596 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.945595 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:41:38.949593 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m15:41:38.962996 [debug] [Thread-1 (]: 
    In "gestion"."public_staging"."stg_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:41:38.983275 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:41:38.985274 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:38.985274 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp154138736000"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp154138736000"
    )
  
[0m15:41:38.988368 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m15:41:39.008627 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:41:39.009626 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:41:39.010626 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:41:39.012454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:41:39.014456 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:41:39.018453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2182AC0B0>]}
[0m15:41:39.019453 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.34s]
[0m15:41:39.021452 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:41:39.022452 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:41:39.026253 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:41:39.028254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:41:39.030252 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:41:39.035590 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:41:39.036589 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:41:39.041485 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.043486 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp154139038588"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:41:39.044485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:39.104368 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.059 seconds
[0m15:41:39.111361 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.112362 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:41:39.114359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:41:39.115359 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.116358 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154139038588'
        
      order by ordinal_position

  
[0m15:41:39.131412 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.016 seconds
[0m15:41:39.135919 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.135919 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:41:39.142888 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.005 seconds
[0m15:41:39.146886 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.147885 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154139038588'
        
      order by ordinal_position

  
[0m15:41:39.151882 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:41:39.155880 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.156879 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:41:39.161031 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:41:39.161031 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:41:39.166036 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:41:39.166036 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.166036 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp154139038588"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp154139038588"
    )
  
[0m15:41:39.171058 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m15:41:39.171058 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:41:39.174257 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:41:39.175261 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:41:39.179081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:41:39.180084 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:41:39.181083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21CF278F0>]}
[0m15:41:39.183083 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.15s]
[0m15:41:39.185081 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:41:39.186080 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:41:39.187082 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:41:39.188079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:41:39.188079 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:41:39.196076 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:41:39.198074 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:41:39.202071 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:41:39.203072 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:41:39.204071 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:41:39.204071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:39.260867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m15:41:39.260867 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:41:39.260867 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN previous_month_net_profit IS NULL THEN NULL
    WHEN previous_month_net_profit = 0 THEN NULL
    ELSE ROUND((monthly_net_profit - previous_month_net_profit) / previous_month_net_profit * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:41:39.270846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction round(double precision, integer) n'existe pas
LINE 41:     ELSE ROUND((monthly_net_profit - previous_month_net_prof...
                  ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m15:41:39.270846 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m15:41:39.270846 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:41:39.280000 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 41:     ELSE ROUND((monthly_net_profit - previous_month_net_prof...
                    ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:41:39.280999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21CF14EC0>]}
[0m15:41:39.281999 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.09s]
[0m15:41:39.282999 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:41:39.283998 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:41:39.283998 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 41:     ELSE ROUND((monthly_net_profit - previous_month_net_prof...
                    ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m15:41:39.284999 [info ] [Thread-1 (]: 4 of 4 START sql table model public_management_control.control_summary ......... [RUN]
[0m15:41:39.286997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:41:39.287997 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:41:39.293994 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:41:39.294994 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:41:39.312323 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:41:39.314321 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.315321 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:41:39.316319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:39.360754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m15:41:39.360754 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.360754 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
)

SELECT *
FROM monthly_control
ORDER BY control_year, control_month
  );
  
[0m15:41:39.381894 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m15:41:39.388890 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.388890 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m15:41:39.390890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:39.395886 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.396887 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m15:41:39.397885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:41:39.405879 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:41:39.406880 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.407879 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:41:39.409879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:41:39.418872 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m15:41:39.424630 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:41:39.424630 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m15:41:39.431163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:41:39.431685 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:41:39.431685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd402184f-65ab-47bc-a9cc-a146804d17e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21CFD2810>]}
[0m15:41:39.431685 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public_management_control.control_summary .... [[32mSELECT 12[0m in 0.14s]
[0m15:41:39.431685 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:41:39.431685 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:39.431685 [debug] [MainThread]: On master: BEGIN
[0m15:41:39.431685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:39.492163 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m15:41:39.493161 [debug] [MainThread]: On master: COMMIT
[0m15:41:39.493161 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:39.494160 [debug] [MainThread]: On master: COMMIT
[0m15:41:39.494160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:41:39.495160 [debug] [MainThread]: On master: Close
[0m15:41:39.496159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:39.497158 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:41:39.497158 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m15:41:39.498158 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:41:39.498158 [info ] [MainThread]: 
[0m15:41:39.499157 [info ] [MainThread]: Finished running 3 incremental models, 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m15:41:39.501157 [debug] [MainThread]: Command end result
[0m15:41:39.531685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:41:39.536189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:41:39.547132 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:41:39.548131 [info ] [MainThread]: 
[0m15:41:39.549131 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:41:39.549131 [info ] [MainThread]: 
[0m15:41:39.550130 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la fonction round(double precision, integer) n'existe pas
  LINE 41:     ELSE ROUND((monthly_net_profit - previous_month_net_prof...
                    ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:41:39.552128 [info ] [MainThread]: 
[0m15:41:39.553128 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:41:39.555128 [debug] [MainThread]: Command `dbt run` failed at 15:41:39.555128 after 3.79 seconds
[0m15:41:39.556126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21C5684D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AE521B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21AE52360>]}
[0m15:41:39.556126 [debug] [MainThread]: Flushing usage events
[0m15:41:40.125837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:19.182491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B3E0E2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B3DF56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B3DCF4EF0>]}


============================== 15:45:19.187487 | f32cdace-2f5e-47b4-b4b7-720936646853 ==============================
[0m15:45:19.187487 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:45:19.189487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:45:19.421221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f32cdace-2f5e-47b4-b4b7-720936646853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B4015C8C0>]}
[0m15:45:19.465927 [debug] [MainThread]: Command `dbt clean` succeeded at 15:45:19.465927 after 0.50 seconds
[0m15:45:19.470973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B3DCF4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B4015C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B40837B00>]}
[0m15:45:19.470973 [debug] [MainThread]: Flushing usage events
[0m15:45:20.071185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:27.301126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379AB54CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379D8EA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379D802270>]}


============================== 15:45:27.310955 | 94a0cdb2-673b-4f25-ae0d-1adf8b98c302 ==============================
[0m15:45:27.310955 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:45:27.313948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:27.630780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379D11FE00>]}
[0m15:45:27.752368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379ADA4890>]}
[0m15:45:27.754367 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:28.056140 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:45:28.057140 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:45:28.058140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379DE7EB40>]}
[0m15:45:31.871344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F6D4C50>]}
[0m15:45:32.121491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:45:32.135837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:45:32.193943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F6C9CA0>]}
[0m15:45:32.193943 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:45:32.193943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F76FFE0>]}
[0m15:45:32.200967 [info ] [MainThread]: 
[0m15:45:32.200967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:32.200967 [info ] [MainThread]: 
[0m15:45:32.200967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:32.218431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:45:32.380082 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:45:32.382080 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:45:32.383080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:32.461879 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.080 seconds
[0m15:45:32.464408 [debug] [ThreadPool]: On list_gestion: Close
[0m15:45:32.470934 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:45:32.475071 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:45:32.476071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:32.554679 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.079 seconds
[0m15:45:32.556679 [debug] [ThreadPool]: On list_gestion: Close
[0m15:45:32.562908 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:45:32.564434 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:45:32.564434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:32.635905 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.073 seconds
[0m15:45:32.643373 [debug] [ThreadPool]: On list_gestion: Close
[0m15:45:32.649368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m15:45:32.664326 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:45:32.666326 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:45:32.667328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:32.733448 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m15:45:32.733448 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:45:32.733448 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:45:32.756297 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m15:45:32.760302 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:45:32.762245 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:45:32.764269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m15:45:32.764269 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:45:32.770811 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:45:32.770811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:32.937665 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m15:45:32.939663 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:45:32.940661 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:45:32.951041 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m15:45:32.958274 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:45:32.960272 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:45:32.961271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m15:45:32.966267 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:45:32.967268 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:45:32.969270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:33.050801 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m15:45:33.050801 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:45:33.050801 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:45:33.063262 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:45:33.065260 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:45:33.066259 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:45:33.067258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m15:45:33.070257 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:45:33.071255 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:45:33.072255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:33.250781 [debug] [ThreadPool]: SQL status: BEGIN in 0.178 seconds
[0m15:45:33.250781 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:45:33.250781 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:45:33.263176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:45:33.266175 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:45:33.267175 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:45:33.268174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m15:45:33.272171 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:45:33.272171 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:45:33.273171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:33.334829 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m15:45:33.335829 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:45:33.335829 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:45:33.344872 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:45:33.344872 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:45:33.350902 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:45:33.359191 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:33.361190 [debug] [MainThread]: On master: BEGIN
[0m15:45:33.362189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:33.433534 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m15:45:33.434533 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:33.435532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:33.442997 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:45:33.442997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F7345C0>]}
[0m15:45:33.451027 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:33.451027 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:33.451027 [debug] [MainThread]: On master: BEGIN
[0m15:45:33.451027 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:45:33.451027 [debug] [MainThread]: On master: COMMIT
[0m15:45:33.451027 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:33.451027 [debug] [MainThread]: On master: COMMIT
[0m15:45:33.451027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:33.451027 [debug] [MainThread]: On master: Close
[0m15:45:33.463989 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:45:33.465988 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:45:33.466987 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:45:33.467987 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:45:33.485922 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:45:33.485922 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:45:33.581009 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.581009 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp154533538737"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:45:33.581009 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:33.762045 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.174 seconds
[0m15:45:33.780709 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.780709 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:45:33.780709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:45:33.780709 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.780709 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154533538737'
        
      order by ordinal_position

  
[0m15:45:33.808060 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.018 seconds
[0m15:45:33.820054 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.822052 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:45:33.828271 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m15:45:33.842421 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.842421 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154533538737'
        
      order by ordinal_position

  
[0m15:45:33.856187 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m15:45:33.865208 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.866207 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:45:33.873203 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m15:45:33.896436 [debug] [Thread-1 (]: 
    In "gestion"."public_staging"."stg_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:45:33.931287 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:45:33.934286 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.935284 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp154533538737"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp154533538737"
    )
  
[0m15:45:33.942579 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.006 seconds
[0m15:45:33.971876 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:45:33.972874 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:45:33.973874 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:45:33.975718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:45:33.980751 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:45:33.980751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379B0184D0>]}
[0m15:45:33.980751 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.51s]
[0m15:45:33.980751 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:45:33.990834 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:45:33.992836 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:45:33.994835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:45:33.995834 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:45:34.003829 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:45:34.005829 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:45:34.012250 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.012250 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp154534012250"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:45:34.012250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:34.093317 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.075 seconds
[0m15:45:34.103310 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.104310 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:45:34.108309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:45:34.109876 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.110876 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154534012250'
        
      order by ordinal_position

  
[0m15:45:34.134772 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.022 seconds
[0m15:45:34.144944 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.146100 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:45:34.153671 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m15:45:34.161671 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.163667 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154534012250'
        
      order by ordinal_position

  
[0m15:45:34.170662 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m15:45:34.178573 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.180574 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:45:34.188566 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m15:45:34.193565 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:45:34.196562 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:45:34.198561 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.200559 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp154534012250"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp154534012250"
    )
  
[0m15:45:34.203557 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m15:45:34.207554 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:45:34.208908 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:45:34.210906 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:45:34.212689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:45:34.212689 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:45:34.212689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A017F5C0>]}
[0m15:45:34.212689 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.22s]
[0m15:45:34.220715 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:45:34.220715 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:45:34.224545 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:45:34.227544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:45:34.229543 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:45:34.233539 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:45:34.235540 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:45:34.245273 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:45:34.248005 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:45:34.248005 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:45:34.251034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:34.321858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m15:45:34.322857 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:45:34.324857 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:45:34.339848 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.014 seconds
[0m15:45:34.349538 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:45:34.350536 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:45:34.351536 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:45:34.352536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:45:34.354534 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:45:34.355533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379FDC7B00>]}
[0m15:45:34.356533 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.13s]
[0m15:45:34.359532 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:45:34.360531 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:45:34.362529 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m15:45:34.363529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:45:34.365527 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:45:34.373522 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:45:34.378582 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:45:34.386146 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.386146 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp154534381140"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
)

SELECT *
FROM monthly_control
ORDER BY control_year, control_month
  );
  
  
[0m15:45:34.386146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:34.466872 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.078 seconds
[0m15:45:34.472868 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.473867 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:45:34.475546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:45:34.475546 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.475546 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp154534381140'
        
      order by ordinal_position

  
[0m15:45:34.503266 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m15:45:34.511262 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.512260 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:45:34.519256 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m15:45:34.528638 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.530634 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:45:34.537629 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m15:45:34.542203 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:45:34.542203 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:45:34.542203 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp154534381140"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp154534381140"
    )
  
[0m15:45:34.542203 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m15:45:34.542203 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m15:45:34.551113 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:45:34.560006 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m15:45:34.561006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a0cdb2-673b-4f25-ae0d-1adf8b98c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A01B3980>]}
[0m15:45:34.562006 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.20s]
[0m15:45:34.563005 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:45:34.564003 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m15:45:34.566003 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:34.567001 [debug] [MainThread]: On master: BEGIN
[0m15:45:34.567001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:34.620949 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m15:45:34.624493 [debug] [MainThread]: On master: COMMIT
[0m15:45:34.626494 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:34.627493 [debug] [MainThread]: On master: COMMIT
[0m15:45:34.628492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:34.629492 [debug] [MainThread]: On master: Close
[0m15:45:34.630491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:34.630491 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:45:34.631490 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m15:45:34.632490 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:45:34.632490 [info ] [MainThread]: 
[0m15:45:34.633489 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m15:45:34.635488 [debug] [MainThread]: Command end result
[0m15:45:34.687926 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:45:34.699918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:45:34.710949 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:45:34.711950 [info ] [MainThread]: 
[0m15:45:34.712948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:34.713947 [info ] [MainThread]: 
[0m15:45:34.714947 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m15:45:34.716946 [info ] [MainThread]: 
[0m15:45:34.717945 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:45:34.730954 [debug] [MainThread]: Command `dbt run` failed at 15:45:34.730954 after 7.59 seconds
[0m15:45:34.730954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379D4ACBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F42EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379D8B88F0>]}
[0m15:45:34.730954 [debug] [MainThread]: Flushing usage events
[0m15:45:35.311804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:47.630996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB72C96300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB754F8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB754FA030>]}


============================== 15:47:47.642663 | f92428ef-760c-4360-88f3-d78a55f6b4e1 ==============================
[0m15:47:47.642663 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:47:47.643660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:48.011376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB74E9C8C0>]}
[0m15:47:48.116766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB75291D60>]}
[0m15:47:48.117766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:48.440962 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:47:48.737679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:48.740677 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\marts\management_control\control_summary.sql
[0m15:47:49.561072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB75BD36E0>]}
[0m15:47:49.718272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:47:49.725702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:47:49.776986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB773721E0>]}
[0m15:47:49.777985 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:47:49.778986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB77342FF0>]}
[0m15:47:49.781983 [info ] [MainThread]: 
[0m15:47:49.782982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:49.784981 [info ] [MainThread]: 
[0m15:47:49.791510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:49.794079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:47:49.909428 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:47:49.910427 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:47:49.911426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:49.966099 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.055 seconds
[0m15:47:49.968098 [debug] [ThreadPool]: On list_gestion: Close
[0m15:47:49.973095 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:47:49.974094 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:47:49.975094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.020770 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.052 seconds
[0m15:47:50.028031 [debug] [ThreadPool]: On list_gestion: Close
[0m15:47:50.031046 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:47:50.031046 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:47:50.031046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.083990 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.051 seconds
[0m15:47:50.087166 [debug] [ThreadPool]: On list_gestion: Close
[0m15:47:50.087166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m15:47:50.096188 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:47:50.096188 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:47:50.096188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:50.253872 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m15:47:50.253872 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:47:50.253872 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:47:50.260897 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:47:50.260897 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:47:50.260897 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:47:50.269774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m15:47:50.276600 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:47:50.277926 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:47:50.277926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.330769 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m15:47:50.330769 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:47:50.336245 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:47:50.346237 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:47:50.348236 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:47:50.348236 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:47:50.349235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m15:47:50.353958 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:47:50.356135 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:47:50.356135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.519543 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m15:47:50.520749 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:47:50.520749 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:47:50.528145 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:47:50.531159 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:47:50.531159 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:47:50.531159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:47:50.539330 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:47:50.540329 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:47:50.540329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.691007 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m15:47:50.691007 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:47:50.691007 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:47:50.704995 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:47:50.706994 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:47:50.707992 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:47:50.708991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m15:47:50.712991 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:47:50.712991 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:47:50.713988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.877970 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m15:47:50.878984 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:47:50.878984 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:47:50.887527 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:47:50.891075 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:47:50.891075 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:47:50.891075 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.891075 [debug] [MainThread]: On master: BEGIN
[0m15:47:50.891075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:50.954518 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m15:47:50.954518 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.954518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:50.961041 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:47:50.961041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB75B022A0>]}
[0m15:47:50.969395 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:50.970395 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.972393 [debug] [MainThread]: On master: BEGIN
[0m15:47:50.973393 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:50.974392 [debug] [MainThread]: On master: COMMIT
[0m15:47:50.975392 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.975392 [debug] [MainThread]: On master: COMMIT
[0m15:47:50.976392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:50.977389 [debug] [MainThread]: On master: Close
[0m15:47:50.979390 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:47:50.980406 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:47:50.981387 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:47:50.982406 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:47:50.990863 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:47:50.990863 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:47:51.080371 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.082371 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp154751042086"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:47:51.082371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:51.144384 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.061 seconds
[0m15:47:51.160806 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.161806 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:47:51.164803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:47:51.166802 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.166802 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154751042086'
        
      order by ordinal_position

  
[0m15:47:51.183682 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.016 seconds
[0m15:47:51.192658 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.192658 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:47:51.192658 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m15:47:51.215841 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.216841 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp154751042086'
        
      order by ordinal_position

  
[0m15:47:51.220738 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m15:47:51.300988 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.302813 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m15:47:51.307810 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m15:47:51.317805 [debug] [Thread-1 (]: 
    In "gestion"."public_staging"."stg_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:47:51.339139 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:47:51.340136 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.341136 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp154751042086"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp154751042086"
    )
  
[0m15:47:51.343771 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m15:47:51.365931 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:47:51.365931 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:47:51.365931 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:47:51.365931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:51.373487 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:47:51.377486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB7720B4D0>]}
[0m15:47:51.378484 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.39s]
[0m15:47:51.380485 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:47:51.381482 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:47:51.382482 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:47:51.383497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:47:51.383497 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:47:51.390478 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:47:51.392484 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:47:51.397475 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.398472 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp154751395476"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:47:51.398472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:51.461053 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.068 seconds
[0m15:47:51.471271 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.472270 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:47:51.475270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:47:51.476267 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.476267 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154751395476'
        
      order by ordinal_position

  
[0m15:47:51.492258 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.015 seconds
[0m15:47:51.497255 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.497255 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:47:51.503252 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:47:51.508248 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.509246 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp154751395476'
        
      order by ordinal_position

  
[0m15:47:51.513245 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:47:51.517243 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.518243 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m15:47:51.520757 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:47:51.525772 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:47:51.525772 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:47:51.529296 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.529296 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp154751395476"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp154751395476"
    )
  
[0m15:47:51.530808 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m15:47:51.530808 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:47:51.530808 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:47:51.530808 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:47:51.539585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:47:51.541601 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:47:51.542601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB770F2F30>]}
[0m15:47:51.543599 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.16s]
[0m15:47:51.545599 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:47:51.546600 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:47:51.547598 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:47:51.548596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:47:51.548596 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:47:51.556592 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:47:51.558593 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:47:51.565587 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.566587 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

    
  
    

  create temporary table "control_growth__dbt_tmp154751561593"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:47:51.568585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:51.634736 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.066 seconds
[0m15:47:51.639734 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.640733 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:47:51.642732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:47:51.643730 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.644729 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_growth__dbt_tmp154751561593'
        
      order by ordinal_position

  
[0m15:47:51.653781 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.015 seconds
[0m15:47:51.660805 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.660805 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:47:51.660805 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m15:47:51.674450 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.674450 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:47:51.678448 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m15:47:51.681447 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:47:51.682446 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:47:51.683446 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
        
            delete from "gestion"."public_management_control"."control_growth"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_growth__dbt_tmp154751561593"
            );

        
    

    insert into "gestion"."public_management_control"."control_growth" ("control_year", "control_month", "monthly_net_profit", "growth_rate")
    (
        select "control_year", "control_month", "monthly_net_profit", "growth_rate"
        from "control_growth__dbt_tmp154751561593"
    )
  
[0m15:47:51.685880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m15:47:51.686765 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m15:47:51.686765 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:47:51.695792 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:47:51.695792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB76F92450>]}
[0m15:47:51.695792 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.15s]
[0m15:47:51.695792 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:47:51.700821 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m15:47:51.695792 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:47:51.705706 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m15:47:51.707705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:47:51.708704 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:47:51.714701 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:47:51.715700 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:47:51.721829 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.721829 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp154751721829"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m15:47:51.721829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:51.883962 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.156 seconds
[0m15:47:51.886728 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.890769 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:47:51.890769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m15:47:51.890769 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.890769 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp154751721829'
        
      order by ordinal_position

  
[0m15:47:51.911524 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m15:47:51.916522 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.916522 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:47:51.921175 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m15:47:51.925865 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.925865 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m15:47:51.930932 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m15:47:51.930932 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:47:51.930932 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:47:51.937492 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp154751721829"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp154751721829"
    )
  
[0m15:47:51.940493 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m15:47:51.941490 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m15:47:51.941490 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:47:51.946488 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m15:47:51.947487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92428ef-760c-4360-88f3-d78a55f6b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB779F3020>]}
[0m15:47:51.948486 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.24s]
[0m15:47:51.949484 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:47:51.950484 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m15:47:51.953393 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:51.953393 [debug] [MainThread]: On master: BEGIN
[0m15:47:51.953393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:52.009154 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m15:47:52.010138 [debug] [MainThread]: On master: COMMIT
[0m15:47:52.010138 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:52.011137 [debug] [MainThread]: On master: COMMIT
[0m15:47:52.011137 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:52.012136 [debug] [MainThread]: On master: Close
[0m15:47:52.013135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:52.014135 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:47:52.014135 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:47:52.015134 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:47:52.015134 [info ] [MainThread]: 
[0m15:47:52.016134 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m15:47:52.019132 [debug] [MainThread]: Command end result
[0m15:47:52.055860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:47:52.060879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:47:52.065884 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:47:52.072094 [info ] [MainThread]: 
[0m15:47:52.075110 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:47:52.076090 [info ] [MainThread]: 
[0m15:47:52.077091 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m15:47:52.079089 [info ] [MainThread]: 
[0m15:47:52.080107 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m15:47:52.081087 [info ] [MainThread]: 
[0m15:47:52.082090 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:47:52.084088 [debug] [MainThread]: Command `dbt run` failed at 15:47:52.084088 after 4.66 seconds
[0m15:47:52.085104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB74E36720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB75962330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB75962B70>]}
[0m15:47:52.089095 [debug] [MainThread]: Flushing usage events
[0m15:47:52.691070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:09.110271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C508EF8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C508ADD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50883BFE0>]}


============================== 15:48:09.115269 | c41a3be2-6643-4caf-8694-38f32fcc237f ==============================
[0m15:48:09.115269 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:48:09.115269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:09.461144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50961F800>]}
[0m15:48:09.575237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C508898980>]}
[0m15:48:09.576807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:09.881593 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:48:10.156431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:10.157432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:10.260303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5096637A0>]}
[0m15:48:10.414768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:10.420797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:10.460983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AAA7A40>]}
[0m15:48:10.464715 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:48:10.466716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AA3AA50>]}
[0m15:48:10.470712 [info ] [MainThread]: 
[0m15:48:10.471714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:10.473711 [info ] [MainThread]: 
[0m15:48:10.474710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:10.483323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:48:10.581559 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:10.581559 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:10.581559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:10.639030 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.053 seconds
[0m15:48:10.641017 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:10.645014 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:10.646013 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:10.647190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:10.690882 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.048 seconds
[0m15:48:10.697349 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:10.702365 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:10.703360 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:10.704359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:10.866049 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.162 seconds
[0m15:48:10.868047 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:10.871101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m15:48:10.878059 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:10.878059 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:48:10.879058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:10.920862 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:48:10.920862 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:10.920862 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:48:10.939193 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:48:10.941179 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:48:10.942178 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:48:10.942178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m15:48:10.945176 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:10.946176 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:48:10.946176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:10.999315 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m15:48:10.999315 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:11.000316 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:48:11.008308 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:48:11.010306 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:48:11.010306 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:48:11.011307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:48:11.014611 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:11.014611 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:48:11.014611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:11.066944 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:48:11.067942 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:11.067942 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:48:11.074939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:48:11.076939 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:48:11.077938 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:48:11.077938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m15:48:11.081256 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:11.081256 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:48:11.081256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:11.132717 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:48:11.133716 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:11.133716 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:48:11.141712 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:48:11.143710 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:48:11.143710 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:48:11.144707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m15:48:11.148195 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:11.149193 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:48:11.150193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:11.308608 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m15:48:11.309620 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:11.309620 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:48:11.322385 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m15:48:11.322385 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:48:11.322385 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:48:11.336847 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:11.337846 [debug] [MainThread]: On master: BEGIN
[0m15:48:11.337846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:11.390879 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m15:48:11.390879 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:11.390879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:11.405889 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:48:11.407888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50B0AAB70>]}
[0m15:48:11.407888 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:11.408888 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:11.409887 [debug] [MainThread]: On master: BEGIN
[0m15:48:11.409887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:11.410887 [debug] [MainThread]: On master: COMMIT
[0m15:48:11.410887 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:11.411886 [debug] [MainThread]: On master: COMMIT
[0m15:48:11.411886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:11.412886 [debug] [MainThread]: On master: Close
[0m15:48:11.416006 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:48:11.416006 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:48:11.421032 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:48:11.421032 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:48:11.433875 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:48:11.434874 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:48:11.519958 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:48:11.521955 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.522956 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:48:11.523954 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:11.573623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m15:48:11.574626 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.574626 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:48:11.585619 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m15:48:11.594109 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.594349 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m15:48:11.596351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:11.603127 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.603127 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m15:48:11.605126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:11.630948 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:11.631938 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.632937 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:11.634946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:11.641945 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m15:48:11.647748 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:11.647748 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m15:48:11.654296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:48:11.659354 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:48:11.662354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5067BC230>]}
[0m15:48:11.664352 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.24s]
[0m15:48:11.666350 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:48:11.667353 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:48:11.668352 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:48:11.669350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:48:11.670349 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:48:11.674347 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:48:11.676345 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:48:11.682129 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:48:11.686143 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.686143 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:48:11.686143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:11.742309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m15:48:11.743308 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.744306 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:48:11.754324 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m15:48:11.758298 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.759298 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m15:48:11.760316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:11.765295 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.767294 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m15:48:11.769293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:11.772291 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:11.773290 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.773290 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:11.775375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:11.778376 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m15:48:11.779376 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:11.780190 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m15:48:11.781034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:48:11.781034 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:48:11.781034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AFE7680>]}
[0m15:48:11.791144 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.11s]
[0m15:48:11.791144 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:48:11.791144 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:48:11.791144 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:48:11.791144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:48:11.797032 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:48:11.807028 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:48:11.808028 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:48:11.816470 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:48:11.816470 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.816470 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:48:11.821027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:11.874502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m15:48:11.874502 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.875500 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:48:11.886500 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m15:48:11.890492 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.891491 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m15:48:11.892492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:11.895490 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.896488 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m15:48:11.898490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:11.901486 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:11.902486 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.902486 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:11.906183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:48:11.909199 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m15:48:11.910199 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:11.910199 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m15:48:11.914484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:48:11.914484 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:48:11.914484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AB25520>]}
[0m15:48:11.921006 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.12s]
[0m15:48:11.921006 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:48:11.921006 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:48:11.921006 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m15:48:11.921006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:48:11.921006 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:48:11.921006 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:48:11.930426 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:48:11.940927 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:48:11.942926 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:11.942926 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:48:11.943925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:11.998820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m15:48:11.999819 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:12.001819 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m15:48:12.010813 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:48:12.017092 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:12.017092 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m15:48:12.019087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:12.022090 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:12.023087 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m15:48:12.024086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:12.026084 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:12.026084 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:12.027083 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:12.030081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:48:12.036078 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m15:48:12.036078 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:12.037077 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m15:48:12.041230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:12.043228 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:48:12.044226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41a3be2-6643-4caf-8694-38f32fcc237f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5096F8740>]}
[0m15:48:12.045226 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 0[0m in 0.12s]
[0m15:48:12.047228 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:48:12.049225 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:12.050226 [debug] [MainThread]: On master: BEGIN
[0m15:48:12.051226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:12.111801 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:48:12.112802 [debug] [MainThread]: On master: COMMIT
[0m15:48:12.114802 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:12.115800 [debug] [MainThread]: On master: COMMIT
[0m15:48:12.116799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:12.116799 [debug] [MainThread]: On master: Close
[0m15:48:12.117802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:12.118797 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:48:12.119797 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m15:48:12.120799 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:48:12.121796 [info ] [MainThread]: 
[0m15:48:12.122796 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m15:48:12.124794 [debug] [MainThread]: Command end result
[0m15:48:12.172762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:12.175759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:12.189460 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:48:12.190986 [info ] [MainThread]: 
[0m15:48:12.190986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:12.190986 [info ] [MainThread]: 
[0m15:48:12.190986 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:48:12.200015 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:12.200015 after 3.25 seconds
[0m15:48:12.202013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AA12AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5091088F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50AA3AA50>]}
[0m15:48:12.204012 [debug] [MainThread]: Flushing usage events
[0m15:48:12.739265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:34.474771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA8F8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA78BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA48B0E0>]}


============================== 15:48:34.480825 | 2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc ==============================
[0m15:48:34.480825 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:48:34.480825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:48:34.811184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEAB4F020>]}
[0m15:48:34.916084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA2AB3B0>]}
[0m15:48:34.921123 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:35.210916 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:48:35.491460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:35.501028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:35.600976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEBD5D490>]}
[0m15:48:35.755804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:35.760807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:35.801038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEC117B30>]}
[0m15:48:35.801038 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:48:35.806942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEC081EE0>]}
[0m15:48:35.811939 [info ] [MainThread]: 
[0m15:48:35.812481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:35.814484 [info ] [MainThread]: 
[0m15:48:35.815484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:35.821480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:48:35.926551 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:35.926551 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:35.931104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:35.986286 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.055 seconds
[0m15:48:35.988307 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:35.991106 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:35.991106 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:35.991106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.048741 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.054 seconds
[0m15:48:36.050741 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:36.053739 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:36.054738 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:36.055737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.108923 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.053 seconds
[0m15:48:36.111922 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:36.113919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m15:48:36.120916 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:36.121916 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:48:36.122916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:36.173831 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:48:36.174832 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:36.176481 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:48:36.185350 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:48:36.186349 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:48:36.187348 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:48:36.188348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m15:48:36.191066 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:36.191066 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:48:36.191066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.244331 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:48:36.245329 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:36.245329 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:48:36.253324 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:48:36.255324 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:48:36.255324 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:48:36.257921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m15:48:36.261127 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:36.261127 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:48:36.261127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.412394 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m15:48:36.412394 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:36.413388 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:48:36.421579 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:48:36.424133 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:48:36.424133 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:48:36.426178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m15:48:36.426178 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:36.426178 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:48:36.431205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.482438 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:48:36.482438 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:36.483453 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:48:36.490995 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:48:36.490995 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:48:36.490995 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:48:36.490995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m15:48:36.500832 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:36.500832 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:48:36.500832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:36.660954 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m15:48:36.660954 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:36.660954 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:48:36.673238 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:48:36.676411 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:48:36.677410 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:48:36.682425 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:36.683424 [debug] [MainThread]: On master: BEGIN
[0m15:48:36.683424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:36.740150 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m15:48:36.741899 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:36.742897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:36.752893 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:48:36.753892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEAB720F0>]}
[0m15:48:36.754891 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:36.755890 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:36.756890 [debug] [MainThread]: On master: BEGIN
[0m15:48:36.758893 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:36.759889 [debug] [MainThread]: On master: COMMIT
[0m15:48:36.759889 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:36.760887 [debug] [MainThread]: On master: COMMIT
[0m15:48:36.760887 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:36.761887 [debug] [MainThread]: On master: Close
[0m15:48:36.764886 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:48:36.765884 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:48:36.766886 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:48:36.767883 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:48:36.779877 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:48:36.780877 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:48:36.860721 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:48:36.860721 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.860721 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:48:36.860721 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:36.915612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m15:48:36.916609 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.916609 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:48:36.930858 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m15:48:36.935865 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.939965 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m15:48:36.941786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:36.947782 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.948781 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m15:48:36.949782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:36.978318 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:36.979318 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.979318 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:36.981490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:36.990701 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m15:48:36.995714 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:36.995714 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m15:48:37.000750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:48:37.000750 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:48:37.010186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE7E384A0>]}
[0m15:48:37.011186 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.24s]
[0m15:48:37.013183 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:48:37.014182 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:48:37.015184 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:48:37.016181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:48:37.016181 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:48:37.020197 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:48:37.021197 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:48:37.031058 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:48:37.031058 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.031058 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:48:37.031058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:37.089412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m15:48:37.091127 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.091127 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:48:37.101079 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m15:48:37.107569 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.108568 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m15:48:37.109567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:37.113565 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.114563 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m15:48:37.115562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:37.117563 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:37.118562 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.118562 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:37.120560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:37.123999 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m15:48:37.123999 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:37.123999 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m15:48:37.131061 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:48:37.131061 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:48:37.131061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EECA6CEF0>]}
[0m15:48:37.131061 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.12s]
[0m15:48:37.131061 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:48:37.131061 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:48:37.131061 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:48:37.131061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:48:37.139899 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:48:37.152792 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:48:37.153791 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:48:37.163786 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:48:37.165784 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.166784 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:48:37.167783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:37.232411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m15:48:37.233412 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.234411 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:48:37.246856 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m15:48:37.250854 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.250854 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m15:48:37.251854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:37.254852 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.255851 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m15:48:37.257554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:37.261078 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:37.261078 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.261078 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:37.261078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:37.261078 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m15:48:37.261078 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:37.261078 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m15:48:37.273203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:48:37.277202 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:48:37.278200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEC652A20>]}
[0m15:48:37.279214 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.15s]
[0m15:48:37.281198 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:48:37.283197 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:48:37.284197 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m15:48:37.285196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:48:37.285196 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:48:37.291895 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:48:37.291895 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:48:37.295899 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:48:37.300928 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.300928 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:48:37.300928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:37.359256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m15:48:37.360246 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.361245 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m15:48:37.371255 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m15:48:37.378234 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.379233 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m15:48:37.380234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:37.385231 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.385231 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m15:48:37.386230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:37.388230 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:37.390230 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.391272 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:37.391272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:37.391272 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m15:48:37.391272 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:37.391272 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m15:48:37.401099 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:37.401099 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:48:37.401099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a7ebe19-5dfd-4410-9e29-0a0363bc7fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EECA87620>]}
[0m15:48:37.407497 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.12s]
[0m15:48:37.409495 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:48:37.411512 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:37.411512 [debug] [MainThread]: On master: BEGIN
[0m15:48:37.412495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:37.467332 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m15:48:37.468333 [debug] [MainThread]: On master: COMMIT
[0m15:48:37.469332 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:37.469332 [debug] [MainThread]: On master: COMMIT
[0m15:48:37.470331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:37.470331 [debug] [MainThread]: On master: Close
[0m15:48:37.471331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:37.472330 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:48:37.473329 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m15:48:37.474330 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:48:37.475329 [info ] [MainThread]: 
[0m15:48:37.477327 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m15:48:37.479326 [debug] [MainThread]: Command end result
[0m15:48:37.515195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:37.519193 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:37.530989 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:48:37.531059 [info ] [MainThread]: 
[0m15:48:37.531059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:37.531059 [info ] [MainThread]: 
[0m15:48:37.531059 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:48:37.531059 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:37.531059 after 3.22 seconds
[0m15:48:37.531059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA4B08F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEA76C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEC082A80>]}
[0m15:48:37.531059 [debug] [MainThread]: Flushing usage events
[0m15:48:38.090798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:42.890750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E625681D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E6229BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E6256A180>]}


============================== 15:48:42.901173 | 9b53a7fe-4efc-4d8c-b4be-a109ee73f33b ==============================
[0m15:48:42.901173 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:48:42.906932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:48:43.245522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E61EA6270>]}
[0m15:48:43.351088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E61F2FC80>]}
[0m15:48:43.355820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:43.660712 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:48:43.915855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:43.915855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:44.010850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E63D28EF0>]}
[0m15:48:44.194239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:44.199235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:44.240864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E640E3C20>]}
[0m15:48:44.240864 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:48:44.240864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E64051F40>]}
[0m15:48:44.240864 [info ] [MainThread]: 
[0m15:48:44.240864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:44.240864 [info ] [MainThread]: 
[0m15:48:44.249436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:44.257209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:48:44.356544 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:44.358562 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:44.358562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:44.410828 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.055 seconds
[0m15:48:44.410828 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:44.410828 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:44.410828 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:44.410828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.469536 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.049 seconds
[0m15:48:44.471908 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:44.471908 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:48:44.471908 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:48:44.471908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.528147 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.050 seconds
[0m15:48:44.530147 [debug] [ThreadPool]: On list_gestion: Close
[0m15:48:44.532145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m15:48:44.541007 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:44.541007 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:48:44.541007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:44.590839 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:48:44.591836 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:48:44.592836 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:48:44.599834 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:48:44.601832 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:48:44.602830 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:48:44.604299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:48:44.610791 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:44.610791 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:48:44.610791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.662461 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:48:44.663459 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:48:44.663459 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:48:44.671935 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:48:44.671935 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:48:44.671935 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:48:44.671935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m15:48:44.671935 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:44.680827 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:48:44.680827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.730173 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:48:44.731171 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:48:44.732169 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:48:44.738601 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:48:44.741128 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:48:44.741128 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:48:44.741128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m15:48:44.741128 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:44.741128 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:48:44.741128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.799780 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:48:44.800779 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:48:44.800779 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:48:44.805155 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:48:44.811181 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:48:44.811181 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:48:44.811181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m15:48:44.811181 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:44.811181 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:48:44.811181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:44.869422 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:48:44.870422 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:48:44.870931 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:48:44.871833 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:48:44.880903 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:48:44.880903 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:48:44.890695 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:44.891694 [debug] [MainThread]: On master: BEGIN
[0m15:48:44.892694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:44.941010 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m15:48:44.941010 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:44.941010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:44.951086 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:48:44.951086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E62588770>]}
[0m15:48:44.954815 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:44.955815 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:44.956815 [debug] [MainThread]: On master: BEGIN
[0m15:48:44.958813 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:44.958813 [debug] [MainThread]: On master: COMMIT
[0m15:48:44.959813 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:44.959813 [debug] [MainThread]: On master: COMMIT
[0m15:48:44.960812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:44.961812 [debug] [MainThread]: On master: Close
[0m15:48:44.963811 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:48:44.964810 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:48:44.965809 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:48:44.966809 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:48:44.975344 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:48:44.980866 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:48:45.060360 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:48:45.062359 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.062359 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:48:45.063359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:45.110985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m15:48:45.110985 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.110985 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control" 
)


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:48:45.127034 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.012 seconds
[0m15:48:45.134028 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.135027 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m15:48:45.136045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.141775 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.142776 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m15:48:45.144773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:45.172905 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:45.173980 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.174790 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m15:48:45.176628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:45.185627 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m15:48:45.193918 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:48:45.193918 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m15:48:45.198391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:45.201386 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:48:45.205232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E61EA4CE0>]}
[0m15:48:45.205232 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.24s]
[0m15:48:45.205232 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:48:45.205232 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:48:45.210769 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m15:48:45.210769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m15:48:45.210769 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m15:48:45.210769 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m15:48:45.210769 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m15:48:45.223966 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m15:48:45.226963 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.227962 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m15:48:45.228960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:45.280965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m15:48:45.280965 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.287467 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m15:48:45.300372 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m15:48:45.304371 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.305370 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m15:48:45.306369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.310367 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.311366 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m15:48:45.312365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.314364 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:45.315363 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.315363 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m15:48:45.317286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:45.320286 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m15:48:45.322291 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m15:48:45.323287 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m15:48:45.328266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:45.330265 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m15:48:45.331264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E64A421B0>]}
[0m15:48:45.332785 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.12s]
[0m15:48:45.333772 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:48:45.334772 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:48:45.335771 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m15:48:45.336770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m15:48:45.337417 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m15:48:45.341656 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m15:48:45.341656 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m15:48:45.350804 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m15:48:45.356061 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.360058 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m15:48:45.362056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:45.420099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m15:48:45.422097 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.423097 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m15:48:45.435380 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m15:48:45.440864 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.440864 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m15:48:45.440864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:45.440864 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.440864 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m15:48:45.440864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.450752 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:45.450752 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.450752 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m15:48:45.455210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:45.460208 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m15:48:45.461207 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m15:48:45.461207 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m15:48:45.465730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:45.467729 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m15:48:45.468729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E6466F1A0>]}
[0m15:48:45.469728 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.13s]
[0m15:48:45.471992 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:48:45.471992 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:48:45.471992 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m15:48:45.475997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m15:48:45.475997 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m15:48:45.481022 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m15:48:45.481022 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m15:48:45.481022 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m15:48:45.488592 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.490592 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m15:48:45.491591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:45.548380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m15:48:45.549381 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.550380 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m15:48:45.561387 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m15:48:45.565384 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.566384 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m15:48:45.567383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.571563 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.571563 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m15:48:45.571563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:45.571563 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:45.571563 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.571563 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m15:48:45.571563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:45.580761 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m15:48:45.580761 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m15:48:45.580761 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m15:48:45.589588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:48:45.592585 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m15:48:45.593583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b53a7fe-4efc-4d8c-b4be-a109ee73f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E646E91F0>]}
[0m15:48:45.594585 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 0[0m in 0.12s]
[0m15:48:45.595934 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:48:45.597936 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:45.597936 [debug] [MainThread]: On master: BEGIN
[0m15:48:45.598936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:45.758145 [debug] [MainThread]: SQL status: BEGIN in 0.160 seconds
[0m15:48:45.759144 [debug] [MainThread]: On master: COMMIT
[0m15:48:45.760143 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:45.760143 [debug] [MainThread]: On master: COMMIT
[0m15:48:45.761142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:45.762141 [debug] [MainThread]: On master: Close
[0m15:48:45.762141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:45.763141 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:48:45.764141 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:48:45.764141 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m15:48:45.765139 [info ] [MainThread]: 
[0m15:48:45.765765 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m15:48:45.767782 [debug] [MainThread]: Command end result
[0m15:48:45.805088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:48:45.805088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:48:45.816118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:48:45.816118 [info ] [MainThread]: 
[0m15:48:45.822720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:45.824720 [info ] [MainThread]: 
[0m15:48:45.825719 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:48:45.828735 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:45.827719 after 3.09 seconds
[0m15:48:45.828735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E628929C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5FE2C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E61EA6F00>]}
[0m15:48:45.829734 [debug] [MainThread]: Flushing usage events
[0m15:48:46.404775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:59.520726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA45B15F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA480165A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA48017950>]}


============================== 15:48:59.530745 | 9f0f32c9-6462-475b-b4ee-33ba6a0c0006 ==============================
[0m15:48:59.530745 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:48:59.530745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:48:59.870876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA48DD2570>]}
[0m15:48:59.973821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA480CC9E0>]}
[0m15:48:59.975861 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:49:00.305891 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:49:00.579500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:00.579500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:00.685789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA48DD0560>]}
[0m15:49:00.861020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:49:00.872411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:49:00.913758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4A267E60>]}
[0m15:49:00.914756 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:49:00.915756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4A1FA900>]}
[0m15:49:00.920799 [info ] [MainThread]: 
[0m15:49:00.920799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:00.920799 [info ] [MainThread]: 
[0m15:49:00.920799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:00.920799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:49:01.040309 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:49:01.041309 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:49:01.042309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:01.103652 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.061 seconds
[0m15:49:01.105654 [debug] [ThreadPool]: On list_gestion: Close
[0m15:49:01.112665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m15:49:01.120701 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:49:01.120701 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:49:01.120701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:01.272469 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m15:49:01.272469 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:49:01.273484 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:49:01.282975 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:49:01.283836 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:49:01.283836 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:49:01.283836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m15:49:01.290876 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:49:01.290876 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:49:01.290876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.344137 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m15:49:01.345138 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:49:01.345138 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:49:01.353107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:49:01.353107 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:49:01.353107 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:49:01.353107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m15:49:01.361127 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:49:01.361127 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:49:01.361127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.520730 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:49:01.520730 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:49:01.520730 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:49:01.533908 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:49:01.536906 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:49:01.537908 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:49:01.538904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m15:49:01.541921 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:49:01.541921 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:49:01.542920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.591131 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m15:49:01.591131 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:49:01.591131 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:49:01.609100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m15:49:01.611100 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:49:01.612098 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:49:01.614097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:49:01.617446 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:49:01.617446 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:49:01.617446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.774015 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m15:49:01.775030 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:49:01.775030 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:49:01.784228 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:49:01.784228 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:49:01.784228 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:49:01.795770 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.800484 [debug] [MainThread]: On master: BEGIN
[0m15:49:01.801485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:01.850852 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m15:49:01.850852 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.850852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:01.860891 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:49:01.866138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4A6C04D0>]}
[0m15:49:01.867138 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:01.869136 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.870135 [debug] [MainThread]: On master: BEGIN
[0m15:49:01.871134 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:01.872134 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.872134 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.873132 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.874132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:01.874132 [debug] [MainThread]: On master: Close
[0m15:49:01.876973 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m15:49:01.877978 [info ] [Thread-1 (]: 1 of 1 START seed file public_seeds.management_control ......................... [RUN]
[0m15:49:01.878995 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m15:49:01.878995 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m15:49:01.879993 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m15:49:01.943785 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:49:01.944785 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m15:49:01.945783 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:02.105633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m15:49:02.106634 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:49:02.106634 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */
truncate table "gestion"."public_seeds"."management_control"
[0m15:49:02.113484 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m15:49:02.190933 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:49:02.190933 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public_seeds"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m15:49:02.203590 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m15:49:02.211603 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m15:49:02.241833 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m15:49:02.242831 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m15:49:02.243829 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m15:49:02.247018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:49:02.250810 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m15:49:02.255334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f0f32c9-6462-475b-b4ee-33ba6a0c0006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4806D1C0>]}
[0m15:49:02.255334 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_seeds.management_control ..................... [[32mINSERT 100[0m in 0.37s]
[0m15:49:02.255334 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m15:49:02.255334 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:02.260857 [debug] [MainThread]: On master: BEGIN
[0m15:49:02.260857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:02.314873 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m15:49:02.316873 [debug] [MainThread]: On master: COMMIT
[0m15:49:02.317871 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:02.318871 [debug] [MainThread]: On master: COMMIT
[0m15:49:02.319871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:02.319871 [debug] [MainThread]: On master: Close
[0m15:49:02.320869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:02.321874 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:49:02.323868 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m15:49:02.323868 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m15:49:02.324867 [info ] [MainThread]: 
[0m15:49:02.325866 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m15:49:02.326866 [debug] [MainThread]: Command end result
[0m15:49:02.360801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:49:02.365806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:49:02.375904 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:49:02.376904 [info ] [MainThread]: 
[0m15:49:02.377903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:02.378903 [info ] [MainThread]: 
[0m15:49:02.379903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:02.382901 [debug] [MainThread]: Command `dbt seed` succeeded at 15:49:02.381901 after 3.02 seconds
[0m15:49:02.385000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4891CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4A047770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA48982570>]}
[0m15:49:02.385000 [debug] [MainThread]: Flushing usage events
[0m15:49:02.908998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:12.132902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE34DCA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE6B69F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE6B68C50>]}


============================== 15:49:12.139126 | ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a ==============================
[0m15:49:12.139126 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:49:12.140125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:49:12.477833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE63555E0>]}
[0m15:49:12.580914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE62EF7D0>]}
[0m15:49:12.580914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:49:12.890843 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:49:13.155376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:13.155376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:13.261182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE81367E0>]}
[0m15:49:13.421100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:49:13.430548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:49:13.471704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE84F7DD0>]}
[0m15:49:13.472705 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:49:13.473722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE848B260>]}
[0m15:49:13.475721 [info ] [MainThread]: 
[0m15:49:13.476701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:13.477716 [info ] [MainThread]: 
[0m15:49:13.478703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:13.481085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:49:13.589816 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:49:13.590815 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:49:13.590815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:13.647079 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.056 seconds
[0m15:49:13.647079 [debug] [ThreadPool]: On list_gestion: Close
[0m15:49:13.651113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m15:49:13.662811 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:49:13.663988 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:49:13.665987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:13.713692 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:49:13.713692 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:49:13.713692 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:49:13.720737 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:49:13.720737 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:49:13.720737 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:49:13.720737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m15:49:13.732982 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:49:13.733980 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:49:13.734979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:13.785940 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:49:13.785940 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:49:13.785940 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:49:13.790969 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:49:13.796230 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:49:13.798233 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:49:13.800229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m15:49:13.803226 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:49:13.803226 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:49:13.804226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:13.850931 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m15:49:13.850931 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:49:13.850931 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:49:13.864888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:49:13.867887 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:49:13.868886 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:49:13.869884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m15:49:13.872133 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:49:13.873132 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:49:13.873132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:13.921078 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:49:13.921078 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:49:13.921078 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:49:13.933601 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:49:13.935600 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:49:13.936600 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:49:13.937597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m15:49:13.939595 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:49:13.940594 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:49:13.940594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:13.990828 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m15:49:13.997960 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:49:13.998961 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:49:14.007954 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m15:49:14.009953 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:49:14.010952 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:49:14.021256 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.022253 [debug] [MainThread]: On master: BEGIN
[0m15:49:14.022253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:14.082434 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m15:49:14.084183 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.084183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:14.090709 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:49:14.099016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE84F7D10>]}
[0m15:49:14.100015 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:14.102019 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.103014 [debug] [MainThread]: On master: BEGIN
[0m15:49:14.104013 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:14.105011 [debug] [MainThread]: On master: COMMIT
[0m15:49:14.105011 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.106011 [debug] [MainThread]: On master: COMMIT
[0m15:49:14.106011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:14.107010 [debug] [MainThread]: On master: Close
[0m15:49:14.109010 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m15:49:14.110009 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m15:49:14.111008 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m15:49:14.111008 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m15:49:14.120788 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m15:49:14.210653 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.211653 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m15:49:14.212651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:14.369764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m15:49:14.371073 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.372068 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:49:14.390760 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.021 seconds
[0m15:49:14.450817 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.450817 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp154914445904"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * 
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m15:49:14.469353 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.012 seconds
[0m15:49:14.472374 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.473392 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp154914445904'
        
      order by ordinal_position

  
[0m15:49:14.477371 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m15:49:14.483616 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.484616 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:49:14.489321 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m15:49:14.492320 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.493328 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp154914445904'
        
      order by ordinal_position

  
[0m15:49:14.499095 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.005 seconds
[0m15:49:14.504092 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.505092 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:49:14.509107 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m15:49:14.521177 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.521177 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp154914445904'
        
      order by ordinal_position

  
[0m15:49:14.521177 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m15:49:14.555943 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.555943 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * 
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m15:49:14.555943 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:49:14.571523 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.571523 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:49:14.573516 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:49:14.573516 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m15:49:14.574515 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.578152 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.581242 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp154914445904" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp154914445904" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:49:14.584323 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.005 seconds
[0m15:49:14.609836 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m15:49:14.610835 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m15:49:14.610835 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m15:49:14.612835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:49:14.620730 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m15:49:14.620730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec8ba92e-dd8e-48d4-ad4c-6ca2c6bb917a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE8E56A80>]}
[0m15:49:14.620730 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.51s]
[0m15:49:14.620730 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m15:49:14.631003 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.632003 [debug] [MainThread]: On master: BEGIN
[0m15:49:14.632003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:14.689542 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m15:49:14.690540 [debug] [MainThread]: On master: COMMIT
[0m15:49:14.691538 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.691538 [debug] [MainThread]: On master: COMMIT
[0m15:49:14.692538 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:14.693537 [debug] [MainThread]: On master: Close
[0m15:49:14.693537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:14.694538 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:49:14.695537 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m15:49:14.696538 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m15:49:14.697535 [info ] [MainThread]: 
[0m15:49:14.698535 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m15:49:14.700534 [debug] [MainThread]: Command end result
[0m15:49:14.736185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:49:14.739185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:49:14.746180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:49:14.746695 [info ] [MainThread]: 
[0m15:49:14.748696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:14.750695 [info ] [MainThread]: 
[0m15:49:14.751694 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:14.754691 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:49:14.754691 after 2.78 seconds
[0m15:49:14.756744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE62EDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE6BCCB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BE46C1880>]}
[0m15:49:14.756744 [debug] [MainThread]: Flushing usage events
[0m15:49:15.331785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:46.263612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6787FD190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E678B3F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E678B3E300>]}


============================== 15:54:46.269610 | 1707ea9e-bc6f-4e77-a856-0866a5eb6995 ==============================
[0m15:54:46.269610 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:54:46.271608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:54:46.482531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1707ea9e-bc6f-4e77-a856-0866a5eb6995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67853FD10>]}
[0m15:54:46.522861 [debug] [MainThread]: Command `dbt clean` succeeded at 15:54:46.521861 after 0.45 seconds
[0m15:54:46.523860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6787FD190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6791C3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6791C3470>]}
[0m15:54:46.524842 [debug] [MainThread]: Flushing usage events
[0m15:54:47.124924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:06.844545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027546284CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275461E4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027548E5E750>]}


============================== 15:55:06.850527 | 8828c046-b74e-4d54-a149-336a3299b3e8 ==============================
[0m15:55:06.850527 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:55:06.852637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:07.148343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549016450>]}
[0m15:55:07.248290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027548E92A20>]}
[0m15:55:07.250896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:07.532169 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:55:07.533169 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:55:07.534166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549303DD0>]}
[0m15:55:09.988108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754A942ED0>]}
[0m15:55:10.125033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:55:10.132781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:55:10.170468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754ABA8710>]}
[0m15:55:10.170468 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:55:10.171498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8828c046-b74e-4d54-a149-336a3299b3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754A77A870>]}
[0m15:55:10.174488 [info ] [MainThread]: 
[0m15:55:10.175160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:10.175974 [info ] [MainThread]: 
[0m15:55:10.176544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:10.180544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:55:10.272961 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:10.272961 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:10.273960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:10.428703 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.155 seconds
[0m15:55:10.430720 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:10.433721 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:10.434717 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:10.435720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:10.481873 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.046 seconds
[0m15:55:10.483870 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:10.486856 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:10.487856 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:10.487856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:10.652345 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.164 seconds
[0m15:55:10.654342 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:10.656358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m15:55:10.665335 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:55:10.665335 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:55:10.666333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:10.772274 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m15:55:10.774273 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:55:10.775273 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:55:10.787265 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m15:55:10.790264 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:55:10.791264 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:55:10.793262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_default_snapshots)
[0m15:55:10.798260 [debug] [ThreadPool]: Using postgres connection "list_default_snapshots"
[0m15:55:10.799261 [debug] [ThreadPool]: On list_default_snapshots: BEGIN
[0m15:55:10.800260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:10.857225 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m15:55:10.858224 [debug] [ThreadPool]: Using postgres connection "list_default_snapshots"
[0m15:55:10.858224 [debug] [ThreadPool]: On list_default_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_default_snapshots"} */
select
      'default' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'default' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'default' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:55:10.866223 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:55:10.868219 [debug] [ThreadPool]: On list_default_snapshots: ROLLBACK
[0m15:55:10.869218 [debug] [ThreadPool]: On list_default_snapshots: Close
[0m15:55:10.870218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_default_snapshots, now list_gestion_public_staging)
[0m15:55:10.873217 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:55:10.874215 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:55:10.874215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:10.919205 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m15:55:10.919205 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:55:10.920203 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:55:10.928184 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:55:10.930183 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:55:10.930183 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:55:10.931182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m15:55:10.934180 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:55:10.934180 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:55:10.935180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:10.980155 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:55:10.980155 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:55:10.981153 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:55:10.988150 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:55:10.990149 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:55:10.991148 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:55:10.993147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m15:55:10.996145 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:55:10.997146 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:55:10.997146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:11.149668 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m15:55:11.150666 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:55:11.150666 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:55:11.159259 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:55:11.162257 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:55:11.163258 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:55:11.165256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:11.166273 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:55:11.166273 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m15:55:11.167272 [info ] [MainThread]: 
[0m15:55:11.168253 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m15:55:11.168813 [error] [MainThread]: Encountered an error:
ERROR: Cross-db references not allowed in postgres (default vs gestion)
[0m15:55:11.170650 [debug] [MainThread]: Command `dbt run` failed at 15:55:11.170650 after 4.47 seconds
[0m15:55:11.170650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275488FE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754ABC20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754AB0EDE0>]}
[0m15:55:11.171633 [debug] [MainThread]: Flushing usage events
[0m15:55:11.724147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:29.013549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289A8334FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AA71CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AA71F4A0>]}


============================== 15:55:29.018734 | fc922d64-d0ef-4688-a092-917592bc36fa ==============================
[0m15:55:29.018734 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:55:29.020736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:29.350671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc922d64-d0ef-4688-a092-917592bc36fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AB1A38F0>]}
[0m15:55:29.455612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc922d64-d0ef-4688-a092-917592bc36fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AAF42930>]}
[0m15:55:29.458610 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:29.730454 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:55:29.978331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:29.979330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:30.065280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc922d64-d0ef-4688-a092-917592bc36fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AB363320>]}
[0m15:55:30.206182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:55:30.211179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:55:30.247158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc922d64-d0ef-4688-a092-917592bc36fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AC7A7E60>]}
[0m15:55:30.247158 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m15:55:30.248176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc922d64-d0ef-4688-a092-917592bc36fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289A8D7AED0>]}
[0m15:55:30.251156 [info ] [MainThread]: 
[0m15:55:30.252156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:30.252156 [info ] [MainThread]: 
[0m15:55:30.253155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:30.258172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:55:30.352100 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:30.353098 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:30.354097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:30.401242 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.048 seconds
[0m15:55:30.403243 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:30.406223 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:30.407226 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:30.408224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.451873 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.044 seconds
[0m15:55:30.453885 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:30.457881 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:55:30.457881 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:55:30.458885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.505859 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.047 seconds
[0m15:55:30.507839 [debug] [ThreadPool]: On list_gestion: Close
[0m15:55:30.509838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_default_snapshots'
[0m15:55:30.515853 [debug] [ThreadPool]: Using postgres connection "list_default_snapshots"
[0m15:55:30.516852 [debug] [ThreadPool]: On list_default_snapshots: BEGIN
[0m15:55:30.517852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:30.563808 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:55:30.564807 [debug] [ThreadPool]: Using postgres connection "list_default_snapshots"
[0m15:55:30.564807 [debug] [ThreadPool]: On list_default_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_default_snapshots"} */
select
      'default' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'default' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'default' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:55:30.572803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:55:30.574803 [debug] [ThreadPool]: On list_default_snapshots: ROLLBACK
[0m15:55:30.574803 [debug] [ThreadPool]: On list_default_snapshots: Close
[0m15:55:30.575802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_default_snapshots, now list_gestion_public_intermediate)
[0m15:55:30.578800 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:55:30.579799 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:55:30.579799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.625030 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:55:30.626032 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:55:30.626032 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:55:30.634040 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:55:30.636026 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:55:30.637026 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:55:30.638023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m15:55:30.641040 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:55:30.642040 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:55:30.642040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.691993 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:55:30.691993 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:55:30.692994 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:55:30.700989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:55:30.702986 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:55:30.703985 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:55:30.704985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m15:55:30.706984 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:55:30.707983 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:55:30.708983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.753849 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:55:30.753849 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:55:30.754864 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:55:30.762845 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:55:30.764845 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:55:30.765844 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:55:30.766843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m15:55:30.771840 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:55:30.772838 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:55:30.773856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:30.833804 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m15:55:30.834804 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:55:30.835803 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:55:30.843799 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:55:30.845797 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:55:30.847796 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:55:30.851794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:30.852793 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:55:30.853792 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m15:55:30.853792 [info ] [MainThread]: 
[0m15:55:30.855792 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:55:30.856790 [error] [MainThread]: Encountered an error:
ERROR: Cross-db references not allowed in postgres (default vs gestion)
[0m15:55:30.859789 [debug] [MainThread]: Command `dbt run` failed at 15:55:30.859789 after 1.99 seconds
[0m15:55:30.860788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AADBF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AC773830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289AC7A00E0>]}
[0m15:55:30.861787 [debug] [MainThread]: Flushing usage events
[0m15:55:41.431167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:04.764039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146F493A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146F4ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146F4B620>]}


============================== 15:56:04.771034 | c4b08ee7-cac6-4021-b2b4-e75accf12d4b ==============================
[0m15:56:04.771034 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:56:04.772033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:05.092867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002014762F230>]}
[0m15:56:05.193809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201448722A0>]}
[0m15:56:05.195790 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:56:05.480629 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:56:05.833434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:05.834432 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m15:56:06.426426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020148BB7EF0>]}
[0m15:56:06.575448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:56:06.581448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:56:06.618471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020148C6CDD0>]}
[0m15:56:06.619488 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m15:56:06.620488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002014898CB60>]}
[0m15:56:06.624486 [info ] [MainThread]: 
[0m15:56:06.625466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:06.626466 [info ] [MainThread]: 
[0m15:56:06.627466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:06.633480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m15:56:06.737399 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:56:06.737399 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:56:06.738399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:06.787373 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.049 seconds
[0m15:56:06.789369 [debug] [ThreadPool]: On list_gestion: Close
[0m15:56:06.792369 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:56:06.793368 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:56:06.794367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:06.941512 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.147 seconds
[0m15:56:06.943496 [debug] [ThreadPool]: On list_gestion: Close
[0m15:56:06.948493 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m15:56:06.949491 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m15:56:06.950491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:06.995622 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.046 seconds
[0m15:56:06.998624 [debug] [ThreadPool]: On list_gestion: Close
[0m15:56:07.000622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m15:56:07.007385 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:56:07.007385 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m15:56:07.008385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:07.054358 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m15:56:07.054358 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m15:56:07.055376 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:56:07.062357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:56:07.064353 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m15:56:07.065352 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m15:56:07.066352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m15:56:07.068368 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:56:07.069368 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m15:56:07.069368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:07.115326 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:56:07.116339 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m15:56:07.116339 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:56:07.124320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:56:07.126335 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m15:56:07.127335 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m15:56:07.128317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m15:56:07.130315 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:56:07.131314 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m15:56:07.132313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:07.284714 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m15:56:07.285728 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m15:56:07.285728 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m15:56:07.294720 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m15:56:07.297721 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m15:56:07.297721 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m15:56:07.298736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m15:56:07.302238 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:56:07.302238 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m15:56:07.303229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:07.350538 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m15:56:07.351549 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m15:56:07.351549 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m15:56:07.360551 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:56:07.362536 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m15:56:07.364541 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m15:56:07.365533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m15:56:07.368550 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:56:07.368550 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m15:56:07.369548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:07.418810 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m15:56:07.419812 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m15:56:07.420811 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m15:56:07.427823 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:56:07.429805 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m15:56:07.430806 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m15:56:07.436818 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.437819 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.438802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:07.486772 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m15:56:07.486772 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.487773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:07.496767 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:56:07.498767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201491E0170>]}
[0m15:56:07.499765 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:07.500767 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.500767 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.501778 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:07.502763 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.502763 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.503762 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.503762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:07.504780 [debug] [MainThread]: On master: Close
[0m15:56:07.506760 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m15:56:07.507761 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m15:56:07.508777 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m15:56:07.508777 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m15:56:07.519771 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m15:56:07.521753 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m15:56:07.594713 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m15:56:07.597708 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:56:07.598708 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m15:56:07.598708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:07.642683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m15:56:07.642683 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m15:56:07.643700 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    UPPER(status) AS status,
    updated_at::timestamptz AS updated_at 
    FROM "gestion"."public_seeds"."management_control")


SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m15:56:07.644700 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « updated_at » n'existe pas
LINE 23:     updated_at::timestamptz AS updated_at 
             ^

[0m15:56:07.645698 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: ROLLBACK
[0m15:56:07.646696 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m15:56:07.653694 [debug] [Thread-1 (]: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la colonne « updated_at » n'existe pas
  LINE 23:     updated_at::timestamptz AS updated_at 
               ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m15:56:07.656678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b08ee7-cac6-4021-b2b4-e75accf12d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020148BE9460>]}
[0m15:56:07.657675 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_staging.stg_management_control  [[31mERROR[0m in 0.15s]
[0m15:56:07.659692 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m15:56:07.660684 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.stg_management_control' to be skipped because of status 'error'.  Reason: Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la colonne « updated_at » n'existe pas
  LINE 23:     updated_at::timestamptz AS updated_at 
               ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql.
[0m15:56:07.662671 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m15:56:07.663689 [info ] [Thread-1 (]: 2 of 4 SKIP relation public_intermediate.int_management_control ................ [[33mSKIP[0m]
[0m15:56:07.665671 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m15:56:07.667671 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m15:56:07.668669 [info ] [Thread-1 (]: 3 of 4 SKIP relation public_management_control.control_growth .................. [[33mSKIP[0m]
[0m15:56:07.672666 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m15:56:07.674683 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m15:56:07.675682 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_management_control.control_summary ................. [[33mSKIP[0m]
[0m15:56:07.677663 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m15:56:07.678662 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.679662 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.680664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:07.833322 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m15:56:07.834322 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.835320 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:07.835320 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.836319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:07.836319 [debug] [MainThread]: On master: Close
[0m15:56:07.837319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:07.838319 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m15:56:07.838319 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m15:56:07.839318 [debug] [MainThread]: Connection 'model.management_control_project.stg_management_control' was properly closed.
[0m15:56:07.839318 [info ] [MainThread]: 
[0m15:56:07.840317 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m15:56:07.842317 [debug] [MainThread]: Command end result
[0m15:56:07.871301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m15:56:07.874299 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m15:56:07.882294 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m15:56:07.883294 [info ] [MainThread]: 
[0m15:56:07.884293 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:56:07.885293 [info ] [MainThread]: 
[0m15:56:07.887294 [error] [MainThread]:   Database Error in model stg_management_control (models\staging\stg_management_control.sql)
  ERREUR:  la colonne « updated_at » n'existe pas
  LINE 23:     updated_at::timestamptz AS updated_at 
               ^
  compiled code at target\run\management_control_project\models\staging\stg_management_control.sql
[0m15:56:07.889290 [info ] [MainThread]: 
[0m15:56:07.890290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m15:56:07.892288 [debug] [MainThread]: Command `dbt run` failed at 15:56:07.892288 after 3.32 seconds
[0m15:56:07.892288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201471A63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201468C57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146E42DE0>]}
[0m15:56:07.893287 [debug] [MainThread]: Flushing usage events
[0m15:56:08.418484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:19.151064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C541F60860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5473E6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5473E7380>]}


============================== 16:01:19.156061 | 2f862c4e-6b8f-439a-bb21-5e2aeafc27b5 ==============================
[0m16:01:19.156061 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:01:19.157060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:01:19.467888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5417B83B0>]}
[0m16:01:19.568832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C547E02B10>]}
[0m16:01:19.569832 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:19.865663 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:01:20.135506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:20.136505 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\staging\stg_management_control.sql
[0m16:01:20.926544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5497B9FA0>]}
[0m16:01:21.073571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:01:21.078569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:01:21.125644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5499BB5C0>]}
[0m16:01:21.126643 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:01:21.127642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54978C950>]}
[0m16:01:21.131643 [info ] [MainThread]: 
[0m16:01:21.134639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:21.136638 [info ] [MainThread]: 
[0m16:01:21.139644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:21.143637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:01:21.249572 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:01:21.249572 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:01:21.250572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:21.302542 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.052 seconds
[0m16:01:21.304541 [debug] [ThreadPool]: On list_gestion: Close
[0m16:01:21.310538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:01:21.317534 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:01:21.318533 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:01:21.318533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:21.370505 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:01:21.370505 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:01:21.371504 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:01:21.381497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:01:21.383921 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:01:21.384919 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:01:21.385917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m16:01:21.387917 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:01:21.388915 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:01:21.388915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:21.438889 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m16:01:21.438889 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:01:21.439888 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:01:21.448882 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:01:21.449880 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:01:21.450881 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:01:21.451879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m16:01:21.455896 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:01:21.456896 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:01:21.457876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:21.616666 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m16:01:21.617663 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:01:21.618662 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:01:21.626659 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:21.628658 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:01:21.629655 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:01:21.630656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m16:01:21.635653 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:01:21.636652 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:01:21.637652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:21.702614 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m16:01:21.703614 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:01:21.704613 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:01:21.712610 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:21.715606 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:01:21.716605 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:01:21.717606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:01:21.719605 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:01:21.720605 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:01:21.721604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:21.784567 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:01:21.785568 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:01:21.786566 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:01:21.798558 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:01:21.800557 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:01:21.800557 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:01:21.812554 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.813550 [debug] [MainThread]: On master: BEGIN
[0m16:01:21.813550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:21.976458 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m16:01:21.977477 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.979477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:21.987450 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:01:21.989451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C549611610>]}
[0m16:01:21.990448 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:21.991449 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.992448 [debug] [MainThread]: On master: BEGIN
[0m16:01:21.993448 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:01:21.994447 [debug] [MainThread]: On master: COMMIT
[0m16:01:21.995446 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.996465 [debug] [MainThread]: On master: COMMIT
[0m16:01:21.997463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:21.998462 [debug] [MainThread]: On master: Close
[0m16:01:22.001461 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:01:22.002445 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:01:22.004460 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:01:22.005440 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:01:22.020434 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:01:22.100387 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.102388 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:01:22.103384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:22.156354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:01:22.157354 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.158353 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:01:22.180341 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.020 seconds
[0m16:01:22.249300 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.250300 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp160122237307"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at 
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:01:22.260296 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m16:01:22.264293 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.265292 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160122237307'
        
      order by ordinal_position

  
[0m16:01:22.272289 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.006 seconds
[0m16:01:22.281283 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.282282 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:01:22.286280 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:01:22.373233 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.375231 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160122237307'
        
      order by ordinal_position

  
[0m16:01:22.383225 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.006 seconds
[0m16:01:22.386223 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.387222 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:01:22.393218 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m16:01:22.408210 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.409211 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160122237307'
        
      order by ordinal_position

  
[0m16:01:22.417205 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.006 seconds
[0m16:01:22.448188 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.449187 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at 
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:01:22.451186 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:01:22.461180 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.462182 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:01:22.464178 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:01:22.465177 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m16:01:22.466177 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.468176 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.469175 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp160122237307" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp160122237307" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:01:22.472173 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:01:22.500158 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:01:22.501157 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:01:22.502156 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:01:22.504154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:22.511152 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:01:22.514150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f862c4e-6b8f-439a-bb21-5e2aeafc27b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5473E4AA0>]}
[0m16:01:22.516148 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 0[0m in 0.51s]
[0m16:01:22.517148 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:01:22.519146 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:22.520146 [debug] [MainThread]: On master: BEGIN
[0m16:01:22.520146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:22.583110 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m16:01:22.585109 [debug] [MainThread]: On master: COMMIT
[0m16:01:22.585109 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:22.586108 [debug] [MainThread]: On master: COMMIT
[0m16:01:22.587108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:22.588107 [debug] [MainThread]: On master: Close
[0m16:01:22.589107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:22.590107 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:01:22.591106 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m16:01:22.592106 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:01:22.593104 [info ] [MainThread]: 
[0m16:01:22.594104 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m16:01:22.596103 [debug] [MainThread]: Command end result
[0m16:01:22.650073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:01:22.654070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:01:22.666063 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:01:22.667062 [info ] [MainThread]: 
[0m16:01:22.668061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:22.669060 [info ] [MainThread]: 
[0m16:01:22.670060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:01:22.673058 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:01:22.673058 after 3.73 seconds
[0m16:01:22.674058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5477B1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5496DAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5496D8C50>]}
[0m16:01:22.675058 [debug] [MainThread]: Flushing usage events
[0m16:01:23.309359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:31.685568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6479D9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6479DB1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B647B54830>]}


============================== 16:01:31.691577 | df52eaa9-4e98-4a8b-bcc4-d1986847e77f ==============================
[0m16:01:31.691577 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:01:31.694002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:32.016815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6485364E0>]}
[0m16:01:32.114779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6482B07A0>]}
[0m16:01:32.115778 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:32.392601 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:01:32.646474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:32.647457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:32.746414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64881BB30>]}
[0m16:01:32.903335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:01:32.908332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:01:32.951218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B649BE7B60>]}
[0m16:01:32.951218 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:01:32.952509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6484E2300>]}
[0m16:01:32.955512 [info ] [MainThread]: 
[0m16:01:32.956511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:32.957509 [info ] [MainThread]: 
[0m16:01:32.959508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:32.965848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:01:33.067481 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:01:33.068480 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:01:33.068480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:33.119668 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.051 seconds
[0m16:01:33.122668 [debug] [ThreadPool]: On list_gestion: Close
[0m16:01:33.128663 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:01:33.130662 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:01:33.131662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.178632 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.047 seconds
[0m16:01:33.180630 [debug] [ThreadPool]: On list_gestion: Close
[0m16:01:33.184612 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:01:33.184612 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:01:33.185611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.232106 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.047 seconds
[0m16:01:33.234121 [debug] [ThreadPool]: On list_gestion: Close
[0m16:01:33.236102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m16:01:33.243098 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:01:33.244099 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:01:33.245098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:33.394925 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m16:01:33.395910 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:01:33.395910 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:01:33.404794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:01:33.406812 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:01:33.407812 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:01:33.408790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:01:33.413787 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:01:33.414805 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:01:33.414805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.461760 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:01:33.461760 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:01:33.462760 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:01:33.469756 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:33.472754 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:01:33.473754 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:01:33.474754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m16:01:33.477752 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:01:33.478750 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:01:33.479750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.625083 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m16:01:33.625083 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:01:33.626098 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:01:33.634611 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:01:33.636628 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:01:33.637609 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:01:33.638609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m16:01:33.643606 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:01:33.644605 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:01:33.645605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.800623 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m16:01:33.801605 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:01:33.802607 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:01:33.811254 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:01:33.813253 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:01:33.814252 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:01:33.815236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:01:33.817251 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:01:33.818250 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:01:33.818250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:33.866205 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:01:33.866205 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:01:33.867204 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:01:33.876200 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:01:33.878212 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:01:33.879198 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:01:33.884212 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:33.885212 [debug] [MainThread]: On master: BEGIN
[0m16:01:33.885212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:33.936164 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m16:01:33.937166 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:33.938166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:33.948173 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:01:33.950159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64A16D160>]}
[0m16:01:33.951158 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:33.952155 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:33.952155 [debug] [MainThread]: On master: BEGIN
[0m16:01:33.953157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:01:33.954154 [debug] [MainThread]: On master: COMMIT
[0m16:01:33.955155 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:33.955155 [debug] [MainThread]: On master: COMMIT
[0m16:01:33.956153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:33.957153 [debug] [MainThread]: On master: Close
[0m16:01:33.960169 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:01:33.960169 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:01:33.962150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:01:33.962150 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:01:33.976156 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:01:33.978143 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:01:34.048100 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:01:34.049099 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.050100 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:01:34.051099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:34.098072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:01:34.098072 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.099071 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:01:34.109066 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m16:01:34.118061 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.119061 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:01:34.120059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.124057 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.125057 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:01:34.126057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.150042 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:01:34.150042 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.151042 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:01:34.155040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:34.163034 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:01:34.168032 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:01:34.169031 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:01:34.174029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:01:34.177027 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:01:34.180025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6459182C0>]}
[0m16:01:34.181024 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.22s]
[0m16:01:34.182024 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:01:34.183023 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:01:34.184024 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:01:34.185022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:01:34.186022 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:01:34.191019 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:01:34.193018 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:01:34.198014 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:01:34.200013 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.201014 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:01:34.202013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:34.256806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m16:01:34.256806 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.257798 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:01:34.266779 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m16:01:34.270778 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.271777 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:01:34.273778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:34.276791 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.277791 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:01:34.278773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.280773 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:01:34.281771 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.281771 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:01:34.285332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:01:34.289334 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:01:34.290353 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:01:34.290353 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:01:34.296331 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:01:34.297347 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:01:34.298346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64A141D90>]}
[0m16:01:34.300326 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.11s]
[0m16:01:34.301325 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:01:34.302327 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:01:34.303326 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:01:34.304326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:01:34.305326 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:01:34.314318 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:01:34.317317 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:01:34.326313 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:01:34.329311 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.329311 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:01:34.330311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:34.474820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m16:01:34.475837 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.475837 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:01:34.486180 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m16:01:34.491178 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.492177 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:01:34.493178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.496192 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.497191 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:01:34.498173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.500190 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:01:34.501189 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.502172 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:01:34.505118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:34.508129 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:01:34.509128 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:01:34.509128 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:01:34.513458 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:01:34.515474 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:01:34.516478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64A58DCA0>]}
[0m16:01:34.517459 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.21s]
[0m16:01:34.518493 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:01:34.519498 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:01:34.520497 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:01:34.521496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:01:34.522496 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:01:34.527491 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:01:34.528491 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:01:34.539487 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:01:34.541518 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.542485 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:01:34.543485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:34.599249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m16:01:34.600249 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.600249 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:01:34.612279 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m16:01:34.616295 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.617295 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:01:34.618294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:01:34.622293 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.622293 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:01:34.624272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:34.626271 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:01:34.627271 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.627271 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:01:34.630628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:34.633643 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:01:34.634647 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:01:34.634647 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:01:34.638628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:01:34.641643 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:01:34.642626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df52eaa9-4e98-4a8b-bcc4-d1986847e77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64A1E6420>]}
[0m16:01:34.644623 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.12s]
[0m16:01:34.646622 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:01:34.648620 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:34.648620 [debug] [MainThread]: On master: BEGIN
[0m16:01:34.649619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:34.700592 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m16:01:34.701591 [debug] [MainThread]: On master: COMMIT
[0m16:01:34.702590 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:34.702590 [debug] [MainThread]: On master: COMMIT
[0m16:01:34.703589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:34.704589 [debug] [MainThread]: On master: Close
[0m16:01:34.705588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:34.705588 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:01:34.706588 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m16:01:34.706588 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:01:34.707587 [info ] [MainThread]: 
[0m16:01:34.708586 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m16:01:34.710585 [debug] [MainThread]: Command end result
[0m16:01:34.749580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:01:34.751576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:01:34.761556 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:01:34.762556 [info ] [MainThread]: 
[0m16:01:34.763558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:34.764556 [info ] [MainThread]: 
[0m16:01:34.765555 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:01:34.767554 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:34.767554 after 3.24 seconds
[0m16:01:34.768552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64824E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64831AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B64867B3B0>]}
[0m16:01:34.768552 [debug] [MainThread]: Flushing usage events
[0m16:01:35.537732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:33.741522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B78B79400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7846A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7846BEC0>]}


============================== 16:04:33.747534 | 62f807db-f9be-4d3b-9660-a367de2bda85 ==============================
[0m16:04:33.747534 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:04:33.748517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:04:34.061338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B763BDBE0>]}
[0m16:04:34.164278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7890F380>]}
[0m16:04:34.166277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:04:34.467942 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:04:34.724800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:34.725801 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:04:35.194618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A7E7DA0>]}
[0m16:04:35.340537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:04:35.345515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:04:35.381493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A8ACCB0>]}
[0m16:04:35.382493 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:04:35.383493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A65AD20>]}
[0m16:04:35.385509 [info ] [MainThread]: 
[0m16:04:35.387492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:35.388489 [info ] [MainThread]: 
[0m16:04:35.389490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:35.395509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:04:35.492430 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:04:35.492430 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:04:35.493429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:35.545667 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.052 seconds
[0m16:04:35.547667 [debug] [ThreadPool]: On list_gestion: Close
[0m16:04:35.552683 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:04:35.553664 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:04:35.555662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:35.713998 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.159 seconds
[0m16:04:35.716016 [debug] [ThreadPool]: On list_gestion: Close
[0m16:04:35.719998 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:04:35.720999 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:04:35.721999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:35.779997 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.058 seconds
[0m16:04:35.782994 [debug] [ThreadPool]: On list_gestion: Close
[0m16:04:35.785993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:04:35.793988 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:04:35.794988 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:04:35.794988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:35.843960 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m16:04:35.844960 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:04:35.845960 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:04:35.853955 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:04:35.856953 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:04:35.856953 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:04:35.857953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m16:04:35.861950 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:04:35.862948 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:04:35.862948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:35.908923 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:04:35.909922 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:04:35.910921 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:04:35.917918 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:04:35.919916 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:04:35.920915 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:04:35.921915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m16:04:35.924914 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:04:35.925913 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:04:35.926913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:35.974889 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:04:35.975886 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:04:35.976884 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:04:35.984880 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:04:35.986878 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:04:35.987877 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:04:35.988876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m16:04:35.991876 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:04:35.992876 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:04:35.993875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:36.039847 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:04:36.040847 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:04:36.042846 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:04:36.055840 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:04:36.058839 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:04:36.060837 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:04:36.061836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m16:04:36.064833 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:04:36.064833 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:04:36.065832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:36.111807 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:04:36.112809 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:04:36.113804 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:04:36.120806 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:04:36.122801 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:04:36.123800 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:04:36.129795 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:36.130795 [debug] [MainThread]: On master: BEGIN
[0m16:04:36.131795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:36.180767 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m16:04:36.181766 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:36.181766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:36.191760 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:04:36.193760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B764CA720>]}
[0m16:04:36.194759 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:36.194759 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:36.195759 [debug] [MainThread]: On master: BEGIN
[0m16:04:36.196757 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:04:36.196757 [debug] [MainThread]: On master: COMMIT
[0m16:04:36.197756 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:36.197756 [debug] [MainThread]: On master: COMMIT
[0m16:04:36.198757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:36.198757 [debug] [MainThread]: On master: Close
[0m16:04:36.201754 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:04:36.201754 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:04:36.204756 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:04:36.205753 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:04:36.224741 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:04:36.225741 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:04:36.293703 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:04:36.294704 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.295701 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:04:36.295701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:36.450212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m16:04:36.450212 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.451213 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:04:36.462235 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m16:04:36.471230 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.472231 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:04:36.474231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:36.477244 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.478227 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:04:36.479228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:36.502212 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:04:36.504212 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.505216 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:04:36.507209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:36.515204 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:04:36.522203 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:04:36.523202 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:04:36.527556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:04:36.530575 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:04:36.533931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76438740>]}
[0m16:04:36.534934 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.33s]
[0m16:04:36.536808 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:04:36.538807 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:04:36.539806 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:04:36.541804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:04:36.543803 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:04:36.550817 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:04:36.552799 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:04:36.563791 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:04:36.564793 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.565794 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:04:36.566791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:36.717456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m16:04:36.718457 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.718457 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:04:36.732459 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m16:04:36.736459 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.737460 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:04:36.738460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:36.745455 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.745455 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:04:36.747453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:36.749453 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:04:36.749453 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.750453 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:04:36.752071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:36.756081 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:04:36.757080 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:04:36.758080 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:04:36.761984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:04:36.763988 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:04:36.764987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7B25E150>]}
[0m16:04:36.765985 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.22s]
[0m16:04:36.767003 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:04:36.768670 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:04:36.769339 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:04:36.770343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:04:36.771359 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:04:36.779338 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:04:36.780338 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:04:36.785334 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:04:36.787333 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.788333 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:04:36.790333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:36.843305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:04:36.844301 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.844301 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:04:36.854297 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m16:04:36.858293 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.859293 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:04:36.860290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:36.863289 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.864289 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:04:36.865290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:36.867286 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:04:36.868286 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.868286 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:04:36.870286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:36.875284 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:04:36.876282 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:04:36.877282 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:04:36.881281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:04:36.883278 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:04:36.883278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7AE04DD0>]}
[0m16:04:36.885276 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.11s]
[0m16:04:36.886276 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:04:36.888276 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:04:36.889276 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:04:36.890273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:04:36.891274 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:04:36.897272 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:04:36.898271 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:04:36.903266 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:04:36.906266 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:36.907267 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:04:36.908263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:37.057941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m16:04:37.057941 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:37.058942 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:04:37.072712 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m16:04:37.076708 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:37.076708 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:04:37.077707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:37.080725 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:37.081708 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:04:37.082724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:04:37.084723 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:04:37.084723 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:37.085722 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:04:37.087704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:37.092720 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:04:37.093718 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:04:37.094697 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:04:37.098378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:04:37.100399 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:04:37.101380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f807db-f9be-4d3b-9660-a367de2bda85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7B2B39E0>]}
[0m16:04:37.103380 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 0[0m in 0.21s]
[0m16:04:37.106379 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:04:37.109376 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:37.109376 [debug] [MainThread]: On master: BEGIN
[0m16:04:37.110375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:37.166344 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m16:04:37.167343 [debug] [MainThread]: On master: COMMIT
[0m16:04:37.167343 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:37.168342 [debug] [MainThread]: On master: COMMIT
[0m16:04:37.168342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:37.169342 [debug] [MainThread]: On master: Close
[0m16:04:37.170343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:37.171341 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:04:37.172340 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m16:04:37.172340 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:04:37.173341 [info ] [MainThread]: 
[0m16:04:37.174339 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m16:04:37.176338 [debug] [MainThread]: Command end result
[0m16:04:37.287278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:04:37.291271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:04:37.299269 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:04:37.299269 [info ] [MainThread]: 
[0m16:04:37.300269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:37.302268 [info ] [MainThread]: 
[0m16:04:37.304267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:04:37.307265 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:37.307265 after 3.77 seconds
[0m16:04:37.308263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7875CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B764CA1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7B26E810>]}
[0m16:04:37.309262 [debug] [MainThread]: Flushing usage events
[0m16:04:37.985037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:44.380690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173782780E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173782F4E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017378279FD0>]}


============================== 16:04:44.388688 | 438e94e5-3e14-4d02-acb2-ef24e0eb93fb ==============================
[0m16:04:44.388688 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:04:44.391686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:44.706996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017378756330>]}
[0m16:04:44.832924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017377E84B30>]}
[0m16:04:44.834924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:04:45.226783 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:04:45.589714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:45.591710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:45.707642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017379A6D310>]}
[0m16:04:45.914524 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:04:45.923519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:04:45.968498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017379E27CE0>]}
[0m16:04:45.969495 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:04:45.971492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173789E2DE0>]}
[0m16:04:45.974489 [info ] [MainThread]: 
[0m16:04:45.975489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:45.976489 [info ] [MainThread]: 
[0m16:04:45.978488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:45.980487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:04:46.101420 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:04:46.102418 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:04:46.103417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:46.170378 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.067 seconds
[0m16:04:46.173375 [debug] [ThreadPool]: On list_gestion: Close
[0m16:04:46.182370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:04:46.196362 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:04:46.197361 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:04:46.198361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:46.260328 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m16:04:46.261327 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:04:46.261327 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:04:46.270323 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:04:46.274319 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:04:46.275318 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:04:46.276319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:04:46.280315 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:04:46.281314 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:04:46.282315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.434226 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m16:04:46.435228 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:04:46.436225 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:04:46.446220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:04:46.449218 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:04:46.450217 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:04:46.453216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:04:46.458213 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:04:46.459212 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:04:46.460212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.523175 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:04:46.524175 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:04:46.525175 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:04:46.532170 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:04:46.536170 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:04:46.537168 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:04:46.539170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m16:04:46.544165 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:04:46.545164 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:04:46.546164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.601133 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m16:04:46.602131 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:04:46.603130 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:04:46.611125 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:04:46.613124 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:04:46.614123 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:04:46.616122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:04:46.619122 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:04:46.620123 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:04:46.621123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.674090 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m16:04:46.674090 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:04:46.675091 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:04:46.683084 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:04:46.687082 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:04:46.688082 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:04:46.698075 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:46.699075 [debug] [MainThread]: On master: BEGIN
[0m16:04:46.700074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:46.865982 [debug] [MainThread]: SQL status: BEGIN in 0.166 seconds
[0m16:04:46.867981 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:46.868979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:46.878973 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:04:46.880972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017378A5DE80>]}
[0m16:04:46.881970 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:46.882970 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:46.883970 [debug] [MainThread]: On master: BEGIN
[0m16:04:46.885968 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:04:46.886968 [debug] [MainThread]: On master: COMMIT
[0m16:04:46.887967 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:46.888966 [debug] [MainThread]: On master: COMMIT
[0m16:04:46.889966 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:46.889966 [debug] [MainThread]: On master: Close
[0m16:04:46.893964 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:04:46.894963 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:04:46.896961 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:04:46.898961 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:04:46.915952 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:04:47.037881 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.038880 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:04:47.039881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:47.207784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m16:04:47.208783 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.209782 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:47.236767 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.026 seconds
[0m16:04:47.315721 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.316721 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp160447304727"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:04:47.328766 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.011 seconds
[0m16:04:47.331764 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.332782 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160447304727'
        
      order by ordinal_position

  
[0m16:04:47.337761 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:04:47.342776 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.342776 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:47.347755 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:04:47.351753 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.352753 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160447304727'
        
      order by ordinal_position

  
[0m16:04:47.356750 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:04:47.361748 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.362748 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:47.366745 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:04:47.375740 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.376740 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160447304727'
        
      order by ordinal_position

  
[0m16:04:47.383736 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.005 seconds
[0m16:04:47.413717 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.414717 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:04:47.415716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:04:47.422713 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.423713 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:04:47.424711 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:04:47.425711 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m16:04:47.426711 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.427710 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.428709 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp160447304727" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp160447304727" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:04:47.430709 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m16:04:47.448697 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:04:47.449697 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:04:47.451698 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:04:47.454695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:47.460691 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:04:47.464690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '438e94e5-3e14-4d02-acb2-ef24e0eb93fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001737A3A6690>]}
[0m16:04:47.465689 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.56s]
[0m16:04:47.468687 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:04:47.470686 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.471685 [debug] [MainThread]: On master: BEGIN
[0m16:04:47.471685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:47.619601 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m16:04:47.620595 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.621579 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.621579 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.622600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:47.623599 [debug] [MainThread]: On master: Close
[0m16:04:47.624578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:47.625595 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:04:47.625595 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m16:04:47.626580 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:04:47.626580 [info ] [MainThread]: 
[0m16:04:47.627594 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m16:04:47.629575 [debug] [MainThread]: Command end result
[0m16:04:47.662574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:04:47.665568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:04:47.676551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:04:47.677550 [info ] [MainThread]: 
[0m16:04:47.678547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:47.679548 [info ] [MainThread]: 
[0m16:04:47.679548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:47.682560 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:04:47.681563 after 3.46 seconds
[0m16:04:47.684545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001737840D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017378A7FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017377DAF5C0>]}
[0m16:04:47.687542 [debug] [MainThread]: Flushing usage events
[0m16:04:48.225569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:35.309159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF2E2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEE8FF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF2E21E0>]}


============================== 16:08:35.314175 | 7e6c29e5-06e8-4542-ab9b-cfc8a6625d56 ==============================
[0m16:08:35.314175 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:08:35.316156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:08:35.642853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF304950>]}
[0m16:08:35.740797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF1D29C0>]}
[0m16:08:35.742796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:08:36.045714 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:08:36.295560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:08:36.296559 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:08:37.043131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF0B73F80>]}
[0m16:08:37.195044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:08:37.200041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:08:37.239021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF0C0CA10>]}
[0m16:08:37.240020 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:08:37.241018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF0BD9C40>]}
[0m16:08:37.243018 [info ] [MainThread]: 
[0m16:08:37.244017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:37.245017 [info ] [MainThread]: 
[0m16:08:37.247015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:37.255011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:08:37.372942 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:08:37.373942 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:08:37.374941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:37.430909 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.056 seconds
[0m16:08:37.432909 [debug] [ThreadPool]: On list_gestion: Close
[0m16:08:37.437905 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:08:37.438904 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:08:37.439904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.487876 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.048 seconds
[0m16:08:37.489875 [debug] [ThreadPool]: On list_gestion: Close
[0m16:08:37.493873 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:08:37.493873 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:08:37.494872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.546843 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.052 seconds
[0m16:08:37.548842 [debug] [ThreadPool]: On list_gestion: Close
[0m16:08:37.550841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m16:08:37.561835 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:08:37.561835 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:08:37.562834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:37.611810 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m16:08:37.611810 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:08:37.612806 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:08:37.620800 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:08:37.622799 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:08:37.623798 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:08:37.624798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m16:08:37.627795 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:08:37.627795 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:08:37.628795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.675773 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:08:37.676784 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:08:37.676784 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:08:37.685766 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:08:37.686765 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:08:37.687780 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:08:37.688761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:08:37.691759 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:08:37.692759 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:08:37.692759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.743731 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:08:37.744731 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:08:37.745730 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:08:37.754725 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:08:37.756723 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:08:37.756723 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:08:37.757722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:08:37.760720 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:08:37.761720 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:08:37.762720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.826683 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m16:08:37.827682 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:08:37.828682 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:08:37.837679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:08:37.839676 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:08:37.839676 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:08:37.840688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:08:37.843674 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:08:37.844673 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:08:37.845673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:37.899641 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m16:08:37.900641 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:08:37.901639 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:08:37.910636 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:08:37.913633 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:08:37.913633 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:08:37.923627 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:37.923627 [debug] [MainThread]: On master: BEGIN
[0m16:08:37.924627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:37.975600 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m16:08:37.976596 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:37.977596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:08:37.987591 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:08:37.988590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEC7CA3C0>]}
[0m16:08:37.989589 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:37.990588 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:37.990588 [debug] [MainThread]: On master: BEGIN
[0m16:08:37.991589 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:08:37.992588 [debug] [MainThread]: On master: COMMIT
[0m16:08:37.993588 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:37.993588 [debug] [MainThread]: On master: COMMIT
[0m16:08:37.994586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:08:37.994586 [debug] [MainThread]: On master: Close
[0m16:08:37.997585 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:08:37.997585 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:08:37.999584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:08:37.999584 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:08:38.011577 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:08:38.013576 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:08:38.092535 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:08:38.094535 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.094535 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:08:38.095534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:38.140516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:08:38.141500 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.141500 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:08:38.154411 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.012 seconds
[0m16:08:38.162055 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.162055 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:08:38.163073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:38.166071 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.167070 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:08:38.169053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.192056 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:08:38.193037 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.194056 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:08:38.195498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:38.203498 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:08:38.209495 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:08:38.210494 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:08:38.214701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:08:38.218718 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:08:38.221698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEC73C230>]}
[0m16:08:38.222699 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.22s]
[0m16:08:38.224698 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:08:38.225698 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:08:38.226697 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:08:38.227694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:08:38.228695 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:08:38.234692 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:08:38.238690 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:08:38.246684 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:08:38.247682 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.248682 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:08:38.249701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:38.405870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m16:08:38.406867 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.407867 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:08:38.420141 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m16:08:38.425138 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.426155 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:08:38.427136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:38.433133 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.433133 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:08:38.435133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.438148 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:08:38.438148 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.439147 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:08:38.442672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:08:38.445693 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:08:38.446691 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:08:38.446691 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:08:38.451057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:08:38.454054 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:08:38.455053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF15CFB90>]}
[0m16:08:38.456053 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.23s]
[0m16:08:38.457052 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:08:38.458053 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:08:38.459069 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:08:38.460052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:08:38.460052 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:08:38.467067 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:08:38.470050 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:08:38.477041 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:08:38.479040 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.481039 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:08:38.482038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:38.532013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m16:08:38.533009 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.534009 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:08:38.551999 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.017 seconds
[0m16:08:38.558996 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.560994 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:08:38.562992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.567990 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.569988 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:08:38.570988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.574985 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:08:38.575985 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.576985 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:08:38.578984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:38.583982 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:08:38.586979 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:08:38.588978 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:08:38.594974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:08:38.598972 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:08:38.599972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1166B70>]}
[0m16:08:38.601970 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.14s]
[0m16:08:38.604968 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:08:38.605968 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:08:38.607966 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:08:38.609966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:08:38.610967 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:08:38.618961 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:08:38.621959 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:08:38.631952 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:08:38.634951 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.635952 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:08:38.637950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:38.695918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m16:08:38.696918 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.697916 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:08:38.710908 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m16:08:38.717904 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.719903 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:08:38.721902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.727897 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.728897 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:08:38.729897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:38.732896 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:08:38.732896 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.733895 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:08:38.737892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:08:38.741890 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:08:38.742888 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:08:38.743888 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:08:38.746739 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:08:38.748739 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:08:38.749738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e6c29e5-06e8-4542-ab9b-cfc8a6625d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF15F8050>]}
[0m16:08:38.750739 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.14s]
[0m16:08:38.752737 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:08:38.753737 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:38.754735 [debug] [MainThread]: On master: BEGIN
[0m16:08:38.754735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:38.903587 [debug] [MainThread]: SQL status: BEGIN in 0.149 seconds
[0m16:08:38.904589 [debug] [MainThread]: On master: COMMIT
[0m16:08:38.905585 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:38.905585 [debug] [MainThread]: On master: COMMIT
[0m16:08:38.906587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:08:38.907584 [debug] [MainThread]: On master: Close
[0m16:08:38.908585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:38.909583 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:08:38.910583 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:08:38.910583 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:08:38.911584 [info ] [MainThread]: 
[0m16:08:38.913581 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m16:08:38.915579 [debug] [MainThread]: Command end result
[0m16:08:39.016523 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:08:39.020522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:08:39.027517 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:08:39.028517 [info ] [MainThread]: 
[0m16:08:39.029516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:39.030515 [info ] [MainThread]: 
[0m16:08:39.031513 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:08:39.032513 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:39.032513 after 3.94 seconds
[0m16:08:39.033526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEEA12060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEC73C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEC7CA3C0>]}
[0m16:08:39.033526 [debug] [MainThread]: Flushing usage events
[0m16:08:39.578913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:04.380515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E861276630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8611846E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E862B8C7A0>]}


============================== 16:09:04.387263 | 03c8ecaa-fe4c-4047-938e-f8c344b80390 ==============================
[0m16:09:04.387263 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:09:04.387704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:04.691101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E863FBA8D0>]}
[0m16:09:04.788046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8639377D0>]}
[0m16:09:04.790044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:05.055909 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:09:05.285761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:05.286761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:05.375708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E863F416A0>]}
[0m16:09:05.523642 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:09:05.529639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:09:05.564600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E865647BC0>]}
[0m16:09:05.565600 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:09:05.566599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86549FCB0>]}
[0m16:09:05.568600 [info ] [MainThread]: 
[0m16:09:05.569597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:05.570596 [info ] [MainThread]: 
[0m16:09:05.571597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:05.573613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:09:05.669558 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:09:05.669558 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:09:05.670552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:05.720566 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.050 seconds
[0m16:09:05.722568 [debug] [ThreadPool]: On list_gestion: Close
[0m16:09:05.728548 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:09:05.735561 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:09:05.736560 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:09:05.736560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:05.780550 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:09:05.781535 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:09:05.781535 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:09:05.789926 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:09:05.791923 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:09:05.791923 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:09:05.792941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:09:05.797938 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:09:05.797938 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:09:05.798921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:05.842894 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:09:05.843894 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:09:05.843894 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:09:05.851905 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:09:05.853906 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:09:05.854888 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:09:05.854888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:09:05.857887 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:09:05.858887 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:09:05.858887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:05.904862 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:09:05.905874 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:09:05.906860 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:09:05.914856 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:09:05.916854 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:09:05.916854 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:09:05.917851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:09:05.921851 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:09:05.922850 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:09:05.922850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:05.967824 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:09:05.967824 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:09:05.968822 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:09:05.975819 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:09:05.977820 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:09:05.978818 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:09:05.979816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m16:09:05.982816 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:09:05.982816 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:09:05.983815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:06.028788 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:09:06.029788 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:09:06.030787 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:09:06.039782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:09:06.041781 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:09:06.041781 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:09:06.049776 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.049776 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.050790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:06.094753 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:09:06.094753 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.095750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:06.104745 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:09:06.105744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E864132180>]}
[0m16:09:06.106743 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:06.107743 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.107743 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.108742 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:09:06.109741 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.109741 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.110742 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.111741 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:06.112741 [debug] [MainThread]: On master: Close
[0m16:09:06.115739 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:09:06.116740 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:09:06.117739 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:09:06.118742 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:09:06.129730 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:09:06.205686 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.206686 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:09:06.206686 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:06.250525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:09:06.251526 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.251526 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:09:06.271227 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m16:09:06.325215 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.326214 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp160906317220"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:09:06.335191 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.008 seconds
[0m16:09:06.339190 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.339190 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160906317220'
        
      order by ordinal_position

  
[0m16:09:06.344186 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:09:06.348203 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.348203 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:09:06.353183 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:09:06.357193 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.357193 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160906317220'
        
      order by ordinal_position

  
[0m16:09:06.362176 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:09:06.366174 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.367173 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:09:06.371172 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:09:06.379184 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.380184 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp160906317220'
        
      order by ordinal_position

  
[0m16:09:06.385164 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:09:06.407151 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.408151 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        CURRENT_TIMESTAMP AS updated_at
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:09:06.409151 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:09:06.416146 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.417144 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:09:06.418143 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:09:06.419143 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m16:09:06.420142 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.422142 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.423141 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp160906317220" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp160906317220" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:09:06.426157 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m16:09:06.449126 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:09:06.450126 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:09:06.451125 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:09:06.452554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:09:06.457555 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:09:06.461553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03c8ecaa-fe4c-4047-938e-f8c344b80390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8613986B0>]}
[0m16:09:06.463551 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.34s]
[0m16:09:06.464550 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:09:06.465698 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.466701 [debug] [MainThread]: On master: BEGIN
[0m16:09:06.466701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:06.517317 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m16:09:06.518320 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.518320 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:06.519319 [debug] [MainThread]: On master: COMMIT
[0m16:09:06.520302 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:06.520302 [debug] [MainThread]: On master: Close
[0m16:09:06.521315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:06.521315 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:09:06.522301 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:09:06.523298 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:09:06.523298 [info ] [MainThread]: 
[0m16:09:06.524299 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m16:09:06.526297 [debug] [MainThread]: Command end result
[0m16:09:06.557280 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:09:06.559292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:09:06.569274 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:09:06.570273 [info ] [MainThread]: 
[0m16:09:06.571272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:06.572272 [info ] [MainThread]: 
[0m16:09:06.573270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:06.574269 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:09:06.574269 after 2.34 seconds
[0m16:09:06.575287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E863937680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E863A67500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86360CEF0>]}
[0m16:09:06.575287 [debug] [MainThread]: Flushing usage events
[0m16:09:12.114694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:16.266332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94F73800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94F71BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94F72300>]}


============================== 16:13:16.271329 | d5e14071-91e3-4ba3-b003-1afd37b72056 ==============================
[0m16:13:16.271329 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:13:16.273328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:13:16.610975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e14071-91e3-4ba3-b003-1afd37b72056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9493F8C0>]}
[0m16:13:16.711915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e14071-91e3-4ba3-b003-1afd37b72056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94FB44A0>]}
[0m16:13:16.712915 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:17.073020 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:13:17.447805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:13:17.448804 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:13:17.449804 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\staging\stg_management_control.sql
[0m16:13:18.276529 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  expected token ',', got 'de'
    line 8
      updated_at='updated_at::timestamptz'  -- Ajout de la conversion explicite ici
[0m16:13:18.279527 [debug] [MainThread]: Command `dbt snapshot` failed at 16:13:18.279527 after 2.24 seconds
[0m16:13:18.280527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94BDD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD966560F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9441D1C0>]}
[0m16:13:18.281528 [debug] [MainThread]: Flushing usage events
[0m16:13:18.860287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:43.722232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F2017C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F201B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F202300>]}


============================== 16:13:43.728229 | 5881dd19-d1ca-496b-9d36-919d48e39609 ==============================
[0m16:13:43.728229 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:13:43.729229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:44.021061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237EBCF140>]}
[0m16:13:44.117007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237E8BBF80>]}
[0m16:13:44.118326 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:44.383180 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:13:44.629039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:13:44.630038 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:13:44.631038 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\staging\stg_management_control.sql
[0m16:13:45.642476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237FC7B2F0>]}
[0m16:13:45.771383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:13:45.776381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:13:45.810361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237FDBB4A0>]}
[0m16:13:45.811361 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:13:45.812360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F9AE2D0>]}
[0m16:13:45.814361 [info ] [MainThread]: 
[0m16:13:45.815360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:45.816359 [info ] [MainThread]: 
[0m16:13:45.818068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:45.819070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:13:45.984990 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:13:45.985989 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:13:45.986989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:46.147013 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.160 seconds
[0m16:13:46.149011 [debug] [ThreadPool]: On list_gestion: Close
[0m16:13:46.157023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:13:46.162626 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:13:46.163625 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:13:46.164625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:46.209448 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:13:46.210448 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:13:46.210448 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:13:46.219546 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:13:46.221531 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:13:46.222530 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:13:46.223528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m16:13:46.226528 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:13:46.227527 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:13:46.227527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:46.275029 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:13:46.275029 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:13:46.276030 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:13:46.284543 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:13:46.286553 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:13:46.287557 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:13:46.288537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:13:46.291537 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:13:46.292535 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:13:46.292535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:46.338859 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:13:46.339858 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:13:46.339858 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:13:46.349084 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:13:46.351083 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:13:46.352085 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:13:46.354084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:13:46.357094 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:13:46.358081 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:13:46.358081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:46.407969 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:13:46.408955 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:13:46.409953 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:13:46.418716 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:13:46.420733 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:13:46.421714 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:13:46.422714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:13:46.425714 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:13:46.426713 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:13:46.427713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:46.472701 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:13:46.473685 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:13:46.474684 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:13:46.482684 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:13:46.484697 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:13:46.484697 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:13:46.490693 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:46.491693 [debug] [MainThread]: On master: BEGIN
[0m16:13:46.491693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:46.541649 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m16:13:46.541649 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:46.542647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:46.552639 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:13:46.554652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237FB2D100>]}
[0m16:13:46.555647 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:46.556637 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:46.556637 [debug] [MainThread]: On master: BEGIN
[0m16:13:46.557655 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:13:46.557655 [debug] [MainThread]: On master: COMMIT
[0m16:13:46.558638 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:46.558638 [debug] [MainThread]: On master: COMMIT
[0m16:13:46.559636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:46.559636 [debug] [MainThread]: On master: Close
[0m16:13:46.562652 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:13:46.563634 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:13:46.564650 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:13:46.565633 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:13:46.576627 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:13:46.653582 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.654581 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:13:46.654581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:13:46.805649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m16:13:46.806647 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.806647 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:13:46.826461 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m16:13:46.878450 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.879431 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp161346870455"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamptz, updated_at::timestamptz), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamptz as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            updated_at::timestamptz as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:13:46.889194 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m16:13:46.893188 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.893188 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161346870455'
        
      order by ordinal_position

  
[0m16:13:46.898184 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:13:46.902182 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.903202 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:13:46.907179 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:13:46.911196 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.912176 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161346870455'
        
      order by ordinal_position

  
[0m16:13:46.916176 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m16:13:46.920190 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.921173 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:13:46.925168 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:13:46.933198 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.933198 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161346870455'
        
      order by ordinal_position

  
[0m16:13:46.938163 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m16:13:46.962149 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.963148 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamptz, updated_at::timestamptz), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamptz as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            updated_at::timestamptz as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:13:46.964148 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:13:46.971144 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.971144 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:13:46.972144 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:13:46.973155 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m16:13:46.974165 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.975140 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.976139 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp161346870455" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp161346870455" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:13:46.978142 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:13:46.997130 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:13:46.998127 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:13:46.999127 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:13:47.003718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:13:47.008718 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:13:47.012716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5881dd19-d1ca-496b-9d36-919d48e39609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237C65C2C0>]}
[0m16:13:47.013718 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 0[0m in 0.45s]
[0m16:13:47.015715 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:13:47.017731 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:47.017731 [debug] [MainThread]: On master: BEGIN
[0m16:13:47.018715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:47.068684 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m16:13:47.069683 [debug] [MainThread]: On master: COMMIT
[0m16:13:47.070683 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:47.071681 [debug] [MainThread]: On master: COMMIT
[0m16:13:47.072681 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:47.073681 [debug] [MainThread]: On master: Close
[0m16:13:47.074680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:47.075680 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:13:47.075680 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m16:13:47.076680 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:13:47.077679 [info ] [MainThread]: 
[0m16:13:47.078678 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m16:13:47.080677 [debug] [MainThread]: Command end result
[0m16:13:47.136655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:13:47.139643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:13:47.146639 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:13:47.148640 [info ] [MainThread]: 
[0m16:13:47.152637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:47.154635 [info ] [MainThread]: 
[0m16:13:47.155635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:47.157633 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:13:47.157633 after 3.58 seconds
[0m16:13:47.158631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F202030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F202300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237F2021B0>]}
[0m16:13:47.159631 [debug] [MainThread]: Flushing usage events
[0m16:13:47.699836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:56.707157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57CE88590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57CE8A840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57CE88650>]}


============================== 16:13:56.713153 | bc9f1352-5fe9-4e44-ac18-f658cd42770d ==============================
[0m16:13:56.713153 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:13:56.714154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:13:57.007375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57D100800>]}
[0m16:13:57.105320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57A45A570>]}
[0m16:13:57.107289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:57.385135 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:13:57.628858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:57.629857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:57.714810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57D2834D0>]}
[0m16:13:57.860727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:13:57.865726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:13:57.902838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57E6C7C80>]}
[0m16:13:57.903838 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:13:57.904837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57E4552E0>]}
[0m16:13:57.906854 [info ] [MainThread]: 
[0m16:13:57.907854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:57.908837 [info ] [MainThread]: 
[0m16:13:57.910835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:57.916848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:13:58.010769 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:13:58.011768 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:13:58.012768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:58.070916 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.059 seconds
[0m16:13:58.073933 [debug] [ThreadPool]: On list_gestion: Close
[0m16:13:58.075932 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:13:58.076931 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:13:58.077931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.124887 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.047 seconds
[0m16:13:58.126903 [debug] [ThreadPool]: On list_gestion: Close
[0m16:13:58.129884 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:13:58.130901 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:13:58.131882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.180869 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.049 seconds
[0m16:13:58.182853 [debug] [ThreadPool]: On list_gestion: Close
[0m16:13:58.184853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m16:13:58.192848 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:13:58.192848 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:13:58.193848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:58.239836 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:13:58.240819 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:13:58.240819 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:13:58.248814 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:13:58.250813 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:13:58.251813 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:13:58.251813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:13:58.254811 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:13:58.255811 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:13:58.255811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.401387 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m16:13:58.401387 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:13:58.402404 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:13:58.411028 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:13:58.413030 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:13:58.414028 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:13:58.415025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m16:13:58.418026 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:13:58.418026 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:13:58.419025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.465557 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:13:58.466572 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:13:58.466572 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:13:58.475346 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:13:58.477364 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:13:58.478344 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:13:58.479344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m16:13:58.481344 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:13:58.482344 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:13:58.483343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.529160 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:13:58.530162 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:13:58.530162 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:13:58.539651 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:13:58.542653 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:13:58.543650 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:13:58.544649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m16:13:58.547662 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:13:58.548648 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:13:58.548648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:58.698749 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m16:13:58.698749 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:13:58.699764 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:13:58.708676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:13:58.710694 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:13:58.711905 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:13:58.717909 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:58.717909 [debug] [MainThread]: On master: BEGIN
[0m16:13:58.718908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:58.765983 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:13:58.766984 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:58.766984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:58.776979 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:13:58.778990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57EC42FF0>]}
[0m16:13:58.779976 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:58.779976 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:58.780992 [debug] [MainThread]: On master: BEGIN
[0m16:13:58.781975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:13:58.781975 [debug] [MainThread]: On master: COMMIT
[0m16:13:58.782991 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:58.782991 [debug] [MainThread]: On master: COMMIT
[0m16:13:58.783991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:58.783991 [debug] [MainThread]: On master: Close
[0m16:13:58.785972 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:13:58.786989 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:13:58.787988 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:13:58.788972 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:13:58.798965 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:13:58.799963 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:13:58.870848 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:13:58.872832 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.872832 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:13:58.873847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:13:58.919010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:13:58.920010 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.920010 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamptz AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:13:58.931811 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m16:13:58.939807 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.940807 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:13:58.941805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:13:58.946803 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.946803 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:13:58.948800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:58.971806 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:13:58.972805 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.973804 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:13:58.976985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:13:58.984003 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:13:58.989000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:13:58.989999 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:13:58.993981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:13:58.996995 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:13:58.999975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57A3C88F0>]}
[0m16:13:59.000989 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.21s]
[0m16:13:59.002974 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:13:59.003990 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:13:59.003990 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:13:59.004990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:13:59.005990 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:13:59.010971 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:13:59.012793 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:13:59.018794 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:13:59.019791 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.020789 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:13:59.021788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:59.073760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:13:59.074757 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.075756 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:13:59.085750 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m16:13:59.089749 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.090747 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:13:59.091747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:13:59.095745 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.096744 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:13:59.097744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:13:59.099743 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:13:59.100743 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.101741 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:13:59.103740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:13:59.107738 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:13:59.108737 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:13:59.109736 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:13:59.113759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:13:59.116758 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:13:59.117757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57EC416D0>]}
[0m16:13:59.119756 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.11s]
[0m16:13:59.121756 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:13:59.122755 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:13:59.123757 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:13:59.125753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:13:59.125753 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:13:59.132749 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:13:59.133749 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:13:59.141745 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:13:59.143744 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.145742 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:13:59.146741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:59.201710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m16:13:59.202709 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.203709 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:13:59.214705 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m16:13:59.220700 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.221699 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:13:59.222700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:13:59.227696 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.228696 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:13:59.230694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:59.233693 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:13:59.234691 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.234691 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:13:59.236690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:13:59.239688 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:13:59.240688 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:13:59.240688 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:13:59.246685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:13:59.248684 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:13:59.249683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57EC2B080>]}
[0m16:13:59.250683 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.12s]
[0m16:13:59.252681 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:13:59.253682 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:13:59.254681 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:13:59.255681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:13:59.255681 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:13:59.260677 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:13:59.262676 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:13:59.269672 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:13:59.271671 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.272670 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:13:59.272670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:59.325640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:13:59.326639 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.326639 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:13:59.336633 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m16:13:59.342629 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.343629 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:13:59.344629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:59.348626 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.348626 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:13:59.349627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:13:59.352625 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:13:59.353623 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.354623 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:13:59.357620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:13:59.360619 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:13:59.361619 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:13:59.362618 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:13:59.366617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:13:59.368616 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:13:59.369614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9f1352-5fe9-4e44-ac18-f658cd42770d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57ECBB8F0>]}
[0m16:13:59.370614 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 0[0m in 0.11s]
[0m16:13:59.372614 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:13:59.373613 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:59.374612 [debug] [MainThread]: On master: BEGIN
[0m16:13:59.374612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:59.430486 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m16:13:59.432484 [debug] [MainThread]: On master: COMMIT
[0m16:13:59.432484 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:59.433483 [debug] [MainThread]: On master: COMMIT
[0m16:13:59.434482 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:59.435482 [debug] [MainThread]: On master: Close
[0m16:13:59.436481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:59.436481 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:13:59.437481 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:13:59.437481 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:13:59.438480 [info ] [MainThread]: 
[0m16:13:59.439480 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m16:13:59.441480 [debug] [MainThread]: Command end result
[0m16:13:59.475458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:13:59.480457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:13:59.489452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:13:59.490451 [info ] [MainThread]: 
[0m16:13:59.491450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:59.492449 [info ] [MainThread]: 
[0m16:13:59.493450 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:13:59.495448 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:59.495448 after 2.96 seconds
[0m16:13:59.496447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57CD20E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57C485610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D57E6A8470>]}
[0m16:13:59.497447 [debug] [MainThread]: Flushing usage events
[0m16:14:00.014640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:05.914705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D81B1B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D81D7F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D81F01040>]}


============================== 16:14:05.919702 | 906b1c86-0e9f-4200-be7a-7bd67ca30942 ==============================
[0m16:14:05.919702 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:14:05.921704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:06.274912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D8166FF50>]}
[0m16:14:06.385850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D8228D550>]}
[0m16:14:06.387824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:06.686656 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:14:06.951504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:06.951504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:07.052449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D8234B260>]}
[0m16:14:07.220350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:14:07.226348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:14:07.266327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DFFD49070>]}
[0m16:14:07.267324 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:14:07.268324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D837A72C0>]}
[0m16:14:07.271324 [info ] [MainThread]: 
[0m16:14:07.272324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:07.274320 [info ] [MainThread]: 
[0m16:14:07.275338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:07.284316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:14:07.399248 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:14:07.400247 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:14:07.400247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:07.453591 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.054 seconds
[0m16:14:07.456587 [debug] [ThreadPool]: On list_gestion: Close
[0m16:14:07.465583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:14:07.473579 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:14:07.474579 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:14:07.474579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:07.530545 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m16:14:07.532547 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:14:07.533544 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:14:07.542539 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:14:07.544537 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:14:07.546538 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:14:07.547536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m16:14:07.552534 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:14:07.553533 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:14:07.554533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.604506 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:14:07.605504 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:14:07.606502 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:14:07.614498 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:14:07.617497 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:14:07.617497 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:14:07.618497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m16:14:07.622494 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:14:07.622494 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:14:07.623494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.674466 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:14:07.675462 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:14:07.676462 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:14:07.684459 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:14:07.686457 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:14:07.687457 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:14:07.688455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m16:14:07.692453 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:14:07.694453 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:14:07.695451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.742426 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:14:07.743425 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:14:07.745422 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:14:07.757415 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:14:07.760413 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:14:07.761414 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:14:07.763412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m16:14:07.768410 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:14:07.770409 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:14:07.771408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.941310 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m16:14:07.942310 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:14:07.944309 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:14:07.951306 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:14:07.954303 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:14:07.954303 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:14:07.963297 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:07.964298 [debug] [MainThread]: On master: BEGIN
[0m16:14:07.964298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:08.138198 [debug] [MainThread]: SQL status: BEGIN in 0.173 seconds
[0m16:14:08.139198 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:08.140197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:08.156188 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m16:14:08.159185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D83D41AC0>]}
[0m16:14:08.160186 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:08.162184 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:08.163185 [debug] [MainThread]: On master: BEGIN
[0m16:14:08.165184 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:14:08.166182 [debug] [MainThread]: On master: COMMIT
[0m16:14:08.167182 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:08.168180 [debug] [MainThread]: On master: COMMIT
[0m16:14:08.169180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:08.170179 [debug] [MainThread]: On master: Close
[0m16:14:08.173179 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:14:08.174176 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:14:08.178174 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:14:08.179173 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:14:08.197168 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:14:08.282115 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.283115 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:14:08.283115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:08.432154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m16:14:08.433155 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.433155 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:14:08.453468 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m16:14:08.508455 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.509455 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp161408499460"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamptz, updated_at::timestamptz), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamptz as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            updated_at::timestamptz as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:14:08.518432 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.008 seconds
[0m16:14:08.521429 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.522429 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161408499460'
        
      order by ordinal_position

  
[0m16:14:08.527426 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:14:08.530424 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.531423 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:14:08.535440 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m16:14:08.539437 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.540437 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161408499460'
        
      order by ordinal_position

  
[0m16:14:08.545434 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m16:14:08.548433 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.549431 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:14:08.554429 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m16:14:08.562406 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.562406 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp161408499460'
        
      order by ordinal_position

  
[0m16:14:08.567421 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m16:14:08.589392 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.590391 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamptz AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamptz, updated_at::timestamptz), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamptz as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamptz as dbt_updated_at,
            updated_at::timestamptz as dbt_valid_from,
            updated_at::timestamptz as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamptz)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:14:08.592389 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:14:08.598385 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.599385 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:14:08.600385 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:14:08.601384 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATETIMETZ). Please update snapshot config 'updated_at'.
[0m16:14:08.603385 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.605381 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.606381 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp161408499460" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp161408499460" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:14:08.610379 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m16:14:08.636363 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:14:08.637363 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:14:08.638363 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:14:08.641361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:14:08.647360 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:14:08.651356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '906b1c86-0e9f-4200-be7a-7bd67ca30942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DFF478290>]}
[0m16:14:08.653355 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.47s]
[0m16:14:08.655353 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:14:08.659352 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:08.660350 [debug] [MainThread]: On master: BEGIN
[0m16:14:08.661350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:08.718318 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m16:14:08.718318 [debug] [MainThread]: On master: COMMIT
[0m16:14:08.719317 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:08.720318 [debug] [MainThread]: On master: COMMIT
[0m16:14:08.720318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:08.721315 [debug] [MainThread]: On master: Close
[0m16:14:08.721315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:08.722315 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:14:08.723315 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m16:14:08.723315 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:14:08.724313 [info ] [MainThread]: 
[0m16:14:08.725312 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m16:14:08.727313 [debug] [MainThread]: Command end result
[0m16:14:08.762294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:14:08.765291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:14:08.771286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:14:08.772287 [info ] [MainThread]: 
[0m16:14:08.773286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:08.774287 [info ] [MainThread]: 
[0m16:14:08.776285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:14:08.778283 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:14:08.778283 after 3.03 seconds
[0m16:14:08.779283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D81B1B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D818448F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D8240F500>]}
[0m16:14:08.779283 [debug] [MainThread]: Flushing usage events
[0m16:14:09.318469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:47.842090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417F0A0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014104B29400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141048C0200>]}


============================== 16:19:47.848091 | 51c617c5-803d-4d2a-af53-5055987fb859 ==============================
[0m16:19:47.848091 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:19:47.850088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:19:48.161406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141044CC860>]}
[0m16:19:48.265387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001410454F440>]}
[0m16:19:48.267367 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:19:48.570209 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:19:48.839054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:19:48.840054 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:19:48.840054 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\staging\stg_management_control.sql
[0m16:19:49.975949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014106B1AEA0>]}
[0m16:19:50.157848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:19:50.165954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:19:50.210928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014106BDA000>]}
[0m16:19:50.211928 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:19:50.214926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141068D7560>]}
[0m16:19:50.218924 [info ] [MainThread]: 
[0m16:19:50.220923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:50.222925 [info ] [MainThread]: 
[0m16:19:50.223922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:50.225919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:19:50.437625 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:19:50.438628 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:19:50.438628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:50.496579 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.057 seconds
[0m16:19:50.499577 [debug] [ThreadPool]: On list_gestion: Close
[0m16:19:50.505572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:19:50.515567 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:19:50.516566 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:19:50.517566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:50.668860 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m16:19:50.669862 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:19:50.669862 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:19:50.679740 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:19:50.681738 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:19:50.682739 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:19:50.683755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m16:19:50.687733 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:19:50.687733 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:19:50.688733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:50.736705 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:19:50.736705 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:19:50.737705 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:19:50.745701 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:19:50.749703 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:19:50.750699 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:19:50.751696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m16:19:50.755693 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:19:50.755693 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:19:50.756693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:50.966700 [debug] [ThreadPool]: SQL status: BEGIN in 0.210 seconds
[0m16:19:50.969704 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:19:50.970698 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:19:50.991686 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m16:19:50.994685 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:19:50.996684 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:19:50.998683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:19:51.003679 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:19:51.005678 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:19:51.006677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:51.089988 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m16:19:51.090987 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:19:51.090987 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:19:51.102056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:19:51.106053 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:19:51.106053 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:19:51.107053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:19:51.111049 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:19:51.112049 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:19:51.114054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:51.188008 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m16:19:51.189006 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:19:51.189006 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:19:51.198071 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:19:51.200068 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:19:51.200068 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:19:51.206064 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.207064 [debug] [MainThread]: On master: BEGIN
[0m16:19:51.208064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:51.405395 [debug] [MainThread]: SQL status: BEGIN in 0.198 seconds
[0m16:19:51.406393 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.406393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:51.421389 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m16:19:51.424381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141068D7560>]}
[0m16:19:51.425382 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:51.426381 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.426381 [debug] [MainThread]: On master: BEGIN
[0m16:19:51.427381 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:19:51.428381 [debug] [MainThread]: On master: COMMIT
[0m16:19:51.429380 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.430383 [debug] [MainThread]: On master: COMMIT
[0m16:19:51.432384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:19:51.434379 [debug] [MainThread]: On master: Close
[0m16:19:51.440373 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:19:51.441373 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:19:51.442373 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:19:51.442373 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:19:51.457364 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:19:51.543314 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:19:51.544313 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:19:51.548314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:51.604281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m16:19:51.605280 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:19:51.606278 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:19:51.628266 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.021 seconds
[0m16:19:51.696228 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:19:51.697227 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp161951686233"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestampt AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestampt as dbt_updated_at,
            updated_at::timestampt as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestampt, updated_at::timestampt), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestampt as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestampt as dbt_updated_at,
            updated_at::timestampt as dbt_valid_from,
            updated_at::timestampt as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestampt))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestampt)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:19:51.699225 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  le type « timestampt » n'existe pas
LINE 27:         updated_at::timestampt AS updated_at  
                             ^

[0m16:19:51.700224 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: ROLLBACK
[0m16:19:51.700224 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:19:51.707221 [debug] [Thread-1 (]: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^
[0m16:19:51.710220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c617c5-803d-4d2a-af53-5055987fb859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014106486630>]}
[0m16:19:51.711220 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.management_control_snapshot ................ [[31mERROR[0m in 0.27s]
[0m16:19:51.713219 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:19:51.715216 [debug] [Thread-4 (]: Marking all children of 'snapshot.management_control_project.management_control_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^.
[0m16:19:51.717215 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.718218 [debug] [MainThread]: On master: BEGIN
[0m16:19:51.719215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:51.773184 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m16:19:51.775182 [debug] [MainThread]: On master: COMMIT
[0m16:19:51.775182 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:51.776181 [debug] [MainThread]: On master: COMMIT
[0m16:19:51.777181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:19:51.778180 [debug] [MainThread]: On master: Close
[0m16:19:51.779180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:51.781178 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:19:51.782180 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m16:19:51.783178 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:19:51.784178 [info ] [MainThread]: 
[0m16:19:51.786176 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m16:19:51.788176 [debug] [MainThread]: Command end result
[0m16:19:51.824429 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:19:51.827428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:19:51.842420 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:19:51.843420 [info ] [MainThread]: 
[0m16:19:51.849417 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:19:51.851417 [info ] [MainThread]: 
[0m16:19:51.853414 [error] [MainThread]:   Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^
[0m16:19:51.855418 [info ] [MainThread]: 
[0m16:19:51.857412 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:19:51.860410 [debug] [MainThread]: Command `dbt snapshot` failed at 16:19:51.860410 after 4.22 seconds
[0m16:19:51.864409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014104DEAEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141069BC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014104F920C0>]}
[0m16:19:51.867406 [debug] [MainThread]: Flushing usage events
[0m16:19:52.452474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:38.619123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3D2A4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FB59FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FB59F70>]}


============================== 16:20:38.625119 | f77a1e11-36ad-44c6-93ed-3a045a79a159 ==============================
[0m16:20:38.625119 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:20:38.626119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:38.977935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3F4D5760>]}
[0m16:20:39.090853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4013DA30>]}
[0m16:20:39.092159 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:39.397007 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:20:39.591877 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:20:39.592878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4150FC50>]}
[0m16:20:42.442245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4197CE30>]}
[0m16:20:42.594160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:20:42.601155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:20:42.644578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D41ACCBF0>]}
[0m16:20:42.645578 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m16:20:42.646094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D41AD8380>]}
[0m16:20:42.650098 [info ] [MainThread]: 
[0m16:20:42.651096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:42.653094 [info ] [MainThread]: 
[0m16:20:42.655111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:42.659218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:20:42.758368 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:20:42.758368 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:20:42.759368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:42.921546 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.162 seconds
[0m16:20:42.923531 [debug] [ThreadPool]: On list_gestion: Close
[0m16:20:42.927529 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:20:42.928528 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:20:42.929530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:42.983497 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.054 seconds
[0m16:20:42.985497 [debug] [ThreadPool]: On list_gestion: Close
[0m16:20:42.989493 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:20:42.990493 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:20:42.990493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.138619 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.148 seconds
[0m16:20:43.140633 [debug] [ThreadPool]: On list_gestion: Close
[0m16:20:43.143273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:20:43.152270 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:20:43.153270 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:20:43.154269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:43.204414 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:20:43.205427 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:20:43.206410 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:20:43.214405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:43.216422 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:20:43.216422 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:20:43.217421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:20:43.221402 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:20:43.221402 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:20:43.222402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.374337 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m16:20:43.374337 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:20:43.375338 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:20:43.387480 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:20:43.390478 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:20:43.391477 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:20:43.392476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m16:20:43.395474 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:20:43.396474 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:20:43.396474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.444451 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:20:43.444451 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:20:43.445464 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:20:43.456455 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:20:43.458440 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:20:43.458440 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:20:43.459438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m16:20:43.463437 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:20:43.464435 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:20:43.464435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.515408 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:20:43.516408 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:20:43.518405 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:20:43.527414 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:20:43.529399 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:20:43.529399 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:20:43.531397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:20:43.534397 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:20:43.535396 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:20:43.535396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.588364 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m16:20:43.589364 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:20:43.590363 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:20:43.598359 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:43.600357 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:20:43.601357 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:20:43.609351 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.609351 [debug] [MainThread]: On master: BEGIN
[0m16:20:43.610351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:43.660324 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m16:20:43.660324 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.661323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:43.672317 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:20:43.674315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D417127B0>]}
[0m16:20:43.675314 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:43.676314 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.676314 [debug] [MainThread]: On master: BEGIN
[0m16:20:43.677314 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:20:43.677314 [debug] [MainThread]: On master: COMMIT
[0m16:20:43.678313 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:43.678313 [debug] [MainThread]: On master: COMMIT
[0m16:20:43.679312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:43.679312 [debug] [MainThread]: On master: Close
[0m16:20:43.683311 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:20:43.684312 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:20:43.685309 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:20:43.686309 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:20:43.696303 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:20:43.698301 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:20:43.775256 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:20:43.776256 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.777256 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:20:43.778256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:43.825229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:20:43.826229 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.827229 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:20:43.839221 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m16:20:43.846216 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.847216 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:20:43.849217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:43.855227 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.856226 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:20:43.857210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:43.893191 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:20:43.893191 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.894191 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:20:43.898251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:20:43.907245 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:20:43.913241 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:20:43.915246 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:20:43.919780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:20:43.923762 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:20:43.926760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3F499100>]}
[0m16:20:43.927759 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.24s]
[0m16:20:43.928759 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:20:43.929778 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:20:43.931760 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:20:43.933758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:20:43.934757 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:20:43.944768 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:20:43.945768 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:20:43.953765 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:20:43.955748 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:43.956764 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:20:43.956764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:44.113814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m16:20:44.115819 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:44.116836 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:20:44.126943 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m16:20:44.131941 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:44.132946 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:20:44.134940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:44.137956 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:44.138954 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:20:44.139954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:44.142953 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:20:44.142953 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:44.143952 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:20:44.147246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:20:44.151248 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:20:44.152233 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:20:44.153236 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:20:44.157175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:20:44.159195 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:20:44.160195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D421DE990>]}
[0m16:20:44.161176 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.23s]
[0m16:20:44.162175 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:20:44.164174 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:20:44.165176 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:20:44.167174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:20:44.168172 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:20:44.174190 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:20:44.176168 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:20:44.185164 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:20:44.187161 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.189161 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:20:44.189161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:44.244130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m16:20:44.244130 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.245128 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:20:44.258121 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m16:20:44.262118 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.263119 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:20:44.266117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:44.270114 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.271113 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:20:44.272112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:44.276112 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:20:44.277111 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.278112 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:20:44.283108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:20:44.287107 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:20:44.289104 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:20:44.290103 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:20:44.294103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:20:44.296100 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:20:44.298099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D422676B0>]}
[0m16:20:44.300097 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.13s]
[0m16:20:44.302097 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:20:44.303095 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:20:44.304095 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:20:44.305094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:20:44.306095 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:20:44.309092 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:20:44.311091 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:20:44.320085 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:20:44.322085 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.323083 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:20:44.323083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:44.472818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m16:20:44.473833 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.473833 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:20:44.484963 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m16:20:44.489962 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.489962 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:20:44.491978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:44.494971 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.495956 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:20:44.496956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:44.500955 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:20:44.501956 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.502952 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:20:44.506107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:20:44.509122 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:20:44.510126 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:20:44.510126 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:20:44.514722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:20:44.516720 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:20:44.517719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77a1e11-36ad-44c6-93ed-3a045a79a159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D41B84710>]}
[0m16:20:44.518718 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.21s]
[0m16:20:44.520715 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:20:44.522714 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:44.522714 [debug] [MainThread]: On master: BEGIN
[0m16:20:44.523713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:44.583681 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m16:20:44.584678 [debug] [MainThread]: On master: COMMIT
[0m16:20:44.585677 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:44.585677 [debug] [MainThread]: On master: COMMIT
[0m16:20:44.586678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:44.587678 [debug] [MainThread]: On master: Close
[0m16:20:44.588676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:44.588676 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:20:44.589675 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:20:44.589675 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:20:44.590675 [info ] [MainThread]: 
[0m16:20:44.591674 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m16:20:44.593673 [debug] [MainThread]: Command end result
[0m16:20:44.725598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:20:44.728597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:20:44.738607 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:20:44.739608 [info ] [MainThread]: 
[0m16:20:44.740590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:44.741588 [info ] [MainThread]: 
[0m16:20:44.742589 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:20:44.744601 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:44.743587 after 6.30 seconds
[0m16:20:44.744601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FBD4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D42254EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D422575F0>]}
[0m16:20:44.745590 [debug] [MainThread]: Flushing usage events
[0m16:20:45.283792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:50.634395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F389CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5EF28620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5EF28200>]}


============================== 16:20:50.639389 | 7782d1da-1594-45a3-a5f7-d24ad75f092c ==============================
[0m16:20:50.639389 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:20:50.640389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:50.955208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5EF28620>]}
[0m16:20:51.082138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5FAA9D60>]}
[0m16:20:51.083136 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:51.406951 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:20:51.682797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:51.683792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:51.776738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F7F31A0>]}
[0m16:20:51.938647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:20:51.943644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:20:51.989690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60F97D10>]}
[0m16:20:51.990690 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 data tests, 1 seed, 1 source, 432 macros
[0m16:20:51.991691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F6E29C0>]}
[0m16:20:51.994706 [info ] [MainThread]: 
[0m16:20:51.995689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:51.997688 [info ] [MainThread]: 
[0m16:20:51.999686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:52.001688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:20:52.104168 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:20:52.105168 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:20:52.106167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:52.168117 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.062 seconds
[0m16:20:52.170114 [debug] [ThreadPool]: On list_gestion: Close
[0m16:20:52.176137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:20:52.186153 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:20:52.186153 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:20:52.187139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:52.239106 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m16:20:52.240104 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:20:52.240104 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:20:52.250604 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:20:52.252607 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:20:52.253606 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:20:52.254605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m16:20:52.256605 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:20:52.257603 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:20:52.257603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:52.306576 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:20:52.307575 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:20:52.307575 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:20:52.316571 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:20:52.318569 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:20:52.319568 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:20:52.320568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:20:52.323566 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:20:52.323566 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:20:52.324565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:52.374518 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m16:20:52.374518 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:20:52.375517 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:20:52.384511 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:20:52.386511 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:20:52.386511 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:20:52.387510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:20:52.390506 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:20:52.391506 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:20:52.391506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:52.441479 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m16:20:52.441479 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:20:52.442478 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:20:52.451472 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:20:52.453471 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:20:52.453471 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:20:52.454470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m16:20:52.457468 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:20:52.458468 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:20:52.458468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:52.607476 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m16:20:52.607476 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:20:52.608477 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:20:52.617489 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:20:52.619470 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:20:52.620470 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:20:52.626483 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.626483 [debug] [MainThread]: On master: BEGIN
[0m16:20:52.627482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:52.780751 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m16:20:52.781750 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.782750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:52.793415 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:20:52.795418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60BD6060>]}
[0m16:20:52.797414 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:52.798416 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.798416 [debug] [MainThread]: On master: BEGIN
[0m16:20:52.799426 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:20:52.800432 [debug] [MainThread]: On master: COMMIT
[0m16:20:52.800432 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.801432 [debug] [MainThread]: On master: COMMIT
[0m16:20:52.802429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:52.803410 [debug] [MainThread]: On master: Close
[0m16:20:52.805409 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:20:52.806408 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:20:52.807408 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:20:52.808407 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:20:52.822403 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:20:52.894376 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:20:52.895362 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:20:52.896358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:52.947332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:20:52.948327 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:20:52.949326 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:20:52.968807 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m16:20:53.034769 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:20:53.035787 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp162053024774"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestampt AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:20:53.036786 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  le type « timestampt » n'existe pas
LINE 27:         updated_at::timestampt AS updated_at  
                             ^

[0m16:20:53.037785 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: ROLLBACK
[0m16:20:53.038767 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:20:53.044781 [debug] [Thread-1 (]: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^
[0m16:20:53.049767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7782d1da-1594-45a3-a5f7-d24ad75f092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5ECC8C20>]}
[0m16:20:53.051760 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.management_control_snapshot ................ [[31mERROR[0m in 0.24s]
[0m16:20:53.054776 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:20:53.056774 [debug] [Thread-4 (]: Marking all children of 'snapshot.management_control_project.management_control_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^.
[0m16:20:53.059200 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:53.060204 [debug] [MainThread]: On master: BEGIN
[0m16:20:53.060204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:53.215517 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m16:20:53.216516 [debug] [MainThread]: On master: COMMIT
[0m16:20:53.216516 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:53.217515 [debug] [MainThread]: On master: COMMIT
[0m16:20:53.218514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:53.218514 [debug] [MainThread]: On master: Close
[0m16:20:53.219514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:53.220513 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:20:53.220513 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:20:53.221514 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:20:53.222512 [info ] [MainThread]: 
[0m16:20:53.223514 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m16:20:53.225066 [debug] [MainThread]: Command end result
[0m16:20:53.258032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:20:53.260039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:20:53.272024 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:20:53.273026 [info ] [MainThread]: 
[0m16:20:53.274023 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:20:53.275022 [info ] [MainThread]: 
[0m16:20:53.277021 [error] [MainThread]:   Database Error in snapshot management_control_snapshot (snapshots\management_control_snapshot.sql)
  ERREUR:  le type « timestampt » n'existe pas
  LINE 27:         updated_at::timestampt AS updated_at  
                               ^
[0m16:20:53.279434 [info ] [MainThread]: 
[0m16:20:53.283433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:20:53.285447 [debug] [MainThread]: Command `dbt snapshot` failed at 16:20:53.285447 after 2.81 seconds
[0m16:20:53.286430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F5E1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F815250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5FBCF0E0>]}
[0m16:20:53.286430 [debug] [MainThread]: Flushing usage events
[0m16:20:53.865892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:41.007676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29E229E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29E229D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29E229130>]}


============================== 16:21:41.013673 | b8ff5303-858c-45b7-a14f-7e0cd29df9e1 ==============================
[0m16:21:41.013673 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:21:41.015674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:21:41.445426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29E7063C0>]}
[0m16:21:41.602337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29DBEFDD0>]}
[0m16:21:41.606334 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:21:41.934147 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:21:42.208989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:42.209988 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\management_control_snapshot.sql
[0m16:21:42.759693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29BB71EE0>]}
[0m16:21:42.945568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:21:42.952564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:21:42.989544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29FEE4FE0>]}
[0m16:21:42.990543 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:21:42.991543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29FD58D40>]}
[0m16:21:42.993541 [info ] [MainThread]: 
[0m16:21:42.994540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:42.995542 [info ] [MainThread]: 
[0m16:21:42.997539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:43.006533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:21:43.125376 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:21:43.125376 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:21:43.126376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:43.188852 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.063 seconds
[0m16:21:43.190849 [debug] [ThreadPool]: On list_gestion: Close
[0m16:21:43.193848 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:21:43.194847 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:21:43.194847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.248820 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.053 seconds
[0m16:21:43.250815 [debug] [ThreadPool]: On list_gestion: Close
[0m16:21:43.253815 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:21:43.254814 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:21:43.254814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.311781 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.056 seconds
[0m16:21:43.313779 [debug] [ThreadPool]: On list_gestion: Close
[0m16:21:43.317778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:21:43.325772 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:21:43.326772 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:21:43.327772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:43.378743 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:21:43.378743 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:21:43.379742 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:21:43.388736 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:21:43.390736 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:21:43.390736 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:21:43.391735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:21:43.395733 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:21:43.395733 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:21:43.396732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.448704 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m16:21:43.449703 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:21:43.450701 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:21:43.457698 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:21:43.459704 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:21:43.460694 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:21:43.461698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:21:43.466693 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:21:43.467692 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:21:43.468693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.518663 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:21:43.518663 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:21:43.519668 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:21:43.527657 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:21:43.529657 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:21:43.531657 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:21:43.533655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m16:21:43.536651 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:21:43.536651 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:21:43.537651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.593619 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m16:21:43.594621 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:21:43.594621 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:21:43.604613 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:21:43.606612 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:21:43.606612 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:21:43.607611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m16:21:43.611608 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:21:43.612608 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:21:43.612608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:43.671575 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m16:21:43.672574 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:21:43.673574 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:21:43.686565 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m16:21:43.688565 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:21:43.689565 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:21:43.695561 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:43.696560 [debug] [MainThread]: On master: BEGIN
[0m16:21:43.697562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:43.753528 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m16:21:43.754530 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:43.755528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:43.766521 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:21:43.769519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A0497200>]}
[0m16:21:43.770518 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:43.772517 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:43.773517 [debug] [MainThread]: On master: BEGIN
[0m16:21:43.774516 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:21:43.775516 [debug] [MainThread]: On master: COMMIT
[0m16:21:43.777515 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:43.777515 [debug] [MainThread]: On master: COMMIT
[0m16:21:43.778513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:43.779513 [debug] [MainThread]: On master: Close
[0m16:21:43.784511 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:21:43.785510 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:21:43.787510 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:21:43.788511 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:21:43.800500 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:21:43.803499 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:21:43.913253 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:21:43.916251 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:43.916251 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:21:43.917251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:43.965224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:21:43.966224 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:43.967225 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:21:43.977217 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m16:21:43.987212 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:43.987212 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:21:43.989209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:43.992207 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:43.993207 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:21:43.994206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.024189 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:21:44.025189 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:44.025189 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:21:44.027340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:44.036338 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:21:44.041353 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:21:44.042352 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:21:44.046601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:21:44.051599 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:21:44.055599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29DB68FB0>]}
[0m16:21:44.057596 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.27s]
[0m16:21:44.058595 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:21:44.059594 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:21:44.060596 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:21:44.061595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:21:44.062595 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:21:44.066594 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:21:44.068590 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:21:44.075606 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:21:44.078584 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.079583 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:21:44.079583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:44.136163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m16:21:44.137161 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.138160 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:21:44.146156 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.007 seconds
[0m16:21:44.152153 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.152153 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:21:44.154154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:44.159149 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.160148 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:21:44.161148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.165147 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:21:44.166148 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.167146 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:21:44.169546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:44.173509 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:21:44.174509 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:21:44.174509 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:21:44.178890 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:21:44.181890 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:21:44.182887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A08EE810>]}
[0m16:21:44.184886 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.12s]
[0m16:21:44.186886 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:21:44.187884 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:21:44.188883 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:21:44.189882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:21:44.189882 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:21:44.194879 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:21:44.196879 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:21:44.207873 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:21:44.209872 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.210874 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:21:44.211871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:44.263840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:21:44.264840 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.265839 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:21:44.275833 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m16:21:44.280830 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.282830 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:21:44.283829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.287826 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.288825 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:21:44.289825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.291823 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:21:44.292824 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.292824 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:21:44.295301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:44.299303 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:21:44.300302 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:21:44.301302 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:21:44.305796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:21:44.307794 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:21:44.308794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29BB72570>]}
[0m16:21:44.310792 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.12s]
[0m16:21:44.312792 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:21:44.313791 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:21:44.315790 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:21:44.317789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:21:44.319792 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:21:44.323785 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:21:44.325786 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:21:44.330781 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:21:44.333781 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.334781 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:21:44.335780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:44.408736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m16:21:44.409737 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.410735 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:21:44.422728 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m16:21:44.426727 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.427726 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:21:44.429724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.436721 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.438720 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:21:44.440719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:44.442718 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:21:44.443717 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.443717 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:21:44.445875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:44.452729 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:21:44.453729 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:21:44.454730 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:21:44.458593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:21:44.460592 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:21:44.461591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ff5303-858c-45b7-a14f-7e0cd29df9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A0940950>]}
[0m16:21:44.462591 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 0[0m in 0.14s]
[0m16:21:44.465590 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:21:44.469587 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:44.470586 [debug] [MainThread]: On master: BEGIN
[0m16:21:44.471589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:44.627119 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m16:21:44.628120 [debug] [MainThread]: On master: COMMIT
[0m16:21:44.628120 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:44.629119 [debug] [MainThread]: On master: COMMIT
[0m16:21:44.629119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:44.630116 [debug] [MainThread]: On master: Close
[0m16:21:44.631117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:44.632117 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:21:44.633117 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:21:44.634116 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:21:44.636114 [info ] [MainThread]: 
[0m16:21:44.636653 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m16:21:44.638658 [debug] [MainThread]: Command end result
[0m16:21:44.749594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:21:44.754590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:21:44.761585 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:21:44.761585 [info ] [MainThread]: 
[0m16:21:44.763585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:44.766583 [info ] [MainThread]: 
[0m16:21:44.769582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:21:44.774580 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:44.774580 after 3.95 seconds
[0m16:21:44.776581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29E480E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29DC220C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29FE3EF30>]}
[0m16:21:44.777576 [debug] [MainThread]: Flushing usage events
[0m16:21:45.345546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:06.831286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0DC0CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0D5F55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0DC79C40>]}


============================== 16:22:06.836283 | 96626077-554f-434d-9f46-bd379d0a2f3a ==============================
[0m16:22:06.836283 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:22:06.838282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:22:07.221062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0E159CD0>]}
[0m16:22:07.339013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0E299D60>]}
[0m16:22:07.342993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:22:07.669824 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:22:08.012611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:08.013615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:08.111554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F4262D0>]}
[0m16:22:08.338429 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:22:08.349423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:22:08.465357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F7E7BF0>]}
[0m16:22:08.467356 [info ] [MainThread]: Found 4 models, 12 data tests, 1 seed, 1 snapshot, 1 source, 432 macros
[0m16:22:08.468355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F425280>]}
[0m16:22:08.478350 [info ] [MainThread]: 
[0m16:22:08.480348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:08.482349 [info ] [MainThread]: 
[0m16:22:08.484346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:08.487345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:22:08.669239 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:22:08.670239 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:22:08.671238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:08.752194 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.081 seconds
[0m16:22:08.754192 [debug] [ThreadPool]: On list_gestion: Close
[0m16:22:08.764187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m16:22:08.820156 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:22:08.834146 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:22:08.837145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:09.026037 [debug] [ThreadPool]: SQL status: BEGIN in 0.189 seconds
[0m16:22:09.027037 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:22:09.028036 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:22:09.043030 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m16:22:09.047024 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:22:09.048024 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:22:09.050023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:22:09.056019 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:22:09.059018 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:22:09.060018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:09.179949 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m16:22:09.180951 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:22:09.181951 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:22:09.196938 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m16:22:09.199936 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:22:09.200936 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:22:09.201936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:22:09.208932 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:22:09.209932 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:22:09.210930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:09.300878 [debug] [ThreadPool]: SQL status: BEGIN in 0.090 seconds
[0m16:22:09.301879 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:22:09.302877 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:22:09.317869 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m16:22:09.320868 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:22:09.321867 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:22:09.323866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:22:09.328863 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:22:09.330862 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:22:09.331861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:09.454882 [debug] [ThreadPool]: SQL status: BEGIN in 0.123 seconds
[0m16:22:09.456881 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:22:09.457881 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:22:09.480870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m16:22:09.484866 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:22:09.485864 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:22:09.487863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m16:22:09.491861 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:22:09.492861 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:22:09.493861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:09.675262 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m16:22:09.676260 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:22:09.677260 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:22:09.689252 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:22:09.692251 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:22:09.693253 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:22:09.706243 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:09.709242 [debug] [MainThread]: On master: BEGIN
[0m16:22:09.710241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:09.803189 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m16:22:09.804187 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:09.805187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:09.820177 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m16:22:09.823175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0B5C24B0>]}
[0m16:22:09.825174 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:09.826175 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:09.828173 [debug] [MainThread]: On master: BEGIN
[0m16:22:09.829172 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:22:09.830172 [debug] [MainThread]: On master: COMMIT
[0m16:22:09.831172 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:09.832171 [debug] [MainThread]: On master: COMMIT
[0m16:22:09.834169 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:22:09.835169 [debug] [MainThread]: On master: Close
[0m16:22:09.838167 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:22:09.842166 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:22:09.844163 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:22:09.845163 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:22:09.865152 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:22:10.033055 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.047052 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:22:10.049046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:10.145992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m16:22:10.147990 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.148989 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:22:10.191965 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.042 seconds
[0m16:22:10.437823 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.444820 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp162210385854"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:22:10.464808 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.018 seconds
[0m16:22:10.470804 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.473807 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp162210385854'
        
      order by ordinal_position

  
[0m16:22:10.482799 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.007 seconds
[0m16:22:10.492796 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.494794 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:22:10.503786 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m16:22:10.516779 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.517778 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp162210385854'
        
      order by ordinal_position

  
[0m16:22:10.526774 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.008 seconds
[0m16:22:10.535768 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.536768 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:22:10.547763 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m16:22:10.570748 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.571747 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp162210385854'
        
      order by ordinal_position

  
[0m16:22:10.584740 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.008 seconds
[0m16:22:10.645706 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.647707 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:22:10.656699 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:22:10.672689 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.675688 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:22:10.677687 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:22:10.679685 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.683684 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.684683 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp162210385854" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp162210385854" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:22:10.690680 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.004 seconds
[0m16:22:10.738653 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:22:10.744648 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:22:10.746650 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:22:10.750643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:22:10.758641 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:22:10.764637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96626077-554f-434d-9f46-bd379d0a2f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0B538680>]}
[0m16:22:10.766636 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.92s]
[0m16:22:10.769634 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:22:10.775631 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:10.777630 [debug] [MainThread]: On master: BEGIN
[0m16:22:10.778629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:10.867578 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m16:22:10.868577 [debug] [MainThread]: On master: COMMIT
[0m16:22:10.870578 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:10.871575 [debug] [MainThread]: On master: COMMIT
[0m16:22:10.872575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:22:10.874576 [debug] [MainThread]: On master: Close
[0m16:22:10.876574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:10.877573 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:22:10.878572 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:22:10.879574 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:22:10.880574 [info ] [MainThread]: 
[0m16:22:10.882570 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m16:22:10.883569 [debug] [MainThread]: Command end result
[0m16:22:10.941536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:22:10.946533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:22:10.958528 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:22:10.959526 [info ] [MainThread]: 
[0m16:22:10.961525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:10.962525 [info ] [MainThread]: 
[0m16:22:10.963524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:22:10.966521 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:22:10.966521 after 4.41 seconds
[0m16:22:10.968521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0DFF8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FCA8DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0D8FCEF0>]}
[0m16:22:10.969520 [debug] [MainThread]: Flushing usage events
[0m16:22:11.516659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:25.599969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E449B0CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A3ECE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A3EE330>]}


============================== 16:32:25.617090 | 044f0da5-af79-43f2-9766-b4e154aaea89 ==============================
[0m16:32:25.617090 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:32:25.619089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:25.895691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '044f0da5-af79-43f2-9766-b4e154aaea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A277020>]}
[0m16:32:25.954222 [debug] [MainThread]: Command `dbt clean` succeeded at 16:32:25.953224 after 0.56 seconds
[0m16:32:25.955222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A6D6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A792960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A6626C0>]}
[0m16:32:25.956221 [debug] [MainThread]: Flushing usage events
[0m16:32:26.554275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:40.551540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A2F5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A2F4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A2F52E0>]}


============================== 16:32:40.556539 | f96f0458-1fb8-4cad-8058-5166f36f38ec ==============================
[0m16:32:40.556539 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:32:40.557539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m16:32:40.900346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A501EE0>]}
[0m16:32:41.025015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A647740>]}
[0m16:32:41.027015 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:32:41.373816 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:32:41.375815 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:32:41.376815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A646060>]}
[0m16:32:44.442670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96BAA06E0>]}
[0m16:32:44.616571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:32:44.624565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:32:44.677535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96BE1D220>]}
[0m16:32:44.678536 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:32:44.680534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96A2B2540>]}
[0m16:32:44.685530 [info ] [MainThread]: 
[0m16:32:44.687529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:44.689529 [info ] [MainThread]: 
[0m16:32:44.690527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:44.696524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m16:32:44.947383 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:32:44.948382 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:32:44.949381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:45.130387 [debug] [ThreadPool]: SQL status: BEGIN in 0.180 seconds
[0m16:32:45.131387 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:32:45.132388 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:32:45.138382 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m16:32:45.140382 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:32:45.141382 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:32:45.142382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:32:45.147378 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:32:45.148377 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:32:45.148377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:45.211340 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:32:45.212341 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:32:45.213340 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:32:45.221336 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:32:45.224333 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:32:45.225333 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:32:45.227332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:32:45.233328 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:32:45.234327 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:32:45.235327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:45.290300 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m16:32:45.291300 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:32:45.292300 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:32:45.299295 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m16:32:45.302294 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:32:45.303294 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:32:45.304293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m16:32:45.307292 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:32:45.307292 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:32:45.308290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:45.362260 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m16:32:45.363259 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:32:45.364258 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:32:45.371075 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m16:32:45.373066 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:32:45.374067 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:32:45.375064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m16:32:45.378063 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:32:45.379062 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:32:45.380062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:45.527977 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m16:32:45.527977 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:32:45.528977 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:32:45.535975 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m16:32:45.538988 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:32:45.538988 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:32:45.546968 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:45.546968 [debug] [MainThread]: On master: BEGIN
[0m16:32:45.547965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:45.604934 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m16:32:45.605933 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:45.606932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:45.616927 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:32:45.618926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96f0458-1fb8-4cad-8058-5166f36f38ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96BE1ECF0>]}
[0m16:32:45.618926 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:45.619925 [debug] [MainThread]: On master: Close
[0m16:32:45.626921 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:32:45.627920 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:32:45.628921 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:32:45.639914 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:32:45.641912 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:32:45.645909 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:32:45.647909 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m16:32:45.648909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now seed.management_control_project.management_control)
[0m16:32:45.649908 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m16:32:45.651907 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m16:32:45.652907 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m16:32:45.653906 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:32:45.654906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.management_control_project.management_control, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m16:32:45.654906 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:32:45.663900 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:32:45.665898 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:32:45.667897 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:32:45.668896 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:32:45.668896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m16:32:45.669896 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:32:45.683889 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:32:45.684887 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:32:45.686886 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:32:45.687885 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:32:45.687885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m16:32:45.688886 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:32:45.696881 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:32:45.698880 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:32:45.700878 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:32:45.700878 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:32:45.701877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m16:32:45.702877 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:32:45.714870 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:32:45.716870 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:32:45.718868 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:32:45.719867 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:32:45.719867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now model.management_control_project.int_management_control)
[0m16:32:45.720867 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:32:45.726863 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:32:45.728862 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:32:45.730876 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:32:45.731860 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:32:45.732859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now snapshot.management_control_project.management_control_snapshot)
[0m16:32:45.733862 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:32:45.739855 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:32:45.741855 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:32:45.741855 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:32:45.742854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.management_control_project.management_control_snapshot, now test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c)
[0m16:32:45.743855 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:32:45.751848 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:32:45.753848 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:32:45.755847 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:32:45.756846 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:32:45.757848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m16:32:45.757848 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:32:45.764841 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:32:45.765840 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:32:45.767840 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:32:45.767840 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:32:45.768839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m16:32:45.769840 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:32:45.776836 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:32:45.779833 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:32:45.781832 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:32:45.782833 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:32:45.783830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m16:32:45.784830 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:32:45.789827 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:32:45.791827 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:32:45.792825 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:32:45.794825 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:32:45.795824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_stg_management_control_control_id.6000ea497a, now model.management_control_project.control_growth)
[0m16:32:45.796825 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:32:45.800823 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:32:45.803820 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:32:45.804820 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:32:45.805820 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:32:45.805820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:32:45.806817 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:32:45.814814 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:32:45.815812 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:32:45.817813 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:32:45.818811 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:32:45.819812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_summary, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m16:32:45.819812 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:32:45.824808 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:32:45.826806 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:32:45.829804 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:32:45.830804 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:32:45.830804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m16:32:45.831803 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:32:45.838799 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:32:45.840798 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:32:45.842800 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:32:45.843798 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:32:45.844797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m16:32:45.845796 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:32:45.850792 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:32:45.852792 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:32:45.854791 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:32:45.855789 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:32:45.855789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m16:32:45.856791 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:32:45.862788 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:32:45.865784 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:32:45.866783 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:32:45.867782 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m16:32:45.868782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.duplicate_control_entries)
[0m16:32:45.869781 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m16:32:45.872781 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m16:32:45.874778 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m16:32:45.876777 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m16:32:45.877777 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:32:45.878777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m16:32:45.879776 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:32:45.884774 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:32:45.886771 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:32:45.887771 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:32:45.889770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:45.889770 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:32:45.890769 [debug] [MainThread]: Connection 'test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b' was properly closed.
[0m16:32:45.897766 [debug] [MainThread]: Command end result
[0m16:32:45.929746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:32:45.932745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:32:45.947736 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:32:45.948738 [debug] [MainThread]: Command `dbt compile` succeeded at 16:32:45.948738 after 5.55 seconds
[0m16:32:45.949738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96BE1BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A969FAF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A969FACE60>]}
[0m16:32:45.950736 [debug] [MainThread]: Flushing usage events
[0m16:32:46.529980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:58.962534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F3B86780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F63E9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F63E9250>]}


============================== 16:32:58.967529 | 86103115-43ab-4aa3-b07d-37d21d882c09 ==============================
[0m16:32:58.967529 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:32:58.969528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:59.243719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86103115-43ab-4aa3-b07d-37d21d882c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F5DAFCE0>]}
[0m16:32:59.295690 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:32:59.297689 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:32:59.300687 [debug] [MainThread]: Command `dbt deps` succeeded at 16:32:59.300687 after 0.52 seconds
[0m16:32:59.301686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F6464EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F5DAFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F5C79B80>]}
[0m16:32:59.302685 [debug] [MainThread]: Flushing usage events
[0m16:32:59.790481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:17.590598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B339853050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B337A96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B339DCA840>]}


============================== 16:34:17.598593 | 4e10ea27-aacd-489b-8b82-3fb5d17ae9f1 ==============================
[0m16:34:17.598593 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:34:17.600592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:34:18.072483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B337BB9550>]}
[0m16:34:18.233444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33A7D7860>]}
[0m16:34:18.236442 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:34:18.670838 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:34:19.090643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:19.091642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:19.263552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33AA1F770>]}
[0m16:34:19.528865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:34:19.535860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:34:19.582477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33BE70950>]}
[0m16:34:19.584479 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:34:19.585475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33BDFDB50>]}
[0m16:34:19.588474 [info ] [MainThread]: 
[0m16:34:19.589473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:19.590473 [info ] [MainThread]: 
[0m16:34:19.591472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:19.593471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:34:19.749383 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:34:19.750382 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:34:19.751382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:19.830336 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m16:34:19.834334 [debug] [ThreadPool]: On list_gestion: Close
[0m16:34:19.836334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_public_seeds)
[0m16:34:19.838332 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_seeds"
"
[0m16:34:19.850324 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m16:34:19.851324 [debug] [ThreadPool]: On create_gestion_public_seeds: BEGIN
[0m16:34:19.852324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:19.915273 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:34:19.917270 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m16:34:19.917270 [debug] [ThreadPool]: On create_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_seeds"} */
create schema if not exists "public_seeds"
[0m16:34:19.923140 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m16:34:19.924140 [debug] [ThreadPool]: On create_gestion_public_seeds: COMMIT
[0m16:34:19.925141 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_seeds"
[0m16:34:19.926137 [debug] [ThreadPool]: On create_gestion_public_seeds: COMMIT
[0m16:34:19.928137 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m16:34:19.929136 [debug] [ThreadPool]: On create_gestion_public_seeds: Close
[0m16:34:19.936134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m16:34:19.946126 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:34:19.947125 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:34:19.947125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:20.009091 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m16:34:20.010090 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:34:20.011089 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:34:20.021085 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m16:34:20.025081 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:34:20.026080 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:34:20.027081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m16:34:20.032077 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:34:20.033076 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:34:20.034076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:20.088045 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m16:34:20.089045 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:34:20.090044 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:34:20.100039 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m16:34:20.103036 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:34:20.104036 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:34:20.106034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m16:34:20.110032 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:34:20.111032 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:34:20.112031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:20.167000 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m16:34:20.168999 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:34:20.169998 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:34:20.177994 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:20.179992 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:34:20.180991 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:34:20.182990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m16:34:20.185988 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:34:20.186990 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:34:20.187988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:20.245236 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m16:34:20.246235 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:34:20.247236 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:34:20.255231 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:20.257230 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:34:20.258229 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:34:20.259227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:34:20.263225 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:34:20.264225 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:34:20.265225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:20.433135 [debug] [ThreadPool]: SQL status: BEGIN in 0.168 seconds
[0m16:34:20.434133 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:34:20.435134 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:34:20.445128 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m16:34:20.448126 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:34:20.449124 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:34:20.459121 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:20.460121 [debug] [MainThread]: On master: BEGIN
[0m16:34:20.461120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:20.623648 [debug] [MainThread]: SQL status: BEGIN in 0.162 seconds
[0m16:34:20.624648 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:20.625648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:20.636642 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:34:20.638640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33AA7F6B0>]}
[0m16:34:20.639639 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:20.641638 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:20.642638 [debug] [MainThread]: On master: BEGIN
[0m16:34:20.643639 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:34:20.644638 [debug] [MainThread]: On master: COMMIT
[0m16:34:20.645635 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:20.645635 [debug] [MainThread]: On master: COMMIT
[0m16:34:20.646636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:20.647635 [debug] [MainThread]: On master: Close
[0m16:34:20.650633 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m16:34:20.651632 [info ] [Thread-1 (]: 1 of 1 START seed file public_seeds.management_control ......................... [RUN]
[0m16:34:20.653631 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m16:34:20.654631 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m16:34:20.655630 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m16:34:20.721591 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m16:34:20.722592 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m16:34:20.723591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:20.781559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m16:34:20.781559 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m16:34:20.782557 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */

    create table "gestion"."public_seeds"."management_control" ("control_id" integer,"department_id" integer,"control_date" date,"expenses" float8,"revenue" float8,"status" text)
  
[0m16:34:20.796549 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m16:34:20.879502 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m16:34:20.880503 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public_seeds"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m16:34:20.885498 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m16:34:20.899492 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m16:34:20.931476 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m16:34:20.932472 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m16:34:20.933471 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m16:34:20.936472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:34:20.939468 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m16:34:20.943467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e10ea27-aacd-489b-8b82-3fb5d17ae9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33C7DADE0>]}
[0m16:34:20.945464 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_seeds.management_control ..................... [[32mINSERT 100[0m in 0.29s]
[0m16:34:20.946464 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m16:34:20.948462 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:20.949466 [debug] [MainThread]: On master: BEGIN
[0m16:34:20.949466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:21.121363 [debug] [MainThread]: SQL status: BEGIN in 0.172 seconds
[0m16:34:21.122363 [debug] [MainThread]: On master: COMMIT
[0m16:34:21.123362 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:21.124361 [debug] [MainThread]: On master: COMMIT
[0m16:34:21.125362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:21.126361 [debug] [MainThread]: On master: Close
[0m16:34:21.128360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:21.129359 [debug] [MainThread]: Connection 'create_gestion_public_seeds' was properly closed.
[0m16:34:21.130359 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:34:21.132357 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m16:34:21.134356 [info ] [MainThread]: 
[0m16:34:21.136355 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m16:34:21.138355 [debug] [MainThread]: Command end result
[0m16:34:21.203738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:34:21.208736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:34:21.221728 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:34:21.222729 [info ] [MainThread]: 
[0m16:34:21.224726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:21.225725 [info ] [MainThread]: 
[0m16:34:21.226726 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:34:21.228724 [debug] [MainThread]: Command `dbt seed` succeeded at 16:34:21.228724 after 3.89 seconds
[0m16:34:21.229724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33A2F8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B339DCA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B33A48A2A0>]}
[0m16:34:21.230723 [debug] [MainThread]: Flushing usage events
[0m16:34:22.400546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:29.112236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3F326210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41F098B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41F08650>]}


============================== 16:34:29.119039 | 00331227-7784-4f7c-89a8-5e0ad0465f84 ==============================
[0m16:34:29.119039 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:34:29.120039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:29.415963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C42143980>]}
[0m16:34:29.512889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41B89D60>]}
[0m16:34:29.513887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:34:29.795726 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:34:30.023614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:30.024595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:30.107566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C432E9E20>]}
[0m16:34:30.243471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:34:30.248467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:34:30.284204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C436B8980>]}
[0m16:34:30.285202 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:34:30.286203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4363E030>]}
[0m16:34:30.289200 [info ] [MainThread]: 
[0m16:34:30.290200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:30.291199 [info ] [MainThread]: 
[0m16:34:30.292200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:30.300196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:34:30.394290 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:34:30.395291 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:34:30.395291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:30.554407 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.159 seconds
[0m16:34:30.556427 [debug] [ThreadPool]: On list_gestion: Close
[0m16:34:30.559409 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:34:30.560409 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:34:30.560409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:30.606071 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m16:34:30.608091 [debug] [ThreadPool]: On list_gestion: Close
[0m16:34:30.610071 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:34:30.611089 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:34:30.612071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:30.658654 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.047 seconds
[0m16:34:30.660635 [debug] [ThreadPool]: On list_gestion: Close
[0m16:34:30.661634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_public_intermediate)
[0m16:34:30.662634 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_intermediate"
"
[0m16:34:30.669648 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m16:34:30.669648 [debug] [ThreadPool]: On create_gestion_public_intermediate: BEGIN
[0m16:34:30.670648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:30.829490 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m16:34:30.830489 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m16:34:30.831490 [debug] [ThreadPool]: On create_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m16:34:30.834488 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m16:34:30.836487 [debug] [ThreadPool]: On create_gestion_public_intermediate: COMMIT
[0m16:34:30.837487 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_intermediate"
[0m16:34:30.838486 [debug] [ThreadPool]: On create_gestion_public_intermediate: COMMIT
[0m16:34:30.840484 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m16:34:30.841483 [debug] [ThreadPool]: On create_gestion_public_intermediate: Close
[0m16:34:30.842485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_gestion_public_intermediate, now create_gestion_public_staging)
[0m16:34:30.844500 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_staging"
"
[0m16:34:30.848479 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m16:34:30.849479 [debug] [ThreadPool]: On create_gestion_public_staging: BEGIN
[0m16:34:30.850478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.008455 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m16:34:31.009469 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m16:34:31.009469 [debug] [ThreadPool]: On create_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_staging"} */
create schema if not exists "public_staging"
[0m16:34:31.011454 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:34:31.013452 [debug] [ThreadPool]: On create_gestion_public_staging: COMMIT
[0m16:34:31.013452 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_staging"
[0m16:34:31.014451 [debug] [ThreadPool]: On create_gestion_public_staging: COMMIT
[0m16:34:31.017826 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m16:34:31.018742 [debug] [ThreadPool]: On create_gestion_public_staging: Close
[0m16:34:31.019747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_gestion_public_staging, now create_gestion_public_management_control)
[0m16:34:31.020748 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "public_management_control"
"
[0m16:34:31.022763 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m16:34:31.023762 [debug] [ThreadPool]: On create_gestion_public_management_control: BEGIN
[0m16:34:31.023762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.184288 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m16:34:31.185285 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m16:34:31.186286 [debug] [ThreadPool]: On create_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_public_management_control"} */
create schema if not exists "public_management_control"
[0m16:34:31.188160 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:34:31.189178 [debug] [ThreadPool]: On create_gestion_public_management_control: COMMIT
[0m16:34:31.190177 [debug] [ThreadPool]: Using postgres connection "create_gestion_public_management_control"
[0m16:34:31.191179 [debug] [ThreadPool]: On create_gestion_public_management_control: COMMIT
[0m16:34:31.194041 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m16:34:31.195059 [debug] [ThreadPool]: On create_gestion_public_management_control: Close
[0m16:34:31.197042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m16:34:31.205055 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:34:31.205055 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:34:31.206038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:31.254009 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:34:31.255024 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:34:31.256009 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:34:31.263004 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:31.266005 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:34:31.267020 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:34:31.267020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m16:34:31.270019 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:34:31.271001 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:34:31.271001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.316973 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:34:31.317976 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:34:31.317976 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:34:31.325983 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:31.327968 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:34:31.327968 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:34:31.328987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m16:34:31.331965 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:34:31.332983 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:34:31.332983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.377939 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:34:31.378938 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:34:31.379937 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:34:31.386934 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:31.388932 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:34:31.388932 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:34:31.389931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:34:31.393930 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:34:31.394929 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:34:31.394929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.440907 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:34:31.441907 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:34:31.441907 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:34:31.449902 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:31.451902 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:34:31.452900 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:34:31.453900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m16:34:31.456898 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:34:31.457898 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:34:31.457898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:31.506869 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:34:31.506869 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:34:31.507869 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:34:31.514865 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:34:31.516864 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:34:31.517863 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:34:31.523859 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:31.523859 [debug] [MainThread]: On master: BEGIN
[0m16:34:31.524859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:31.679634 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m16:34:31.680633 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:31.680633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:31.691435 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:34:31.692452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4369FCB0>]}
[0m16:34:31.693451 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:31.694433 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:31.694433 [debug] [MainThread]: On master: BEGIN
[0m16:34:31.695431 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:34:31.696430 [debug] [MainThread]: On master: COMMIT
[0m16:34:31.696430 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:31.697430 [debug] [MainThread]: On master: COMMIT
[0m16:34:31.697430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:31.698431 [debug] [MainThread]: On master: Close
[0m16:34:31.700428 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:34:31.701428 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:34:31.702429 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:34:31.703427 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:34:31.712422 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:34:31.713421 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:34:31.783382 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:34:31.785380 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:34:31.786380 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:34:31.787379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:31.834018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m16:34:31.834018 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:34:31.835017 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:34:31.845813 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m16:34:31.868802 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:34:31.869801 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:34:31.870801 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:34:31.872346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:34:31.874366 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:34:31.877459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3F4485C0>]}
[0m16:34:31.878462 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.17s]
[0m16:34:31.879460 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:34:31.881461 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:34:31.882460 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:34:31.883458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:34:31.883458 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:34:31.887474 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:34:31.888473 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:34:31.892471 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:34:31.894453 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:34:31.895469 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:34:31.896469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:32.005389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m16:34:32.006389 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:34:32.007388 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:34:32.025378 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.017 seconds
[0m16:34:32.028376 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:34:32.029375 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:34:32.030374 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:34:32.031964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:34:32.032963 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:34:32.033962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4402DF70>]}
[0m16:34:32.034962 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.15s]
[0m16:34:32.035961 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:34:32.036961 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:34:32.037961 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:34:32.038960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:34:32.038960 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:34:32.043956 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:34:32.044956 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:34:32.050953 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:34:32.052951 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:34:32.054951 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:34:32.055951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:32.103923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m16:34:32.104922 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:34:32.105921 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:34:32.118433 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m16:34:32.120431 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:34:32.120431 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:34:32.121431 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:34:32.123000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:34:32.124003 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:34:32.125002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C43B69FA0>]}
[0m16:34:32.126002 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.09s]
[0m16:34:32.128000 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:34:32.128000 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:34:32.129000 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:34:32.130998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:34:32.130998 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:34:32.136996 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:34:32.138994 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:34:32.144992 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:34:32.146274 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:34:32.147278 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:34:32.149280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:32.310009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m16:34:32.310009 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:34:32.311025 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:34:32.320384 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public_management_control.control_summary » n'existe pas
LINE 38:         FROM "gestion"."public_management_control"."control_...
                      ^

[0m16:34:32.321385 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m16:34:32.322385 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:34:32.335439 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la relation « public_management_control.control_summary » n'existe pas
  LINE 38:         FROM "gestion"."public_management_control"."control_...
                        ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m16:34:32.336437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00331227-7784-4f7c-89a8-5e0ad0465f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C43C13CB0>]}
[0m16:34:32.337437 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.21s]
[0m16:34:32.338241 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:34:32.339246 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la relation « public_management_control.control_summary » n'existe pas
  LINE 38:         FROM "gestion"."public_management_control"."control_...
                        ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m16:34:32.342251 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:32.342251 [debug] [MainThread]: On master: BEGIN
[0m16:34:32.343241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:32.394376 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m16:34:32.395376 [debug] [MainThread]: On master: COMMIT
[0m16:34:32.396375 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:32.397374 [debug] [MainThread]: On master: COMMIT
[0m16:34:32.398375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:32.399374 [debug] [MainThread]: On master: Close
[0m16:34:32.400373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:32.401373 [debug] [MainThread]: Connection 'create_gestion_public_management_control' was properly closed.
[0m16:34:32.402372 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:34:32.402372 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:34:32.403371 [info ] [MainThread]: 
[0m16:34:32.404372 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m16:34:32.407371 [debug] [MainThread]: Command end result
[0m16:34:32.439351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:34:32.442350 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:34:32.450865 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:34:32.451851 [info ] [MainThread]: 
[0m16:34:32.452852 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:34:32.453852 [info ] [MainThread]: 
[0m16:34:32.455851 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la relation « public_management_control.control_summary » n'existe pas
  LINE 38:         FROM "gestion"."public_management_control"."control_...
                        ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m16:34:32.457852 [info ] [MainThread]: 
[0m16:34:32.458849 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:34:32.460846 [debug] [MainThread]: Command `dbt run` failed at 16:34:32.460846 after 3.50 seconds
[0m16:34:32.461846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41AED640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3F326210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4215DEB0>]}
[0m16:34:32.461846 [debug] [MainThread]: Flushing usage events
[0m16:34:33.012953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:36.772836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E2056780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E1F5CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E427F6E0>]}


============================== 16:36:36.777844 | c2d32d4f-72ab-4d78-afa7-3cdd8edc4693 ==============================
[0m16:36:36.777844 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:36:36.779831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:36.983731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2d32d4f-72ab-4d78-afa7-3cdd8edc4693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E4D22C60>]}
[0m16:36:37.021546 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:36:37.023302 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:36:37.025306 [debug] [MainThread]: Command `dbt deps` succeeded at 16:36:37.025306 after 0.44 seconds
[0m16:36:37.025306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E4E92090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E449CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E41A9FD0>]}
[0m16:36:37.026309 [debug] [MainThread]: Flushing usage events
[0m16:36:37.623149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:06.395293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8767A1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A879C581A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A879C5B770>]}


============================== 16:37:06.401316 | f4c4436c-b177-4289-9948-5547bb66bffe ==============================
[0m16:37:06.401316 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:37:06.402316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:06.616192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c4436c-b177-4289-9948-5547bb66bffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A87918E9F0>]}
[0m16:37:06.651450 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:37:06.653450 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:37:06.655466 [debug] [MainThread]: Command `dbt deps` succeeded at 16:37:06.655466 after 0.41 seconds
[0m16:37:06.656466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A879A54E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8799DC9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A879EB1220>]}
[0m16:37:06.656466 [debug] [MainThread]: Flushing usage events
[0m16:37:07.184094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:29.415545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F209940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F20BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2EAF7F50>]}


============================== 16:39:29.420529 | 85fb1266-8889-4a29-8933-eaec41bf20db ==============================
[0m16:39:29.420529 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:39:29.421529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:29.624412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85fb1266-8889-4a29-8933-eaec41bf20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F6E9F10>]}
[0m16:39:29.665403 [debug] [MainThread]: Command `dbt clean` succeeded at 16:39:29.665403 after 0.45 seconds
[0m16:39:29.666402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F1408F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F7BA180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2EAF7F50>]}
[0m16:39:29.667402 [debug] [MainThread]: Flushing usage events
[0m16:39:30.241953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:38.964201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11C975820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11F6EFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11F6ED640>]}


============================== 16:39:38.970196 | f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92 ==============================
[0m16:39:38.970196 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:39:38.971196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:39.253053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FBC1B50>]}
[0m16:39:39.345000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11E823740>]}
[0m16:39:39.346999 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:39.617844 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:39:39.618843 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:39:39.619826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FCAD0A0>]}
[0m16:39:42.030421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EDE95B0>]}
[0m16:39:42.165448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:39:42.170819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:39:42.203803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1215249B0>]}
[0m16:39:42.203803 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:39:42.204816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FD26750>]}
[0m16:39:42.207802 [info ] [MainThread]: 
[0m16:39:42.208801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:42.209801 [info ] [MainThread]: 
[0m16:39:42.210817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:42.215796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m16:39:42.309660 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:39:42.309660 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:39:42.310660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:42.360505 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:39:42.361508 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:39:42.362504 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:39:42.371337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:39:42.373338 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:39:42.373338 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:39:42.374338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m16:39:42.381331 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:39:42.382331 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:39:42.383334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:42.427957 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:39:42.428942 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:39:42.429941 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:39:42.437160 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:39:42.439177 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:39:42.440176 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:39:42.441157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m16:39:42.444175 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:39:42.444175 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:39:42.445157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:42.488147 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:39:42.489131 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:39:42.490130 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:39:42.497141 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:39:42.499125 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:39:42.500124 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:39:42.501123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m16:39:42.504122 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:39:42.505121 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:39:42.505121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:42.550618 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:39:42.550618 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:39:42.551602 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:39:42.558598 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:39:42.560597 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:39:42.561596 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:39:42.562598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m16:39:42.565595 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:39:42.565595 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:39:42.566594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:42.611588 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:39:42.612588 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:39:42.613567 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:39:42.620565 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:39:42.622562 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:39:42.623561 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:39:42.633557 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:42.634555 [debug] [MainThread]: On master: BEGIN
[0m16:39:42.635557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:42.689524 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m16:39:42.689524 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:42.690523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:42.700517 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:39:42.702516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d2cf-d4e9-4acd-9761-b1a0966a4f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C121546DE0>]}
[0m16:39:42.703515 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:42.703515 [debug] [MainThread]: On master: Close
[0m16:39:42.707513 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:39:42.707513 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:39:42.708512 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:39:42.719506 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:39:42.721506 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:39:42.723504 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:39:42.724504 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m16:39:42.729502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now seed.management_control_project.management_control)
[0m16:39:42.730502 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m16:39:42.733498 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m16:39:42.734497 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m16:39:42.735497 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:39:42.735497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.management_control_project.management_control, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m16:39:42.736496 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:39:42.740494 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:39:42.742493 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:39:42.746491 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:39:42.746491 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:39:42.748162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m16:39:42.749177 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:39:42.758173 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:39:42.761173 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:39:42.764170 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:39:42.765169 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:39:42.766171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m16:39:42.768167 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:39:42.773164 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:39:42.774165 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:39:42.775164 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:39:42.776163 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:39:42.778166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m16:39:42.779162 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:39:42.786157 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:39:42.787157 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:39:42.789155 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:39:42.789155 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:39:42.790155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now model.management_control_project.int_management_control)
[0m16:39:42.791154 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:39:42.795152 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:39:42.797151 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:39:42.799150 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:39:42.799150 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:39:42.801149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now snapshot.management_control_project.management_control_snapshot)
[0m16:39:42.802150 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:39:42.807146 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:39:42.808144 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:39:42.809144 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:39:42.809144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.management_control_project.management_control_snapshot, now test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c)
[0m16:39:42.810143 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:39:42.815650 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:39:42.816650 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:39:42.817650 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:39:42.818649 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:39:42.819649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m16:39:42.819649 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:39:42.823647 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:39:42.825644 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:39:42.826646 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:39:42.827644 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:39:42.828643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m16:39:42.828643 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:39:42.832640 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:39:42.834641 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:39:42.835640 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:39:42.836639 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:39:42.836639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m16:39:42.837640 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:39:42.841636 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:39:42.843634 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:39:42.844633 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:39:42.845636 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:39:42.845636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_stg_management_control_control_id.6000ea497a, now model.management_control_project.control_growth)
[0m16:39:42.846633 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:39:42.851630 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:39:42.853629 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:39:42.855629 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:39:42.856627 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:39:42.856627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:39:42.857626 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:39:42.861624 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:39:42.862624 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:39:42.863623 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:39:42.864622 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:39:42.865622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_summary, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m16:39:42.865622 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:39:42.870620 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:39:42.871618 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:39:42.873635 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:39:42.874616 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:39:42.874616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m16:39:42.875634 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:39:42.879632 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:39:42.881631 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:39:42.883629 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:39:42.884612 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:39:42.884612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m16:39:42.885611 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:39:42.889626 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:39:42.890609 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:39:42.891607 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:39:42.892625 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:39:42.893606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m16:39:42.893606 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:39:42.897622 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:39:42.901482 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:39:42.903481 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:39:42.904480 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m16:39:42.905482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.duplicate_control_entries)
[0m16:39:42.905482 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m16:39:42.908479 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m16:39:42.910477 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m16:39:42.911476 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m16:39:42.912478 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:39:42.913477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m16:39:42.913477 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:39:42.918474 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:39:42.920471 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:39:42.921473 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:39:42.922472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:42.923488 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m16:39:42.923488 [debug] [MainThread]: Connection 'test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b' was properly closed.
[0m16:39:42.927485 [debug] [MainThread]: Command end result
[0m16:39:42.953470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:39:42.956454 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:39:42.964465 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:39:42.966463 [debug] [MainThread]: Command `dbt compile` succeeded at 16:39:42.966463 after 4.14 seconds
[0m16:39:42.966463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FA34740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FA10530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11F604EF0>]}
[0m16:39:42.967445 [debug] [MainThread]: Flushing usage events
[0m16:39:43.485454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:52.931561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021392CF6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138D65DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021392512C30>]}


============================== 16:39:52.936572 | 3214fe1f-1a56-471e-a815-26aee6126627 ==============================
[0m16:39:52.936572 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:39:52.937558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:53.217416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021393976A50>]}
[0m16:39:53.312199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021392E3CA70>]}
[0m16:39:53.313997 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:53.586447 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:39:53.827494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:53.828492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:53.920443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021393B6FC20>]}
[0m16:39:54.052876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:39:54.057874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:39:54.090597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021394FC88F0>]}
[0m16:39:54.091598 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:39:54.092536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021394FAF710>]}
[0m16:39:54.094540 [info ] [MainThread]: 
[0m16:39:54.095539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:54.096538 [info ] [MainThread]: 
[0m16:39:54.097315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:54.102330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:39:54.197501 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:39:54.197501 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:39:54.198500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:54.350300 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.152 seconds
[0m16:39:54.352315 [debug] [ThreadPool]: On list_gestion: Close
[0m16:39:54.355316 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:39:54.355316 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:39:54.356300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.403824 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m16:39:54.405840 [debug] [ThreadPool]: On list_gestion: Close
[0m16:39:54.408823 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:39:54.409823 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:39:54.410824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.455187 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.045 seconds
[0m16:39:54.457186 [debug] [ThreadPool]: On list_gestion: Close
[0m16:39:54.459185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m16:39:54.466182 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:39:54.467180 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:39:54.467180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:54.513169 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:39:54.513169 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:39:54.514156 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:39:54.522148 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:39:54.524150 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:39:54.525149 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:39:54.526147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m16:39:54.529147 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:39:54.529147 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:39:54.530146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.574331 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:39:54.574331 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:39:54.575316 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:39:54.583324 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:39:54.585310 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:39:54.586309 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:39:54.586309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m16:39:54.590307 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:39:54.590307 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:39:54.591307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.740310 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m16:39:54.741309 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:39:54.741309 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:39:54.749904 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:39:54.751889 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:39:54.752904 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:39:54.752904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m16:39:54.756884 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:39:54.756884 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:39:54.757884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.805412 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:39:54.805412 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:39:54.806426 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:39:54.814709 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:39:54.816695 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:39:54.817693 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:39:54.817693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m16:39:54.823689 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:39:54.825706 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:39:54.826689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.972418 [debug] [ThreadPool]: SQL status: BEGIN in 0.146 seconds
[0m16:39:54.973419 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:39:54.973419 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:39:54.982350 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:39:54.984329 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:39:54.984329 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:39:54.990329 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:54.991326 [debug] [MainThread]: On master: BEGIN
[0m16:39:54.991326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:55.037331 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:39:55.038345 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:55.038345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:55.048705 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:39:55.050692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021390DE26C0>]}
[0m16:39:55.051692 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:55.052691 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:55.052691 [debug] [MainThread]: On master: BEGIN
[0m16:39:55.053688 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:39:55.053688 [debug] [MainThread]: On master: COMMIT
[0m16:39:55.054706 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:55.054706 [debug] [MainThread]: On master: COMMIT
[0m16:39:55.055706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:55.055706 [debug] [MainThread]: On master: Close
[0m16:39:55.058697 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:39:55.059703 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:39:55.060685 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:39:55.061687 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:39:55.073679 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:39:55.074678 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:39:55.144640 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:39:55.146639 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.147640 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:39:55.148638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:55.302299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m16:39:55.304300 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.305295 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:39:55.316291 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m16:39:55.326284 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.327283 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:39:55.332183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:39:55.336191 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.337193 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:39:55.338187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:39:55.364161 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:39:55.364161 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.365161 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:39:55.367366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:39:55.374383 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:39:55.380379 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:39:55.380379 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:39:55.387332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m16:39:55.390333 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:39:55.393333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395913290>]}
[0m16:39:55.395331 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.33s]
[0m16:39:55.397330 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:39:55.398330 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:39:55.399342 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:39:55.399342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:39:55.400328 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:39:55.404325 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:39:55.405325 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:39:55.410322 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:39:55.412321 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.413320 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:39:55.414339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:55.567279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.153 seconds
[0m16:39:55.568279 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.568279 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:39:55.578456 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m16:39:55.582472 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.583471 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:39:55.584453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:39:55.589451 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.590451 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:39:55.591450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:39:55.594465 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:39:55.595464 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.595464 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:39:55.599166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:39:55.602195 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:39:55.603195 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:39:55.603195 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:39:55.607496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:39:55.609513 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:39:55.610515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395971850>]}
[0m16:39:55.611497 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.21s]
[0m16:39:55.612516 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:39:55.614372 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:39:55.615374 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:39:55.615769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:39:55.616771 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:39:55.620768 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:39:55.621768 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:39:55.627764 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:39:55.630763 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.631762 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:39:55.632762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:55.685172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:39:55.686173 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.686173 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:39:55.697166 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m16:39:55.701163 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.701163 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:39:55.702163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:39:55.706160 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.707161 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:39:55.708160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:39:55.710158 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:39:55.710158 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.711157 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:39:55.712733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:39:55.715733 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:39:55.716733 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:39:55.716733 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:39:55.720733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:39:55.723730 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:39:55.724729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395925CD0>]}
[0m16:39:55.726727 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.11s]
[0m16:39:55.727727 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:39:55.728727 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:39:55.729727 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:39:55.730725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:39:55.731725 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:39:55.743719 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:39:55.745720 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:39:55.749714 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:39:55.750713 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:39:55.751714 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:39:55.752713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:55.811680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m16:39:55.812679 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:39:55.812679 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:39:55.821432 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.008 seconds
[0m16:39:55.825430 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:39:55.825430 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:39:55.826429 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:39:55.828199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:39:55.829205 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:39:55.830201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3214fe1f-1a56-471e-a815-26aee6126627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139597FBF0>]}
[0m16:39:55.831203 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.10s]
[0m16:39:55.833200 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:39:55.834199 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:55.835200 [debug] [MainThread]: On master: BEGIN
[0m16:39:55.836198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:55.886169 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m16:39:55.887169 [debug] [MainThread]: On master: COMMIT
[0m16:39:55.887169 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:55.888168 [debug] [MainThread]: On master: COMMIT
[0m16:39:55.889167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:55.889167 [debug] [MainThread]: On master: Close
[0m16:39:55.890168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:55.892166 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:39:55.892166 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m16:39:55.893168 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:39:55.894167 [info ] [MainThread]: 
[0m16:39:55.895165 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m16:39:55.898162 [debug] [MainThread]: Command end result
[0m16:39:55.932144 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:39:55.935142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:39:55.944139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:39:55.945136 [info ] [MainThread]: 
[0m16:39:55.946136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:55.947135 [info ] [MainThread]: 
[0m16:39:55.948135 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:39:55.951132 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:55.951132 after 3.15 seconds
[0m16:39:55.951132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213937F1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021393294E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021393944B00>]}
[0m16:39:55.952132 [debug] [MainThread]: Flushing usage events
[0m16:39:56.497579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:01.689748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDABB83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDF048920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDF0483E0>]}


============================== 16:40:01.694756 | 61f4a193-7a84-41e3-bdaa-6dc11ad73991 ==============================
[0m16:40:01.694756 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:40:01.696742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:01.984578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDE68FD10>]}
[0m16:40:02.078522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDEF21280>]}
[0m16:40:02.080522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:02.350524 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:40:02.585846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:02.586845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:02.680797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDF44FFE0>]}
[0m16:40:02.818736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:02.822717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:02.856696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE08A0620>]}
[0m16:40:02.857713 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:40:02.858697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDF44FEC0>]}
[0m16:40:02.860711 [info ] [MainThread]: 
[0m16:40:02.861694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:02.862692 [info ] [MainThread]: 
[0m16:40:02.863691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:02.869688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:40:02.962656 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:02.962656 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:02.963656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:03.116181 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.153 seconds
[0m16:40:03.118201 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:03.121181 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:03.122199 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:03.123197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.168049 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.045 seconds
[0m16:40:03.170069 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:03.173068 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:03.174067 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:03.175050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.219808 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.045 seconds
[0m16:40:03.222810 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:03.224789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:40:03.231785 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:03.232785 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:40:03.232785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:03.275760 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:40:03.276778 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:03.277759 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:40:03.284771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:03.286754 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:40:03.287754 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:40:03.288753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:40:03.291752 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:03.292751 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:40:03.292751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.337741 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:03.338725 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:03.339724 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:40:03.346720 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:03.348738 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:40:03.349737 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:40:03.350719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:40:03.352732 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:03.353734 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:40:03.354716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.399692 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:03.399692 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:03.400691 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:40:03.407685 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:03.409702 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:40:03.410702 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:40:03.411682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:40:03.414683 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:03.414683 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:40:03.415680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.570321 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m16:40:03.571322 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:03.571322 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:40:03.580200 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:40:03.582198 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:40:03.584197 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:40:03.585196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m16:40:03.588195 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:03.589194 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:40:03.589194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.634185 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:03.635171 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:03.636167 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:40:03.643178 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:40:03.645164 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:40:03.645164 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:40:03.652161 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.652161 [debug] [MainThread]: On master: BEGIN
[0m16:40:03.653160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:03.700196 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:40:03.700196 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.701197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:03.710672 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:40:03.712688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0E1C140>]}
[0m16:40:03.713669 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:03.713669 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.714670 [debug] [MainThread]: On master: BEGIN
[0m16:40:03.715773 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:03.715773 [debug] [MainThread]: On master: COMMIT
[0m16:40:03.716794 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.716794 [debug] [MainThread]: On master: COMMIT
[0m16:40:03.717794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:03.717794 [debug] [MainThread]: On master: Close
[0m16:40:03.720792 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:40:03.721775 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:40:03.722775 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:40:03.723772 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:40:03.734773 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:40:03.735771 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:40:03.822739 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:40:03.824722 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.824722 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:40:03.825719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:03.868911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:40:03.869906 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.869906 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:40:03.882578 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m16:40:03.889591 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.890590 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m16:40:03.891590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:03.895569 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.895569 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m16:40:03.896569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:03.925571 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:40:03.925571 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.926570 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:40:03.928551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:40:03.936052 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m16:40:03.942048 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:03.943048 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m16:40:03.946983 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:40:03.950001 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:40:03.953704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE11F2D50>]}
[0m16:40:03.954707 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.23s]
[0m16:40:03.955505 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:40:03.957525 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:40:03.957525 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:40:03.958508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:40:03.959508 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:40:03.963505 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:40:03.965505 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:40:03.969503 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:40:03.970501 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:03.971502 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:40:03.971502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:04.029357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m16:40:04.030355 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:04.030355 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:40:04.039778 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m16:40:04.043775 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:04.043775 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m16:40:04.044774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:04.049771 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:04.050771 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m16:40:04.051771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:04.054771 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:40:04.055768 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:04.056767 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:40:04.058044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:40:04.061063 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m16:40:04.062047 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:04.062047 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m16:40:04.066328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:40:04.068347 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:40:04.069346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1251730>]}
[0m16:40:04.071328 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.11s]
[0m16:40:04.072325 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:40:04.073324 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:40:04.074326 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:40:04.075324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:40:04.075324 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:40:04.081339 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:40:04.082319 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:40:04.090316 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:40:04.092316 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.093314 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:40:04.094314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:04.243950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m16:40:04.244951 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.244951 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:40:04.254536 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m16:40:04.259534 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.259534 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m16:40:04.260534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:04.264532 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.265531 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m16:40:04.266529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:04.268530 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:40:04.269529 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.269529 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m16:40:04.271528 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:40:04.274543 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m16:40:04.275524 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:04.275524 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m16:40:04.280139 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:40:04.282139 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:40:04.283143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0CE1AC0>]}
[0m16:40:04.284138 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.21s]
[0m16:40:04.286136 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:40:04.286136 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:40:04.287134 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:40:04.288146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:40:04.289157 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:40:04.297161 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:40:04.298142 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:40:04.302140 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:40:04.304140 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.306139 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:40:04.307138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:04.355305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m16:40:04.356302 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.356302 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:40:04.365299 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.008 seconds
[0m16:40:04.369294 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.369294 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m16:40:04.371294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:04.374291 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.375291 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m16:40:04.376292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:40:04.378289 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:40:04.378289 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.379289 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m16:40:04.382242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:40:04.386245 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m16:40:04.388244 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:04.388244 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m16:40:04.392244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:40:04.394253 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:40:04.395239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f4a193-7a84-41e3-bdaa-6dc11ad73991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1287EF0>]}
[0m16:40:04.396255 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.11s]
[0m16:40:04.398237 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:40:04.400237 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.400237 [debug] [MainThread]: On master: BEGIN
[0m16:40:04.401236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:04.449487 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m16:40:04.449487 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.450488 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.450488 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.451487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:04.451487 [debug] [MainThread]: On master: Close
[0m16:40:04.452484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:04.453484 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:40:04.454483 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m16:40:04.455503 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:40:04.455503 [info ] [MainThread]: 
[0m16:40:04.456500 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m16:40:04.458481 [debug] [MainThread]: Command end result
[0m16:40:04.489463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:04.494461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:04.502474 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:40:04.502474 [info ] [MainThread]: 
[0m16:40:04.504456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:04.505456 [info ] [MainThread]: 
[0m16:40:04.506454 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:40:04.509454 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:04.509454 after 2.96 seconds
[0m16:40:04.510452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE08664E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDEEA35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDE60A8D0>]}
[0m16:40:04.511461 [debug] [MainThread]: Flushing usage events
[0m16:40:10.044626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:16.858167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E9B706E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EA0844A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED922510>]}


============================== 16:40:16.864310 | 07a9363f-041c-43b9-bc1e-a3b0f052217a ==============================
[0m16:40:16.864310 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:40:16.864847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:40:17.158746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EDAD2A50>]}
[0m16:40:17.248694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EDB9D400>]}
[0m16:40:17.249694 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:17.516541 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:40:17.747409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:17.748408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:17.829363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EEDAC6B0>]}
[0m16:40:17.960287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:17.964285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:18.004620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF170620>]}
[0m16:40:18.004620 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:40:18.005796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF0D6360>]}
[0m16:40:18.007815 [info ] [MainThread]: 
[0m16:40:18.009120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:18.010125 [info ] [MainThread]: 
[0m16:40:18.012123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:18.020118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:40:18.116345 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:18.116345 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:18.117345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:18.173311 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.056 seconds
[0m16:40:18.175312 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:18.180308 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:18.181307 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:18.182309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.227280 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.045 seconds
[0m16:40:18.229281 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:18.232280 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:40:18.233278 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:40:18.234278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.276252 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.042 seconds
[0m16:40:18.278251 [debug] [ThreadPool]: On list_gestion: Close
[0m16:40:18.280250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m16:40:18.287246 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:18.287246 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:40:18.288246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:18.332222 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:40:18.333221 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:18.333221 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:40:18.341216 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:40:18.342215 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:40:18.343215 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:40:18.344213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:40:18.348212 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:18.349211 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:40:18.350210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.396185 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:40:18.396185 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:18.397185 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:40:18.405178 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:40:18.406178 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:40:18.407178 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:40:18.408177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m16:40:18.410176 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:18.411176 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:40:18.411176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.456149 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:18.457150 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:18.457150 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:40:18.465144 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:18.466144 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:40:18.467144 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:40:18.468142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m16:40:18.471142 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:18.471142 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:40:18.472141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.517190 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:18.518192 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:18.518192 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:40:18.526185 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:18.528170 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:40:18.529168 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:40:18.530168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:40:18.534179 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:18.535164 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:40:18.535164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:18.583136 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:40:18.584137 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:18.585136 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:40:18.592134 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:40:18.594148 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:40:18.595148 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:40:18.603143 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.604142 [debug] [MainThread]: On master: BEGIN
[0m16:40:18.604142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:18.651099 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:40:18.652099 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.652099 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:18.661107 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:40:18.663091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF6CFAD0>]}
[0m16:40:18.664090 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:18.664090 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.665089 [debug] [MainThread]: On master: BEGIN
[0m16:40:18.665089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:18.666107 [debug] [MainThread]: On master: COMMIT
[0m16:40:18.667091 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:18.668088 [debug] [MainThread]: On master: COMMIT
[0m16:40:18.669089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:18.669089 [debug] [MainThread]: On master: Close
[0m16:40:18.671089 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m16:40:18.672105 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m16:40:18.673103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m16:40:18.674103 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m16:40:18.685079 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m16:40:18.687077 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m16:40:18.757055 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.758054 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp164018726073"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m16:40:18.759054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:18.811006 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.052 seconds
[0m16:40:18.827015 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.827997 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m16:40:18.830999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:40:18.831994 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.832995 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp164018726073'
        
      order by ordinal_position

  
[0m16:40:18.853591 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.019 seconds
[0m16:40:18.859608 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.860608 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m16:40:18.864587 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m16:40:18.873601 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.874600 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m16:40:18.878598 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m16:40:18.900585 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m16:40:18.901568 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.902569 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp164018726073"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp164018726073"
    )
  
[0m16:40:18.905322 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m16:40:18.924312 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:40:18.925311 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m16:40:18.926311 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m16:40:18.927886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:40:18.929906 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m16:40:18.933886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED2F8740>]}
[0m16:40:18.935887 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.26s]
[0m16:40:18.936884 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m16:40:18.937886 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m16:40:18.938882 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m16:40:18.939882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m16:40:18.940883 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m16:40:18.944386 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m16:40:18.945404 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m16:40:18.949401 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:18.950383 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp164018948401"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m16:40:18.951384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:19.010347 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.059 seconds
[0m16:40:19.016345 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.018346 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m16:40:19.020343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:40:19.021343 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.022343 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp164018948401'
        
      order by ordinal_position

  
[0m16:40:19.036333 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.014 seconds
[0m16:40:19.040331 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.041334 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m16:40:19.045328 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m16:40:19.056322 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.057322 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp164018948401'
        
      order by ordinal_position

  
[0m16:40:19.060319 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m16:40:19.065317 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.066317 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m16:40:19.073313 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m16:40:19.085305 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:40:19.087304 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m16:40:19.088303 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.089303 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp164018948401"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp164018948401"
    )
  
[0m16:40:19.092303 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m16:40:19.093301 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:40:19.094301 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m16:40:19.095300 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m16:40:19.098298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:40:19.099298 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m16:40:19.100297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF661370>]}
[0m16:40:19.102296 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.16s]
[0m16:40:19.105294 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m16:40:19.107292 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m16:40:19.108294 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_management_control.control_growth .... [RUN]
[0m16:40:19.109292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.control_growth)
[0m16:40:19.110292 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m16:40:19.116287 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m16:40:19.118289 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m16:40:19.126283 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.127284 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

    
  
    

  create temporary table "control_growth__dbt_tmp164019123284"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m16:40:19.128285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:19.189354 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.061 seconds
[0m16:40:19.193353 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.194354 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m16:40:19.196352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:40:19.196352 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.197352 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_growth__dbt_tmp164019123284'
        
      order by ordinal_position

  
[0m16:40:19.211344 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.013 seconds
[0m16:40:19.214341 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.215341 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m16:40:19.219338 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:40:19.223336 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.223336 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m16:40:19.227334 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m16:40:19.230332 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m16:40:19.231332 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m16:40:19.232332 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
        
            delete from "gestion"."public_management_control"."control_growth"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_growth__dbt_tmp164019123284"
            );

        
    

    insert into "gestion"."public_management_control"."control_growth" ("control_year", "control_month", "monthly_net_profit", "growth_rate")
    (
        select "control_year", "control_month", "monthly_net_profit", "growth_rate"
        from "control_growth__dbt_tmp164019123284"
    )
  
[0m16:40:19.234331 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m16:40:19.235330 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m16:40:19.236329 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m16:40:19.244324 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m16:40:19.245325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EDA33290>]}
[0m16:40:19.245325 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.14s]
[0m16:40:19.246684 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m16:40:19.247690 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m16:40:19.248705 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m16:40:19.248705 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_management_control.control_summary ... [RUN]
[0m16:40:19.251686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m16:40:19.251686 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m16:40:19.260698 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m16:40:19.262678 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m16:40:19.268676 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.269694 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp164019264696"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m16:40:19.270694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:19.327643 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.056 seconds
[0m16:40:19.331657 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.332657 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m16:40:19.335639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:40:19.335639 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.336638 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp164019264696'
        
      order by ordinal_position

  
[0m16:40:19.351630 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.014 seconds
[0m16:40:19.355627 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.355627 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m16:40:19.360624 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m16:40:19.365621 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.365621 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m16:40:19.370619 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:40:19.373634 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m16:40:19.374614 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m16:40:19.375614 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp164019264696"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp164019264696"
    )
  
[0m16:40:19.377613 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m16:40:19.378612 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m16:40:19.379630 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m16:40:19.383609 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m16:40:19.385609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a9363f-041c-43b9-bc1e-a3b0f052217a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF6AC230>]}
[0m16:40:19.386608 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.13s]
[0m16:40:19.387608 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m16:40:19.388609 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m16:40:19.390608 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:19.390608 [debug] [MainThread]: On master: BEGIN
[0m16:40:19.391607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:19.545026 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m16:40:19.545026 [debug] [MainThread]: On master: COMMIT
[0m16:40:19.546039 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:19.546039 [debug] [MainThread]: On master: COMMIT
[0m16:40:19.547043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:19.548043 [debug] [MainThread]: On master: Close
[0m16:40:19.548043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:19.549023 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m16:40:19.550023 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m16:40:19.551023 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m16:40:19.552023 [info ] [MainThread]: 
[0m16:40:19.553022 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m16:40:19.555020 [debug] [MainThread]: Command end result
[0m16:40:19.583004 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:19.588003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:19.601994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:40:19.602993 [info ] [MainThread]: 
[0m16:40:19.604992 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:40:19.605992 [info ] [MainThread]: 
[0m16:40:19.607991 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m16:40:19.609994 [info ] [MainThread]: 
[0m16:40:19.610989 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m16:40:19.612986 [info ] [MainThread]: 
[0m16:40:19.613985 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m16:40:19.616000 [debug] [MainThread]: Command `dbt run` failed at 16:40:19.614983 after 2.90 seconds
[0m16:40:19.616983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EEEF5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF5A5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EDD7D490>]}
[0m16:40:19.617987 [debug] [MainThread]: Flushing usage events
[0m16:40:20.148828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:27.452955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE37D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE37FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE5B21E0>]}


============================== 16:40:27.458575 | 7422a2a1-6d05-41f9-be7d-03977bd1454f ==============================
[0m16:40:27.458575 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:40:27.459083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:40:27.757456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE1B7D70>]}
[0m16:40:27.849387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE5D1D60>]}
[0m16:40:27.851385 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:28.121240 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:40:28.353115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:28.354115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:28.437049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEEBD7560>]}
[0m16:40:28.569981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:28.574970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:28.673427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEFF75E20>]}
[0m16:40:28.674426 [info ] [MainThread]: Found 4 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 432 macros
[0m16:40:28.676427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEFBD1880>]}
[0m16:40:28.679441 [info ] [MainThread]: 
[0m16:40:28.680423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:28.682423 [info ] [MainThread]: 
[0m16:40:28.683030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:28.688037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:40:28.795061 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:28.796061 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:40:28.798060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:28.856532 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m16:40:28.857532 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:40:28.858532 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:40:28.865528 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:28.867526 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:40:28.868525 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:40:28.869524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:40:28.872523 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:28.873522 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:40:28.873522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:28.916301 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:40:28.917303 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:40:28.918302 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:40:28.925296 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:28.927309 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:40:28.928312 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:40:28.929294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:40:28.932311 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:28.933310 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:40:28.934305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:28.978787 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:28.979773 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:40:28.980774 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:40:28.987766 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:40:28.989765 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:40:28.990765 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:40:28.991763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m16:40:28.994762 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:28.994762 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:40:28.995762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:29.040720 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:40:29.040720 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:40:29.041719 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:40:29.049714 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:40:29.051712 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:40:29.051712 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:40:29.052712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m16:40:29.055710 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:29.056710 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:40:29.057709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:29.103659 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:40:29.104661 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:40:29.104661 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:40:29.112654 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:40:29.114672 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:40:29.115653 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:40:29.121649 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:29.121649 [debug] [MainThread]: On master: BEGIN
[0m16:40:29.122663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:29.186613 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m16:40:29.187612 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:29.191609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:29.212597 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m16:40:29.214596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7422a2a1-6d05-41f9-be7d-03977bd1454f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEFBD1880>]}
[0m16:40:29.216595 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:29.217595 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:29.218594 [debug] [MainThread]: On master: BEGIN
[0m16:40:29.220593 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:29.220593 [debug] [MainThread]: On master: COMMIT
[0m16:40:29.221592 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:29.222592 [debug] [MainThread]: On master: COMMIT
[0m16:40:29.223591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:29.224591 [debug] [MainThread]: On master: Close
[0m16:40:29.228589 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:40:29.230588 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m16:40:29.232587 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m16:40:29.234585 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:40:29.277560 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:40:29.279558 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:40:29.310013 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:40:29.313018 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:40:29.315017 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m16:40:29.316016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:29.360990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:40:29.361992 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:40:29.361992 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m16:40:29.364988 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:29.370985 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m16:40:29.371985 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m16:40:29.372983 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.14s]
[0m16:40:29.374982 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:40:29.374982 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m16:40:29.375981 [info ] [Thread-1 (]: 2 of 14 START test duplicate_control_entries ................................... [RUN]
[0m16:40:29.376982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m16:40:29.377981 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m16:40:29.381979 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m16:40:29.382978 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m16:40:29.385975 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m16:40:29.386975 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m16:40:29.387974 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m16:40:29.388973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:29.554750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m16:40:29.555751 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m16:40:29.556750 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_id, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_id
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m16:40:29.558748 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « control_id » n'existe pas
LINE 7:       SELECT control_id, COUNT(*)
                     ^

[0m16:40:29.558748 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m16:40:29.559747 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m16:40:29.582736 [debug] [Thread-1 (]: Database Error in test duplicate_control_entries (tests\duplicate_control_entries.sql)
  ERREUR:  la colonne « control_id » n'existe pas
  LINE 7:       SELECT control_id, COUNT(*)
                       ^
  compiled code at target\run\management_control_project\tests\duplicate_control_entries.sql
[0m16:40:29.583734 [error] [Thread-1 (]: 2 of 14 ERROR duplicate_control_entries ........................................ [[31mERROR[0m in 0.21s]
[0m16:40:29.585733 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m16:40:29.586732 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:40:29.587733 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.duplicate_control_entries' to be skipped because of status 'error'.  Reason: Database Error in test duplicate_control_entries (tests\duplicate_control_entries.sql)
  ERREUR:  la colonne « control_id » n'existe pas
  LINE 7:       SELECT control_id, COUNT(*)
                       ^
  compiled code at target\run\management_control_project\tests\duplicate_control_entries.sql.
[0m16:40:29.587733 [info ] [Thread-1 (]: 3 of 14 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m16:40:29.589730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m16:40:29.591730 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:40:29.604721 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:40:29.606721 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:40:29.611720 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:40:29.613719 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:40:29.615720 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m16:40:29.615720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:29.764548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m16:40:29.765562 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:40:29.765562 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m16:40:29.767866 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:29.769883 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m16:40:29.770885 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m16:40:29.771868 [info ] [Thread-1 (]: 3 of 14 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.18s]
[0m16:40:29.772867 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:40:29.773884 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:40:29.774883 [info ] [Thread-1 (]: 4 of 14 START test not_null_control_summary_total_net_profit ................... [RUN]
[0m16:40:29.775864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m16:40:29.775864 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:40:29.779880 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:40:29.781861 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:40:29.784878 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:40:29.786255 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:40:29.787258 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: BEGIN
[0m16:40:29.788257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:29.841337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:40:29.842337 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:40:29.843336 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_net_profit
from "gestion"."public_management_control"."control_summary"
where total_net_profit is null



      
    ) dbt_internal_test
[0m16:40:29.845335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:29.848333 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: ROLLBACK
[0m16:40:29.848333 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: Close
[0m16:40:29.850334 [info ] [Thread-1 (]: 4 of 14 PASS not_null_control_summary_total_net_profit ......................... [[32mPASS[0m in 0.07s]
[0m16:40:29.851331 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:40:29.852349 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:40:29.853318 [info ] [Thread-1 (]: 5 of 14 START test not_null_int_management_control_net_profit .................. [RUN]
[0m16:40:29.854320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m16:40:29.854320 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:40:29.859336 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:40:29.860317 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:40:29.863334 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:40:29.865314 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:40:29.866314 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m16:40:29.867313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.014815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m16:40:30.015817 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:40:30.015817 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m16:40:30.018269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:30.020289 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m16:40:30.021270 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m16:40:30.022269 [info ] [Thread-1 (]: 5 of 14 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.17s]
[0m16:40:30.024268 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:40:30.024268 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:40:30.025267 [info ] [Thread-1 (]: 6 of 14 START test not_null_management_control_snapshot_updated_at ............. [RUN]
[0m16:40:30.026267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m16:40:30.027268 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:40:30.033281 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:40:30.034262 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:40:30.037279 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:40:30.039259 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:40:30.039259 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: BEGIN
[0m16:40:30.040258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.092231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:40:30.093228 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:40:30.093228 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select updated_at
from "gestion"."snapshots"."management_control_snapshot"
where updated_at is null



      
    ) dbt_internal_test
[0m16:40:30.094228 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
LINE 14: from "gestion"."snapshots"."management_control_snapshot"
              ^

[0m16:40:30.095228 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: ROLLBACK
[0m16:40:30.095228 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: Close
[0m16:40:30.100224 [debug] [Thread-1 (]: Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql
[0m16:40:30.101224 [error] [Thread-1 (]: 6 of 14 ERROR not_null_management_control_snapshot_updated_at .................. [[31mERROR[0m in 0.07s]
[0m16:40:30.102225 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:40:30.103223 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:40:30.103223 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql.
[0m16:40:30.104223 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_management_control_control_date ................ [RUN]
[0m16:40:30.105221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m16:40:30.106222 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:40:30.110219 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:40:30.111219 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:40:30.115216 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:40:30.117784 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:40:30.119787 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m16:40:30.119787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.173757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:40:30.174755 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:40:30.174755 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m16:40:30.176754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:30.178754 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m16:40:30.179754 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m16:40:30.181752 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_management_control_control_date ...................... [[32mPASS[0m in 0.08s]
[0m16:40:30.182751 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:40:30.183752 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:40:30.184752 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_management_control_control_id .................. [RUN]
[0m16:40:30.185752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m16:40:30.185752 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:40:30.189747 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:40:30.191748 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:40:30.194746 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:40:30.195745 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:40:30.196743 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m16:40:30.197743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.247715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m16:40:30.248713 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:40:30.249713 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m16:40:30.251713 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:30.254709 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m16:40:30.254709 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m16:40:30.255709 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_management_control_control_id ........................ [[32mPASS[0m in 0.07s]
[0m16:40:30.257709 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:40:30.258708 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:40:30.258708 [info ] [Thread-1 (]: 9 of 14 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m16:40:30.259706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m16:40:30.260706 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:40:30.265704 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:40:30.267702 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:40:30.270701 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:40:30.271700 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:40:30.272700 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m16:40:30.272700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.326881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:40:30.326881 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:40:30.327880 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m16:40:30.330880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:30.333877 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m16:40:30.334877 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m16:40:30.335875 [info ] [Thread-1 (]: 9 of 14 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.08s]
[0m16:40:30.336876 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:40:30.337875 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:40:30.338875 [info ] [Thread-1 (]: 10 of 14 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m16:40:30.339874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m16:40:30.339874 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:40:30.344871 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:40:30.346869 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:40:30.349867 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:40:30.350867 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:40:30.351868 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m16:40:30.352869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.504159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m16:40:30.505173 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:40:30.505173 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m16:40:30.507485 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:30.509501 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m16:40:30.510504 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m16:40:30.511485 [info ] [Thread-1 (]: 10 of 14 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.17s]
[0m16:40:30.513485 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:40:30.514483 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:40:30.515485 [info ] [Thread-1 (]: 11 of 14 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m16:40:30.516482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m16:40:30.517498 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:40:30.521479 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:40:30.522498 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:40:30.525495 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:40:30.526476 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:40:30.527494 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m16:40:30.528476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.576463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m16:40:30.577450 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:40:30.578448 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m16:40:30.580445 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:30.582447 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m16:40:30.583445 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m16:40:30.584445 [info ] [Thread-1 (]: 11 of 14 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.07s]
[0m16:40:30.586460 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:40:30.586460 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:40:30.587460 [info ] [Thread-1 (]: 12 of 14 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m16:40:30.588441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m16:40:30.588441 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:40:30.597436 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:40:30.598435 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:40:30.602433 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:40:30.604432 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:40:30.604432 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m16:40:30.605431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.654404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m16:40:30.655403 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:40:30.656402 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:30.658400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:30.660399 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m16:40:30.660399 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m16:40:30.662399 [info ] [Thread-1 (]: 12 of 14 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.07s]
[0m16:40:30.663398 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:40:30.664400 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:40:30.665397 [info ] [Thread-1 (]: 13 of 14 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m16:40:30.666397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m16:40:30.666397 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:40:30.671394 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:40:30.672393 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:40:30.675391 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:40:30.676390 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:40:30.677391 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m16:40:30.678389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.728366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m16:40:30.729367 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:40:30.730365 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:30.732364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
LINE 15: from "gestion"."snapshots"."management_control_snapshot"
              ^

[0m16:40:30.733368 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m16:40:30.734363 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m16:40:30.737361 [debug] [Thread-1 (]: Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m16:40:30.738361 [error] [Thread-1 (]: 13 of 14 ERROR unique_management_control_snapshot_control_id ................... [[31mERROR[0m in 0.07s]
[0m16:40:30.740360 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:40:30.740360 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:40:30.741359 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43' to be skipped because of status 'error'.  Reason: Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql.
[0m16:40:30.741359 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_management_control_control_id ................... [RUN]
[0m16:40:30.743358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m16:40:30.743358 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:40:30.749354 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:40:30.751354 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:40:30.755351 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:40:30.757351 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:40:30.758351 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m16:40:30.759348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.810318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:40:30.811319 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:40:30.812319 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:30.814318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:30.816315 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m16:40:30.817314 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m16:40:30.818315 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.07s]
[0m16:40:30.820314 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:40:30.821312 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:30.822313 [debug] [MainThread]: On master: BEGIN
[0m16:40:30.822313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:30.869286 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:40:30.870286 [debug] [MainThread]: On master: COMMIT
[0m16:40:30.871283 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:30.871283 [debug] [MainThread]: On master: COMMIT
[0m16:40:30.872283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:30.872283 [debug] [MainThread]: On master: Close
[0m16:40:30.873284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:30.874283 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m16:40:30.875282 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m16:40:30.875282 [info ] [MainThread]: 
[0m16:40:30.876282 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m16:40:30.880279 [debug] [MainThread]: Command end result
[0m16:40:30.916482 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:40:30.918479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:40:30.928475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:40:30.929474 [info ] [MainThread]: 
[0m16:40:30.930473 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:40:30.931472 [info ] [MainThread]: 
[0m16:40:30.932471 [error] [MainThread]:   Database Error in test duplicate_control_entries (tests\duplicate_control_entries.sql)
  ERREUR:  la colonne « control_id » n'existe pas
  LINE 7:       SELECT control_id, COUNT(*)
                       ^
  compiled code at target\run\management_control_project\tests\duplicate_control_entries.sql
[0m16:40:30.933472 [info ] [MainThread]: 
[0m16:40:30.934470 [error] [MainThread]:   Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql
[0m16:40:30.936469 [info ] [MainThread]: 
[0m16:40:30.938468 [error] [MainThread]:   Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m16:40:30.940467 [info ] [MainThread]: 
[0m16:40:30.942466 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=0 TOTAL=14
[0m16:40:30.945465 [debug] [MainThread]: Command `dbt test` failed at 16:40:30.945465 after 3.64 seconds
[0m16:40:30.946465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE8415B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEE37D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEDCF8B60>]}
[0m16:40:30.948470 [debug] [MainThread]: Flushing usage events
[0m16:40:31.477763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:06.987610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F542D82C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5414AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F54606780>]}


============================== 16:42:06.993253 | a529825c-0e23-445c-a5c0-7112a804d3c5 ==============================
[0m16:42:06.993253 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:42:06.995253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:42:07.311858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F54A18140>]}
[0m16:42:07.412801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F548FBC50>]}
[0m16:42:07.414485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:42:07.709086 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:42:07.955946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:07.957944 [debug] [MainThread]: Partial parsing: updated file: management_control_project://tests\duplicate_control_entries.sql
[0m16:42:08.261770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F549F8C50>]}
[0m16:42:08.412700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:42:08.417698 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:42:08.471574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F56354410>]}
[0m16:42:08.471574 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 14 data tests, 1 source, 432 macros
[0m16:42:08.472591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F55F1AAE0>]}
[0m16:42:08.475589 [info ] [MainThread]: 
[0m16:42:08.476570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:08.477571 [info ] [MainThread]: 
[0m16:42:08.478570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:08.483584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m16:42:08.577531 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:42:08.578530 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:42:08.578530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:08.628483 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:42:08.629501 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:42:08.629501 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:42:08.637481 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:42:08.640477 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:42:08.641476 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:42:08.642478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m16:42:08.645473 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:42:08.646473 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:42:08.647475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:08.732426 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m16:42:08.732426 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:42:08.733425 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:42:08.741419 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:42:08.743418 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:42:08.744417 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:42:08.745417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m16:42:08.749415 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:42:08.750414 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:42:08.750414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:08.800385 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:42:08.801387 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:42:08.802386 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:42:08.811378 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:42:08.813378 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:42:08.813378 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:42:08.814377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m16:42:08.817376 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:42:08.818376 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:42:08.819375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:08.878341 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m16:42:08.879340 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:42:08.880339 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:42:08.888335 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:42:08.890333 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:42:08.891333 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:42:08.892332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m16:42:08.894331 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:42:08.895330 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:42:08.895330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:08.940305 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:42:08.941305 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:42:08.941305 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:42:08.948300 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:42:08.950299 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:42:08.951299 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:42:08.957295 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:08.957295 [debug] [MainThread]: On master: BEGIN
[0m16:42:08.958295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:09.005270 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:42:09.006268 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:09.006268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:09.015262 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:42:09.016261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a529825c-0e23-445c-a5c0-7112a804d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F548D21B0>]}
[0m16:42:09.017262 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:09.018260 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:09.018260 [debug] [MainThread]: On master: BEGIN
[0m16:42:09.019261 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:42:09.020260 [debug] [MainThread]: On master: COMMIT
[0m16:42:09.020260 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:09.021258 [debug] [MainThread]: On master: COMMIT
[0m16:42:09.022260 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:42:09.022260 [debug] [MainThread]: On master: Close
[0m16:42:09.025258 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:42:09.025258 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m16:42:09.027255 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m16:42:09.027255 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:42:09.051241 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:42:09.054241 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:42:09.079225 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:42:09.081225 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:42:09.082223 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m16:42:09.083223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:09.130196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:42:09.131196 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m16:42:09.131196 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m16:42:09.134194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:09.141191 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m16:42:09.142190 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m16:42:09.143189 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.12s]
[0m16:42:09.144188 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m16:42:09.145189 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m16:42:09.146188 [info ] [Thread-1 (]: 2 of 14 START test duplicate_control_entries ................................... [RUN]
[0m16:42:09.147186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m16:42:09.147186 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m16:42:09.151185 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m16:42:09.152184 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m16:42:09.157183 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m16:42:09.159181 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m16:42:09.159181 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m16:42:09.160180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.214148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m16:42:09.215148 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m16:42:09.215148 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_year, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_year
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m16:42:09.218147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:09.220146 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m16:42:09.221143 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m16:42:09.222144 [warn ] [Thread-1 (]: 2 of 14 WARN 1 duplicate_control_entries ....................................... [[33mWARN 1[0m in 0.08s]
[0m16:42:09.224144 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m16:42:09.225143 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:42:09.225143 [info ] [Thread-1 (]: 3 of 14 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m16:42:09.226141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m16:42:09.227141 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:42:09.234136 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:42:09.236137 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:42:09.239135 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:42:09.241133 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:42:09.242133 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m16:42:09.242133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.301099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m16:42:09.301099 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m16:42:09.303099 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m16:42:09.306097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:09.310093 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m16:42:09.311093 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m16:42:09.312093 [info ] [Thread-1 (]: 3 of 14 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.09s]
[0m16:42:09.314093 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m16:42:09.315091 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:42:09.316091 [info ] [Thread-1 (]: 4 of 14 START test not_null_control_summary_total_net_profit ................... [RUN]
[0m16:42:09.317089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b)
[0m16:42:09.317089 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:42:09.324085 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:42:09.326084 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:42:09.331081 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:42:09.332080 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:42:09.333080 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: BEGIN
[0m16:42:09.334079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.394045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m16:42:09.395045 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"
[0m16:42:09.396044 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_net_profit
from "gestion"."public_management_control"."control_summary"
where total_net_profit is null



      
    ) dbt_internal_test
[0m16:42:09.398043 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:42:09.400042 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: ROLLBACK
[0m16:42:09.401041 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b: Close
[0m16:42:09.402041 [info ] [Thread-1 (]: 4 of 14 PASS not_null_control_summary_total_net_profit ......................... [[32mPASS[0m in 0.08s]
[0m16:42:09.404040 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b
[0m16:42:09.405040 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:42:09.406038 [info ] [Thread-1 (]: 5 of 14 START test not_null_int_management_control_net_profit .................. [RUN]
[0m16:42:09.407038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_summary_total_net_profit.e5b803df0b, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m16:42:09.408036 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:42:09.413034 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:42:09.415034 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:42:09.421030 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:42:09.424031 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:42:09.426028 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m16:42:09.426028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.577264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m16:42:09.578264 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m16:42:09.578264 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m16:42:09.580261 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:42:09.582260 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m16:42:09.583259 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m16:42:09.584258 [info ] [Thread-1 (]: 5 of 14 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.18s]
[0m16:42:09.586258 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m16:42:09.588256 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:42:09.590255 [info ] [Thread-1 (]: 6 of 14 START test not_null_management_control_snapshot_updated_at ............. [RUN]
[0m16:42:09.591254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m16:42:09.592258 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:42:09.600270 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:42:09.603249 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:42:09.607259 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:42:09.608247 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:42:09.609245 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: BEGIN
[0m16:42:09.610263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.661405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:42:09.662388 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m16:42:09.662388 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select updated_at
from "gestion"."snapshots"."management_control_snapshot"
where updated_at is null



      
    ) dbt_internal_test
[0m16:42:09.664386 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
LINE 14: from "gestion"."snapshots"."management_control_snapshot"
              ^

[0m16:42:09.664386 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: ROLLBACK
[0m16:42:09.665386 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: Close
[0m16:42:09.674398 [debug] [Thread-1 (]: Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql
[0m16:42:09.675398 [error] [Thread-1 (]: 6 of 14 ERROR not_null_management_control_snapshot_updated_at .................. [[31mERROR[0m in 0.08s]
[0m16:42:09.676379 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m16:42:09.677378 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:42:09.677378 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql.
[0m16:42:09.678380 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_management_control_control_date ................ [RUN]
[0m16:42:09.680379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m16:42:09.681378 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:42:09.686374 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:42:09.688373 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:42:09.693370 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:42:09.695370 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:42:09.696368 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m16:42:09.698368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.750340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:42:09.751339 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m16:42:09.752336 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m16:42:09.755335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:42:09.757333 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m16:42:09.758333 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m16:42:09.759332 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_management_control_control_date ...................... [[32mPASS[0m in 0.08s]
[0m16:42:09.760332 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m16:42:09.761333 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:42:09.762333 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_management_control_control_id .................. [RUN]
[0m16:42:09.763330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m16:42:09.763330 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:42:09.768328 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:42:09.770325 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:42:09.777322 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:42:09.778321 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:42:09.779321 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m16:42:09.780319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.834289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m16:42:09.836290 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m16:42:09.837288 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m16:42:09.840287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:09.842284 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m16:42:09.843283 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m16:42:09.844284 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_management_control_control_id ........................ [[32mPASS[0m in 0.08s]
[0m16:42:09.845283 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m16:42:09.846282 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:42:09.847284 [info ] [Thread-1 (]: 9 of 14 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m16:42:09.848281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m16:42:09.848281 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:42:09.854278 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:42:09.855277 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:42:09.858276 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:42:09.860274 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:42:09.860274 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m16:42:09.861273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.916241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m16:42:09.917242 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m16:42:09.918241 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m16:42:09.922241 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:09.924237 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m16:42:09.925237 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m16:42:09.926239 [info ] [Thread-1 (]: 9 of 14 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.08s]
[0m16:42:09.928236 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m16:42:09.928236 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:42:09.929236 [info ] [Thread-1 (]: 10 of 14 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m16:42:09.930234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m16:42:09.931233 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:42:09.936231 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:42:09.937231 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:42:09.945225 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:42:09.947225 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:42:09.948227 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m16:42:09.949226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:10.104217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m16:42:10.105199 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m16:42:10.105199 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m16:42:10.107284 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:42:10.109305 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m16:42:10.110302 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m16:42:10.111285 [info ] [Thread-1 (]: 10 of 14 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.18s]
[0m16:42:10.114284 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m16:42:10.116282 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:42:10.117282 [info ] [Thread-1 (]: 11 of 14 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m16:42:10.119281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m16:42:10.120284 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:42:10.127278 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:42:10.129276 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:42:10.133272 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:42:10.135273 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:42:10.137272 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m16:42:10.138271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:10.192017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:42:10.193016 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m16:42:10.194014 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m16:42:10.196014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:42:10.198011 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m16:42:10.198011 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m16:42:10.200010 [info ] [Thread-1 (]: 11 of 14 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.08s]
[0m16:42:10.201009 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m16:42:10.203009 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:42:10.203009 [info ] [Thread-1 (]: 12 of 14 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m16:42:10.204009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m16:42:10.205007 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:42:10.213003 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:42:10.215001 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:42:10.218000 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:42:10.220002 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:42:10.221998 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m16:42:10.222998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:10.276966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m16:42:10.277965 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m16:42:10.277965 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:10.280965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:10.282962 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m16:42:10.283961 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m16:42:10.284962 [info ] [Thread-1 (]: 12 of 14 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.08s]
[0m16:42:10.286962 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m16:42:10.287960 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:42:10.288959 [info ] [Thread-1 (]: 13 of 14 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m16:42:10.289959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m16:42:10.290958 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:42:10.294955 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:42:10.295954 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:42:10.300952 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:42:10.303951 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:42:10.304951 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m16:42:10.306950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:10.462558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m16:42:10.463568 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m16:42:10.464570 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:10.465553 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
LINE 15: from "gestion"."snapshots"."management_control_snapshot"
              ^

[0m16:42:10.465553 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m16:42:10.466552 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m16:42:10.470550 [debug] [Thread-1 (]: Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m16:42:10.471547 [error] [Thread-1 (]: 13 of 14 ERROR unique_management_control_snapshot_control_id ................... [[31mERROR[0m in 0.18s]
[0m16:42:10.472547 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m16:42:10.473546 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:42:10.474564 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43' to be skipped because of status 'error'.  Reason: Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql.
[0m16:42:10.474564 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_management_control_control_id ................... [RUN]
[0m16:42:10.476220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m16:42:10.477223 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:42:10.481221 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:42:10.482222 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:42:10.485219 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:42:10.486217 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:42:10.487217 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m16:42:10.487217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:10.536146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m16:42:10.538165 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m16:42:10.538165 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:10.541140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:42:10.543158 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m16:42:10.544139 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m16:42:10.545138 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.07s]
[0m16:42:10.546140 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m16:42:10.547137 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:10.548137 [debug] [MainThread]: On master: BEGIN
[0m16:42:10.549137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:10.694833 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m16:42:10.694833 [debug] [MainThread]: On master: COMMIT
[0m16:42:10.695835 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:10.695835 [debug] [MainThread]: On master: COMMIT
[0m16:42:10.696833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:42:10.697831 [debug] [MainThread]: On master: Close
[0m16:42:10.697831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:10.698831 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m16:42:10.699831 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m16:42:10.699831 [info ] [MainThread]: 
[0m16:42:10.700835 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m16:42:10.704845 [debug] [MainThread]: Command end result
[0m16:42:10.801771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:42:10.804770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:42:10.812765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:42:10.813765 [info ] [MainThread]: 
[0m16:42:10.814766 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 1 warning:[0m
[0m16:42:10.814766 [info ] [MainThread]: 
[0m16:42:10.815764 [error] [MainThread]:   Database Error in test not_null_management_control_snapshot_updated_at (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 14: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\not_null_management_control_snapshot_updated_at.sql
[0m16:42:10.817763 [info ] [MainThread]: 
[0m16:42:10.819762 [error] [MainThread]:   Database Error in test unique_management_control_snapshot_control_id (snapshots\schema.yml)
  ERREUR:  la relation « snapshots.management_control_snapshot » n'existe pas
  LINE 15: from "gestion"."snapshots"."management_control_snapshot"
                ^
  compiled code at target\run\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m16:42:10.821762 [info ] [MainThread]: 
[0m16:42:10.822760 [warn ] [MainThread]: [33mWarning in test duplicate_control_entries (tests\duplicate_control_entries.sql)[0m
[0m16:42:10.823759 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m16:42:10.825760 [info ] [MainThread]: 
[0m16:42:10.827760 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\tests\duplicate_control_entries.sql
[0m16:42:10.828760 [info ] [MainThread]: 
[0m16:42:10.829759 [info ] [MainThread]: Done. PASS=11 WARN=1 ERROR=2 SKIP=0 TOTAL=14
[0m16:42:10.832755 [debug] [MainThread]: Command `dbt test` failed at 16:42:10.832755 after 4.04 seconds
[0m16:42:10.833756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F51B98680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5414AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5630D280>]}
[0m16:42:10.833756 [debug] [MainThread]: Flushing usage events
[0m16:42:11.445491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:05.972616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE77FBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE77441A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEA099310>]}


============================== 16:44:05.981612 | a9100b78-d298-4818-901d-8a73b28ae4ff ==============================
[0m16:44:05.981612 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:44:05.982611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:06.428355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEA09A000>]}
[0m16:44:06.604659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE79C1D60>]}
[0m16:44:06.606658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:44:07.002501 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:44:07.428016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:07.429014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:07.551944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEB8962D0>]}
[0m16:44:07.821450 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:44:07.829445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:44:07.886412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEBC60350>]}
[0m16:44:07.887412 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 14 data tests, 1 source, 432 macros
[0m16:44:07.889410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEB896600>]}
[0m16:44:07.892414 [info ] [MainThread]: 
[0m16:44:07.894408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:07.895409 [info ] [MainThread]: 
[0m16:44:07.897408 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:07.899404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m16:44:08.054317 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m16:44:08.055316 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m16:44:08.055316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:08.114281 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.059 seconds
[0m16:44:08.116281 [debug] [ThreadPool]: On list_gestion: Close
[0m16:44:08.118279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion, now create_gestion_snapshots)
[0m16:44:08.119279 [debug] [ThreadPool]: Creating schema "database: "gestion"
schema: "snapshots"
"
[0m16:44:08.131273 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m16:44:08.132273 [debug] [ThreadPool]: On create_gestion_snapshots: BEGIN
[0m16:44:08.133270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:08.194236 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m16:44:08.195236 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m16:44:08.197235 [debug] [ThreadPool]: On create_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "create_gestion_snapshots"} */
create schema if not exists "snapshots"
[0m16:44:08.200233 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m16:44:08.203232 [debug] [ThreadPool]: On create_gestion_snapshots: COMMIT
[0m16:44:08.204231 [debug] [ThreadPool]: Using postgres connection "create_gestion_snapshots"
[0m16:44:08.205230 [debug] [ThreadPool]: On create_gestion_snapshots: COMMIT
[0m16:44:08.208228 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m16:44:08.210228 [debug] [ThreadPool]: On create_gestion_snapshots: Close
[0m16:44:08.219221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m16:44:08.231215 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:44:08.233213 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m16:44:08.234214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:08.297177 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:44:08.298177 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m16:44:08.299175 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m16:44:08.310169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:44:08.314168 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m16:44:08.315167 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m16:44:08.317166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m16:44:08.322163 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:44:08.324161 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m16:44:08.325161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:08.387126 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m16:44:08.388125 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m16:44:08.389125 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m16:44:08.401117 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:44:08.404116 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m16:44:08.405116 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m16:44:08.406115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m16:44:08.411112 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:44:08.412112 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m16:44:08.413111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:08.478074 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m16:44:08.479073 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m16:44:08.480072 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:44:08.491066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m16:44:08.494064 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m16:44:08.495064 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m16:44:08.497062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m16:44:08.502061 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:44:08.503060 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m16:44:08.504058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:08.568021 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m16:44:08.569021 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m16:44:08.570021 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:44:08.580016 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:44:08.582279 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m16:44:08.582279 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m16:44:08.584278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m16:44:08.589275 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:44:08.589275 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m16:44:08.590275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:08.654239 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m16:44:08.655239 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m16:44:08.656237 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m16:44:08.668230 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:44:08.671228 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m16:44:08.672227 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m16:44:08.685221 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:08.686220 [debug] [MainThread]: On master: BEGIN
[0m16:44:08.687219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:08.748185 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m16:44:08.749183 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:08.749183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:08.761177 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:44:08.763176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEB7BAA80>]}
[0m16:44:08.764175 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:08.764175 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:08.765175 [debug] [MainThread]: On master: BEGIN
[0m16:44:08.766175 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:44:08.767174 [debug] [MainThread]: On master: COMMIT
[0m16:44:08.768173 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:08.768173 [debug] [MainThread]: On master: COMMIT
[0m16:44:08.769172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:44:08.770173 [debug] [MainThread]: On master: Close
[0m16:44:08.772171 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m16:44:08.773172 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m16:44:08.775169 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m16:44:08.776168 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m16:44:08.791160 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m16:44:08.905095 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:44:08.906095 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id,
        updated_at::timestamp as dbt_updated_at,
        updated_at::timestamp as dbt_valid_from,
        
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
from (
        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m16:44:08.908093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:08.971057 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.064 seconds
[0m16:44:08.984050 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:44:08.985050 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:44:08.987048 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:44:08.988048 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m16:44:08.990046 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:44:08.991046 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m16:44:08.995043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:44:08.996043 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:44:08.997043 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      
  
    

  create  table "gestion"."snapshots"."management_control_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id,
        updated_at::timestamp as dbt_updated_at,
        updated_at::timestamp as dbt_valid_from,
        
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
from (
        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"
    ) sbq



  );
  
  
[0m16:44:09.011035 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m16:44:09.052010 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:44:09.054009 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m16:44:09.055009 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m16:44:09.057007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:44:09.062005 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m16:44:09.066002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9100b78-d298-4818-901d-8a73b28ae4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE795C230>]}
[0m16:44:09.068001 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mSELECT 51[0m in 0.29s]
[0m16:44:09.072000 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m16:44:09.073997 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:09.074998 [debug] [MainThread]: On master: BEGIN
[0m16:44:09.075996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:09.239407 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m16:44:09.240406 [debug] [MainThread]: On master: COMMIT
[0m16:44:09.242405 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:09.243404 [debug] [MainThread]: On master: COMMIT
[0m16:44:09.244404 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:44:09.245404 [debug] [MainThread]: On master: Close
[0m16:44:09.246402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:09.247402 [debug] [MainThread]: Connection 'create_gestion_snapshots' was properly closed.
[0m16:44:09.248401 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m16:44:09.249401 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m16:44:09.250400 [info ] [MainThread]: 
[0m16:44:09.251399 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m16:44:09.253399 [debug] [MainThread]: Command end result
[0m16:44:09.320361 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m16:44:09.325359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m16:44:09.339349 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m16:44:09.340349 [info ] [MainThread]: 
[0m16:44:09.341349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:09.343348 [info ] [MainThread]: 
[0m16:44:09.344347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:09.348346 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:44:09.347345 after 3.63 seconds
[0m16:44:09.349343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE77FBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE9A15640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEBA33920>]}
[0m16:44:09.350344 [debug] [MainThread]: Flushing usage events
[0m16:44:09.891034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:36.850668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012547C763F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254A1E1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254A1E00B0>]}


============================== 16:46:36.857663 | 9c1da232-c1e7-41b1-b52b-21fe2fbfed5b ==============================
[0m16:46:36.857663 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:46:36.859663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:46:37.167488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c1da232-c1e7-41b1-b52b-21fe2fbfed5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254A7FE660>]}
[0m16:46:37.213460 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:46:37.215458 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:46:37.218457 [debug] [MainThread]: Command `dbt deps` succeeded at 16:46:37.217457 after 0.65 seconds
[0m16:46:37.218457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254A66E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254AB24470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254AA6BA10>]}
[0m16:46:37.219457 [debug] [MainThread]: Flushing usage events
[0m16:46:37.793142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:07.569162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AC4F60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AC404500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AE71F830>]}


============================== 16:48:07.574177 | 8e12d9fd-9bbc-4811-a68e-765701911531 ==============================
[0m16:48:07.574177 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:48:07.576158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:07.781042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e12d9fd-9bbc-4811-a68e-765701911531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF1C23C0>]}
[0m16:48:07.810577 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:48:07.812558 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:48:07.815556 [debug] [MainThread]: Command `dbt deps` succeeded at 16:48:07.814557 after 0.43 seconds
[0m16:48:07.815556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AC4F60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AE61D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF3E31D0>]}
[0m16:48:07.816555 [debug] [MainThread]: Flushing usage events
[0m16:48:08.399360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:08.876055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD548C68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD548C47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD548C4710>]}


============================== 16:49:08.881050 | 83b6443e-9b0f-4f58-932a-9aa31e4990b4 ==============================
[0m16:49:08.881050 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:49:08.883036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:09.192859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83b6443e-9b0f-4f58-932a-9aa31e4990b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD549D2D50>]}
[0m16:49:09.244828 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:49:09.246830 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:49:09.248827 [debug] [MainThread]: Command `dbt deps` succeeded at 16:49:09.248827 after 0.53 seconds
[0m16:49:09.249828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD545480B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54BF3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD545C4EF0>]}
[0m16:49:09.250825 [debug] [MainThread]: Flushing usage events
[0m16:49:14.803284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:04.779820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9484230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AC1C5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AC1C4E30>]}


============================== 16:55:04.785833 | b1b70b21-d5a4-48dd-8076-dd83004ef976 ==============================
[0m16:55:04.785833 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:55:04.786814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:04.996694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1b70b21-d5a4-48dd-8076-dd83004ef976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AC1C75F0>]}
[0m16:55:05.043685 [debug] [MainThread]: Command `dbt clean` succeeded at 16:55:05.043685 after 0.46 seconds
[0m16:55:05.044686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB193260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AC3D9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AC309FD0>]}
[0m16:55:05.045685 [debug] [MainThread]: Flushing usage events
[0m16:55:05.671343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:23.718683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025909741970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259098757F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002590957CBC0>]}


============================== 16:55:23.724679 | c80258bc-534f-451f-9e3d-433df137e1f0 ==============================
[0m16:55:23.724679 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:55:23.725678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:23.939557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c80258bc-534f-451f-9e3d-433df137e1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259098F1070>]}
[0m16:55:23.969874 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:55:23.971861 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:55:23.973876 [debug] [MainThread]: Command `dbt deps` succeeded at 16:55:23.973876 after 0.40 seconds
[0m16:55:23.973876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025903485B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025909743440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025909852D50>]}
[0m16:55:23.974875 [debug] [MainThread]: Flushing usage events
[0m16:55:24.473474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:13.078360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D869A32F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D869A321B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D869A32FC0>]}


============================== 16:56:13.083356 | 9fca8fe2-c6fc-4b79-87ba-da2ae3881f01 ==============================
[0m16:56:13.083356 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:56:13.085356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:56:13.292237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fca8fe2-c6fc-4b79-87ba-da2ae3881f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86975A2A0>]}
[0m16:56:13.323990 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:56:13.325975 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:56:13.327976 [debug] [MainThread]: Command `dbt deps` succeeded at 16:56:13.327976 after 0.46 seconds
[0m16:56:13.328975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86975A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D869BB1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8693B0E30>]}
[0m16:56:13.329975 [debug] [MainThread]: Flushing usage events
[0m16:56:13.920517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:05.049204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D611806E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D64F300B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D64F32A80>]}


============================== 16:57:05.054873 | 9d16ac9b-1312-4cb4-bcab-1a1e98617f56 ==============================
[0m16:57:05.054873 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:57:05.055854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:05.255420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d16ac9b-1312-4cb4-bcab-1a1e98617f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D64BDA540>]}
[0m16:57:05.287363 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:57:05.288971 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:57:05.290969 [debug] [MainThread]: Command `dbt deps` succeeded at 16:57:05.290969 after 0.40 seconds
[0m16:57:05.290969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D649BCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D64DACEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D65062660>]}
[0m16:57:05.291968 [debug] [MainThread]: Flushing usage events
[0m16:57:05.865436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:38.171749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021620CE6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021623529F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021623529EB0>]}


============================== 16:58:38.177731 | 0790c262-0933-4853-8e71-2f8709f635d3 ==============================
[0m16:58:38.177731 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:58:38.178731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:38.204139 [info ] [MainThread]: dbt version: 1.9.1
[0m16:58:38.205222 [info ] [MainThread]: python version: 3.12.4
[0m16:58:38.206002 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m16:58:38.206585 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m16:58:38.309138 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m16:58:38.310119 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m16:58:38.310119 [info ] [MainThread]: Using dbt_project.yml file at C:\controle_gestion_dbt\dbt_project.yml
[0m16:58:38.312117 [info ] [MainThread]: adapter type: postgres
[0m16:58:38.313133 [info ] [MainThread]: adapter version: 1.9.0
[0m16:58:38.476024 [info ] [MainThread]: Configuration:
[0m16:58:38.476558 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:58:38.477579 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:58:38.478561 [info ] [MainThread]: Required dependencies:
[0m16:58:38.479561 [debug] [MainThread]: Executing "git --help"
[0m16:58:38.538331 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:58:38.539331 [debug] [MainThread]: STDERR: "b''"
[0m16:58:38.540331 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:58:38.542331 [info ] [MainThread]: Connection:
[0m16:58:38.544328 [info ] [MainThread]:   host: localhost
[0m16:58:38.545329 [info ] [MainThread]:   port: 5432
[0m16:58:38.546327 [info ] [MainThread]:   user: postgres
[0m16:58:38.547327 [info ] [MainThread]:   database: gestion
[0m16:58:38.549327 [info ] [MainThread]:   schema: public
[0m16:58:38.551326 [info ] [MainThread]:   connect_timeout: 10
[0m16:58:38.551326 [info ] [MainThread]:   role: None
[0m16:58:38.552324 [info ] [MainThread]:   search_path: None
[0m16:58:38.553324 [info ] [MainThread]:   keepalives_idle: 0
[0m16:58:38.554322 [info ] [MainThread]:   sslmode: None
[0m16:58:38.555323 [info ] [MainThread]:   sslcert: None
[0m16:58:38.556322 [info ] [MainThread]:   sslkey: None
[0m16:58:38.557320 [info ] [MainThread]:   sslrootcert: None
[0m16:58:38.558322 [info ] [MainThread]:   application_name: dbt
[0m16:58:38.560319 [info ] [MainThread]:   retries: 1
[0m16:58:38.562319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:58:38.877771 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:58:38.953731 [debug] [MainThread]: Using postgres connection "debug"
[0m16:58:38.953731 [debug] [MainThread]: On debug: select 1 as id
[0m16:58:38.954730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:39.102510 [debug] [MainThread]: SQL status: SELECT 1 in 0.148 seconds
[0m16:58:39.103525 [debug] [MainThread]: On debug: Close
[0m16:58:39.104508 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:58:39.105512 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:58:39.108508 [debug] [MainThread]: Command `dbt debug` succeeded at 16:58:39.108508 after 1.13 seconds
[0m16:58:39.109507 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:58:39.110515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021623E64740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021623E65010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216232C22A0>]}
[0m16:58:39.110515 [debug] [MainThread]: Flushing usage events
[0m16:58:39.778270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:46.933484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1E10590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1E104D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1E13860>]}


============================== 16:58:46.940480 | 3409d5c3-f2b1-4d2b-ab1a-8023900a9db7 ==============================
[0m16:58:46.940480 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:58:46.942479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:58:47.179343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3409d5c3-f2b1-4d2b-ab1a-8023900a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1276480>]}
[0m16:58:47.215248 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:58:47.217233 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:58:47.219245 [debug] [MainThread]: Command `dbt deps` succeeded at 16:58:47.219245 after 0.49 seconds
[0m16:58:47.219245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1B5CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C16912B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181C1E34A70>]}
[0m16:58:47.220248 [debug] [MainThread]: Flushing usage events
[0m16:58:47.737052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:35.858467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CE836240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D1524BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D1524770>]}


============================== 16:59:35.864093 | fab9316c-513a-48a2-8c75-44a69c5abcb3 ==============================
[0m16:59:35.864093 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:59:35.864752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:59:36.061642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab9316c-513a-48a2-8c75-44a69c5abcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0A3C8F0>]}
[0m16:59:36.093443 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:59:36.094431 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:59:36.096427 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:36.096427 after 0.38 seconds
[0m16:59:36.097427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D122CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D16E5E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0A3C8F0>]}
[0m16:59:36.097427 [debug] [MainThread]: Flushing usage events
[0m16:59:36.609669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:51.960790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685513B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685513B080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026855139220>]}


============================== 17:01:51.964787 | 388cd363-d047-48f2-bf3f-e0d76d08654e ==============================
[0m17:01:51.964787 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:01:51.965787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:52.177665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '388cd363-d047-48f2-bf3f-e0d76d08654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026854D7AAE0>]}
[0m17:01:52.213075 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:01:52.214614 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:01:52.216308 [debug] [MainThread]: Command `dbt deps` succeeded at 17:01:52.215305 after 0.45 seconds
[0m17:01:52.216308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026854D7AAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268567F3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268555A1E50>]}
[0m17:01:52.217308 [debug] [MainThread]: Flushing usage events
[0m17:01:52.822450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:02.088161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011547568D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115475683E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011547568320>]}


============================== 17:05:02.094514 | 65a28940-b0c7-4c8c-9b6b-f17eeaf6eab1 ==============================
[0m17:05:02.094514 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:05:02.095032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:05:02.296919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a28940-b0c7-4c8c-9b6b-f17eeaf6eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001154777ED50>]}
[0m17:05:02.331190 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:05:02.346162 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-1mgo4thk'
[0m17:05:02.347163 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:02.529371 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:02.530374 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:02.648827 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:02.653845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m17:05:02.786425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m17:05:02.789422 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:05:02.909065 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:05:02.913081 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:03.474841 [info ] [MainThread]: Installed from version 1.3.0
[0m17:05:03.475840 [info ] [MainThread]: Up to date!
[0m17:05:03.476839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65a28940-b0c7-4c8c-9b6b-f17eeaf6eab1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115476F2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115477C3D10>]}
[0m17:05:03.476839 [info ] [MainThread]: Installing calogica/dbt_date
[0m17:05:03.807465 [info ] [MainThread]: Installed from version 0.10.1
[0m17:05:03.808467 [info ] [MainThread]: Up to date!
[0m17:05:03.809465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65a28940-b0c7-4c8c-9b6b-f17eeaf6eab1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115477C3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115477C1580>]}
[0m17:05:03.810465 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:05:04.139798 [info ] [MainThread]: Installed from version 0.13.1
[0m17:05:04.140798 [info ] [MainThread]: Up to date!
[0m17:05:04.141796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65a28940-b0c7-4c8c-9b6b-f17eeaf6eab1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001154777F170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001154777FF20>]}
[0m17:05:04.145794 [debug] [MainThread]: Command `dbt deps` succeeded at 17:05:04.144795 after 2.25 seconds
[0m17:05:04.146794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115474AA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001154791BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011546D1CEC0>]}
[0m17:05:04.147794 [debug] [MainThread]: Flushing usage events
[0m17:05:04.681993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:32.184052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA46065F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA48ABDB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA48ABC9E0>]}


============================== 17:05:32.191047 | 501f6498-63be-4ec5-b7ec-dd15601fb9ed ==============================
[0m17:05:32.191047 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:05:32.192048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:05:32.533851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501f6498-63be-4ec5-b7ec-dd15601fb9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA48D32F30>]}
[0m17:05:32.571829 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:05:32.713748 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-rydypxqh'
[0m17:05:32.714748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:53.881946 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:53.882945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:54.025132 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:54.033129 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m17:05:54.164361 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m17:05:54.168362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:06:27.803768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC57100B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC55C83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5711BE0>]}


============================== 17:06:27.810373 | c8fdd298-d7e0-4899-81ac-e8d4bb12de43 ==============================
[0m17:06:27.810373 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:06:27.811352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:27.844081 [info ] [MainThread]: dbt version: 1.9.1
[0m17:06:27.847079 [info ] [MainThread]: python version: 3.12.4
[0m17:06:27.848079 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m17:06:27.849079 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:06:27.986277 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m17:06:27.987275 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m17:06:27.988275 [info ] [MainThread]: Using dbt_project.yml file at C:\controle_gestion_dbt\dbt_project.yml
[0m17:06:27.990277 [info ] [MainThread]: adapter type: postgres
[0m17:06:27.991274 [info ] [MainThread]: adapter version: 1.9.0
[0m17:06:28.219143 [info ] [MainThread]: Configuration:
[0m17:06:28.221143 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:06:28.221143 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:06:28.222141 [info ] [MainThread]: Required dependencies:
[0m17:06:28.224141 [debug] [MainThread]: Executing "git --help"
[0m17:06:28.294100 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:06:28.295099 [debug] [MainThread]: STDERR: "b''"
[0m17:06:28.295099 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:06:28.297098 [info ] [MainThread]: Connection:
[0m17:06:28.298098 [info ] [MainThread]:   host: localhost
[0m17:06:28.298098 [info ] [MainThread]:   port: 5432
[0m17:06:28.299097 [info ] [MainThread]:   user: postgres
[0m17:06:28.300097 [info ] [MainThread]:   database: gestion
[0m17:06:28.300097 [info ] [MainThread]:   schema: public
[0m17:06:28.301095 [info ] [MainThread]:   connect_timeout: 10
[0m17:06:28.302095 [info ] [MainThread]:   role: None
[0m17:06:28.302095 [info ] [MainThread]:   search_path: None
[0m17:06:28.303095 [info ] [MainThread]:   keepalives_idle: 0
[0m17:06:28.304094 [info ] [MainThread]:   sslmode: None
[0m17:06:28.306094 [info ] [MainThread]:   sslcert: None
[0m17:06:28.307093 [info ] [MainThread]:   sslkey: None
[0m17:06:28.308091 [info ] [MainThread]:   sslrootcert: None
[0m17:06:28.310092 [info ] [MainThread]:   application_name: dbt
[0m17:06:28.311090 [info ] [MainThread]:   retries: 1
[0m17:06:28.313090 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:28.667886 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:06:28.782820 [debug] [MainThread]: Using postgres connection "debug"
[0m17:06:28.783819 [debug] [MainThread]: On debug: select 1 as id
[0m17:06:28.783819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:28.862776 [debug] [MainThread]: SQL status: SELECT 1 in 0.078 seconds
[0m17:06:28.863774 [debug] [MainThread]: On debug: Close
[0m17:06:28.864775 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:06:28.866773 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:06:28.869770 [debug] [MainThread]: Command `dbt debug` succeeded at 17:06:28.868771 after 1.23 seconds
[0m17:06:28.869770 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:06:28.870769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5955460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5434EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5A07BF0>]}
[0m17:06:28.871770 [debug] [MainThread]: Flushing usage events
[0m17:06:29.446651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:44.610605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290921C4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029094F249B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029094F24BC0>]}


============================== 17:06:44.615618 | 1894e57c-882d-4e96-9735-9010ade7ddc1 ==============================
[0m17:06:44.615618 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:06:44.617600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:44.831478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1894e57c-882d-4e96-9735-9010ade7ddc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029094F04560>]}
[0m17:06:44.871865 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-n_89uz0k'
[0m17:06:44.872865 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:45.099434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:45.100433 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:45.231168 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:45.236148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m17:06:45.371274 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m17:06:45.378293 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:06:45.487908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:06:45.489924 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:06:46.011863 [info ] [MainThread]: Installed from version 1.3.0
[0m17:06:46.012862 [info ] [MainThread]: Up to date!
[0m17:06:46.013861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1894e57c-882d-4e96-9735-9010ade7ddc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029096180DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029096183AA0>]}
[0m17:06:46.014860 [info ] [MainThread]: Installing calogica/dbt_date
[0m17:06:46.359663 [info ] [MainThread]: Installed from version 0.10.1
[0m17:06:46.360664 [info ] [MainThread]: Up to date!
[0m17:06:46.361662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1894e57c-882d-4e96-9735-9010ade7ddc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029096183BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029096180EF0>]}
[0m17:06:46.362661 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:06:46.697970 [info ] [MainThread]: Installed from version 0.13.1
[0m17:06:46.698967 [info ] [MainThread]: Up to date!
[0m17:06:46.700966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1894e57c-882d-4e96-9735-9010ade7ddc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909619A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909619A4B0>]}
[0m17:06:46.705964 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:46.704964 after 2.23 seconds
[0m17:06:46.706963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290947AA660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029094F24BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290960F35C0>]}
[0m17:06:46.707963 [debug] [MainThread]: Flushing usage events
[0m17:06:47.195768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:34.446702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158166A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FF197E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021581E246B0>]}


============================== 17:09:34.451685 | 8c8b5a91-7752-43ec-830e-bbcc63c255c8 ==============================
[0m17:09:34.451685 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:09:34.453685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select test_utils', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:34.763524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c8b5a91-7752-43ec-830e-bbcc63c255c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021581A6E9C0>]}
[0m17:09:34.857454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c8b5a91-7752-43ec-830e-bbcc63c255c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFBA7AD0>]}
[0m17:09:34.859453 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:35.180969 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:09:35.182951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:09:35.183956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c8b5a91-7752-43ec-830e-bbcc63c255c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215819E0980>]}
[0m17:09:37.676179 [error] [MainThread]: Encountered an error:
Compilation Error in model test_utils (models\staging\test_utils.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The management_control_project.test_utils model triggered this warning. 
  
  > in macro default__surrogate_key (macros\sql\surrogate_key.sql)
  > called by macro surrogate_key (macros\sql\surrogate_key.sql)
  > called by model test_utils (models\staging\test_utils.sql)
[0m17:09:37.679815 [debug] [MainThread]: Command `dbt run` failed at 17:09:37.679815 after 3.43 seconds
[0m17:09:37.679815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021581C3A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021583570050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021583752A20>]}
[0m17:09:37.680815 [debug] [MainThread]: Flushing usage events
[0m17:09:38.267922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:03.968571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B780F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B79B06B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B4EF41A0>]}


============================== 17:10:03.975582 | 00e9d25b-f4a4-4f0d-8a32-146d034730da ==============================
[0m17:10:03.975582 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:10:03.976563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select test_utils', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:04.300377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B510D040>]}
[0m17:10:04.403320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B6D7E420>]}
[0m17:10:04.405059 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:04.710567 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:10:04.712566 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:10:04.713383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B7E98950>]}
[0m17:10:08.305966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B9A32120>]}
[0m17:10:08.534837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:10:08.542724 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:10:08.590899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B9A25400>]}
[0m17:10:08.591902 [info ] [MainThread]: Found 5 models, 1 snapshot, 14 data tests, 1 seed, 1 source, 702 macros
[0m17:10:08.592830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B9A6C380>]}
[0m17:10:08.595604 [info ] [MainThread]: 
[0m17:10:08.596589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:08.597587 [info ] [MainThread]: 
[0m17:10:08.598586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:08.600586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m17:10:08.688537 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m17:10:08.689536 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m17:10:08.689536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:08.737173 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.047 seconds
[0m17:10:08.741908 [debug] [ThreadPool]: On list_gestion: Close
[0m17:10:08.747904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m17:10:08.754918 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:10:08.754918 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:10:08.757899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:08.906526 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m17:10:08.907517 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:10:08.908535 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:10:08.918512 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m17:10:08.920511 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:10:08.921511 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:10:08.922509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m17:10:08.925507 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:10:08.925507 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:10:08.926507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:08.975480 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m17:10:08.976480 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:10:08.977479 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:10:08.985474 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:10:08.987473 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:10:08.988472 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:10:08.989471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m17:10:08.992469 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:10:08.992469 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:10:08.993469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:09.040442 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m17:10:09.041443 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:10:09.042442 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:10:09.049437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:10:09.051436 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:10:09.052436 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:10:09.053434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m17:10:09.056433 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:10:09.057433 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:10:09.058432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:09.101410 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:10:09.101410 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:10:09.102408 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:10:09.109402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:10:09.111402 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:10:09.112401 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:10:09.113400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m17:10:09.116399 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:10:09.117397 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:10:09.118397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:09.162371 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:10:09.163373 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:10:09.163373 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:10:09.171369 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:10:09.173367 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:10:09.173367 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:10:09.180363 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.180363 [debug] [MainThread]: On master: BEGIN
[0m17:10:09.181363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:09.226625 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:10:09.226625 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.227639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:09.240265 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m17:10:09.242283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B7E52180>]}
[0m17:10:09.243281 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:09.243281 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.244281 [debug] [MainThread]: On master: BEGIN
[0m17:10:09.245263 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:10:09.245263 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.246261 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.246261 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.247260 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:09.247260 [debug] [MainThread]: On master: Close
[0m17:10:09.252494 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m17:10:09.253499 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.test_utils ................... [RUN]
[0m17:10:09.254308 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.test_utils'
[0m17:10:09.255319 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m17:10:09.266305 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m17:10:09.268832 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m17:10:09.336809 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m17:10:09.339591 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m17:10:09.340590 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m17:10:09.340590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:09.383893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:10:09.384908 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m17:10:09.385910 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m17:10:09.405842 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.019 seconds
[0m17:10:09.432828 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m17:10:09.433826 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m17:10:09.434827 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m17:10:09.436827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:09.438826 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m17:10:09.442824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e9d25b-f4a4-4f0d-8a32-146d034730da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B990B4D0>]}
[0m17:10:09.443822 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.19s]
[0m17:10:09.445820 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m17:10:09.447818 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.448818 [debug] [MainThread]: On master: BEGIN
[0m17:10:09.449818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:09.608506 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m17:10:09.609507 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.609507 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.610506 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.610506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:09.611505 [debug] [MainThread]: On master: Close
[0m17:10:09.611505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:09.612503 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m17:10:09.613504 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m17:10:09.614502 [debug] [MainThread]: Connection 'model.management_control_project.test_utils' was properly closed.
[0m17:10:09.615520 [info ] [MainThread]: 
[0m17:10:09.616171 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m17:10:09.617010 [debug] [MainThread]: Command end result
[0m17:10:09.660007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:10:09.662988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:10:09.673052 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:10:09.674055 [info ] [MainThread]: 
[0m17:10:09.675055 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:09.676055 [info ] [MainThread]: 
[0m17:10:09.677066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:10:09.678053 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:09.678053 after 5.88 seconds
[0m17:10:09.679070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B7CB1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B9A7BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1B7B092B0>]}
[0m17:10:09.680054 [debug] [MainThread]: Flushing usage events
[0m17:10:10.182624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:44.080821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284ABB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284ABB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284ABB350>]}


============================== 17:11:44.086802 | 8202578f-4038-47ae-bcf3-ed3ee39d90e2 ==============================
[0m17:11:44.086802 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:11:44.087801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select control_summary', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:44.389630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528515BE60>]}
[0m17:11:44.486592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284E12B70>]}
[0m17:11:44.488591 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:11:44.774410 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:11:45.090722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:45.091704 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\marts\management_control\schema.yaml
[0m17:11:45.770318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286A90230>]}
[0m17:11:45.920229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:11:45.925226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:11:45.976670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286DDB920>]}
[0m17:11:45.977672 [info ] [MainThread]: Found 5 models, 1 snapshot, 15 data tests, 1 seed, 1 source, 702 macros
[0m17:11:45.978671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286DA9820>]}
[0m17:11:45.982669 [info ] [MainThread]: 
[0m17:11:45.983479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:45.984550 [info ] [MainThread]: 
[0m17:11:45.986556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:45.991832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m17:11:46.159738 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:11:46.160739 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:11:46.160739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:46.208170 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m17:11:46.208170 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:11:46.209169 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:11:46.216150 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m17:11:46.218168 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:11:46.219151 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:11:46.220148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m17:11:46.223165 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:11:46.224165 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:11:46.224165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:46.268136 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:11:46.269123 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:11:46.270121 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:11:46.277132 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:11:46.279116 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:11:46.280116 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:11:46.281114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m17:11:46.283132 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:11:46.284131 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:11:46.285130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:46.330698 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:11:46.330698 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:11:46.331699 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:11:46.340199 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:11:46.342184 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:11:46.343183 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:11:46.344184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m17:11:46.347199 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:11:46.347199 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:11:46.348198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:46.393818 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:11:46.394832 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:11:46.394832 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:11:46.403952 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:11:46.405965 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:11:46.405965 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:11:46.406969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m17:11:46.411179 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:11:46.411179 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:11:46.412178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:46.460755 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m17:11:46.460755 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:11:46.461751 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:11:46.470765 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:11:46.472781 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:11:46.472781 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:11:46.480777 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.481776 [debug] [MainThread]: On master: BEGIN
[0m17:11:46.481776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:46.526735 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:11:46.527732 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.527732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:46.537730 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:11:46.538740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8202578f-4038-47ae-bcf3-ed3ee39d90e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528246A4B0>]}
[0m17:11:46.539743 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:46.540726 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.540726 [debug] [MainThread]: On master: BEGIN
[0m17:11:46.541742 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:11:46.541742 [debug] [MainThread]: On master: COMMIT
[0m17:11:46.542723 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.542723 [debug] [MainThread]: On master: COMMIT
[0m17:11:46.543723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:46.543723 [debug] [MainThread]: On master: Close
[0m17:11:46.546721 [debug] [Thread-1 (]: Began running node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:46.547721 [info ] [Thread-1 (]: 1 of 3 START test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0  [RUN]
[0m17:11:46.548720 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956'
[0m17:11:46.549719 [debug] [Thread-1 (]: Began compiling node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:46.758621 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:46.759628 [error] [Thread-1 (]: 1 of 3 ERROR dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0  [[31mERROR[0m in 0.21s]
[0m17:11:46.761638 [debug] [Thread-1 (]: Finished running node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:46.761638 [debug] [Thread-1 (]: Began running node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:46.762640 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:11:46.763642 [info ] [Thread-1 (]: 2 of 3 START test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id  [RUN]
[0m17:11:46.765620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956, now test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916)
[0m17:11:46.766621 [debug] [Thread-1 (]: Began compiling node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:46.773618 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:46.774617 [error] [Thread-1 (]: 2 of 3 ERROR dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id  [[31mERROR[0m in 0.01s]
[0m17:11:46.776615 [debug] [Thread-1 (]: Finished running node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:46.777615 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m17:11:46.778614 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:11:46.779628 [info ] [Thread-1 (]: 3 of 3 START test duplicate_control_entries .................................... [RUN]
[0m17:11:46.781613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916, now test.management_control_project.duplicate_control_entries)
[0m17:11:46.782629 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m17:11:46.813440 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m17:11:46.815434 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m17:11:46.841437 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m17:11:46.842419 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:11:46.844434 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m17:11:46.844434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:46.889018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:11:46.890017 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:11:46.890017 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_year, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_year
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m17:11:46.892996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:11:46.897997 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m17:11:46.898997 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m17:11:46.899997 [warn ] [Thread-1 (]: 3 of 3 WARN 1 duplicate_control_entries ........................................ [[33mWARN 1[0m in 0.12s]
[0m17:11:46.900995 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m17:11:46.902995 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.902995 [debug] [MainThread]: On master: BEGIN
[0m17:11:46.903993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:47.048451 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m17:11:47.049450 [debug] [MainThread]: On master: COMMIT
[0m17:11:47.049450 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:47.050449 [debug] [MainThread]: On master: COMMIT
[0m17:11:47.050449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:47.051467 [debug] [MainThread]: On master: Close
[0m17:11:47.051467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:47.052448 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m17:11:47.053448 [debug] [MainThread]: Connection 'test.management_control_project.duplicate_control_entries' was properly closed.
[0m17:11:47.053448 [info ] [MainThread]: 
[0m17:11:47.054597 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m17:11:47.055601 [debug] [MainThread]: Command end result
[0m17:11:47.099593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:11:47.102575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:11:47.111587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:11:47.112568 [info ] [MainThread]: 
[0m17:11:47.113567 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 1 warning:[0m
[0m17:11:47.114568 [info ] [MainThread]: 
[0m17:11:47.115567 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:47.116566 [info ] [MainThread]: 
[0m17:11:47.117568 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:47.120469 [info ] [MainThread]: 
[0m17:11:47.122349 [warn ] [MainThread]: [33mWarning in test duplicate_control_entries (tests\duplicate_control_entries.sql)[0m
[0m17:11:47.123364 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:11:47.123364 [info ] [MainThread]: 
[0m17:11:47.124346 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\tests\duplicate_control_entries.sql
[0m17:11:47.126345 [info ] [MainThread]: 
[0m17:11:47.127346 [info ] [MainThread]: Done. PASS=0 WARN=1 ERROR=2 SKIP=0 TOTAL=3
[0m17:11:47.128780 [debug] [MainThread]: Command `dbt test` failed at 17:11:47.128780 after 3.25 seconds
[0m17:11:47.128780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015283CC2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284954860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015284F221B0>]}
[0m17:11:47.129779 [debug] [MainThread]: Flushing usage events
[0m17:11:47.694422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:51.455780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049ECD3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049EB09DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049EB09520>]}


============================== 17:11:51.462775 | c7e607f5-dfc7-4245-85a5-185dcb0bde82 ==============================
[0m17:11:51.462775 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:11:51.464777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select control_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:11:52.147384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049ECF47D0>]}
[0m17:11:52.257338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049EE6A6F0>]}
[0m17:11:52.258320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:11:52.593581 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:11:52.916414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:52.917395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:53.009361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A0043FB0>]}
[0m17:11:53.171252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:11:53.175249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:11:53.225342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A08A0590>]}
[0m17:11:53.226347 [info ] [MainThread]: Found 5 models, 1 snapshot, 15 data tests, 1 seed, 1 source, 702 macros
[0m17:11:53.227329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A066BE90>]}
[0m17:11:53.229345 [info ] [MainThread]: 
[0m17:11:53.230654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:53.231658 [info ] [MainThread]: 
[0m17:11:53.232475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:53.239474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m17:11:53.332553 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:11:53.332553 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:11:53.333557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:53.486986 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m17:11:53.487993 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:11:53.487993 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:11:53.496666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:11:53.498683 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:11:53.499665 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:11:53.500664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m17:11:53.504675 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:11:53.505660 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:11:53.505660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:53.552779 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m17:11:53.553779 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:11:53.554779 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:11:53.562788 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m17:11:53.564773 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:11:53.565772 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:11:53.566775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m17:11:53.570767 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:11:53.571766 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:11:53.571766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:53.615744 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:11:53.616761 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:11:53.617759 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:11:53.624738 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m17:11:53.626754 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:11:53.626754 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:11:53.627753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m17:11:53.630751 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:11:53.631751 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:11:53.631751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:53.675723 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:11:53.675723 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:11:53.676722 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:11:53.684704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:11:53.686703 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:11:53.686703 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:11:53.687720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m17:11:53.692698 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:11:53.692698 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:11:53.693697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:53.740382 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:11:53.740382 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:11:53.741395 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:11:53.749391 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:11:53.751374 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:11:53.752374 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:11:53.758370 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:53.759369 [debug] [MainThread]: On master: BEGIN
[0m17:11:53.759369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:53.810341 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m17:11:53.811355 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:53.812339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:53.821334 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:11:53.823332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e607f5-dfc7-4245-85a5-185dcb0bde82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A0BC60C0>]}
[0m17:11:53.823332 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:53.824333 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:53.824333 [debug] [MainThread]: On master: BEGIN
[0m17:11:53.825332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:11:53.826332 [debug] [MainThread]: On master: COMMIT
[0m17:11:53.826332 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:53.827331 [debug] [MainThread]: On master: COMMIT
[0m17:11:53.827331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:53.828330 [debug] [MainThread]: On master: Close
[0m17:11:53.830329 [debug] [Thread-1 (]: Began running node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:53.831329 [info ] [Thread-1 (]: 1 of 3 START test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0  [RUN]
[0m17:11:53.833327 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956'
[0m17:11:53.834327 [debug] [Thread-1 (]: Began compiling node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:53.855314 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:53.857315 [error] [Thread-1 (]: 1 of 3 ERROR dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0  [[31mERROR[0m in 0.02s]
[0m17:11:53.859012 [debug] [Thread-1 (]: Finished running node test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956
[0m17:11:53.859989 [debug] [Thread-1 (]: Began running node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:53.859989 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:11:53.860986 [info ] [Thread-1 (]: 2 of 3 START test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id  [RUN]
[0m17:11:53.863000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0.292a017956, now test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916)
[0m17:11:53.863988 [debug] [Thread-1 (]: Began compiling node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:53.872982 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:53.874001 [error] [Thread-1 (]: 2 of 3 ERROR dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id  [[31mERROR[0m in 0.01s]
[0m17:11:53.875979 [debug] [Thread-1 (]: Finished running node test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916
[0m17:11:53.876979 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m17:11:53.876979 [debug] [Thread-4 (]: Marking all children of 'test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:11:53.877978 [info ] [Thread-1 (]: 3 of 3 START test duplicate_control_entries .................................... [RUN]
[0m17:11:53.878976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id.5f032c1916, now test.management_control_project.duplicate_control_entries)
[0m17:11:53.879977 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m17:11:53.882993 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m17:11:53.884975 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m17:11:53.906979 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m17:11:53.908961 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:11:53.909977 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m17:11:53.909977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:53.956947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:11:53.957932 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:11:53.957932 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_year, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_year
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m17:11:53.959931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:11:53.965928 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m17:11:53.966926 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m17:11:53.967928 [warn ] [Thread-1 (]: 3 of 3 WARN 1 duplicate_control_entries ........................................ [[33mWARN 1[0m in 0.09s]
[0m17:11:53.969943 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m17:11:53.971938 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:53.971938 [debug] [MainThread]: On master: BEGIN
[0m17:11:53.972925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:54.125566 [debug] [MainThread]: SQL status: BEGIN in 0.152 seconds
[0m17:11:54.126580 [debug] [MainThread]: On master: COMMIT
[0m17:11:54.126580 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:54.127583 [debug] [MainThread]: On master: COMMIT
[0m17:11:54.127583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:54.128582 [debug] [MainThread]: On master: Close
[0m17:11:54.129565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:54.129565 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m17:11:54.130581 [debug] [MainThread]: Connection 'test.management_control_project.duplicate_control_entries' was properly closed.
[0m17:11:54.131580 [info ] [MainThread]: 
[0m17:11:54.132561 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m17:11:54.134134 [debug] [MainThread]: Command end result
[0m17:11:54.174091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:11:54.177090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:11:54.185086 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:11:54.186088 [info ] [MainThread]: 
[0m17:11:54.187085 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 1 warning:[0m
[0m17:11:54.188086 [info ] [MainThread]: 
[0m17:11:54.189098 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_control_summary_total_revenue__0 (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:54.191085 [info ] [MainThread]: 
[0m17:11:54.191572 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_unique_control_summary_control_id (models\marts\management_control\schema.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:11:54.193746 [info ] [MainThread]: 
[0m17:11:54.194232 [warn ] [MainThread]: [33mWarning in test duplicate_control_entries (tests\duplicate_control_entries.sql)[0m
[0m17:11:54.195253 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:11:54.196286 [info ] [MainThread]: 
[0m17:11:54.197214 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\tests\duplicate_control_entries.sql
[0m17:11:54.198086 [info ] [MainThread]: 
[0m17:11:54.199311 [info ] [MainThread]: Done. PASS=0 WARN=1 ERROR=2 SKIP=0 TOTAL=3
[0m17:11:54.201333 [debug] [MainThread]: Command `dbt test` failed at 17:11:54.201333 after 3.05 seconds
[0m17:11:54.202330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049E1C4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049E18B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049E18A990>]}
[0m17:11:54.203312 [debug] [MainThread]: Flushing usage events
[0m17:11:59.745611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:54.347812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7451A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF740FC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF740FCE00>]}


============================== 17:12:54.354053 | 1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630 ==============================
[0m17:12:54.354053 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:12:54.355071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:54.667540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF749C54C0>]}
[0m17:12:54.766467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF74B39D60>]}
[0m17:12:54.768466 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:55.068310 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:12:55.394123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:55.395105 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\marts\management_control\schema.yaml
[0m17:12:55.979772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF76542ED0>]}
[0m17:12:56.161668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:12:56.167666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:12:56.225632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7678CC50>]}
[0m17:12:56.226631 [info ] [MainThread]: Found 5 models, 1 snapshot, 13 data tests, 1 seed, 1 source, 702 macros
[0m17:12:56.226631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF76737590>]}
[0m17:12:56.229628 [info ] [MainThread]: 
[0m17:12:56.230628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:56.231627 [info ] [MainThread]: 
[0m17:12:56.231627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:56.237625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m17:12:56.361552 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:12:56.363551 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:12:56.364550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:56.534455 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m17:12:56.535453 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:12:56.536453 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:12:56.545448 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:12:56.547446 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:12:56.548446 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:12:56.549446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m17:12:56.554442 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:12:56.555442 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:12:56.556441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:56.724693 [debug] [ThreadPool]: SQL status: BEGIN in 0.169 seconds
[0m17:12:56.725693 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:12:56.727692 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:12:56.735688 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m17:12:56.738685 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:12:56.739685 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:12:56.740685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m17:12:56.748681 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:12:56.749680 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:12:56.750679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:56.805648 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m17:12:56.806647 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:12:56.807646 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:12:56.814642 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:12:56.901594 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:12:56.902593 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:12:56.903593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m17:12:56.907591 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:12:56.908591 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:12:56.909589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:57.075494 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m17:12:57.076492 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:12:57.077491 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:12:57.084487 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:12:57.086489 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:12:57.087488 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:12:57.088486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m17:12:57.092483 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:12:57.093483 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:12:57.093483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:57.142455 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m17:12:57.143454 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:12:57.144453 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:12:57.154448 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m17:12:57.157446 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:12:57.159445 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:12:57.171439 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:57.173437 [debug] [MainThread]: On master: BEGIN
[0m17:12:57.174438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:57.223412 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:12:57.224408 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:57.225407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:57.236401 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m17:12:57.238400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f0d2f30-dc9d-4096-8f74-e2cdd3f9f630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF71E6A810>]}
[0m17:12:57.239399 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:57.241398 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:57.242398 [debug] [MainThread]: On master: BEGIN
[0m17:12:57.242398 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:12:57.243398 [debug] [MainThread]: On master: COMMIT
[0m17:12:57.244397 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:57.244397 [debug] [MainThread]: On master: COMMIT
[0m17:12:57.245397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:57.246396 [debug] [MainThread]: On master: Close
[0m17:12:57.249393 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:12:57.251393 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m17:12:57.252392 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m17:12:57.253391 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:12:57.284374 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:12:57.289370 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:12:57.328349 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:12:57.331346 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:12:57.332346 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m17:12:57.333346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:57.496254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m17:12:57.498252 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:12:57.498252 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m17:12:57.501250 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:57.508246 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m17:12:57.509244 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m17:12:57.511244 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.26s]
[0m17:12:57.512243 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:12:57.513243 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m17:12:57.514243 [info ] [Thread-1 (]: 2 of 13 START test duplicate_control_entries ................................... [RUN]
[0m17:12:57.515242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m17:12:57.516242 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m17:12:57.521238 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m17:12:57.523238 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m17:12:57.530239 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m17:12:57.532232 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:12:57.534231 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m17:12:57.535232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.595196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m17:12:57.596195 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:12:57.597195 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_year, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_year
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m17:12:57.601193 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:12:57.604192 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m17:12:57.606190 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m17:12:57.607189 [warn ] [Thread-1 (]: 2 of 13 WARN 1 duplicate_control_entries ....................................... [[33mWARN 1[0m in 0.09s]
[0m17:12:57.610188 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m17:12:57.611187 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:12:57.612186 [info ] [Thread-1 (]: 3 of 13 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m17:12:57.614185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m17:12:57.614185 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:12:57.625179 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:12:57.627179 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:12:57.635172 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:12:57.638171 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:12:57.639171 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m17:12:57.640170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.689145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:12:57.690141 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:12:57.691140 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m17:12:57.693140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:12:57.696139 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m17:12:57.697138 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m17:12:57.698136 [info ] [Thread-1 (]: 3 of 13 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.08s]
[0m17:12:57.700136 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:12:57.701136 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:12:57.702135 [info ] [Thread-1 (]: 4 of 13 START test not_null_int_management_control_net_profit .................. [RUN]
[0m17:12:57.703134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m17:12:57.704134 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:12:57.710130 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:12:57.712129 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:12:57.718127 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:12:57.722123 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:12:57.725121 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m17:12:57.726121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.820067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m17:12:57.821067 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:12:57.823066 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m17:12:57.827065 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:57.831060 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m17:12:57.835059 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m17:12:57.837058 [info ] [Thread-1 (]: 4 of 13 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.13s]
[0m17:12:57.843054 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:12:57.844056 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:12:57.846052 [info ] [Thread-1 (]: 5 of 13 START test not_null_management_control_snapshot_updated_at ............. [RUN]
[0m17:12:57.847051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m17:12:57.849051 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:12:57.864042 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:12:57.873038 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:12:57.881033 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:12:57.896024 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:12:57.897023 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: BEGIN
[0m17:12:57.901024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.998965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m17:12:58.000965 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:12:58.001963 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select updated_at
from "gestion"."snapshots"."management_control_snapshot"
where updated_at is null



      
    ) dbt_internal_test
[0m17:12:58.005961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:12:58.009958 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: ROLLBACK
[0m17:12:58.010957 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: Close
[0m17:12:58.012957 [info ] [Thread-1 (]: 5 of 13 PASS not_null_management_control_snapshot_updated_at ................... [[32mPASS[0m in 0.17s]
[0m17:12:58.015955 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:12:58.016955 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:12:58.018954 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_management_control_control_date ................ [RUN]
[0m17:12:58.020952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m17:12:58.022952 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:12:58.036943 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:12:58.040941 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:12:58.046936 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:12:58.049937 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:12:58.051935 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m17:12:58.053936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.156874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m17:12:58.159876 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:12:58.161873 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m17:12:58.165869 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:58.168868 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m17:12:58.170867 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m17:12:58.171866 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_management_control_control_date ...................... [[32mPASS[0m in 0.15s]
[0m17:12:58.185858 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:12:58.186857 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:12:58.187857 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_management_control_control_id .................. [RUN]
[0m17:12:58.192854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m17:12:58.193853 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:12:58.205847 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:12:58.209844 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:12:58.215840 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:12:58.220839 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:12:58.221839 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m17:12:58.222836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.304790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m17:12:58.305789 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:12:58.306788 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m17:12:58.308787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:58.311786 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m17:12:58.312785 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m17:12:58.314784 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_management_control_control_id ........................ [[32mPASS[0m in 0.12s]
[0m17:12:58.316784 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:12:58.317782 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:12:58.318782 [info ] [Thread-1 (]: 8 of 13 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m17:12:58.319782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m17:12:58.319782 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:12:58.326778 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:12:58.328776 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:12:58.335772 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:12:58.339775 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:12:58.341772 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m17:12:58.342769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.412730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m17:12:58.413728 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:12:58.414727 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m17:12:58.418724 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:12:58.421723 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m17:12:58.423721 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m17:12:58.424721 [info ] [Thread-1 (]: 8 of 13 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.11s]
[0m17:12:58.427719 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:12:58.429718 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:12:58.430717 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_management_control_control_date ......... [RUN]
[0m17:12:58.433716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m17:12:58.434715 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:12:58.445709 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:12:58.449707 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:12:58.455703 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:12:58.457702 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:12:58.458702 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m17:12:58.459701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.519667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m17:12:58.520667 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:12:58.521666 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m17:12:58.523664 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:12:58.526664 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m17:12:58.527662 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m17:12:58.528663 [info ] [Thread-1 (]: 9 of 13 PASS source_not_null_raw_management_control_control_date ............... [[32mPASS[0m in 0.09s]
[0m17:12:58.530661 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:12:58.531660 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:12:58.532659 [info ] [Thread-1 (]: 10 of 13 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m17:12:58.533658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m17:12:58.534658 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:12:58.540655 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:12:58.542655 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:12:58.551653 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:12:58.553647 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:12:58.554647 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m17:12:58.555649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.609616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:12:58.611614 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:12:58.611614 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m17:12:58.613613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:12:58.616612 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m17:12:58.617611 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m17:12:58.618610 [info ] [Thread-1 (]: 10 of 13 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.08s]
[0m17:12:58.621609 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:12:58.621609 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:12:58.622608 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m17:12:58.623607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m17:12:58.624607 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:12:58.632603 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:12:58.635601 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:12:58.642597 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:12:58.645595 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:12:58.646594 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m17:12:58.647593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.716556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m17:12:58.717555 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:12:58.719555 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:12:58.723551 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:12:58.725550 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m17:12:58.726549 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m17:12:58.727547 [info ] [Thread-1 (]: 11 of 13 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.10s]
[0m17:12:58.729546 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:12:58.730545 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:12:58.732546 [info ] [Thread-1 (]: 12 of 13 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m17:12:58.733546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m17:12:58.735550 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:12:58.744540 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:12:58.746537 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:12:58.753536 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:12:58.756533 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:12:58.757531 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m17:12:58.758531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.814498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m17:12:58.816497 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:12:58.817496 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:12:58.820496 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:58.823494 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m17:12:58.824492 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m17:12:58.825491 [info ] [Thread-1 (]: 12 of 13 PASS unique_management_control_snapshot_control_id .................... [[32mPASS[0m in 0.09s]
[0m17:12:58.828490 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:12:58.828490 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:12:58.829489 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_management_control_control_id ................... [RUN]
[0m17:12:58.830489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m17:12:58.831488 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:12:58.841483 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:12:58.843481 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:12:58.849480 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:12:58.851477 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:12:58.853476 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m17:12:58.854476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.921437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m17:12:58.922436 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:12:58.923435 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:12:58.926434 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:12:58.929432 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m17:12:58.931431 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m17:12:58.932431 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.10s]
[0m17:12:58.935429 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:12:58.938427 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:58.939427 [debug] [MainThread]: On master: BEGIN
[0m17:12:58.939427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:59.002390 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m17:12:59.003390 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.004389 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.005388 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.006388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:59.006388 [debug] [MainThread]: On master: Close
[0m17:12:59.008387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:59.008387 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m17:12:59.009386 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m17:12:59.010385 [info ] [MainThread]: 
[0m17:12:59.011385 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m17:12:59.017383 [debug] [MainThread]: Command end result
[0m17:12:59.075350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:12:59.079346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:12:59.090339 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:12:59.091339 [info ] [MainThread]: 
[0m17:12:59.092339 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:12:59.093339 [info ] [MainThread]: 
[0m17:12:59.094338 [warn ] [MainThread]: [33mWarning in test duplicate_control_entries (tests\duplicate_control_entries.sql)[0m
[0m17:12:59.096337 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:12:59.097336 [info ] [MainThread]: 
[0m17:12:59.099337 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\tests\duplicate_control_entries.sql
[0m17:12:59.101335 [info ] [MainThread]: 
[0m17:12:59.102334 [info ] [MainThread]: Done. PASS=12 WARN=1 ERROR=0 SKIP=0 TOTAL=13
[0m17:12:59.107337 [debug] [MainThread]: Command `dbt test` succeeded at 17:12:59.106333 after 4.92 seconds
[0m17:12:59.108330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF745ED880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF71E6A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7678EFC0>]}
[0m17:12:59.109329 [debug] [MainThread]: Flushing usage events
[0m17:13:03.010654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:36.626006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC31C49F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2F2F45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2F2F4AD0>]}


============================== 17:14:36.631998 | ec517a16-a201-4c07-a362-ffe12044a882 ==============================
[0m17:14:36.631998 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:14:36.632980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:14:36.933408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC322D8E90>]}
[0m17:14:37.032353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC31E5FFE0>]}
[0m17:14:37.033353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:37.332198 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:14:37.618034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:14:37.619016 [debug] [MainThread]: Partial parsing: updated file: management_control_project://tests\duplicate_control_entries.sql
[0m17:14:37.898856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC33A4E1B0>]}
[0m17:14:38.034778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:14:38.039775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:14:38.083768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC33D1C680>]}
[0m17:14:38.084768 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 13 data tests, 1 source, 702 macros
[0m17:14:38.085751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3158A720>]}
[0m17:14:38.087750 [info ] [MainThread]: 
[0m17:14:38.088749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:38.089750 [info ] [MainThread]: 
[0m17:14:38.090748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:38.095746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m17:14:38.188692 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:14:38.189691 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:14:38.189691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:38.349511 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m17:14:38.349511 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:14:38.350528 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:14:38.358890 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:14:38.360908 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:14:38.361890 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:14:38.361890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m17:14:38.366075 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:14:38.366075 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:14:38.367074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:38.519472 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m17:14:38.520470 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:14:38.520470 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:14:38.529425 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:14:38.531442 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:14:38.531442 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:14:38.533424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m17:14:38.536422 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:14:38.537421 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:14:38.537421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:38.580480 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:14:38.580480 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:14:38.581481 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:14:38.590150 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:14:38.592168 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:14:38.593149 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:14:38.593149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m17:14:38.597146 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:14:38.597146 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:14:38.598146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:38.739431 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m17:14:38.739431 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:14:38.740444 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:14:38.748623 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:14:38.750640 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:14:38.750640 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:14:38.751640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m17:14:38.755633 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:14:38.755633 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:14:38.756637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:38.803735 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m17:14:38.804734 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:14:38.804734 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:14:38.812729 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:14:38.814730 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:14:38.814730 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:14:38.821726 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:38.822728 [debug] [MainThread]: On master: BEGIN
[0m17:14:38.822728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:38.868699 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m17:14:38.869716 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:38.869716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:14:38.879691 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:14:38.881690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec517a16-a201-4c07-a362-ffe12044a882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC323274A0>]}
[0m17:14:38.882690 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:38.883689 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:38.884688 [debug] [MainThread]: On master: BEGIN
[0m17:14:38.884688 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:14:38.885687 [debug] [MainThread]: On master: COMMIT
[0m17:14:38.885687 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:38.886687 [debug] [MainThread]: On master: COMMIT
[0m17:14:38.887686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:38.887686 [debug] [MainThread]: On master: Close
[0m17:14:38.890684 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:38.892702 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m17:14:38.894682 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m17:14:38.896682 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:38.923666 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:14:38.924665 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:38.946671 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:14:38.947654 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:14:38.948655 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m17:14:38.948655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:38.995625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:14:38.996626 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:14:38.997624 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m17:14:38.999623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:39.004620 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m17:14:39.005620 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m17:14:39.006618 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.11s]
[0m17:14:39.007617 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:39.008619 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m17:14:39.009618 [info ] [Thread-1 (]: 2 of 13 START test duplicate_control_entries ................................... [RUN]
[0m17:14:39.010616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m17:14:39.010616 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m17:14:39.014614 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m17:14:39.015614 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m17:14:39.022609 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m17:14:39.024608 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:14:39.025607 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m17:14:39.025607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.071965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:14:39.072964 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m17:14:39.073962 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m17:14:39.075975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:39.077960 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m17:14:39.078959 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m17:14:39.079958 [info ] [Thread-1 (]: 2 of 13 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.07s]
[0m17:14:39.080958 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m17:14:39.081958 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:39.082956 [info ] [Thread-1 (]: 3 of 13 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m17:14:39.083956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m17:14:39.083956 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:39.091969 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:14:39.093952 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:39.100946 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:14:39.102947 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:14:39.103945 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m17:14:39.104945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.148920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:14:39.149919 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:14:39.149919 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m17:14:39.151917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.154917 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m17:14:39.155916 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m17:14:39.156915 [info ] [Thread-1 (]: 3 of 13 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.07s]
[0m17:14:39.157915 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:39.158914 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:39.159913 [info ] [Thread-1 (]: 4 of 13 START test not_null_int_management_control_net_profit .................. [RUN]
[0m17:14:39.160912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m17:14:39.160912 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:39.165909 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:14:39.166908 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:39.169906 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:14:39.170906 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:14:39.171906 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m17:14:39.172906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.220886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:14:39.221885 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:14:39.221885 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m17:14:39.223883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.226881 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m17:14:39.226881 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m17:14:39.227880 [info ] [Thread-1 (]: 4 of 13 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.07s]
[0m17:14:39.229881 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:39.229881 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:39.230879 [info ] [Thread-1 (]: 5 of 13 START test not_null_management_control_snapshot_updated_at ............. [RUN]
[0m17:14:39.231879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m17:14:39.231879 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:39.237875 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:14:39.239874 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:39.243871 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:14:39.245870 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:14:39.245870 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: BEGIN
[0m17:14:39.246870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.294842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:14:39.294842 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:14:39.295842 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select updated_at
from "gestion"."snapshots"."management_control_snapshot"
where updated_at is null



      
    ) dbt_internal_test
[0m17:14:39.297841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.299839 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: ROLLBACK
[0m17:14:39.300838 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: Close
[0m17:14:39.300838 [info ] [Thread-1 (]: 5 of 13 PASS not_null_management_control_snapshot_updated_at ................... [[32mPASS[0m in 0.07s]
[0m17:14:39.302838 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:39.303837 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:39.304837 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_management_control_control_date ................ [RUN]
[0m17:14:39.305836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m17:14:39.305836 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:39.378795 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:14:39.379794 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:39.382793 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:14:39.383793 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:14:39.384792 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m17:14:39.385808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.533230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m17:14:39.534245 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:14:39.534245 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m17:14:39.536562 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.538577 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m17:14:39.539581 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m17:14:39.540563 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_management_control_control_date ...................... [[32mPASS[0m in 0.23s]
[0m17:14:39.541562 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:39.542562 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:39.543560 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_management_control_control_id .................. [RUN]
[0m17:14:39.544139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m17:14:39.545156 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:39.551158 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:14:39.552159 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:39.557134 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:14:39.558148 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:14:39.559133 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m17:14:39.560151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.606795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:14:39.606795 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:14:39.607797 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m17:14:39.609793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.611795 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m17:14:39.612794 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m17:14:39.613810 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_management_control_control_id ........................ [[32mPASS[0m in 0.07s]
[0m17:14:39.615791 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:39.616789 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:39.616789 [info ] [Thread-1 (]: 8 of 13 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m17:14:39.618791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m17:14:39.618791 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:39.624803 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:14:39.626784 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:39.629801 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:14:39.631781 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:14:39.631781 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m17:14:39.632799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.682769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:14:39.682769 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:14:39.683770 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m17:14:39.686767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:39.688751 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m17:14:39.689750 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m17:14:39.690747 [info ] [Thread-1 (]: 8 of 13 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.07s]
[0m17:14:39.692747 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:39.693746 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:39.693746 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_management_control_control_date ......... [RUN]
[0m17:14:39.694765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m17:14:39.695746 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:39.700743 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:14:39.701743 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:39.707738 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:14:39.708736 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:14:39.709736 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m17:14:39.710737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.761113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:14:39.762126 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:14:39.763111 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m17:14:39.764576 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.766596 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m17:14:39.768577 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m17:14:39.770576 [info ] [Thread-1 (]: 9 of 13 PASS source_not_null_raw_management_control_control_date ............... [[32mPASS[0m in 0.07s]
[0m17:14:39.773575 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:39.774574 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:39.775575 [info ] [Thread-1 (]: 10 of 13 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m17:14:39.776657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m17:14:39.777662 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:39.786656 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:14:39.789655 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:39.792669 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:14:39.793652 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:14:39.794652 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m17:14:39.794652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.843190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:14:39.844192 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:14:39.844192 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m17:14:39.847204 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:14:39.849205 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m17:14:39.849205 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m17:14:39.850205 [info ] [Thread-1 (]: 10 of 13 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.07s]
[0m17:14:39.852204 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:39.853184 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:39.854184 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m17:14:39.855183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m17:14:39.855183 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:39.864179 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:14:39.865179 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:39.869176 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:14:39.871175 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:14:39.872174 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m17:14:39.873173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.924144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m17:14:39.924144 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:14:39.925145 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:14:39.928143 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:39.930141 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m17:14:39.931141 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m17:14:39.932139 [info ] [Thread-1 (]: 11 of 13 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.08s]
[0m17:14:39.934138 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:39.935137 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:39.935137 [info ] [Thread-1 (]: 12 of 13 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m17:14:39.937137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m17:14:39.937137 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:39.943134 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:14:39.944133 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:39.948131 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:14:39.949131 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:14:39.950131 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m17:14:39.950131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.996739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:14:39.997753 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:14:39.997753 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:14:40.000052 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:40.003053 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m17:14:40.004054 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m17:14:40.006053 [info ] [Thread-1 (]: 12 of 13 PASS unique_management_control_snapshot_control_id .................... [[32mPASS[0m in 0.07s]
[0m17:14:40.008053 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:40.008053 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:40.009052 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_management_control_control_id ................... [RUN]
[0m17:14:40.010049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m17:14:40.011067 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:40.015064 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:14:40.017045 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:40.023043 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:14:40.026042 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:14:40.027061 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m17:14:40.028058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:40.181121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.153 seconds
[0m17:14:40.181121 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:14:40.182121 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:14:40.184437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:14:40.186457 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m17:14:40.187457 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m17:14:40.188440 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.18s]
[0m17:14:40.190437 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:40.192437 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:40.193454 [debug] [MainThread]: On master: BEGIN
[0m17:14:40.193454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:40.245279 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m17:14:40.245279 [debug] [MainThread]: On master: COMMIT
[0m17:14:40.246279 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:40.246279 [debug] [MainThread]: On master: COMMIT
[0m17:14:40.247278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:40.248276 [debug] [MainThread]: On master: Close
[0m17:14:40.248276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:40.249278 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m17:14:40.250294 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m17:14:40.251276 [info ] [MainThread]: 
[0m17:14:40.251820 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m17:14:40.257820 [debug] [MainThread]: Command end result
[0m17:14:40.304795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:14:40.308792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:14:40.316788 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:14:40.316788 [info ] [MainThread]: 
[0m17:14:40.317786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:40.318786 [info ] [MainThread]: 
[0m17:14:40.320786 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m17:14:40.323063 [debug] [MainThread]: Command `dbt test` succeeded at 17:14:40.323063 after 3.88 seconds
[0m17:14:40.324066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC31A7D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC33D3CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC33D3F4A0>]}
[0m17:14:40.324066 [debug] [MainThread]: Flushing usage events
[0m17:14:40.907241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:48.519490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C3D5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6BFF77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C3D5CD0>]}


============================== 17:14:48.525503 | c5136706-7412-4345-8230-388c0a51ffdd ==============================
[0m17:14:48.525503 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:14:48.526485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m17:14:48.942247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C3F7C80>]}
[0m17:14:49.057180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6BBAB5C0>]}
[0m17:14:49.059179 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:49.362023 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:14:49.650839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:49.651840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:49.736792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6D800DD0>]}
[0m17:14:49.903697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:14:49.908694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:14:49.938675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6D801730>]}
[0m17:14:49.939674 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 13 data tests, 1 source, 702 macros
[0m17:14:49.940674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6D8E0D40>]}
[0m17:14:49.943672 [info ] [MainThread]: 
[0m17:14:49.944672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:49.945671 [info ] [MainThread]: 
[0m17:14:49.946672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:49.951683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m17:14:50.045554 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:14:50.046552 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:14:50.046552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:50.199419 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m17:14:50.200420 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:14:50.200420 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:14:50.208662 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:14:50.210679 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:14:50.211659 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:14:50.212659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m17:14:50.215673 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:14:50.216657 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:14:50.216657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:50.261770 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m17:14:50.261770 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:14:50.262783 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:14:50.271406 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:14:50.273423 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:14:50.273423 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:14:50.275404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m17:14:50.277420 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:14:50.278420 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:14:50.279419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:50.322575 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:14:50.323589 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:14:50.323589 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:14:50.332130 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:14:50.334138 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:14:50.335122 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:14:50.336124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m17:14:50.340122 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:14:50.340122 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:14:50.341138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:50.387750 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m17:14:50.388736 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:14:50.388736 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:14:50.396744 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:14:50.398729 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:14:50.398729 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:14:50.399728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m17:14:50.403726 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:14:50.403726 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:14:50.404726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:50.560024 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m17:14:50.561039 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:14:50.561039 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:14:50.570137 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:14:50.572156 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:14:50.573135 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:14:50.584129 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:50.585132 [debug] [MainThread]: On master: BEGIN
[0m17:14:50.585132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:50.629919 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:14:50.630919 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:50.630919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:14:50.640912 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:14:50.642926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5136706-7412-4345-8230-388c0a51ffdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C551FD0>]}
[0m17:14:50.643911 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:50.643911 [debug] [MainThread]: On master: Close
[0m17:14:50.647908 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m17:14:50.648923 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m17:14:50.649907 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m17:14:50.660903 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m17:14:50.663760 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m17:14:50.665776 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m17:14:50.668775 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m17:14:50.670773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now seed.management_control_project.management_control)
[0m17:14:50.671772 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m17:14:50.675770 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m17:14:50.676770 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m17:14:50.676770 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:50.678029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.management_control_project.management_control, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m17:14:50.678029 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:50.695024 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m17:14:50.699022 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:50.700020 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m17:14:50.702027 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:50.703019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m17:14:50.704019 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:50.713012 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m17:14:50.714012 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:50.716011 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m17:14:50.716011 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:50.717010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m17:14:50.718012 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:50.723008 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m17:14:50.724007 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:50.725005 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m17:14:50.726005 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:50.726005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m17:14:50.727004 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:50.735003 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m17:14:50.736000 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:50.737001 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m17:14:50.737999 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m17:14:50.738997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now model.management_control_project.int_management_control)
[0m17:14:50.738997 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m17:14:50.742995 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m17:14:50.743995 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m17:14:50.744994 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m17:14:50.745993 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m17:14:50.746993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m17:14:50.746993 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m17:14:50.763984 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m17:14:50.765983 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m17:14:50.767984 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m17:14:50.768982 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m17:14:50.769982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now snapshot.management_control_project.management_control_snapshot)
[0m17:14:50.769982 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m17:14:50.775977 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m17:14:50.777977 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m17:14:50.778975 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:50.780974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.management_control_project.management_control_snapshot, now test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c)
[0m17:14:50.781973 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:50.788971 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m17:14:50.790970 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:50.791975 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m17:14:50.792969 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:50.792969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m17:14:50.793968 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:50.798965 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m17:14:50.800963 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:50.801962 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m17:14:50.802963 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:50.803962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m17:14:50.803962 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:50.808959 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m17:14:50.810958 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:50.811958 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m17:14:50.811958 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:50.812957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m17:14:50.812957 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:50.818952 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m17:14:50.819952 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:50.820951 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m17:14:50.821950 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m17:14:50.822950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_stg_management_control_control_id.6000ea497a, now model.management_control_project.control_growth)
[0m17:14:50.822950 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m17:14:50.828946 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m17:14:50.829945 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m17:14:50.830945 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m17:14:50.831944 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m17:14:50.831944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m17:14:50.832944 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m17:14:50.843939 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m17:14:50.846860 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m17:14:50.848863 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m17:14:50.848863 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:50.849864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_summary, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m17:14:50.851882 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:50.855876 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m17:14:50.857857 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:50.858858 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m17:14:50.858858 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:50.859856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m17:14:50.859856 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:50.864872 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m17:14:50.865855 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:50.866852 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m17:14:50.867853 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:50.868852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m17:14:50.869850 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:50.875847 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m17:14:50.876846 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:50.877846 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m17:14:50.878845 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:50.878845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m17:14:50.879845 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:50.884843 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m17:14:50.886841 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:50.887841 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m17:14:50.888840 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m17:14:50.888840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.duplicate_control_entries)
[0m17:14:50.889858 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m17:14:50.893855 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m17:14:50.894836 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m17:14:50.895854 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m17:14:50.896836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:50.897837 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m17:14:50.897837 [debug] [MainThread]: Connection 'test.management_control_project.duplicate_control_entries' was properly closed.
[0m17:14:50.902850 [debug] [MainThread]: Command end result
[0m17:14:51.005773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:14:51.008772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:14:51.017767 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:14:51.019766 [debug] [MainThread]: Command `dbt compile` succeeded at 17:14:51.019766 after 2.65 seconds
[0m17:14:51.019766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C11FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6C11EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C6B88A330>]}
[0m17:14:51.020766 [debug] [MainThread]: Flushing usage events
[0m17:14:51.544094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:34.453840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E9549FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E954BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E97A1100>]}


============================== 17:15:34.459839 | 978e629b-e2f7-4cc3-9c67-c7a8b87abc47 ==============================
[0m17:15:34.459839 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:15:34.460838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:34.767660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E93E0FE0>]}
[0m17:15:34.866622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8A4C8F0>]}
[0m17:15:34.869604 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:35.159439 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:15:35.593188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:35.594188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:35.709122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EAE80DD0>]}
[0m17:15:35.851042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:15:35.856052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:15:35.889238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EB3A9B20>]}
[0m17:15:35.890246 [info ] [MainThread]: Found 5 models, 1 snapshot, 1 seed, 13 data tests, 1 source, 702 macros
[0m17:15:35.891106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EAE818B0>]}
[0m17:15:35.893110 [info ] [MainThread]: 
[0m17:15:35.895108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:35.895108 [info ] [MainThread]: 
[0m17:15:35.897354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:35.899352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m17:15:35.991663 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m17:15:35.992662 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m17:15:35.993662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:36.038656 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.045 seconds
[0m17:15:36.040673 [debug] [ThreadPool]: On list_gestion: Close
[0m17:15:36.046653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m17:15:36.054666 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:15:36.054666 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m17:15:36.055664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:36.202114 [debug] [ThreadPool]: SQL status: BEGIN in 0.146 seconds
[0m17:15:36.202114 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m17:15:36.203127 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m17:15:36.211680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:15:36.213698 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m17:15:36.214678 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m17:15:36.214678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m17:15:36.218678 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:15:36.218678 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m17:15:36.219677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:36.261765 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:15:36.261765 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m17:15:36.262764 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:15:36.270773 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m17:15:36.272758 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m17:15:36.272758 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m17:15:36.273756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m17:15:36.278771 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:15:36.279771 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m17:15:36.280770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:36.436434 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m17:15:36.437449 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m17:15:36.437449 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m17:15:36.446608 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:15:36.448626 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m17:15:36.449625 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m17:15:36.449625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m17:15:36.453952 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:15:36.453952 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m17:15:36.454952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:36.500897 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:15:36.500897 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m17:15:36.501911 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m17:15:36.510547 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:15:36.512546 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m17:15:36.513545 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m17:15:36.514548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m17:15:36.517561 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:15:36.518561 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m17:15:36.518561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:36.668483 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m17:15:36.668483 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m17:15:36.669485 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:15:36.678225 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:15:36.680243 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m17:15:36.680243 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m17:15:36.689219 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:36.690218 [debug] [MainThread]: On master: BEGIN
[0m17:15:36.690218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:36.733723 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m17:15:36.734709 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:36.735708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:36.744716 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:15:36.746702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EAD33FB0>]}
[0m17:15:36.747701 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:36.748704 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:36.748704 [debug] [MainThread]: On master: BEGIN
[0m17:15:36.749716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:15:36.749716 [debug] [MainThread]: On master: COMMIT
[0m17:15:36.750699 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:36.750699 [debug] [MainThread]: On master: COMMIT
[0m17:15:36.751698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:36.751698 [debug] [MainThread]: On master: Close
[0m17:15:36.754695 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m17:15:36.756696 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m17:15:36.758693 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m17:15:36.760693 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m17:15:36.771704 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m17:15:36.847660 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:36.848643 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m17:15:36.848643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:15:36.997438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m17:15:36.998450 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:36.998450 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:15:37.020617 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.021 seconds
[0m17:15:37.095589 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.097605 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp171537081595"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:15:37.106580 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m17:15:37.111578 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.112579 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp171537081595'
        
      order by ordinal_position

  
[0m17:15:37.116574 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m17:15:37.120584 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.121591 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:15:37.125587 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m17:15:37.129567 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.130566 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp171537081595'
        
      order by ordinal_position

  
[0m17:15:37.134583 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m17:15:37.142559 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.143559 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:15:37.147556 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m17:15:37.156551 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.157551 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp171537081595'
        
      order by ordinal_position

  
[0m17:15:37.161548 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m17:15:37.182536 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.183536 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m17:15:37.184554 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m17:15:37.190532 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.191531 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:15:37.192531 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:15:37.192531 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.196003 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.197007 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp171537081595" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp171537081595" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:15:37.200007 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m17:15:37.215014 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m17:15:37.216014 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m17:15:37.216996 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m17:15:37.218357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:15:37.222376 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m17:15:37.225356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '978e629b-e2f7-4cc3-9c67-c7a8b87abc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EAD32CC0>]}
[0m17:15:37.227355 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 0[0m in 0.46s]
[0m17:15:37.228354 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m17:15:37.230354 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:37.230354 [debug] [MainThread]: On master: BEGIN
[0m17:15:37.231352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:37.279324 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:15:37.280327 [debug] [MainThread]: On master: COMMIT
[0m17:15:37.280327 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:37.281326 [debug] [MainThread]: On master: COMMIT
[0m17:15:37.282323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:37.282323 [debug] [MainThread]: On master: Close
[0m17:15:37.283322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:37.283322 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m17:15:37.284323 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m17:15:37.284323 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m17:15:37.285323 [info ] [MainThread]: 
[0m17:15:37.286321 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m17:15:37.289319 [debug] [MainThread]: Command end result
[0m17:15:37.329298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m17:15:37.332296 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m17:15:37.340297 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m17:15:37.341291 [info ] [MainThread]: 
[0m17:15:37.343289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:37.344289 [info ] [MainThread]: 
[0m17:15:37.345288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:37.346287 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:15:37.346287 after 3.04 seconds
[0m17:15:37.347285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E97A1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EB77E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E907CEF0>]}
[0m17:15:37.348286 [debug] [MainThread]: Flushing usage events
[0m17:15:37.916590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:59.537790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021953989F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219539880B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021953989DF0>]}


============================== 18:40:59.553429 | 694606f9-5129-450d-bba7-500741950be3 ==============================
[0m18:40:59.553429 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:40:59.553429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:00.133569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219539EFD70>]}
[0m18:41:00.274190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219537E7B30>]}
[0m18:41:00.274190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:41:00.573972 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:41:00.980193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:00.980193 [debug] [MainThread]: Partial parsing: updated file: management_control_project://seeds\management_control.csv
[0m18:41:01.340426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021955079400>]}
[0m18:41:01.481060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:01.496686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:01.567590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002195539B470>]}
[0m18:41:01.567590 [info ] [MainThread]: Found 5 models, 1 snapshot, 13 data tests, 1 seed, 1 source, 702 macros
[0m18:41:01.567590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021955464C50>]}
[0m18:41:01.567590 [info ] [MainThread]: 
[0m18:41:01.567590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:01.575793 [info ] [MainThread]: 
[0m18:41:01.575793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:01.575793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m18:41:01.803874 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:01.803874 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:01.803874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:01.866364 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.064 seconds
[0m18:41:01.866364 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:01.881988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m18:41:01.881988 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:01.881988 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m18:41:01.881988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:02.109070 [debug] [ThreadPool]: SQL status: BEGIN in 0.221 seconds
[0m18:41:02.109070 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:02.109070 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m18:41:02.124695 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m18:41:02.140345 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m18:41:02.140345 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m18:41:02.140345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m18:41:02.155948 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:02.155948 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m18:41:02.155948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:02.234062 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m18:41:02.234062 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:02.234062 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m18:41:02.249684 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m18:41:02.249684 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m18:41:02.249684 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m18:41:02.249684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m18:41:02.249684 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:02.249684 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m18:41:02.249684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:02.296574 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m18:41:02.296574 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:02.296574 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:41:02.312196 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:02.312196 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m18:41:02.312196 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m18:41:02.312196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_staging)
[0m18:41:02.312196 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:02.312196 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m18:41:02.312196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:02.530919 [debug] [ThreadPool]: SQL status: BEGIN in 0.220 seconds
[0m18:41:02.530919 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:02.546569 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:02.562190 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.016 seconds
[0m18:41:02.562190 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m18:41:02.562190 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m18:41:02.562190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m18:41:02.562190 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:02.562190 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m18:41:02.562190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:02.642152 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m18:41:02.642152 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:02.642152 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m18:41:02.642152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:02.642152 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m18:41:02.642152 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m18:41:02.657796 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:02.657796 [debug] [MainThread]: On master: BEGIN
[0m18:41:02.657796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:02.704651 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m18:41:02.704651 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:02.704651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:02.704651 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m18:41:02.720272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219559BC5C0>]}
[0m18:41:02.720272 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:02.720272 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:02.720272 [debug] [MainThread]: On master: BEGIN
[0m18:41:02.720272 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:41:02.720272 [debug] [MainThread]: On master: COMMIT
[0m18:41:02.720272 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:02.720272 [debug] [MainThread]: On master: COMMIT
[0m18:41:02.720272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:02.720272 [debug] [MainThread]: On master: Close
[0m18:41:02.720272 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m18:41:02.720272 [info ] [Thread-1 (]: 1 of 1 START seed file public_seeds.management_control ......................... [RUN]
[0m18:41:02.720272 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m18:41:02.720272 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m18:41:02.720272 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m18:41:02.832306 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m18:41:02.832306 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m18:41:02.832306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:03.019789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.197 seconds
[0m18:41:03.019789 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m18:41:03.019789 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */
truncate table "gestion"."public_seeds"."management_control"
[0m18:41:03.035413 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m18:41:03.175526 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m18:41:03.175526 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public_seeds"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m18:41:03.175526 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.008 seconds
[0m18:41:03.191150 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m18:41:03.206774 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m18:41:03.206774 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m18:41:03.206774 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m18:41:03.222401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:41:03.222401 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m18:41:03.222401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694606f9-5129-450d-bba7-500741950be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219532C8B00>]}
[0m18:41:03.222401 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_seeds.management_control ..................... [[32mINSERT 100[0m in 0.50s]
[0m18:41:03.222401 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m18:41:03.222401 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:03.222401 [debug] [MainThread]: On master: BEGIN
[0m18:41:03.222401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:03.284877 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m18:41:03.284877 [debug] [MainThread]: On master: COMMIT
[0m18:41:03.284877 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:03.292221 [debug] [MainThread]: On master: COMMIT
[0m18:41:03.292221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:03.292221 [debug] [MainThread]: On master: Close
[0m18:41:03.292221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:03.292221 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m18:41:03.292221 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m18:41:03.292221 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m18:41:03.292221 [info ] [MainThread]: 
[0m18:41:03.292221 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m18:41:03.300236 [debug] [MainThread]: Command end result
[0m18:41:03.349330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:03.360399 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:03.360399 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m18:41:03.360399 [info ] [MainThread]: 
[0m18:41:03.360399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:03.360399 [info ] [MainThread]: 
[0m18:41:03.375433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:41:03.375433 [debug] [MainThread]: Command `dbt seed` succeeded at 18:41:03.375433 after 4.03 seconds
[0m18:41:03.375433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021953AECF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021953712CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021953279FA0>]}
[0m18:41:03.375433 [debug] [MainThread]: Flushing usage events
[0m18:41:03.864167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:10.199930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208781DA870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208781DB530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020878D52030>]}


============================== 18:41:10.215534 | 87467de5-829c-45cc-aef9-531f30ded041 ==============================
[0m18:41:10.215534 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:41:10.215534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:41:10.665058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087826A570>]}
[0m18:41:10.806513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020878DF0EC0>]}
[0m18:41:10.806513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:41:11.093910 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:41:11.390056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:11.390056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:11.490216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208781EF0E0>]}
[0m18:41:11.640127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:11.640127 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:11.707211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A223C80>]}
[0m18:41:11.707211 [info ] [MainThread]: Found 5 models, 1 snapshot, 13 data tests, 1 seed, 1 source, 702 macros
[0m18:41:11.707211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A67C470>]}
[0m18:41:11.707211 [info ] [MainThread]: 
[0m18:41:11.707211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:11.707211 [info ] [MainThread]: 
[0m18:41:11.722989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:11.731474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m18:41:11.839528 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:11.839528 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:11.839528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:11.886400 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m18:41:11.886400 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:11.886400 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:11.886400 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:11.886400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:11.933272 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.045 seconds
[0m18:41:11.933272 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:11.933272 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:11.933272 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:11.933272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:11.980144 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.044 seconds
[0m18:41:11.980144 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:11.995771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m18:41:11.995771 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:11.995771 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m18:41:11.995771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:12.253386 [debug] [ThreadPool]: SQL status: BEGIN in 0.250 seconds
[0m18:41:12.256108 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:12.258683 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m18:41:12.273702 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m18:41:12.273702 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m18:41:12.273702 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m18:41:12.273702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m18:41:12.290346 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:12.290346 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m18:41:12.290346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:12.373483 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m18:41:12.373483 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:12.373483 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m18:41:12.390146 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m18:41:12.390146 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m18:41:12.390146 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m18:41:12.390146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m18:41:12.390146 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:12.390146 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m18:41:12.390146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:12.456792 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m18:41:12.456792 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:12.473506 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:12.473506 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m18:41:12.473506 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m18:41:12.473506 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m18:41:12.490320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m18:41:12.490320 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:12.490320 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m18:41:12.490320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:12.556734 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m18:41:12.556734 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:12.556734 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:41:12.573260 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m18:41:12.573260 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m18:41:12.573260 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m18:41:12.573260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m18:41:12.590778 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:12.590778 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m18:41:12.590778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:12.656719 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m18:41:12.656719 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:12.656719 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m18:41:12.673180 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m18:41:12.673180 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m18:41:12.673180 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m18:41:12.690086 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:12.690086 [debug] [MainThread]: On master: BEGIN
[0m18:41:12.690086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:12.889825 [debug] [MainThread]: SQL status: BEGIN in 0.200 seconds
[0m18:41:12.889825 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:12.889825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:12.906623 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m18:41:12.906623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A1DF590>]}
[0m18:41:12.906623 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:12.906623 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:12.906623 [debug] [MainThread]: On master: BEGIN
[0m18:41:12.906623 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:41:12.906623 [debug] [MainThread]: On master: COMMIT
[0m18:41:12.906623 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:12.922249 [debug] [MainThread]: On master: COMMIT
[0m18:41:12.923398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:12.923398 [debug] [MainThread]: On master: Close
[0m18:41:12.923398 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m18:41:12.923398 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m18:41:12.923398 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m18:41:12.923398 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m18:41:12.956722 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m18:41:12.956722 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m18:41:13.040020 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.040020 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp184113006818"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m18:41:13.040020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:13.106011 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.063 seconds
[0m18:41:13.122688 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.122688 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m18:41:13.122688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:41:13.122688 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.122688 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp184113006818'
        
      order by ordinal_position

  
[0m18:41:13.138312 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.020 seconds
[0m18:41:13.153954 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.153954 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:41:13.153954 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m18:41:13.169566 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.169566 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:41:13.169566 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m18:41:13.185189 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m18:41:13.185189 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.185189 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp184113006818"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp184113006818"
    )
  
[0m18:41:13.200808 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m18:41:13.216435 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m18:41:13.216435 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:13.216435 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m18:41:13.216435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:13.216435 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m18:41:13.216435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020878228A70>]}
[0m18:41:13.216435 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.29s]
[0m18:41:13.216435 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m18:41:13.216435 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m18:41:13.232057 [info ] [Thread-1 (]: 2 of 5 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m18:41:13.232057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m18:41:13.232057 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m18:41:13.232057 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m18:41:13.232057 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m18:41:13.232057 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.232057 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp184113232057"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m18:41:13.232057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:13.306442 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.063 seconds
[0m18:41:13.306442 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.306442 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m18:41:13.306442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:41:13.306442 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.306442 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp184113232057'
        
      order by ordinal_position

  
[0m18:41:13.331854 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.016 seconds
[0m18:41:13.331854 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.331854 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m18:41:13.339388 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m18:41:13.347392 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.347392 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp184113232057'
        
      order by ordinal_position

  
[0m18:41:13.355408 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m18:41:13.355408 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.355408 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m18:41:13.363432 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m18:41:13.363432 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:41:13.363432 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m18:41:13.363432 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.379056 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp184113232057"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp184113232057"
    )
  
[0m18:41:13.379056 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.003 seconds
[0m18:41:13.379056 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m18:41:13.379056 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:13.379056 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m18:41:13.379056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:13.379056 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m18:41:13.379056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A1C0500>]}
[0m18:41:13.379056 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.15s]
[0m18:41:13.379056 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m18:41:13.379056 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m18:41:13.394682 [info ] [Thread-1 (]: 3 of 5 START sql incremental model public_staging.test_utils ................... [RUN]
[0m18:41:13.394682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m18:41:13.394682 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m18:41:13.413734 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m18:41:13.413734 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m18:41:13.423758 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.423758 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

    
  
    

  create temporary table "test_utils__dbt_tmp184113423758"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m18:41:13.423758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:13.471964 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.049 seconds
[0m18:41:13.480084 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.480084 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m18:41:13.480084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:41:13.480084 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.480084 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'test_utils__dbt_tmp184113423758'
        
      order by ordinal_position

  
[0m18:41:13.495724 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m18:41:13.495724 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.495724 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:41:13.511335 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m18:41:13.511335 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.511335 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:41:13.511335 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m18:41:13.526959 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m18:41:13.526959 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.526959 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      insert into "gestion"."public_staging"."test_utils" ("unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "test_utils__dbt_tmp184113423758"
    )


  
[0m18:41:13.526959 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m18:41:13.526959 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m18:41:13.526959 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:13.526959 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m18:41:13.526959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:13.526959 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m18:41:13.526959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087AEBC290>]}
[0m18:41:13.526959 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model public_staging.test_utils .............. [[32mINSERT 0 51[0m in 0.13s]
[0m18:41:13.542581 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m18:41:13.542581 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m18:41:13.542581 [info ] [Thread-1 (]: 4 of 5 START sql incremental model public_management_control.control_growth .... [RUN]
[0m18:41:13.542581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m18:41:13.542581 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m18:41:13.542581 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m18:41:13.542581 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m18:41:13.542581 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.542581 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

    
  
    

  create temporary table "control_growth__dbt_tmp184113542581"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m18:41:13.558206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:13.607286 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.061 seconds
[0m18:41:13.622891 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.622891 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m18:41:13.626454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:41:13.626454 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.626454 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_growth__dbt_tmp184113542581'
        
      order by ordinal_position

  
[0m18:41:13.639417 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.015 seconds
[0m18:41:13.647441 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.647441 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m18:41:13.647441 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m18:41:13.710379 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.710379 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m18:41:13.710379 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m18:41:13.710379 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m18:41:13.725988 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:13.725988 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
        
            delete from "gestion"."public_management_control"."control_growth"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_growth__dbt_tmp184113542581"
            );

        
    

    insert into "gestion"."public_management_control"."control_growth" ("control_year", "control_month", "monthly_net_profit", "growth_rate")
    (
        select "control_year", "control_month", "monthly_net_profit", "growth_rate"
        from "control_growth__dbt_tmp184113542581"
    )
  
[0m18:41:13.725988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m18:41:13.725988 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m18:41:13.725988 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m18:41:13.741609 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m18:41:13.741609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020878D731A0>]}
[0m18:41:13.741609 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.20s]
[0m18:41:13.741609 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m18:41:13.741609 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m18:41:13.741609 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m18:41:13.741609 [info ] [Thread-1 (]: 5 of 5 START sql incremental model public_management_control.control_summary ... [RUN]
[0m18:41:13.741609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m18:41:13.741609 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m18:41:13.763752 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m18:41:13.763752 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m18:41:13.763752 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.763752 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp184113763752"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m18:41:13.763752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:13.822541 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.058 seconds
[0m18:41:13.830542 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.830542 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m18:41:13.830542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:41:13.830542 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.838543 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp184113763752'
        
      order by ordinal_position

  
[0m18:41:13.847328 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m18:41:13.855328 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.855328 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m18:41:13.863385 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m18:41:13.863385 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.863385 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m18:41:13.863385 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m18:41:13.863385 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m18:41:13.863385 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:13.863385 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp184113763752"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp184113763752"
    )
  
[0m18:41:13.879012 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m18:41:13.879012 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m18:41:13.879012 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m18:41:13.879012 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m18:41:13.879012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87467de5-829c-45cc-aef9-531f30ded041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A758C80>]}
[0m18:41:13.879012 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.14s]
[0m18:41:13.879012 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m18:41:13.879012 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m18:41:13.879012 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:13.879012 [debug] [MainThread]: On master: BEGIN
[0m18:41:13.894649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:14.113377 [debug] [MainThread]: SQL status: BEGIN in 0.225 seconds
[0m18:41:14.113377 [debug] [MainThread]: On master: COMMIT
[0m18:41:14.113377 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:14.113377 [debug] [MainThread]: On master: COMMIT
[0m18:41:14.113377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:14.113377 [debug] [MainThread]: On master: Close
[0m18:41:14.113377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:14.113377 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m18:41:14.113377 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m18:41:14.129000 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m18:41:14.129000 [info ] [MainThread]: 
[0m18:41:14.129000 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m18:41:14.129000 [debug] [MainThread]: Command end result
[0m18:41:14.190181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:14.190181 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:14.205708 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m18:41:14.205708 [info ] [MainThread]: 
[0m18:41:14.213709 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:41:14.213709 [info ] [MainThread]: 
[0m18:41:14.213709 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m18:41:14.213709 [info ] [MainThread]: 
[0m18:41:14.213709 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m18:41:14.213709 [info ] [MainThread]: 
[0m18:41:14.221711 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:41:14.221711 [debug] [MainThread]: Command `dbt run` failed at 18:41:14.221711 after 4.20 seconds
[0m18:41:14.221711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087AA30A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087AA30B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087AA33470>]}
[0m18:41:14.221711 [debug] [MainThread]: Flushing usage events
[0m18:41:14.717115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:27.532853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227C79B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227C637140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227C6348F0>]}


============================== 18:41:27.532853 | e6802c75-cb19-4f7d-9584-d6cd3b15da47 ==============================
[0m18:41:27.532853 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:41:27.548480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:27.830235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CC7A000>]}
[0m18:41:27.923979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CEE9C70>]}
[0m18:41:27.923979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:41:28.204730 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:41:28.470319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:28.470319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:28.565023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CB1A870>]}
[0m18:41:28.705638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:28.721243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:28.752494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227E6212E0>]}
[0m18:41:28.752494 [info ] [MainThread]: Found 5 models, 1 snapshot, 13 data tests, 1 seed, 1 source, 702 macros
[0m18:41:28.752494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227E5F33B0>]}
[0m18:41:28.752494 [info ] [MainThread]: 
[0m18:41:28.752494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:28.752494 [info ] [MainThread]: 
[0m18:41:28.763645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:28.765204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m18:41:28.859520 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:28.859520 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:28.859520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:28.908032 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.051 seconds
[0m18:41:28.908032 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:28.908032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m18:41:28.923656 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:28.923656 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m18:41:28.923656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:28.970528 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m18:41:28.970528 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:28.970528 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m18:41:28.970528 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:28.986156 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m18:41:28.986156 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m18:41:28.986156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m18:41:28.986156 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:28.986156 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m18:41:28.986156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:29.033765 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m18:41:29.033765 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:29.033765 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:29.041789 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m18:41:29.051451 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m18:41:29.051451 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m18:41:29.051451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m18:41:29.051451 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:29.051451 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m18:41:29.051451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:29.099251 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m18:41:29.099251 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:29.099251 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m18:41:29.114889 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:29.114889 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m18:41:29.114889 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m18:41:29.114889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m18:41:29.114889 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:29.114889 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m18:41:29.114889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:29.161747 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m18:41:29.161747 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:29.161747 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:41:29.177369 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:29.177369 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m18:41:29.177369 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m18:41:29.177369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m18:41:29.177369 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:29.177369 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m18:41:29.177369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:29.224259 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:41:29.224259 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:29.224259 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m18:41:29.239865 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m18:41:29.239865 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m18:41:29.239865 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m18:41:29.239865 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.239865 [debug] [MainThread]: On master: BEGIN
[0m18:41:29.255492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:29.286736 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:41:29.286736 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.286736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:29.302362 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m18:41:29.302362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CF84170>]}
[0m18:41:29.302362 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:29.302362 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.302362 [debug] [MainThread]: On master: BEGIN
[0m18:41:29.302362 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:41:29.302362 [debug] [MainThread]: On master: COMMIT
[0m18:41:29.302362 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.302362 [debug] [MainThread]: On master: COMMIT
[0m18:41:29.302362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:29.317984 [debug] [MainThread]: On master: Close
[0m18:41:29.317984 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m18:41:29.317984 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m18:41:29.317984 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m18:41:29.317984 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m18:41:29.317984 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m18:41:29.392854 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.392854 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m18:41:29.392854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:29.440128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:41:29.440128 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.440128 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:41:29.455734 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m18:41:29.502624 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.502624 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp184129502624"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:41:29.518244 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.011 seconds
[0m18:41:29.518244 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.518244 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp184129502624'
        
      order by ordinal_position

  
[0m18:41:29.518244 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m18:41:29.533854 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.533854 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:41:29.533854 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m18:41:29.533854 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.533854 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp184129502624'
        
      order by ordinal_position

  
[0m18:41:29.550265 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m18:41:29.551209 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.551209 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:41:29.559228 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m18:41:29.567886 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.567886 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp184129502624'
        
      order by ordinal_position

  
[0m18:41:29.567886 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m18:41:29.583531 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.583531 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:41:29.583531 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:41:29.599152 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.599152 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:41:29.599152 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m18:41:29.599152 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.599152 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.599152 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp184129502624" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp184129502624" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:41:29.599152 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m18:41:29.614778 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m18:41:29.614778 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m18:41:29.614778 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m18:41:29.614778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:29.630401 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m18:41:29.630401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6802c75-cb19-4f7d-9584-d6cd3b15da47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227EDC3C80>]}
[0m18:41:29.630401 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.31s]
[0m18:41:29.630401 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m18:41:29.630401 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.630401 [debug] [MainThread]: On master: BEGIN
[0m18:41:29.630401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:29.846692 [debug] [MainThread]: SQL status: BEGIN in 0.214 seconds
[0m18:41:29.846692 [debug] [MainThread]: On master: COMMIT
[0m18:41:29.846692 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:29.846692 [debug] [MainThread]: On master: COMMIT
[0m18:41:29.846692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:29.862338 [debug] [MainThread]: On master: Close
[0m18:41:29.862338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:29.862338 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m18:41:29.862338 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m18:41:29.862338 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m18:41:29.862338 [info ] [MainThread]: 
[0m18:41:29.862338 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m18:41:29.862338 [debug] [MainThread]: Command end result
[0m18:41:29.976154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:29.976154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:29.984154 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m18:41:29.984154 [info ] [MainThread]: 
[0m18:41:29.984154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:29.984154 [info ] [MainThread]: 
[0m18:41:29.992264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:41:29.992264 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:41:29.992264 after 2.59 seconds
[0m18:41:29.992264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227C814CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CB19CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001227CC44C50>]}
[0m18:41:29.992264 [debug] [MainThread]: Flushing usage events
[0m18:41:30.446411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:41.843873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C7F281D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C7BAD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C7F2BCB0>]}


============================== 18:41:41.843873 | 2ec1984b-716b-4072-a219-95b1b33f59a0 ==============================
[0m18:41:41.843873 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:41:41.843873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:42.141585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C78670E0>]}
[0m18:41:42.235328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C77F1FA0>]}
[0m18:41:42.235328 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:41:42.558010 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:41:42.830857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:42.830857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:42.924599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C96B79E0>]}
[0m18:41:43.065216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:43.065216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:43.113279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C9D31430>]}
[0m18:41:43.113279 [info ] [MainThread]: Found 5 models, 1 snapshot, 13 data tests, 1 seed, 1 source, 702 macros
[0m18:41:43.113279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C98E92E0>]}
[0m18:41:43.121524 [info ] [MainThread]: 
[0m18:41:43.121524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:43.121524 [info ] [MainThread]: 
[0m18:41:43.125646 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:43.132231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m18:41:43.213637 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:43.213637 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:43.213637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:43.424806 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.206 seconds
[0m18:41:43.424806 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:43.424806 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:43.424806 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:43.424806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:43.487284 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.055 seconds
[0m18:41:43.487284 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:43.487284 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m18:41:43.487284 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m18:41:43.487284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:43.534156 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.044 seconds
[0m18:41:43.534156 [debug] [ThreadPool]: On list_gestion: Close
[0m18:41:43.534156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m18:41:43.549799 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:43.549799 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m18:41:43.549799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:43.596652 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:41:43.596652 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m18:41:43.596652 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m18:41:43.596652 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:41:43.596652 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m18:41:43.596652 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m18:41:43.596652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m18:41:43.612276 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:43.612276 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m18:41:43.612276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:43.834829 [debug] [ThreadPool]: SQL status: BEGIN in 0.221 seconds
[0m18:41:43.834829 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m18:41:43.834829 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:41:43.850430 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m18:41:43.850430 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m18:41:43.850430 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m18:41:43.850430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m18:41:43.866053 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:43.866053 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m18:41:43.866053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:43.944171 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m18:41:43.944171 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m18:41:43.944171 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m18:41:43.959813 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m18:41:43.959813 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m18:41:43.959813 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m18:41:43.959813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m18:41:43.959813 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:43.959813 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m18:41:43.959813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:44.196200 [debug] [ThreadPool]: SQL status: BEGIN in 0.224 seconds
[0m18:41:44.196200 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m18:41:44.196200 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:44.211798 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.023 seconds
[0m18:41:44.227460 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m18:41:44.227460 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m18:41:44.227460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m18:41:44.243049 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:44.243049 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m18:41:44.258673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:44.383660 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m18:41:44.383660 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m18:41:44.383660 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m18:41:44.399310 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m18:41:44.399310 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m18:41:44.399310 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m18:41:44.414909 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.414909 [debug] [MainThread]: On master: BEGIN
[0m18:41:44.414909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:44.477403 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m18:41:44.477403 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.477403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:44.493028 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m18:41:44.493028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C9D11AC0>]}
[0m18:41:44.493028 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:44.493028 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.493028 [debug] [MainThread]: On master: BEGIN
[0m18:41:44.493028 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:41:44.493028 [debug] [MainThread]: On master: COMMIT
[0m18:41:44.493028 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.493028 [debug] [MainThread]: On master: COMMIT
[0m18:41:44.493028 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:44.493028 [debug] [MainThread]: On master: Close
[0m18:41:44.493028 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m18:41:44.493028 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m18:41:44.493028 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.stg_management_control'
[0m18:41:44.493028 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m18:41:44.508651 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m18:41:44.508651 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m18:41:44.579994 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m18:41:44.588028 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.588028 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m18:41:44.588028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:44.619278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m18:41:44.619278 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.619278 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m18:41:44.634900 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m18:41:44.634900 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.634900 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m18:41:44.650525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:41:44.650525 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.650525 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m18:41:44.650525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:44.666148 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m18:41:44.666148 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.666148 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m18:41:44.666148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:44.682460 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m18:41:44.682460 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m18:41:44.682460 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m18:41:44.697030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m18:41:44.705048 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m18:41:44.705048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C7C83C80>]}
[0m18:41:44.705048 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.21s]
[0m18:41:44.705048 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m18:41:44.705048 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m18:41:44.713029 [info ] [Thread-1 (]: 2 of 5 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m18:41:44.713809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.int_management_control)
[0m18:41:44.713809 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m18:41:44.713809 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m18:41:44.713809 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m18:41:44.713809 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m18:41:44.713809 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.713809 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m18:41:44.713809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:44.765138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:41:44.765138 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.765138 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m18:41:44.781692 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m18:41:44.789699 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.789699 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m18:41:44.797273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:41:44.797273 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.797273 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m18:41:44.797273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:44.797273 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m18:41:44.797273 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.805273 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m18:41:44.805273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:44.805273 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m18:41:44.805273 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m18:41:44.805273 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m18:41:44.813290 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:41:44.813290 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m18:41:44.813290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA4DBC80>]}
[0m18:41:44.813290 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.10s]
[0m18:41:44.821312 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m18:41:44.821312 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m18:41:44.821312 [info ] [Thread-1 (]: 3 of 5 START sql incremental model public_staging.test_utils ................... [RUN]
[0m18:41:44.821312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m18:41:44.827531 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m18:41:44.832066 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m18:41:44.847712 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m18:41:44.847712 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m18:41:44.847712 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.847712 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m18:41:44.847712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:44.897435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:41:44.905452 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.905452 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m18:41:44.913946 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m18:41:44.913946 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.913946 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m18:41:44.921948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:44.921948 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.921948 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m18:41:44.921948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:44.929963 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m18:41:44.929963 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.929963 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m18:41:44.929963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:41:44.938004 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m18:41:44.938004 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m18:41:44.938004 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m18:41:44.938004 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:41:44.938004 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m18:41:44.938004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA15FD10>]}
[0m18:41:44.938004 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.12s]
[0m18:41:44.938004 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m18:41:44.938004 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m18:41:44.953646 [info ] [Thread-1 (]: 4 of 5 START sql incremental model public_management_control.control_growth .... [RUN]
[0m18:41:44.953646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m18:41:44.953646 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m18:41:44.953646 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m18:41:44.953646 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m18:41:44.953646 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m18:41:44.953646 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:44.953646 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m18:41:44.953646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:45.015221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:41:45.015221 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:45.015221 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m18:41:45.030388 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m18:41:45.030388 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:45.030388 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m18:41:45.030388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:45.038407 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:45.038407 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m18:41:45.038407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:45.038407 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m18:41:45.038407 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:45.046387 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m18:41:45.047276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:41:45.047276 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m18:41:45.047276 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m18:41:45.047276 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m18:41:45.055295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:41:45.055295 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m18:41:45.055295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA53BDD0>]}
[0m18:41:45.055295 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.10s]
[0m18:41:45.063289 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m18:41:45.063289 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m18:41:45.063289 [info ] [Thread-1 (]: 5 of 5 START sql incremental model public_management_control.control_summary ... [RUN]
[0m18:41:45.063289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m18:41:45.063289 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m18:41:45.138343 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m18:41:45.138343 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m18:41:45.147064 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m18:41:45.147064 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.147064 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m18:41:45.147064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:45.186735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:41:45.186735 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.186735 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m18:41:45.203425 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m18:41:45.213567 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.213567 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m18:41:45.213567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:41:45.221566 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.221566 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m18:41:45.221566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:45.221566 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m18:41:45.221566 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.221566 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m18:41:45.221566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:45.230133 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m18:41:45.230133 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m18:41:45.230133 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m18:41:45.230133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:41:45.230133 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m18:41:45.230133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec1984b-716b-4072-a219-95b1b33f59a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C85D9EE0>]}
[0m18:41:45.230133 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.17s]
[0m18:41:45.230133 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m18:41:45.245775 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:45.245775 [debug] [MainThread]: On master: BEGIN
[0m18:41:45.245775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:45.280677 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m18:41:45.280677 [debug] [MainThread]: On master: COMMIT
[0m18:41:45.280677 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:45.280677 [debug] [MainThread]: On master: COMMIT
[0m18:41:45.280677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:45.280677 [debug] [MainThread]: On master: Close
[0m18:41:45.296320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:45.296960 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m18:41:45.296960 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m18:41:45.296960 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m18:41:45.296960 [info ] [MainThread]: 
[0m18:41:45.296960 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m18:41:45.296960 [debug] [MainThread]: Command end result
[0m18:41:45.347338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m18:41:45.348433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m18:41:45.348433 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m18:41:45.348433 [info ] [MainThread]: 
[0m18:41:45.348433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:45.348433 [info ] [MainThread]: 
[0m18:41:45.348433 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:41:45.363997 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:45.363997 after 3.65 seconds
[0m18:41:45.363997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C80FCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA04C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA04CAA0>]}
[0m18:41:45.363997 [debug] [MainThread]: Flushing usage events
[0m18:41:45.875108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:42.021104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FAE89940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FAE89400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FAE8A030>]}


============================== 19:17:42.036726 | 8b0fc23f-2de5-452d-a693-77b43e5db1d1 ==============================
[0m19:17:42.036726 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:17:42.036726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:42.318244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b0fc23f-2de5-452d-a693-77b43e5db1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FB390A70>]}
[0m19:17:42.427613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b0fc23f-2de5-452d-a693-77b43e5db1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FB4C0680>]}
[0m19:17:42.427613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:17:42.774081 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:17:43.008439 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:17:43.008439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b0fc23f-2de5-452d-a693-77b43e5db1d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FC922690>]}
[0m19:17:46.364900 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m19:17:46.585406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.management_control_project.dim_departement' (models\OLAP\dim_departement.sql) depends on a node named 'raw_department' which was not found
[0m19:17:46.585406 [debug] [MainThread]: Command `dbt run` failed at 19:17:46.585406 after 4.77 seconds
[0m19:17:46.585406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FB2F30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FCC915B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FCFBA660>]}
[0m19:17:46.585406 [debug] [MainThread]: Flushing usage events
[0m19:17:47.039049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:30.297058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202EF8D4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F21381A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F213A240>]}


============================== 19:42:30.297058 | aa42a5b2-283d-455e-8c46-8c095563990b ==============================
[0m19:42:30.297058 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:42:30.297058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:30.513549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa42a5b2-283d-455e-8c46-8c095563990b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F213B770>]}
[0m19:42:30.581536 [debug] [MainThread]: Command `dbt clean` succeeded at 19:42:30.581143 after 0.48 seconds
[0m19:42:30.581536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202EF8D4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F213B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F276A660>]}
[0m19:42:30.581536 [debug] [MainThread]: Flushing usage events
[0m19:42:31.021441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:37.412776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D6FA63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D6FA59A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D7AB0E60>]}


============================== 19:42:37.412776 | 7232b1d8-63c6-4230-957c-3b46d19499cb ==============================
[0m19:42:37.412776 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:42:37.412776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:42:37.711544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7232b1d8-63c6-4230-957c-3b46d19499cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D6FEFDD0>]}
[0m19:42:37.805289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7232b1d8-63c6-4230-957c-3b46d19499cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D720E510>]}
[0m19:42:37.805289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:42:38.089906 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:42:38.089906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:42:38.089906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7232b1d8-63c6-4230-957c-3b46d19499cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D8D96FC0>]}
[0m19:42:40.945584 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m19:42:41.177446 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.management_control_project.dim_departement' (models\OLAP\dim_departement.sql) depends on a node named 'raw_department' which was not found
[0m19:42:41.177446 [debug] [MainThread]: Command `dbt seed` failed at 19:42:41.177446 after 3.91 seconds
[0m19:42:41.177446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D79A46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D966E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D1A16180>]}
[0m19:42:41.177446 [debug] [MainThread]: Flushing usage events
[0m19:42:41.629860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:36.798574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFAC24920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFD76DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFD76CF80>]}


============================== 19:46:36.798574 | ec3b1e80-2335-42b3-8e6d-7cf033167a9c ==============================
[0m19:46:36.798574 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:46:36.798574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:46:37.097361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFAE396A0>]}
[0m19:46:37.191106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFB1447A0>]}
[0m19:46:37.191106 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:46:37.459767 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:46:37.459767 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:46:37.459767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFDD16210>]}
[0m19:46:40.186072 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m19:46:40.408271 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.relationships_fact_management_control_department_id__department_id__ref_dim_department_.7d77b4615d' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:46:40.408271 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.unique_dim_department_department_id.b30c62b76b' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:46:40.408271 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.not_null_dim_department_department_id.00afe97aab' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:46:40.408271 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.not_null_dim_department_department_name.6e1efcd65f' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:46:40.534210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFF551E20>]}
[0m19:46:40.765125 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:46:40.780750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:46:40.836795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFF562D50>]}
[0m19:46:40.837990 [info ] [MainThread]: Found 9 models, 1 snapshot, 22 data tests, 1 seed, 1 source, 702 macros
[0m19:46:40.837990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFF517EC0>]}
[0m19:46:40.837990 [info ] [MainThread]: 
[0m19:46:40.843165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:40.843165 [info ] [MainThread]: 
[0m19:46:40.843165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:40.848032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:46:40.943138 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:46:40.943138 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:46:40.943138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:40.992062 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.049 seconds
[0m19:46:40.992062 [debug] [ThreadPool]: On list_gestion: Close
[0m19:46:40.992062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m19:46:41.007687 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:46:41.007687 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:46:41.007687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:41.054573 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:46:41.054573 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:46:41.054573 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:46:41.054573 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m19:46:41.054573 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:46:41.054573 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:46:41.054573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_staging)
[0m19:46:41.070184 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:46:41.070184 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:46:41.070184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.109954 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:46:41.109954 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:46:41.109954 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:46:41.117953 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:46:41.126434 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:46:41.126434 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:46:41.126434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m19:46:41.126434 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:46:41.126434 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:46:41.126434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.360847 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m19:46:41.360847 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:46:41.360847 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:46:41.377546 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m19:46:41.377546 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:46:41.394072 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:46:41.394072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m19:46:41.394072 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:46:41.409811 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:46:41.411084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.494009 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m19:46:41.494009 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:46:41.509811 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:46:41.511920 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m19:46:41.511920 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:46:41.526340 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:46:41.526340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m19:46:41.534341 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:46:41.534341 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:46:41.534341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.593798 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m19:46:41.593798 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:46:41.593798 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:46:41.593798 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:46:41.593798 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:46:41.593798 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:46:41.593798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m19:46:41.612191 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:46:41.612191 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:46:41.612191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.643513 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:46:41.643513 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:46:41.659152 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:46:41.660383 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:46:41.660383 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:46:41.660383 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:46:41.676783 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:41.676783 [debug] [MainThread]: On master: BEGIN
[0m19:46:41.676783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:41.727014 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m19:46:41.727014 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:41.727014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:41.727014 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m19:46:41.727014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFF503FB0>]}
[0m19:46:41.727014 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:41.742641 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:41.743696 [debug] [MainThread]: On master: BEGIN
[0m19:46:41.743696 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:46:41.743696 [debug] [MainThread]: On master: COMMIT
[0m19:46:41.743696 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:41.743696 [debug] [MainThread]: On master: COMMIT
[0m19:46:41.743696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:46:41.743696 [debug] [MainThread]: On master: Close
[0m19:46:41.743696 [debug] [Thread-1 (]: Began running node seed.management_control_project.management_control
[0m19:46:41.743696 [info ] [Thread-1 (]: 1 of 1 START seed file public_seeds.management_control ......................... [RUN]
[0m19:46:41.743696 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.management_control_project.management_control'
[0m19:46:41.743696 [debug] [Thread-1 (]: Began compiling node seed.management_control_project.management_control
[0m19:46:41.743696 [debug] [Thread-1 (]: Began executing node seed.management_control_project.management_control
[0m19:46:41.794758 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m19:46:41.794758 [debug] [Thread-1 (]: On seed.management_control_project.management_control: BEGIN
[0m19:46:41.794758 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:46:42.027467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m19:46:42.027467 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m19:46:42.027467 [debug] [Thread-1 (]: On seed.management_control_project.management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "seed.management_control_project.management_control"} */
truncate table "gestion"."public_seeds"."management_control"
[0m19:46:42.027467 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m19:46:42.192796 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m19:46:42.192796 [debug] [Thread-1 (]: On seed.management_control_project.management_control: 
          insert into "gestion"."public_seeds"."management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m19:46:42.192796 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m19:46:42.208439 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.management_control_project.management_control"
[0m19:46:42.242909 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m19:46:42.242909 [debug] [Thread-1 (]: Using postgres connection "seed.management_control_project.management_control"
[0m19:46:42.250909 [debug] [Thread-1 (]: On seed.management_control_project.management_control: COMMIT
[0m19:46:42.250909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:46:42.259477 [debug] [Thread-1 (]: On seed.management_control_project.management_control: Close
[0m19:46:42.259477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec3b1e80-2335-42b3-8e6d-7cf033167a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFCEB4BF0>]}
[0m19:46:42.259477 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_seeds.management_control ..................... [[32mINSERT 100[0m in 0.52s]
[0m19:46:42.259477 [debug] [Thread-1 (]: Finished running node seed.management_control_project.management_control
[0m19:46:42.259477 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:42.259477 [debug] [MainThread]: On master: BEGIN
[0m19:46:42.259477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:42.326727 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m19:46:42.326727 [debug] [MainThread]: On master: COMMIT
[0m19:46:42.326727 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:42.326727 [debug] [MainThread]: On master: COMMIT
[0m19:46:42.326727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:46:42.326727 [debug] [MainThread]: On master: Close
[0m19:46:42.326727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:42.334730 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:46:42.334730 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m19:46:42.334730 [debug] [MainThread]: Connection 'seed.management_control_project.management_control' was properly closed.
[0m19:46:42.334730 [info ] [MainThread]: 
[0m19:46:42.334730 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m19:46:42.334730 [debug] [MainThread]: Command end result
[0m19:46:42.379053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:46:42.379053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:46:42.394275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:46:42.394275 [info ] [MainThread]: 
[0m19:46:42.394275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:42.394275 [info ] [MainThread]: 
[0m19:46:42.394275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:46:42.394275 [debug] [MainThread]: Command `dbt seed` succeeded at 19:46:42.394275 after 5.80 seconds
[0m19:46:42.394275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFAC24920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFD74CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DFF559100>]}
[0m19:46:42.394275 [debug] [MainThread]: Flushing usage events
[0m19:46:42.849840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:59.356767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ABE9FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC0CF500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ABE9D8E0>]}


============================== 19:46:59.372388 | a1eb4814-a2af-4e90-ba08-38b6f5f7924e ==============================
[0m19:46:59.372388 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:46:59.372388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:46:59.748531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC231C10>]}
[0m19:46:59.857900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ABAE5640>]}
[0m19:46:59.857900 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:47:00.172145 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:47:00.505278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:00.505278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:00.605170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC5CF1D0>]}
[0m19:47:00.771456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:47:00.788123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:47:00.821670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC611AF0>]}
[0m19:47:00.821670 [info ] [MainThread]: Found 9 models, 1 snapshot, 22 data tests, 1 seed, 1 source, 702 macros
[0m19:47:00.821670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC58B890>]}
[0m19:47:00.821670 [info ] [MainThread]: 
[0m19:47:00.821670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:00.821670 [info ] [MainThread]: 
[0m19:47:00.837521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:00.841936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:47:00.936818 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:00.936818 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:00.936818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:00.985443 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.054 seconds
[0m19:47:00.985443 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:01.001067 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:01.001067 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:01.001067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:01.032314 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.043 seconds
[0m19:47:01.047947 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:01.047947 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:01.047947 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:01.047947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:01.300131 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.257 seconds
[0m19:47:01.315756 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:01.315756 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:01.331380 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:01.331380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:01.455455 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.127 seconds
[0m19:47:01.455455 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:01.472228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m19:47:01.488840 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:47:01.488840 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:47:01.488840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:01.738669 [debug] [ThreadPool]: SQL status: BEGIN in 0.250 seconds
[0m19:47:01.738669 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:47:01.738669 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:47:01.772026 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m19:47:01.772026 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:47:01.772026 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:47:01.772026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_seeds)
[0m19:47:01.788822 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:47:01.788822 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:47:01.788822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:01.888115 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m19:47:01.888115 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:47:01.888115 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:47:01.904896 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m19:47:01.904896 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:47:01.904896 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:47:01.904896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public)
[0m19:47:01.904896 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:47:01.920678 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:47:01.922471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:02.183659 [debug] [ThreadPool]: SQL status: BEGIN in 0.263 seconds
[0m19:47:02.187348 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:47:02.188654 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:47:02.212880 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m19:47:02.220773 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:47:02.220773 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:47:02.220773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_staging)
[0m19:47:02.236430 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:47:02.252028 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:47:02.252028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:02.382040 [debug] [ThreadPool]: SQL status: BEGIN in 0.130 seconds
[0m19:47:02.382040 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:47:02.382040 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:47:02.397663 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m19:47:02.397663 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:47:02.397663 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:47:02.397663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m19:47:02.397663 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:47:02.397663 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:47:02.397663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:02.460162 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m19:47:02.460162 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:47:02.460162 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:47:02.475801 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m19:47:02.475801 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:47:02.475801 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:47:02.475801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m19:47:02.491410 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:47:02.491410 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:47:02.491410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:02.725772 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m19:47:02.725772 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:47:02.725772 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:47:02.725772 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:47:02.725772 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:47:02.725772 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:47:02.741391 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:02.741391 [debug] [MainThread]: On master: BEGIN
[0m19:47:02.741391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:02.803885 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m19:47:02.803885 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:02.803885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:02.820203 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m19:47:02.820203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC5422A0>]}
[0m19:47:02.820203 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:02.820203 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:02.820203 [debug] [MainThread]: On master: BEGIN
[0m19:47:02.820203 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:47:02.828219 [debug] [MainThread]: On master: COMMIT
[0m19:47:02.828219 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:02.828219 [debug] [MainThread]: On master: COMMIT
[0m19:47:02.828219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:02.828219 [debug] [MainThread]: On master: Close
[0m19:47:02.828219 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m19:47:02.828219 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m19:47:02.836218 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_departement'
[0m19:47:02.836218 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m19:47:02.844271 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m19:47:02.854881 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m19:47:02.904037 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m19:47:02.904037 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:47:02.904037 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m19:47:02.904037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:02.957861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:47:02.957861 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:47:02.957861 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id,
FROM "gestion"."public_seeds"."management_control"
  );
  
[0m19:47:02.957861 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « FROM »
LINE 16: FROM "gestion"."public_seeds"."management_control"
         ^

[0m19:47:02.957861 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: ROLLBACK
[0m19:47:02.957861 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m19:47:02.957861 [debug] [Thread-1 (]: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:47:02.970266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB8148F0>]}
[0m19:47:02.970266 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.dim_departement ................... [[31mERROR[0m in 0.12s]
[0m19:47:02.970266 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m19:47:02.970266 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m19:47:02.970266 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.dim_departement' to be skipped because of status 'error'.  Reason: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql.
[0m19:47:02.970266 [info ] [Thread-1 (]: 2 of 9 START sql table model public.dim_time ................................... [RUN]
[0m19:47:02.978283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_time)
[0m19:47:02.978283 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m19:47:02.978283 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m19:47:02.978283 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m19:47:02.986283 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m19:47:02.989610 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:02.989610 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m19:47:02.989610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.038497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:47:03.038497 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:03.038497 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m19:47:03.061801 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.023 seconds
[0m19:47:03.070470 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:03.070470 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:47:03.070470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:03.094509 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:47:03.094509 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:03.094509 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:47:03.094509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:03.094509 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m19:47:03.110133 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:03.110133 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m19:47:03.110133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:47:03.110133 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m19:47:03.110133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AE4D5160>]}
[0m19:47:03.110133 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.13s]
[0m19:47:03.110133 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m19:47:03.110133 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m19:47:03.110133 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m19:47:03.110133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m19:47:03.110133 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m19:47:03.127754 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m19:47:03.128277 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m19:47:03.171719 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.171719 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp194703156155"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m19:47:03.171719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.225744 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.053 seconds
[0m19:47:03.241372 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.241372 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m19:47:03.241372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:03.241372 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.241372 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp194703156155'
        
      order by ordinal_position

  
[0m19:47:03.257011 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.015 seconds
[0m19:47:03.272619 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.272619 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:47:03.272619 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m19:47:03.272619 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.272619 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:47:03.288240 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m19:47:03.303884 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m19:47:03.303884 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.303884 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp194703156155"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp194703156155"
    )
  
[0m19:47:03.303884 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.001 seconds
[0m19:47:03.303884 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:47:03.303884 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:03.303884 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:47:03.303884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:03.319490 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m19:47:03.319490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ADDB0B90>]}
[0m19:47:03.319490 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.21s]
[0m19:47:03.319490 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m19:47:03.319490 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m19:47:03.319490 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m19:47:03.319490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_status)
[0m19:47:03.319490 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m19:47:03.319490 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m19:47:03.319490 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m19:47:03.336231 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m19:47:03.338157 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:03.338157 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m19:47:03.338157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.387313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m19:47:03.387313 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:03.387313 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:47:03.403663 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m19:47:03.403663 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:03.403663 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:47:03.411664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:03.411664 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:47:03.411664 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:03.411664 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:47:03.411664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:03.420412 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m19:47:03.420412 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:03.420412 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m19:47:03.420412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:47:03.420412 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m19:47:03.420412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AE5B20F0>]}
[0m19:47:03.428413 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.10s]
[0m19:47:03.428413 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m19:47:03.428413 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m19:47:03.428413 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m19:47:03.428413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m19:47:03.428413 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m19:47:03.495083 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m19:47:03.503065 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m19:47:03.503065 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m19:47:03.503065 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:03.503065 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m19:47:03.511109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.542373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m19:47:03.542373 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:03.542373 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m19:47:03.558000 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m19:47:03.558000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:03.558000 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m19:47:03.558000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:03.558000 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:47:03.558000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:03.558000 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:47:03.573607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:03.573607 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m19:47:03.573607 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:03.573607 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m19:47:03.573607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:47:03.573607 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m19:47:03.573607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ABC9E420>]}
[0m19:47:03.573607 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.15s]
[0m19:47:03.573607 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m19:47:03.573607 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m19:47:03.573607 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m19:47:03.573607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m19:47:03.573607 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m19:47:03.592112 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m19:47:03.592112 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m19:47:03.605580 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.605580 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp194703603403"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m19:47:03.605580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.812825 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.211 seconds
[0m19:47:03.812825 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.812825 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m19:47:03.828451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:03.828451 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.828451 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp194703603403'
        
      order by ordinal_position

  
[0m19:47:03.844073 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.020 seconds
[0m19:47:03.859699 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.859699 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m19:47:03.859699 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:47:03.876076 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.876076 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp194703603403'
        
      order by ordinal_position

  
[0m19:47:03.876076 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:47:03.876076 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.876076 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m19:47:03.886732 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:47:03.904605 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:47:03.905796 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m19:47:03.905796 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.905796 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp194703603403"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp194703603403"
    )
  
[0m19:47:03.905796 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m19:47:03.913799 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:47:03.913799 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:03.913799 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:47:03.913799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:03.913799 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m19:47:03.920275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC683C80>]}
[0m19:47:03.920275 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.35s]
[0m19:47:03.920275 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m19:47:03.926337 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m19:47:03.926337 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m19:47:03.929638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m19:47:03.930222 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m19:47:03.955069 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m19:47:03.955069 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m19:47:03.955069 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:03.955069 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

    
  
    

  create temporary table "test_utils__dbt_tmp194703955069"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m19:47:03.955069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:04.011516 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.053 seconds
[0m19:47:04.020200 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.020200 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m19:47:04.020200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:04.020200 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.020200 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'test_utils__dbt_tmp194703955069'
        
      order by ordinal_position

  
[0m19:47:04.036211 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m19:47:04.044251 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.044251 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:47:04.044251 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m19:47:04.044251 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.044251 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:47:04.059896 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m19:47:04.059896 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m19:47:04.059896 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.059896 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      insert into "gestion"."public_staging"."test_utils" ("unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "test_utils__dbt_tmp194703955069"
    )


  
[0m19:47:04.059896 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m19:47:04.075516 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:47:04.075516 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:04.075516 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:47:04.075516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:04.075516 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m19:47:04.075516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AE561EE0>]}
[0m19:47:04.075516 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mINSERT 0 51[0m in 0.15s]
[0m19:47:04.075516 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m19:47:04.075516 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m19:47:04.075516 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m19:47:04.075516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m19:47:04.075516 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m19:47:04.092949 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m19:47:04.093197 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m19:47:04.093197 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.093197 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

    
  
    

  create temporary table "control_growth__dbt_tmp194704093197"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m19:47:04.093197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:04.155507 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.059 seconds
[0m19:47:04.163513 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.163513 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m19:47:04.163513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:04.163513 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.171513 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_growth__dbt_tmp194704093197'
        
      order by ordinal_position

  
[0m19:47:04.187950 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.016 seconds
[0m19:47:04.191323 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.191323 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m19:47:04.191323 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m19:47:04.199285 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.199285 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m19:47:04.204539 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m19:47:04.207326 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m19:47:04.207326 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:04.207326 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
        
            delete from "gestion"."public_management_control"."control_growth"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_growth__dbt_tmp194704093197"
            );

        
    

    insert into "gestion"."public_management_control"."control_growth" ("control_year", "control_month", "monthly_net_profit", "growth_rate")
    (
        select "control_year", "control_month", "monthly_net_profit", "growth_rate"
        from "control_growth__dbt_tmp194704093197"
    )
  
[0m19:47:04.207326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m19:47:04.207326 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m19:47:04.215398 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m19:47:04.215398 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m19:47:04.220871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AE4E7440>]}
[0m19:47:04.221103 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.14s]
[0m19:47:04.223411 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m19:47:04.223411 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m19:47:04.223411 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m19:47:04.223411 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m19:47:04.223411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m19:47:04.223411 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m19:47:04.239277 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m19:47:04.239896 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m19:47:04.239896 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.239896 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp194704239896"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m19:47:04.239896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:04.302596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.060 seconds
[0m19:47:04.310596 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.310596 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m19:47:04.310596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:04.310596 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.310596 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp194704239896'
        
      order by ordinal_position

  
[0m19:47:04.328966 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m19:47:04.338364 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.338364 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m19:47:04.343390 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m19:47:04.343390 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.343390 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m19:47:04.354413 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m19:47:04.354413 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m19:47:04.359425 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:04.359606 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp194704239896"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp194704239896"
    )
  
[0m19:47:04.359606 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m19:47:04.359606 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m19:47:04.359606 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m19:47:04.367249 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m19:47:04.367249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1eb4814-a2af-4e90-ba08-38b6f5f7924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC5CC4D0>]}
[0m19:47:04.369969 [error] [Thread-1 (]: 9 of 9 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.14s]
[0m19:47:04.371736 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m19:47:04.371736 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m19:47:04.374483 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:04.374483 [debug] [MainThread]: On master: BEGIN
[0m19:47:04.374483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:04.438204 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m19:47:04.438204 [debug] [MainThread]: On master: COMMIT
[0m19:47:04.438204 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:04.438204 [debug] [MainThread]: On master: COMMIT
[0m19:47:04.438204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:04.438204 [debug] [MainThread]: On master: Close
[0m19:47:04.438204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:04.438204 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:47:04.438204 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m19:47:04.438204 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m19:47:04.438204 [info ] [MainThread]: 
[0m19:47:04.438204 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m19:47:04.455017 [debug] [MainThread]: Command end result
[0m19:47:04.488910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:47:04.505821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:47:04.505821 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:47:04.505821 [info ] [MainThread]: 
[0m19:47:04.505821 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:47:04.505821 [info ] [MainThread]: 
[0m19:47:04.505821 [error] [MainThread]:   Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:47:04.505821 [info ] [MainThread]: 
[0m19:47:04.519813 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m19:47:04.522732 [info ] [MainThread]: 
[0m19:47:04.522732 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m19:47:04.522732 [info ] [MainThread]: 
[0m19:47:04.522732 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m19:47:04.522732 [debug] [MainThread]: Command `dbt run` failed at 19:47:04.522732 after 5.34 seconds
[0m19:47:04.522732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AE16FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AC677B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229ADD36C30>]}
[0m19:47:04.522732 [debug] [MainThread]: Flushing usage events
[0m19:47:05.038610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:20.718499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F13982030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F13981BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F13981B80>]}


============================== 19:47:20.734128 | 85e45cac-2873-4b58-84d6-a0781e49ee83 ==============================
[0m19:47:20.734128 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:47:20.734128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:21.025968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F12E95BE0>]}
[0m19:47:21.119729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1383FCB0>]}
[0m19:47:21.135339 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:47:21.408814 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:47:21.690044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:21.690044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:21.783789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F14CA2E40>]}
[0m19:47:21.943338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:47:21.949233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:47:21.991367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F13C29F70>]}
[0m19:47:21.991367 [info ] [MainThread]: Found 9 models, 1 snapshot, 22 data tests, 1 seed, 1 source, 702 macros
[0m19:47:21.991367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F13899D60>]}
[0m19:47:21.999449 [info ] [MainThread]: 
[0m19:47:21.999449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:21.999449 [info ] [MainThread]: 
[0m19:47:21.999449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:22.007457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:47:22.097752 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:22.097752 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:22.097752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:22.147563 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.049 seconds
[0m19:47:22.151253 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:22.151253 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:22.151253 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:22.151253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.198124 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.046 seconds
[0m19:47:22.198124 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:22.198124 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:22.198124 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:22.198124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.245015 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.044 seconds
[0m19:47:22.245015 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:22.245015 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:47:22.245015 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:47:22.245015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.291883 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.044 seconds
[0m19:47:22.291883 [debug] [ThreadPool]: On list_gestion: Close
[0m19:47:22.307491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m19:47:22.307491 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:47:22.307491 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:47:22.307491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:22.355092 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:47:22.355092 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:47:22.355092 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:47:22.364880 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:47:22.372894 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:47:22.372894 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:47:22.372894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m19:47:22.372894 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:47:22.372894 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:47:22.372894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.412749 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m19:47:22.412749 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:47:22.412749 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:47:22.428357 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:47:22.428357 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:47:22.428357 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:47:22.428357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m19:47:22.428357 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:47:22.428357 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:47:22.428357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.475230 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m19:47:22.475230 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:47:22.475230 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:47:22.490852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m19:47:22.490852 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:47:22.490852 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:47:22.506481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public)
[0m19:47:22.506481 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:47:22.506481 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:47:22.506481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.568990 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m19:47:22.568990 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:47:22.584597 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:47:22.584597 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:47:22.584597 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:47:22.584597 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:47:22.584597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_management_control)
[0m19:47:22.584597 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:47:22.600222 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:47:22.600222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.631468 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m19:47:22.647092 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:47:22.647092 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:47:22.647092 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:47:22.647092 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:47:22.647092 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:47:22.647092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m19:47:22.662716 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:47:22.662716 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:47:22.662716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:22.693964 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:47:22.709588 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:47:22.709588 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:47:22.709588 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:47:22.709588 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:47:22.709588 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:47:22.725230 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:22.725230 [debug] [MainThread]: On master: BEGIN
[0m19:47:22.725230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:22.772101 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m19:47:22.772101 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:22.772101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:22.787723 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:47:22.787723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15758140>]}
[0m19:47:22.787723 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:22.787723 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:22.787723 [debug] [MainThread]: On master: BEGIN
[0m19:47:22.787723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:47:22.787723 [debug] [MainThread]: On master: COMMIT
[0m19:47:22.787723 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:22.787723 [debug] [MainThread]: On master: COMMIT
[0m19:47:22.787723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:22.787723 [debug] [MainThread]: On master: Close
[0m19:47:22.787723 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m19:47:22.787723 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m19:47:22.787723 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_departement'
[0m19:47:22.787723 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m19:47:22.818089 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m19:47:22.818089 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m19:47:22.864311 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m19:47:22.864311 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:47:22.872349 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m19:47:22.872349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:22.914669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:47:22.914669 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:47:22.914669 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id,
FROM "gestion"."public_seeds"."management_control"
  );
  
[0m19:47:22.914669 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « FROM »
LINE 16: FROM "gestion"."public_seeds"."management_control"
         ^

[0m19:47:22.914669 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: ROLLBACK
[0m19:47:22.914669 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m19:47:22.914669 [debug] [Thread-1 (]: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:47:22.930312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F12E590D0>]}
[0m19:47:22.930312 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.dim_departement ................... [[31mERROR[0m in 0.14s]
[0m19:47:22.930312 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m19:47:22.930312 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m19:47:22.930312 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.dim_departement' to be skipped because of status 'error'.  Reason: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql.
[0m19:47:22.930312 [info ] [Thread-1 (]: 2 of 9 START sql table model public.dim_time ................................... [RUN]
[0m19:47:22.930312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_time)
[0m19:47:22.930312 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m19:47:22.930312 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m19:47:22.930312 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m19:47:22.948839 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m19:47:22.948839 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:22.948839 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m19:47:22.948839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.165755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m19:47:23.165755 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:23.181381 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m19:47:23.275159 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.095 seconds
[0m19:47:23.290750 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:23.290750 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m19:47:23.290750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:23.306397 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:23.306397 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:47:23.306397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:23.353261 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:47:23.353261 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:23.353261 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:47:23.384508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m19:47:23.384508 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m19:47:23.401292 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:47:23.401292 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m19:47:23.422551 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m19:47:23.430574 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m19:47:23.431219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F10DD86B0>]}
[0m19:47:23.431219 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.50s]
[0m19:47:23.431219 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m19:47:23.431219 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m19:47:23.431219 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m19:47:23.431219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m19:47:23.431219 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m19:47:23.431219 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m19:47:23.448841 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m19:47:23.506263 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m19:47:23.506263 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.506263 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m19:47:23.506263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.553541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m19:47:23.553541 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.553541 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m19:47:23.569169 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m19:47:23.569169 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.569169 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m19:47:23.569169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:23.569169 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.569169 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m19:47:23.569169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:23.569169 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:47:23.569169 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.584805 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:47:23.584805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:23.584805 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m19:47:23.584805 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:47:23.584805 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m19:47:23.616090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m19:47:23.616090 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m19:47:23.616090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15BE8710>]}
[0m19:47:23.631660 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.18s]
[0m19:47:23.666974 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m19:47:23.673009 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m19:47:23.681479 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m19:47:23.681479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_status)
[0m19:47:23.689513 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m19:47:23.698862 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m19:47:23.709173 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m19:47:23.731338 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m19:47:23.735577 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:23.735577 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m19:47:23.735577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.852137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.118 seconds
[0m19:47:23.852137 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:23.852137 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:47:23.883391 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.026 seconds
[0m19:47:23.899041 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:23.899041 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m19:47:23.899041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:23.914633 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:23.914633 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:47:23.930966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:47:23.930966 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:47:23.938970 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:23.938970 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:47:23.938970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:24.012394 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m19:47:24.012394 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:47:24.012394 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m19:47:24.012394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:47:24.028000 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m19:47:24.028000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15C16F00>]}
[0m19:47:24.028000 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.35s]
[0m19:47:24.028000 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m19:47:24.028000 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m19:47:24.028000 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m19:47:24.028000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m19:47:24.028000 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m19:47:24.028000 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m19:47:24.028000 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m19:47:24.043640 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m19:47:24.046197 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.047612 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m19:47:24.047612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:24.277428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m19:47:24.277428 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.277428 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m19:47:24.301841 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.020 seconds
[0m19:47:24.301841 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.315742 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m19:47:24.315742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:24.323748 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.332364 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m19:47:24.332364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:24.340364 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:47:24.340364 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.340364 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:47:24.348072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:24.356073 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m19:47:24.356073 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:47:24.356073 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m19:47:24.387919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m19:47:24.387919 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m19:47:24.387919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15742720>]}
[0m19:47:24.387919 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.36s]
[0m19:47:24.427817 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m19:47:24.430923 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m19:47:24.434102 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m19:47:24.434102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m19:47:24.434102 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m19:47:24.447964 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m19:47:24.455964 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m19:47:24.467547 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m19:47:24.467547 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.467547 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m19:47:24.481320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:24.553666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m19:47:24.553666 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.553666 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m19:47:24.569306 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.010 seconds
[0m19:47:24.569306 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.569306 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m19:47:24.569306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:24.569306 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.569306 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m19:47:24.584914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:24.584914 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:47:24.584914 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.584914 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:47:24.584914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:47:24.584914 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m19:47:24.584914 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:47:24.584914 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m19:47:24.631799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m19:47:24.648911 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m19:47:24.654491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F14C5E030>]}
[0m19:47:24.654491 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.22s]
[0m19:47:24.666953 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m19:47:24.666953 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m19:47:24.681293 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m19:47:24.682424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m19:47:24.682424 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m19:47:24.734339 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m19:47:24.734339 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m19:47:24.757190 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m19:47:24.764807 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.764807 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m19:47:24.764807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:24.851363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m19:47:24.851363 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.851363 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m19:47:24.898289 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.046 seconds
[0m19:47:24.898289 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.898289 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m19:47:24.898289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:24.913858 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.913858 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m19:47:24.929518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:24.929518 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:47:24.929518 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.929518 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:47:24.945142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:24.960768 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m19:47:24.960768 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:47:24.960768 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m19:47:24.993854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m19:47:24.997752 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m19:47:24.997752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15B92A50>]}
[0m19:47:25.005751 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.32s]
[0m19:47:25.005751 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m19:47:25.014804 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m19:47:25.014804 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m19:47:25.014804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m19:47:25.014804 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m19:47:25.047467 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m19:47:25.050445 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m19:47:25.050445 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m19:47:25.067521 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.067521 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m19:47:25.067521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:25.306539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.241 seconds
[0m19:47:25.306539 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.306539 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m19:47:25.337751 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.020 seconds
[0m19:47:25.337751 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.337751 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m19:47:25.337751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:25.353376 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.353376 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m19:47:25.353376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:25.353376 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:47:25.369022 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.369022 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:47:25.369022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:25.369022 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m19:47:25.369022 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:47:25.369022 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m19:47:25.415871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m19:47:25.415871 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m19:47:25.415871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15B91550>]}
[0m19:47:25.415871 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.40s]
[0m19:47:25.415871 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m19:47:25.415871 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m19:47:25.415871 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m19:47:25.431499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m19:47:25.433249 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m19:47:25.450435 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m19:47:25.464044 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m19:47:25.471265 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m19:47:25.471265 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.480680 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m19:47:25.483274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:25.579674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m19:47:25.579674 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.579674 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m19:47:25.610902 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.031 seconds
[0m19:47:25.642188 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.642188 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m19:47:25.657783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:25.673433 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.673433 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m19:47:25.673433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:47:25.673433 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:47:25.673433 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.673433 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:47:25.689019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:25.689019 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m19:47:25.689019 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:47:25.689019 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m19:47:25.735916 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m19:47:25.735916 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m19:47:25.735916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e45cac-2873-4b58-84d6-a0781e49ee83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15C7A090>]}
[0m19:47:25.751517 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.30s]
[0m19:47:25.751517 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m19:47:25.751517 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:25.751517 [debug] [MainThread]: On master: BEGIN
[0m19:47:25.751517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:25.838416 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m19:47:25.838416 [debug] [MainThread]: On master: COMMIT
[0m19:47:25.838416 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:25.838416 [debug] [MainThread]: On master: COMMIT
[0m19:47:25.838416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:25.838416 [debug] [MainThread]: On master: Close
[0m19:47:25.838416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:25.838416 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:47:25.838416 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m19:47:25.838416 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m19:47:25.838416 [info ] [MainThread]: 
[0m19:47:25.838416 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m19:47:25.838416 [debug] [MainThread]: Command end result
[0m19:47:25.899157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:47:25.914044 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:47:25.922060 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:47:25.922060 [info ] [MainThread]: 
[0m19:47:25.922060 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:47:25.922060 [info ] [MainThread]: 
[0m19:47:25.922060 [error] [MainThread]:   Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:47:25.922060 [info ] [MainThread]: 
[0m19:47:25.922060 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:47:25.930045 [debug] [MainThread]: Command `dbt run` failed at 19:47:25.930045 after 5.34 seconds
[0m19:47:25.930045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15B84A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F153E7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F15BF2F00>]}
[0m19:47:25.935172 [debug] [MainThread]: Flushing usage events
[0m19:47:26.488825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:40.600938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF099E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF0980E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF09A090>]}


============================== 19:49:40.600938 | 1e312480-a18f-4b90-8027-287b7a0910d7 ==============================
[0m19:49:40.600938 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:49:40.616564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:49:40.918551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF28C980>]}
[0m19:49:41.009129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF6BA540>]}
[0m19:49:41.009129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:49:41.287469 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:49:41.593080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:41.593080 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\OLAP\schema.yaml
[0m19:49:41.992711 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m19:49:42.173375 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.unique_dim_department_department_id.b30c62b76b' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:49:42.173375 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.not_null_dim_department_department_id.00afe97aab' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:49:42.173375 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.relationships_fact_management_control_department_id__department_id__ref_dim_department_.7d77b4615d' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m19:49:42.299822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC11576E0>]}
[0m19:49:42.440456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:49:42.440456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:49:42.471686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1244CB0>]}
[0m19:49:42.487311 [info ] [MainThread]: Found 9 models, 1 snapshot, 20 data tests, 1 seed, 1 source, 702 macros
[0m19:49:42.487311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC107AC00>]}
[0m19:49:42.487311 [info ] [MainThread]: 
[0m19:49:42.487311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:49:42.499826 [info ] [MainThread]: 
[0m19:49:42.500274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:42.511278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:49:42.686824 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:49:42.686824 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:49:42.686824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:42.764930 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.070 seconds
[0m19:49:42.764930 [debug] [ThreadPool]: On list_gestion: Close
[0m19:49:42.764930 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:49:42.764930 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:49:42.764930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:42.827422 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.058 seconds
[0m19:49:42.827422 [debug] [ThreadPool]: On list_gestion: Close
[0m19:49:42.827422 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:49:42.827422 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:49:42.827422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:42.889935 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.058 seconds
[0m19:49:42.889935 [debug] [ThreadPool]: On list_gestion: Close
[0m19:49:42.905560 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:49:42.905560 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:49:42.905560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.143300 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.235 seconds
[0m19:49:43.143300 [debug] [ThreadPool]: On list_gestion: Close
[0m19:49:43.143300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m19:49:43.176908 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:49:43.176908 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:49:43.176908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:43.276091 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m19:49:43.276091 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:49:43.276091 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:49:43.292564 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m19:49:43.292564 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:49:43.292564 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:49:43.292564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m19:49:43.309615 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:49:43.309615 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:49:43.309615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.375636 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m19:49:43.375636 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:49:43.375636 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:49:43.392437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:49:43.392437 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:49:43.392437 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:49:43.392437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public)
[0m19:49:43.392437 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:49:43.392437 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:49:43.392437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.442365 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m19:49:43.442365 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:49:43.442365 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:49:43.459346 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m19:49:43.459346 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:49:43.459346 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:49:43.459346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_management_control)
[0m19:49:43.459346 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:49:43.459346 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:49:43.459346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.726365 [debug] [ThreadPool]: SQL status: BEGIN in 0.264 seconds
[0m19:49:43.726365 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:49:43.726365 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:49:43.759588 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.024 seconds
[0m19:49:43.759588 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:49:43.759588 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:49:43.759588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m19:49:43.776525 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:49:43.776525 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:49:43.776525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.907545 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m19:49:43.907545 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:49:43.907545 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:49:43.938795 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.023 seconds
[0m19:49:43.938795 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:49:43.938795 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:49:43.954430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m19:49:43.954430 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:49:43.970054 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:49:43.970054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:44.079413 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m19:49:44.079413 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:49:44.095050 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:49:44.095050 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m19:49:44.095050 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:49:44.110659 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:49:44.110659 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:44.110659 [debug] [MainThread]: On master: BEGIN
[0m19:49:44.110659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:44.158523 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m19:49:44.158523 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:44.158523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:44.174538 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:49:44.174538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC147DD60>]}
[0m19:49:44.174538 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:44.174538 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:44.174538 [debug] [MainThread]: On master: BEGIN
[0m19:49:44.174538 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:49:44.174538 [debug] [MainThread]: On master: COMMIT
[0m19:49:44.174538 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:44.174538 [debug] [MainThread]: On master: COMMIT
[0m19:49:44.182542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:44.182542 [debug] [MainThread]: On master: Close
[0m19:49:44.182542 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m19:49:44.182542 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m19:49:44.182542 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_departement'
[0m19:49:44.182542 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m19:49:44.193349 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m19:49:44.193349 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m19:49:44.242533 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m19:49:44.242533 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:49:44.242533 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m19:49:44.242533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:49:44.292377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:49:44.292377 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:49:44.292377 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id,
FROM "gestion"."public_seeds"."management_control"
  );
  
[0m19:49:44.292377 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « FROM »
LINE 16: FROM "gestion"."public_seeds"."management_control"
         ^

[0m19:49:44.292377 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: ROLLBACK
[0m19:49:44.292377 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m19:49:44.308188 [debug] [Thread-1 (]: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:49:44.312375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBE9D4EC0>]}
[0m19:49:44.312375 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.dim_departement ................... [[31mERROR[0m in 0.13s]
[0m19:49:44.312375 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m19:49:44.312375 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m19:49:44.312375 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.dim_departement' to be skipped because of status 'error'.  Reason: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql.
[0m19:49:44.312375 [info ] [Thread-1 (]: 2 of 9 START sql table model public.dim_time ................................... [RUN]
[0m19:49:44.312375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_time)
[0m19:49:44.312375 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m19:49:44.325687 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m19:49:44.325687 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m19:49:44.333688 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m19:49:44.333688 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.333688 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m19:49:44.333688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:44.376404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m19:49:44.391757 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.391757 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m19:49:44.408413 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.019 seconds
[0m19:49:44.416433 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.416433 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m19:49:44.416433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:44.424413 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.424413 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:49:44.424413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:44.448103 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:49:44.448103 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.448103 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:49:44.448103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:49:44.448103 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m19:49:44.463708 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:49:44.463708 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m19:49:44.463708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:49:44.463708 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m19:49:44.463708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBC958470>]}
[0m19:49:44.463708 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.15s]
[0m19:49:44.463708 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m19:49:44.479333 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m19:49:44.479333 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m19:49:44.479333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m19:49:44.479333 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m19:49:44.479333 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m19:49:44.479333 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m19:49:44.526743 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m19:49:44.526743 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.526743 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m19:49:44.526743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:44.755206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.235 seconds
[0m19:49:44.755206 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.755206 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m19:49:44.786453 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.017 seconds
[0m19:49:44.786453 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.786453 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m19:49:44.802059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:44.802059 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.802059 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m19:49:44.802059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:44.817683 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:49:44.817683 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.817683 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:49:44.817683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:49:44.833326 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m19:49:44.833326 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:49:44.833326 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m19:49:44.833326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m19:49:44.833326 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m19:49:44.848928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1837DD0>]}
[0m19:49:44.848928 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.37s]
[0m19:49:44.848928 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m19:49:44.848928 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m19:49:44.848928 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m19:49:44.862683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_status)
[0m19:49:44.866331 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m19:49:44.878430 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m19:49:44.878430 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m19:49:44.891867 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m19:49:44.896941 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.896941 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m19:49:44.896941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:44.965733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m19:49:44.965733 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.965733 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:49:44.981358 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m19:49:44.981358 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.981358 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m19:49:44.981358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:44.981358 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.981358 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:49:44.981358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:44.981358 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:49:44.997000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.997000 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:49:44.997000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:49:44.997000 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m19:49:44.997000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:49:44.997000 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m19:49:44.997000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:49:45.012620 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m19:49:45.012620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1856690>]}
[0m19:49:45.012620 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.16s]
[0m19:49:45.012620 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m19:49:45.012620 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m19:49:45.012620 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m19:49:45.012620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m19:49:45.012620 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m19:49:45.012620 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m19:49:45.012620 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m19:49:45.028232 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m19:49:45.030968 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.031438 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m19:49:45.031438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:45.076008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:49:45.076008 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.076008 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m19:49:45.091541 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m19:49:45.091541 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.091541 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m19:49:45.091541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:45.099541 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.099541 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m19:49:45.099541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:45.099541 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:49:45.099541 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.099541 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:49:45.108234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:49:45.108234 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m19:49:45.108234 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:49:45.108234 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m19:49:45.116829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:49:45.116829 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m19:49:45.116829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1179CA0>]}
[0m19:49:45.116829 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.10s]
[0m19:49:45.124832 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m19:49:45.124832 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m19:49:45.124832 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m19:49:45.124832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m19:49:45.124832 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m19:49:45.124832 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m19:49:45.132874 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m19:49:45.135515 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m19:49:45.141287 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.142867 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m19:49:45.142867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:45.352544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m19:49:45.368149 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.368149 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m19:49:45.383772 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.018 seconds
[0m19:49:45.399415 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.399415 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m19:49:45.399415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:49:45.415015 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.415015 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m19:49:45.415015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:45.415015 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:49:45.415015 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.415015 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:49:45.430643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:49:45.430643 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m19:49:45.430643 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:49:45.430643 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m19:49:45.446262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m19:49:45.446262 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m19:49:45.446262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1889010>]}
[0m19:49:45.461910 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.32s]
[0m19:49:45.461910 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m19:49:45.461910 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m19:49:45.461910 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m19:49:45.474106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m19:49:45.474106 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m19:49:45.543512 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m19:49:45.543512 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m19:49:45.566576 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m19:49:45.566576 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.566576 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m19:49:45.566576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:45.654252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m19:49:45.669880 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.669880 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m19:49:45.701127 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.026 seconds
[0m19:49:45.716778 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.716778 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m19:49:45.716778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:45.732381 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.732381 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m19:49:45.732381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:45.732381 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:49:45.750137 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.757940 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:49:45.765950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:49:45.775411 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m19:49:45.775411 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:49:45.775411 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m19:49:45.791410 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m19:49:45.799505 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m19:49:45.799505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC13D4FE0>]}
[0m19:49:45.799505 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.34s]
[0m19:49:45.799505 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m19:49:45.815159 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m19:49:45.818395 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m19:49:45.826272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m19:49:45.826272 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m19:49:45.842905 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m19:49:45.863428 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m19:49:45.878320 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m19:49:45.878320 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.878320 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m19:49:45.878320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:45.948013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:49:45.948013 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.963639 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m19:49:45.963639 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m19:49:45.979278 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.979278 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m19:49:45.979278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:45.979278 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.979278 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m19:49:45.979278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:45.979278 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:49:45.979278 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.994888 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:49:45.994888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:49:45.994888 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m19:49:45.994888 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:49:45.994888 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m19:49:45.994888 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:49:46.010509 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m19:49:46.010509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC13D5910>]}
[0m19:49:46.010509 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.19s]
[0m19:49:46.010509 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m19:49:46.010509 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m19:49:46.010509 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m19:49:46.010509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m19:49:46.010509 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m19:49:46.028729 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m19:49:46.028729 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m19:49:46.042853 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m19:49:46.042853 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.042853 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m19:49:46.042853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:46.100045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m19:49:46.100045 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.100045 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m19:49:46.116087 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m19:49:46.116087 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.116087 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m19:49:46.116087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:46.116087 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.116087 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m19:49:46.116087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:46.116087 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:49:46.131729 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.131729 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:49:46.131729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:49:46.131729 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m19:49:46.131729 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:49:46.131729 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m19:49:46.131729 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:49:46.131729 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m19:49:46.147335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e312480-a18f-4b90-8027-287b7a0910d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC18E31D0>]}
[0m19:49:46.147335 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.12s]
[0m19:49:46.147335 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m19:49:46.147335 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:46.147335 [debug] [MainThread]: On master: BEGIN
[0m19:49:46.147335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:46.199246 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m19:49:46.199246 [debug] [MainThread]: On master: COMMIT
[0m19:49:46.199246 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:46.199246 [debug] [MainThread]: On master: COMMIT
[0m19:49:46.199246 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:46.199246 [debug] [MainThread]: On master: Close
[0m19:49:46.199246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:46.199246 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:49:46.199246 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m19:49:46.207914 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m19:49:46.207914 [info ] [MainThread]: 
[0m19:49:46.209241 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m19:49:46.209241 [debug] [MainThread]: Command end result
[0m19:49:46.258500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:49:46.259990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:49:46.259990 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:49:46.259990 [info ] [MainThread]: 
[0m19:49:46.259990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:49:46.259990 [info ] [MainThread]: 
[0m19:49:46.259990 [error] [MainThread]:   Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_seeds"."management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:49:46.276029 [info ] [MainThread]: 
[0m19:49:46.276029 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:49:46.276029 [debug] [MainThread]: Command `dbt run` failed at 19:49:46.276029 after 5.87 seconds
[0m19:49:46.276029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBF502AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFBD1FC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFC1858BC0>]}
[0m19:49:46.276029 [debug] [MainThread]: Flushing usage events
[0m19:49:46.819167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:33.661931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0393ACBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A038EC09E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0368643B0>]}


============================== 19:50:33.677736 | 2ee778a5-3bbb-487b-b01f-252e4925afd5 ==============================
[0m19:50:33.677736 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:50:33.677736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:33.988327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A039017830>]}
[0m19:50:34.066446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A038B5C950>]}
[0m19:50:34.082058 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:50:34.367007 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:50:34.679483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:34.679483 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\OLAP\dim_departement.sql
[0m19:50:35.103331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03A9B7590>]}
[0m19:50:35.268581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:50:35.277182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:50:35.308444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B18C5F0>]}
[0m19:50:35.308444 [info ] [MainThread]: Found 9 models, 1 snapshot, 20 data tests, 1 seed, 1 source, 702 macros
[0m19:50:35.308444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03AC96450>]}
[0m19:50:35.324059 [info ] [MainThread]: 
[0m19:50:35.328660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:35.330320 [info ] [MainThread]: 
[0m19:50:35.330320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:35.330320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:50:35.451465 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:50:35.451465 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:50:35.451465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:35.498353 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.055 seconds
[0m19:50:35.498353 [debug] [ThreadPool]: On list_gestion: Close
[0m19:50:35.498353 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:50:35.513963 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:50:35.513963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:35.560849 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.047 seconds
[0m19:50:35.560849 [debug] [ThreadPool]: On list_gestion: Close
[0m19:50:35.560849 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:50:35.560849 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:50:35.560849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:35.607725 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.047 seconds
[0m19:50:35.607725 [debug] [ThreadPool]: On list_gestion: Close
[0m19:50:35.623332 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:50:35.623332 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:50:35.623332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:35.670201 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.046 seconds
[0m19:50:35.670201 [debug] [ThreadPool]: On list_gestion: Close
[0m19:50:35.670201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m19:50:35.670201 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:50:35.685844 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:50:35.685844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:35.717072 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:50:35.717072 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:50:35.717072 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:50:35.732698 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:50:35.732698 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:50:35.732698 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:50:35.732698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m19:50:35.732698 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:50:35.732698 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:50:35.748320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:35.793819 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m19:50:35.793819 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:50:35.793819 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:50:35.802255 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:50:35.802255 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:50:35.802255 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:50:35.802255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public)
[0m19:50:35.810379 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:50:35.810379 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:50:35.810379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:36.076014 [debug] [ThreadPool]: SQL status: BEGIN in 0.265 seconds
[0m19:50:36.076014 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:50:36.076014 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:50:36.107272 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m19:50:36.107272 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:50:36.107272 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:50:36.122897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_seeds)
[0m19:50:36.138495 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:50:36.138495 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:50:36.138495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:36.247852 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m19:50:36.247852 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:50:36.247852 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:50:36.263493 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:50:36.263493 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:50:36.263493 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:50:36.263493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_snapshots)
[0m19:50:36.263493 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:50:36.279099 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:50:36.279099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:36.311360 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:50:36.311360 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:50:36.311360 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:50:36.327054 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:50:36.327054 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:50:36.335056 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:50:36.335056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_management_control)
[0m19:50:36.335056 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:50:36.335056 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:50:36.335056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:36.375112 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m19:50:36.375112 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:50:36.375112 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:50:36.390742 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m19:50:36.390742 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:50:36.390742 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:50:36.406350 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:36.406350 [debug] [MainThread]: On master: BEGIN
[0m19:50:36.406350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:36.453225 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m19:50:36.453225 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:36.453225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:36.453225 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m19:50:36.453225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B5A6BD0>]}
[0m19:50:36.453225 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:36.468846 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:36.468846 [debug] [MainThread]: On master: BEGIN
[0m19:50:36.468846 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:50:36.468846 [debug] [MainThread]: On master: COMMIT
[0m19:50:36.468846 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:36.468846 [debug] [MainThread]: On master: COMMIT
[0m19:50:36.468846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:36.468846 [debug] [MainThread]: On master: Close
[0m19:50:36.468846 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m19:50:36.468846 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_time ................................... [RUN]
[0m19:50:36.468846 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_time'
[0m19:50:36.468846 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m19:50:36.487399 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m19:50:36.487399 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m19:50:36.598069 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m19:50:36.598069 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.598069 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m19:50:36.598069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:36.644937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m19:50:36.644937 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.644937 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m19:50:36.660561 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.018 seconds
[0m19:50:36.660561 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.660561 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m19:50:36.660561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:36.676188 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.676188 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:50:36.676188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:36.691809 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:50:36.691809 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.691809 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:50:36.707485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:50:36.723083 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m19:50:36.723083 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:50:36.738705 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m19:50:36.738705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:50:36.738705 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m19:50:36.754321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A036A78380>]}
[0m19:50:36.754321 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.27s]
[0m19:50:36.754321 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m19:50:36.754321 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m19:50:36.754321 [info ] [Thread-1 (]: 2 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m19:50:36.754321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m19:50:36.754321 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m19:50:36.754321 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m19:50:36.754321 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m19:50:36.811699 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m19:50:36.811699 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.811699 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m19:50:36.811699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:36.860258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:50:36.860258 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.860258 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m19:50:36.880628 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m19:50:36.888648 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.888648 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m19:50:36.888648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:36.893694 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.893694 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m19:50:36.893694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:36.893694 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:50:36.893694 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.893694 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:50:36.893694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:36.901710 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m19:50:36.901710 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:50:36.901710 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m19:50:36.910075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:50:36.910075 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m19:50:36.910075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B59A840>]}
[0m19:50:36.910075 [info ] [Thread-1 (]: 2 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.16s]
[0m19:50:36.910075 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m19:50:36.910075 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m19:50:36.910075 [info ] [Thread-1 (]: 3 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m19:50:36.910075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_departement)
[0m19:50:36.910075 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m19:50:36.910075 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m19:50:36.910075 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m19:50:36.928371 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m19:50:36.928371 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:50:36.928371 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m19:50:36.928371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:36.978248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:50:36.978248 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:50:36.978248 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id,
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:50:36.978248 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « FROM »
LINE 16: FROM "gestion"."public_staging"."stg_management_control"
         ^

[0m19:50:36.978248 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: ROLLBACK
[0m19:50:36.978248 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m19:50:36.978248 [debug] [Thread-1 (]: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_staging"."stg_management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:50:36.978248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03A9615B0>]}
[0m19:50:36.978248 [error] [Thread-1 (]: 3 of 9 ERROR creating sql table model public.dim_departement ................... [[31mERROR[0m in 0.07s]
[0m19:50:36.993562 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m19:50:36.993562 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m19:50:36.993562 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.dim_departement' to be skipped because of status 'error'.  Reason: Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_staging"."stg_management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql.
[0m19:50:36.993562 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m19:50:36.993562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_status)
[0m19:50:36.993562 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m19:50:37.001564 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m19:50:37.001564 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m19:50:37.010767 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m19:50:37.010767 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.010767 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m19:50:37.010767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.060038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:50:37.060249 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.060249 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:50:37.068252 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m19:50:37.076268 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.076921 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m19:50:37.076921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.076921 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.076921 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:50:37.084943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.084943 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:50:37.084943 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.084943 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:50:37.084943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:50:37.092938 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m19:50:37.092938 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:50:37.092938 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m19:50:37.100966 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:50:37.100966 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m19:50:37.100966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B65FEC0>]}
[0m19:50:37.100966 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.11s]
[0m19:50:37.100966 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m19:50:37.100966 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m19:50:37.100966 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m19:50:37.100966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m19:50:37.100966 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m19:50:37.100966 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m19:50:37.100966 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m19:50:37.119676 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m19:50:37.119676 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.126651 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m19:50:37.128171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.168311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:50:37.168311 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.168311 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m19:50:37.176293 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.007 seconds
[0m19:50:37.184332 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.184332 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m19:50:37.184332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.184332 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.184332 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m19:50:37.184332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.184332 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:50:37.184332 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.184332 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:50:37.199971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:50:37.199971 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m19:50:37.199971 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:50:37.199971 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m19:50:37.199971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:50:37.199971 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m19:50:37.199971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B5AFE90>]}
[0m19:50:37.199971 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.10s]
[0m19:50:37.215581 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m19:50:37.215581 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m19:50:37.215581 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m19:50:37.215581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m19:50:37.222178 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m19:50:37.223979 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m19:50:37.223979 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m19:50:37.223979 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m19:50:37.239622 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.239622 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m19:50:37.239622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.301494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m19:50:37.301494 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.301494 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m19:50:37.318977 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.012 seconds
[0m19:50:37.318977 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.318977 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m19:50:37.318977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.326976 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.326976 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m19:50:37.326976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.335022 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:50:37.335022 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.335022 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:50:37.335022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:37.335022 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m19:50:37.335022 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:50:37.335022 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m19:50:37.335022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:50:37.350647 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m19:50:37.350647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B18F020>]}
[0m19:50:37.350647 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.14s]
[0m19:50:37.350647 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m19:50:37.350647 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m19:50:37.350647 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m19:50:37.362548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m19:50:37.364046 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m19:50:37.378593 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m19:50:37.378593 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m19:50:37.397275 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m19:50:37.397275 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.397275 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m19:50:37.397275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.443482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:50:37.443482 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.443482 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m19:50:37.452119 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m19:50:37.460125 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.460125 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m19:50:37.460125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.460125 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.468175 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m19:50:37.468175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.468175 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:50:37.468175 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.468175 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:50:37.468175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:50:37.468175 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m19:50:37.468175 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:50:37.468175 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m19:50:37.483799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:50:37.483799 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m19:50:37.483799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B9DA1E0>]}
[0m19:50:37.483799 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.13s]
[0m19:50:37.483799 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m19:50:37.483799 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m19:50:37.483799 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m19:50:37.483799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m19:50:37.483799 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m19:50:37.483799 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m19:50:37.499423 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m19:50:37.502644 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m19:50:37.502644 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.502644 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m19:50:37.502644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.551482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:50:37.551482 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.551482 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m19:50:37.559482 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.010 seconds
[0m19:50:37.567522 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.567522 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m19:50:37.567522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.567522 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.567522 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m19:50:37.567522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:50:37.567522 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:50:37.567522 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.567522 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:50:37.567522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:37.583160 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m19:50:37.583160 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:50:37.583160 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m19:50:37.583160 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:50:37.583160 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m19:50:37.583160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B6674A0>]}
[0m19:50:37.583160 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.10s]
[0m19:50:37.598771 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m19:50:37.598771 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m19:50:37.598771 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m19:50:37.598771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m19:50:37.598771 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m19:50:37.598771 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m19:50:37.598771 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m19:50:37.616597 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m19:50:37.616597 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.616597 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m19:50:37.616597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:37.856029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.232 seconds
[0m19:50:37.856029 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.856029 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m19:50:37.876799 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.016 seconds
[0m19:50:37.888047 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.888047 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m19:50:37.888047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:37.895253 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.895253 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m19:50:37.895253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:37.912160 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:50:37.912160 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.912160 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:50:37.912160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:50:37.920134 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m19:50:37.928399 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:50:37.928399 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m19:50:37.935974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m19:50:37.935974 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m19:50:37.945215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee778a5-3bbb-487b-b01f-252e4925afd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B9F41A0>]}
[0m19:50:37.945215 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.35s]
[0m19:50:37.948947 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m19:50:37.951882 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:37.951882 [debug] [MainThread]: On master: BEGIN
[0m19:50:37.951882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:38.033741 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m19:50:38.033741 [debug] [MainThread]: On master: COMMIT
[0m19:50:38.033741 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:38.033741 [debug] [MainThread]: On master: COMMIT
[0m19:50:38.033741 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:38.041758 [debug] [MainThread]: On master: Close
[0m19:50:38.043687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:38.044567 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:50:38.044567 [debug] [MainThread]: Connection 'list_gestion_public_management_control' was properly closed.
[0m19:50:38.044567 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m19:50:38.047593 [info ] [MainThread]: 
[0m19:50:38.047593 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m19:50:38.047593 [debug] [MainThread]: Command end result
[0m19:50:38.111561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:50:38.111561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:50:38.134665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:50:38.134665 [info ] [MainThread]: 
[0m19:50:38.134665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:50:38.134665 [info ] [MainThread]: 
[0m19:50:38.134665 [error] [MainThread]:   Database Error in model dim_departement (models\OLAP\dim_departement.sql)
  ERREUR:  erreur de syntaxe sur ou près de « FROM »
  LINE 16: FROM "gestion"."public_staging"."stg_management_control"
           ^
  compiled code at target\run\management_control_project\models\OLAP\dim_departement.sql
[0m19:50:38.143354 [info ] [MainThread]: 
[0m19:50:38.145576 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:50:38.145576 [debug] [MainThread]: Command `dbt run` failed at 19:50:38.145576 after 4.61 seconds
[0m19:50:38.145576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03B1A0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03947AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03947B2F0>]}
[0m19:50:38.145576 [debug] [MainThread]: Flushing usage events
[0m19:50:38.709808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:55.231105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96105640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96105610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C9678B110>]}


============================== 19:51:55.246729 | ab584c88-14c6-4cb6-962a-be9379be558d ==============================
[0m19:51:55.246729 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:51:55.246729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:55.637926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96E8EB10>]}
[0m19:51:55.748321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96BF2B40>]}
[0m19:51:55.748321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:51:56.110160 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:51:56.437721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:56.437721 [debug] [MainThread]: Partial parsing: updated file: management_control_project://models\OLAP\dim_departement.sql
[0m19:51:56.970916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C986193A0>]}
[0m19:51:57.189653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:51:57.189653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:51:57.254122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C986E4E90>]}
[0m19:51:57.254122 [info ] [MainThread]: Found 9 models, 1 snapshot, 20 data tests, 1 seed, 1 source, 702 macros
[0m19:51:57.254122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C987CA2A0>]}
[0m19:51:57.254122 [info ] [MainThread]: 
[0m19:51:57.254122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:57.254122 [info ] [MainThread]: 
[0m19:51:57.254122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:57.254122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m19:51:57.370435 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:51:57.370435 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:51:57.370435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:57.425328 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.054 seconds
[0m19:51:57.425328 [debug] [ThreadPool]: On list_gestion: Close
[0m19:51:57.425328 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:51:57.425328 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:51:57.425328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:57.487822 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.052 seconds
[0m19:51:57.487822 [debug] [ThreadPool]: On list_gestion: Close
[0m19:51:57.487822 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:51:57.487822 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:51:57.487822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:57.534693 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.045 seconds
[0m19:51:57.534693 [debug] [ThreadPool]: On list_gestion: Close
[0m19:51:57.550319 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m19:51:57.550319 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m19:51:57.550319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:57.597193 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.057 seconds
[0m19:51:57.612814 [debug] [ThreadPool]: On list_gestion: Close
[0m19:51:57.612814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_staging'
[0m19:51:57.628441 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:51:57.628441 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:51:57.628441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:57.786440 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m19:51:57.786440 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:51:57.786440 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:51:57.786440 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:51:57.786440 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:51:57.786440 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:51:57.802064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m19:51:57.802064 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:51:57.802064 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:51:57.802064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.036423 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m19:51:58.036423 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:51:58.036423 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:51:58.052049 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m19:51:58.067673 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:51:58.067673 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:51:58.067673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_intermediate)
[0m19:51:58.067673 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:51:58.067673 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:51:58.067673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.239535 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m19:51:58.239535 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:51:58.239535 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:51:58.239535 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m19:51:58.255158 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:51:58.255158 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:51:58.255158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m19:51:58.255158 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:51:58.255158 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:51:58.255158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.303827 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m19:51:58.303827 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:51:58.303827 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:51:58.319454 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:51:58.319454 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:51:58.319454 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:51:58.319454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public)
[0m19:51:58.319454 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:51:58.319454 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:51:58.319454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.538223 [debug] [ThreadPool]: SQL status: BEGIN in 0.220 seconds
[0m19:51:58.538223 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:51:58.553812 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:51:58.585061 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.027 seconds
[0m19:51:58.585061 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:51:58.585061 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:51:58.600687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_seeds)
[0m19:51:58.616308 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:51:58.616308 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:51:58.616308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.694426 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m19:51:58.694426 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:51:58.694426 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:51:58.710050 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m19:51:58.710050 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:51:58.710050 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:51:58.725676 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:58.725676 [debug] [MainThread]: On master: BEGIN
[0m19:51:58.725676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:58.788169 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m19:51:58.788169 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:58.788169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:58.804164 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m19:51:58.804705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98B2A1B0>]}
[0m19:51:58.804705 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:58.804705 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:58.804705 [debug] [MainThread]: On master: BEGIN
[0m19:51:58.804705 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:51:58.804705 [debug] [MainThread]: On master: COMMIT
[0m19:51:58.804705 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:58.804705 [debug] [MainThread]: On master: COMMIT
[0m19:51:58.804705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:58.804705 [debug] [MainThread]: On master: Close
[0m19:51:58.804705 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m19:51:58.820487 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_time ................................... [RUN]
[0m19:51:58.820487 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_time'
[0m19:51:58.820487 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m19:51:58.836994 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m19:51:58.836994 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m19:51:58.974838 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m19:51:58.974838 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:58.974838 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m19:51:58.974838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:59.021711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:51:59.021711 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:59.021711 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m19:51:59.037351 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.017 seconds
[0m19:51:59.037351 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:59.037351 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m19:51:59.052975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.052975 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:59.052975 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m19:51:59.052975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.084213 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:51:59.084213 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:59.084213 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m19:51:59.084213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:51:59.099829 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m19:51:59.099829 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m19:51:59.099829 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m19:51:59.115471 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:51:59.115471 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m19:51:59.115471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C960C9010>]}
[0m19:51:59.115471 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.29s]
[0m19:51:59.115471 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m19:51:59.115471 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m19:51:59.115471 [info ] [Thread-1 (]: 2 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m19:51:59.115471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m19:51:59.115471 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m19:51:59.133039 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m19:51:59.133504 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m19:51:59.177218 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m19:51:59.177218 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.177218 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m19:51:59.177218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.228460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:51:59.228460 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.228460 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m19:51:59.236471 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m19:51:59.244489 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.244489 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m19:51:59.244489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:51:59.244489 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.244489 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m19:51:59.244489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:51:59.244489 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:51:59.244489 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.244489 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m19:51:59.244489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:51:59.260114 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m19:51:59.260114 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m19:51:59.260114 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m19:51:59.260114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:51:59.260114 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m19:51:59.260114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C985FADB0>]}
[0m19:51:59.260114 [info ] [Thread-1 (]: 2 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.14s]
[0m19:51:59.260114 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m19:51:59.260114 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m19:51:59.275755 [info ] [Thread-1 (]: 3 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m19:51:59.275755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_departement)
[0m19:51:59.275755 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m19:51:59.275755 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m19:51:59.275755 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m19:51:59.275755 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m19:51:59.275755 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:51:59.275755 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m19:51:59.275755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.353739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m19:51:59.353739 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:51:59.353739 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:51:59.361744 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.009 seconds
[0m19:51:59.370221 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:51:59.370221 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
alter table "gestion"."public"."dim_departement__dbt_tmp" rename to "dim_departement"
[0m19:51:59.370221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.370221 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m19:51:59.370221 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:51:59.370221 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m19:51:59.370221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:51:59.385847 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_departement__dbt_backup"
[0m19:51:59.385847 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m19:51:59.385847 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
drop table if exists "gestion"."public"."dim_departement__dbt_backup" cascade
[0m19:51:59.385847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:51:59.385847 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m19:51:59.385847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C988695E0>]}
[0m19:51:59.401470 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.dim_departement ....................... [[32mSELECT 5[0m in 0.11s]
[0m19:51:59.401470 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m19:51:59.401470 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m19:51:59.401470 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m19:51:59.401470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_status)
[0m19:51:59.401470 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m19:51:59.401470 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m19:51:59.418153 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m19:51:59.424870 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m19:51:59.424870 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.424870 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m19:51:59.436820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.495645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m19:51:59.503770 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.503770 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m19:51:59.511770 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m19:51:59.519771 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.527821 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m19:51:59.527821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.527821 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.527821 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m19:51:59.527821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.527821 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:51:59.543446 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.543446 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m19:51:59.543446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:51:59.543446 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m19:51:59.543446 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m19:51:59.543446 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m19:51:59.559069 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:51:59.559069 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m19:51:59.559069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98BF64B0>]}
[0m19:51:59.559069 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.16s]
[0m19:51:59.559069 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m19:51:59.559069 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m19:51:59.559069 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m19:51:59.574694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m19:51:59.576336 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m19:51:59.582877 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m19:51:59.586820 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m19:51:59.589328 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m19:51:59.589328 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.589328 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m19:51:59.589328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.653666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m19:51:59.661668 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.661668 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m19:51:59.669666 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.007 seconds
[0m19:51:59.669666 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.669666 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m19:51:59.669666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:51:59.677704 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.677704 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m19:51:59.677704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:51:59.677704 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:51:59.677704 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.677704 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m19:51:59.677704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:51:59.677704 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m19:51:59.677704 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m19:51:59.677704 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m19:51:59.693328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:51:59.693328 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m19:51:59.693328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98592960>]}
[0m19:51:59.693328 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.12s]
[0m19:51:59.693328 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m19:51:59.693328 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m19:51:59.693328 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m19:51:59.693328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m19:51:59.693328 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m19:51:59.693328 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m19:51:59.693328 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m19:51:59.715677 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m19:51:59.715677 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.715677 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m19:51:59.720204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.770303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m19:51:59.770303 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.770303 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m19:51:59.778769 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m19:51:59.786981 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.786981 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m19:51:59.786981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:51:59.794984 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.802981 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m19:51:59.802981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:59.802981 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:51:59.802981 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.802981 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m19:51:59.811016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:51:59.811016 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m19:51:59.811016 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m19:51:59.811016 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m19:51:59.811016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:51:59.826643 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m19:51:59.826643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98B491C0>]}
[0m19:51:59.826643 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.13s]
[0m19:51:59.826643 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m19:51:59.826643 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m19:51:59.826643 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m19:51:59.826643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m19:51:59.826643 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m19:51:59.870064 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m19:51:59.870064 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m19:51:59.888596 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m19:51:59.888596 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:51:59.888596 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m19:51:59.888596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:00.038151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m19:52:00.038151 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:52:00.038151 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m19:52:00.053774 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.013 seconds
[0m19:52:00.069400 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:52:00.069400 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m19:52:00.069400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:52:00.069400 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:52:00.069400 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m19:52:00.069400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:52:00.085023 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:52:00.085023 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:52:00.085023 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m19:52:00.085023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:52:00.085023 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m19:52:00.085023 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m19:52:00.085023 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m19:52:00.100650 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:52:00.100650 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m19:52:00.100650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98B512E0>]}
[0m19:52:00.100650 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.27s]
[0m19:52:00.100650 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m19:52:00.100650 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m19:52:00.100650 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m19:52:00.100650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m19:52:00.100650 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m19:52:00.100650 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m19:52:00.117142 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m19:52:00.124125 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m19:52:00.124125 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.124125 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m19:52:00.124125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:00.360739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m19:52:00.360739 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.360739 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m19:52:00.376361 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.021 seconds
[0m19:52:00.393253 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.393253 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m19:52:00.403386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:00.411387 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.411387 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m19:52:00.419385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:00.419923 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:52:00.419923 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.419923 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m19:52:00.419923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:52:00.435552 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m19:52:00.435552 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m19:52:00.435552 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m19:52:00.435552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:52:00.435552 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m19:52:00.451175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C98BE8470>]}
[0m19:52:00.451175 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.35s]
[0m19:52:00.451175 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m19:52:00.451175 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m19:52:00.451175 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m19:52:00.460519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m19:52:00.460519 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m19:52:00.471536 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m19:52:00.471536 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m19:52:00.490510 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m19:52:00.490510 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.490510 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m19:52:00.490510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:00.552777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m19:52:00.560809 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.560809 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m19:52:00.576434 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.013 seconds
[0m19:52:00.576434 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.576434 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m19:52:00.576434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:00.592060 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.592060 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m19:52:00.592060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:00.592060 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:52:00.592060 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.592060 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m19:52:00.592060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:52:00.607683 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m19:52:00.607683 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m19:52:00.607683 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m19:52:00.607683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:52:00.607683 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m19:52:00.607683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab584c88-14c6-4cb6-962a-be9379be558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96F3EFC0>]}
[0m19:52:00.607683 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.16s]
[0m19:52:00.623305 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m19:52:00.623305 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:00.623305 [debug] [MainThread]: On master: BEGIN
[0m19:52:00.623305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:00.686822 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m19:52:00.686822 [debug] [MainThread]: On master: COMMIT
[0m19:52:00.686822 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:00.686822 [debug] [MainThread]: On master: COMMIT
[0m19:52:00.694822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:52:00.694822 [debug] [MainThread]: On master: Close
[0m19:52:00.694822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:00.694822 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m19:52:00.694822 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m19:52:00.694822 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m19:52:00.694822 [info ] [MainThread]: 
[0m19:52:00.694822 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m19:52:00.702822 [debug] [MainThread]: Command end result
[0m19:52:00.738908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:52:00.754963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:52:00.754963 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:52:00.754963 [info ] [MainThread]: 
[0m19:52:00.754963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:00.754963 [info ] [MainThread]: 
[0m19:52:00.754963 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:52:00.769789 [debug] [MainThread]: Command `dbt run` succeeded at 19:52:00.754963 after 5.74 seconds
[0m19:52:00.769965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96919700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96B08530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C96B08470>]}
[0m19:52:00.769965 [debug] [MainThread]: Flushing usage events
[0m19:52:01.283106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:07.288634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D6711D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D6712210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D6711D30>]}


============================== 19:52:07.296635 | 98425ea5-9583-4662-a65a-253e1b9272af ==============================
[0m19:52:07.296635 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:52:07.296635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:52:07.776189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D67860F0>]}
[0m19:52:07.918319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D6711EE0>]}
[0m19:52:07.918319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:52:08.377052 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:52:08.834691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:08.834691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:09.017499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D7C1C590>]}
[0m19:52:09.284074 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:52:09.292072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:52:09.364289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D831B590>]}
[0m19:52:09.364289 [info ] [MainThread]: Found 9 models, 1 snapshot, 20 data tests, 1 seed, 1 source, 702 macros
[0m19:52:09.364289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D6735E20>]}
[0m19:52:09.364289 [info ] [MainThread]: 
[0m19:52:09.364289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:52:09.380645 [info ] [MainThread]: 
[0m19:52:09.380645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:09.386399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m19:52:09.525575 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:52:09.525575 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:52:09.525575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:09.596493 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m19:52:09.596493 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:52:09.596493 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:52:09.612117 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m19:52:09.612117 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:52:09.612117 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:52:09.612117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_management_control)
[0m19:52:09.612117 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:52:09.612117 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:52:09.612117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:09.674615 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m19:52:09.674615 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:52:09.690236 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:52:09.690236 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m19:52:09.690236 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:52:09.690236 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:52:09.705860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m19:52:09.705860 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:52:09.705860 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:52:09.705860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:09.767430 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m19:52:09.767430 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:52:09.767430 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:52:09.783057 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:52:09.783057 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:52:09.783057 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:52:09.783057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m19:52:09.783057 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:52:09.783057 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:52:09.783057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:10.018098 [debug] [ThreadPool]: SQL status: BEGIN in 0.229 seconds
[0m19:52:10.018098 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:52:10.018098 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:52:10.035481 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m19:52:10.035481 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:52:10.035481 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:52:10.050566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m19:52:10.051420 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:52:10.051420 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:52:10.051420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:10.117175 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m19:52:10.117939 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:52:10.117939 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:52:10.117939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:52:10.117939 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:52:10.117939 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:52:10.133815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_intermediate)
[0m19:52:10.134342 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:52:10.134342 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:52:10.134342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:10.184425 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m19:52:10.184425 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:52:10.184425 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:52:10.184425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:52:10.184425 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:52:10.184425 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:52:10.201256 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.201256 [debug] [MainThread]: On master: BEGIN
[0m19:52:10.201256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:10.251018 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m19:52:10.251018 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.251018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:10.268617 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m19:52:10.268617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98425ea5-9583-4662-a65a-253e1b9272af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D694D6D0>]}
[0m19:52:10.268617 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:10.283800 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.284421 [debug] [MainThread]: On master: BEGIN
[0m19:52:10.284421 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:52:10.284421 [debug] [MainThread]: On master: COMMIT
[0m19:52:10.284421 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.284421 [debug] [MainThread]: On master: COMMIT
[0m19:52:10.284421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:52:10.284421 [debug] [MainThread]: On master: Close
[0m19:52:10.284421 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:52:10.284421 [info ] [Thread-1 (]: 1 of 20 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m19:52:10.284421 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m19:52:10.284421 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:52:10.343219 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:52:10.343219 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:52:10.383774 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:52:10.389161 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:52:10.389161 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m19:52:10.389161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:10.449369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m19:52:10.449369 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:52:10.449369 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m19:52:10.449369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:52:10.464992 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m19:52:10.464992 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m19:52:10.464992 [info ] [Thread-1 (]: 1 of 20 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.18s]
[0m19:52:10.464992 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:52:10.464992 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m19:52:10.464992 [info ] [Thread-1 (]: 2 of 20 START test duplicate_control_entries ................................... [RUN]
[0m19:52:10.481730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m19:52:10.481730 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m19:52:10.485096 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m19:52:10.485096 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m19:52:10.501312 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m19:52:10.501312 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m19:52:10.501312 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m19:52:10.501312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:10.575324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m19:52:10.575324 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m19:52:10.575324 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m19:52:10.583322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:52:10.583322 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m19:52:10.583322 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m19:52:10.591363 [info ] [Thread-1 (]: 2 of 20 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.10s]
[0m19:52:10.591363 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m19:52:10.591363 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:52:10.591363 [info ] [Thread-1 (]: 3 of 20 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m19:52:10.591363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m19:52:10.597682 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:52:10.600737 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:52:10.617500 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:52:10.617500 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:52:10.617500 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:52:10.617500 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m19:52:10.617500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:10.683914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m19:52:10.691915 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:52:10.691915 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m19:52:10.691915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:10.691915 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m19:52:10.699913 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m19:52:10.699913 [info ] [Thread-1 (]: 3 of 20 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.11s]
[0m19:52:10.699913 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:52:10.699913 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:52:10.699913 [info ] [Thread-1 (]: 4 of 20 START test not_null_dim_status_status_code ............................. [RUN]
[0m19:52:10.699913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa)
[0m19:52:10.699913 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:52:10.718757 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:52:10.718757 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:52:10.718757 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:52:10.718757 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:52:10.718757 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: BEGIN
[0m19:52:10.718757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:10.783898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m19:52:10.783898 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:52:10.791900 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status_code
from "gestion"."public"."dim_status"
where status_code is null



      
    ) dbt_internal_test
[0m19:52:10.792127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:52:10.792127 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: ROLLBACK
[0m19:52:10.792127 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: Close
[0m19:52:10.792127 [info ] [Thread-1 (]: 4 of 20 PASS not_null_dim_status_status_code ................................... [[32mPASS[0m in 0.09s]
[0m19:52:10.800897 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:52:10.800897 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:52:10.800897 [info ] [Thread-1 (]: 5 of 20 START test not_null_dim_time_calendar_date ............................. [RUN]
[0m19:52:10.800897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa, now test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3)
[0m19:52:10.800897 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:52:10.800897 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:52:10.800897 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:52:10.800897 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:52:10.800897 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:52:10.817044 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: BEGIN
[0m19:52:10.818210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:10.869090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m19:52:10.869090 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:52:10.869090 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select calendar_date
from "gestion"."public"."dim_time"
where calendar_date is null



      
    ) dbt_internal_test
[0m19:52:10.885051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:52:10.885051 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: ROLLBACK
[0m19:52:10.885051 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: Close
[0m19:52:10.885051 [info ] [Thread-1 (]: 5 of 20 PASS not_null_dim_time_calendar_date ................................... [[32mPASS[0m in 0.08s]
[0m19:52:10.885051 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:52:10.885051 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:52:10.885051 [info ] [Thread-1 (]: 6 of 20 START test not_null_fact_management_control_department_id .............. [RUN]
[0m19:52:10.885051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3, now test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e)
[0m19:52:10.900252 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:52:10.903715 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:52:10.903715 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:52:10.918783 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:52:10.918783 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:52:10.918783 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: BEGIN
[0m19:52:10.918783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.087037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m19:52:11.087037 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:52:11.087037 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select department_id
from "gestion"."public"."fact_management_control"
where department_id is null



      
    ) dbt_internal_test
[0m19:52:11.087037 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.087037 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: ROLLBACK
[0m19:52:11.087037 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: Close
[0m19:52:11.102661 [info ] [Thread-1 (]: 6 of 20 PASS not_null_fact_management_control_department_id .................... [[32mPASS[0m in 0.22s]
[0m19:52:11.102661 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:52:11.102661 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:52:11.102661 [info ] [Thread-1 (]: 7 of 20 START test not_null_fact_management_control_total_expenses ............. [RUN]
[0m19:52:11.102661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e, now test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b)
[0m19:52:11.102661 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:52:11.122678 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:52:11.123455 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:52:11.123455 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:52:11.133544 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:52:11.135167 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: BEGIN
[0m19:52:11.135167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.191194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m19:52:11.191194 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:52:11.206819 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_expenses
from "gestion"."public"."fact_management_control"
where total_expenses is null



      
    ) dbt_internal_test
[0m19:52:11.206819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.206819 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: ROLLBACK
[0m19:52:11.206819 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: Close
[0m19:52:11.206819 [info ] [Thread-1 (]: 7 of 20 PASS not_null_fact_management_control_total_expenses ................... [[32mPASS[0m in 0.10s]
[0m19:52:11.206819 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:52:11.206819 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:52:11.222443 [info ] [Thread-1 (]: 8 of 20 START test not_null_fact_management_control_total_revenue .............. [RUN]
[0m19:52:11.222443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b, now test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6)
[0m19:52:11.222443 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:52:11.222443 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:52:11.238067 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:52:11.243480 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:52:11.252144 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:52:11.252144 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: BEGIN
[0m19:52:11.252144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.307933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m19:52:11.324402 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:52:11.324402 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "gestion"."public"."fact_management_control"
where total_revenue is null



      
    ) dbt_internal_test
[0m19:52:11.324402 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.324402 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: ROLLBACK
[0m19:52:11.333604 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: Close
[0m19:52:11.333604 [info ] [Thread-1 (]: 8 of 20 PASS not_null_fact_management_control_total_revenue .................... [[32mPASS[0m in 0.11s]
[0m19:52:11.333604 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:52:11.333604 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:52:11.333604 [info ] [Thread-1 (]: 9 of 20 START test not_null_int_management_control_net_profit .................. [RUN]
[0m19:52:11.333604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m19:52:11.341604 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:52:11.352046 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:52:11.352046 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:52:11.352046 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:52:11.352046 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:52:11.352046 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m19:52:11.352046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.417071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m19:52:11.417071 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:52:11.417071 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m19:52:11.417071 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.425072 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m19:52:11.425072 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m19:52:11.425072 [info ] [Thread-1 (]: 9 of 20 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.09s]
[0m19:52:11.433072 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:52:11.433072 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m19:52:11.433072 [info ] [Thread-1 (]: 10 of 20 START test not_null_management_control_snapshot_updated_at ............ [RUN]
[0m19:52:11.438322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9)
[0m19:52:11.438506 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m19:52:11.450772 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m19:52:11.452453 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m19:52:11.452453 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m19:52:11.452453 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m19:52:11.452453 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: BEGIN
[0m19:52:11.452453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.634848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m19:52:11.634848 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"
[0m19:52:11.634848 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select updated_at
from "gestion"."snapshots"."management_control_snapshot"
where updated_at is null



      
    ) dbt_internal_test
[0m19:52:11.634848 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.634848 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: ROLLBACK
[0m19:52:11.634848 [debug] [Thread-1 (]: On test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9: Close
[0m19:52:11.650472 [info ] [Thread-1 (]: 10 of 20 PASS not_null_management_control_snapshot_updated_at .................. [[32mPASS[0m in 0.22s]
[0m19:52:11.650472 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9
[0m19:52:11.650472 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:52:11.650472 [info ] [Thread-1 (]: 11 of 20 START test not_null_stg_management_control_control_date ............... [RUN]
[0m19:52:11.650472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_management_control_snapshot_updated_at.a591ddfef9, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m19:52:11.650472 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:52:11.667711 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:52:11.671821 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:52:11.766401 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:52:11.766401 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:52:11.774436 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m19:52:11.774436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.821311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m19:52:11.821311 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:52:11.821311 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m19:52:11.836932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.836932 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m19:52:11.836932 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m19:52:11.836932 [info ] [Thread-1 (]: 11 of 20 PASS not_null_stg_management_control_control_date ..................... [[32mPASS[0m in 0.19s]
[0m19:52:11.836932 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:52:11.836932 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:52:11.836932 [info ] [Thread-1 (]: 12 of 20 START test not_null_stg_management_control_control_id ................. [RUN]
[0m19:52:11.836932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m19:52:11.852614 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:52:11.855319 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:52:11.855319 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:52:11.855319 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:52:11.869134 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:52:11.869134 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m19:52:11.869134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:11.933596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m19:52:11.933596 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:52:11.941599 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m19:52:11.941599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:11.941599 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m19:52:11.949597 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m19:52:11.949597 [info ] [Thread-1 (]: 12 of 20 PASS not_null_stg_management_control_control_id ....................... [[32mPASS[0m in 0.11s]
[0m19:52:11.949597 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:52:11.949597 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:52:11.949597 [info ] [Thread-1 (]: 13 of 20 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m19:52:11.957632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m19:52:11.957632 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:52:11.957632 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:52:11.957632 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:52:11.976925 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:52:11.976925 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:52:11.976925 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m19:52:11.976925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.041482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m19:52:12.049481 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:52:12.050183 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m19:52:12.050183 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:52:12.058191 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m19:52:12.058191 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m19:52:12.058191 [info ] [Thread-1 (]: 13 of 20 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.11s]
[0m19:52:12.058191 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:52:12.066183 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:52:12.066183 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m19:52:12.069502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m19:52:12.069502 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:52:12.072200 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:52:12.083274 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:52:12.088622 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:52:12.088622 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:52:12.088622 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m19:52:12.088622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.166239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m19:52:12.166239 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:52:12.166239 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m19:52:12.166239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:12.174277 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m19:52:12.174277 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m19:52:12.174277 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.11s]
[0m19:52:12.174277 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:52:12.174277 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:52:12.174277 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m19:52:12.174277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m19:52:12.174277 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:52:12.196130 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:52:12.196130 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:52:12.200332 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:52:12.200332 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:52:12.200332 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m19:52:12.200332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.274574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m19:52:12.274574 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:52:12.274574 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m19:52:12.283537 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:12.283537 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m19:52:12.283537 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m19:52:12.283537 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.11s]
[0m19:52:12.291538 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:52:12.291538 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:52:12.291538 [info ] [Thread-1 (]: 16 of 20 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m19:52:12.291538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m19:52:12.291538 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:52:12.303418 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:52:12.316572 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:52:12.318767 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:52:12.318767 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:52:12.318767 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m19:52:12.318767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.383850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m19:52:12.383850 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:52:12.383850 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:52:12.383850 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:12.391852 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m19:52:12.391852 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m19:52:12.391852 [info ] [Thread-1 (]: 16 of 20 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.10s]
[0m19:52:12.391852 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:52:12.391852 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:52:12.391852 [info ] [Thread-1 (]: 17 of 20 START test unique_dim_status_status_code .............................. [RUN]
[0m19:52:12.399920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_dim_status_status_code.ce72371f5e)
[0m19:52:12.399920 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:52:12.399920 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:52:12.399920 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:52:12.411353 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:52:12.411625 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:52:12.411625 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: BEGIN
[0m19:52:12.411625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.466715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m19:52:12.466715 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:52:12.466715 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_status_status_code.ce72371f5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    status_code as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_status"
where status_code is not null
group by status_code
having count(*) > 1



      
    ) dbt_internal_test
[0m19:52:12.466715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:12.466715 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: ROLLBACK
[0m19:52:12.474716 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: Close
[0m19:52:12.474716 [info ] [Thread-1 (]: 17 of 20 PASS unique_dim_status_status_code .................................... [[32mPASS[0m in 0.08s]
[0m19:52:12.474716 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:52:12.474716 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:52:12.474716 [info ] [Thread-1 (]: 18 of 20 START test unique_dim_time_calendar_date .............................. [RUN]
[0m19:52:12.474716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_status_status_code.ce72371f5e, now test.management_control_project.unique_dim_time_calendar_date.4fe35b7375)
[0m19:52:12.474716 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:52:12.483528 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:52:12.483528 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:52:12.483528 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:52:12.491528 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:52:12.491528 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: BEGIN
[0m19:52:12.491528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.653348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m19:52:12.653348 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:52:12.653348 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    calendar_date as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_time"
where calendar_date is not null
group by calendar_date
having count(*) > 1



      
    ) dbt_internal_test
[0m19:52:12.653348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:52:12.668974 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: ROLLBACK
[0m19:52:12.668974 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: Close
[0m19:52:12.668974 [info ] [Thread-1 (]: 18 of 20 PASS unique_dim_time_calendar_date .................................... [[32mPASS[0m in 0.19s]
[0m19:52:12.668974 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:52:12.668974 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:52:12.668974 [info ] [Thread-1 (]: 19 of 20 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m19:52:12.668974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_time_calendar_date.4fe35b7375, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m19:52:12.668974 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:52:12.688448 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:52:12.688448 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:52:12.688448 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:52:12.701303 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:52:12.701303 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m19:52:12.701303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.757478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m19:52:12.757478 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:52:12.757478 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:52:12.757478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:52:12.757478 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m19:52:12.757478 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m19:52:12.773103 [warn ] [Thread-1 (]: 19 of 20 WARN 51 unique_management_control_snapshot_control_id ................. [[33mWARN 51[0m in 0.10s]
[0m19:52:12.773103 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:52:12.773103 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:52:12.773103 [info ] [Thread-1 (]: 20 of 20 START test unique_stg_management_control_control_id ................... [RUN]
[0m19:52:12.773103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m19:52:12.782196 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:52:12.790197 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:52:12.790197 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:52:12.798195 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:52:12.798195 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:52:12.806226 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m19:52:12.806226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.851419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m19:52:12.851419 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:52:12.851419 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:52:12.851419 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:52:12.866611 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m19:52:12.866611 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m19:52:12.866611 [info ] [Thread-1 (]: 20 of 20 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.09s]
[0m19:52:12.866611 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:52:12.866611 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:12.866611 [debug] [MainThread]: On master: BEGIN
[0m19:52:12.866611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:12.917790 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m19:52:12.917790 [debug] [MainThread]: On master: COMMIT
[0m19:52:12.917790 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:12.917790 [debug] [MainThread]: On master: COMMIT
[0m19:52:12.917790 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:52:12.917790 [debug] [MainThread]: On master: Close
[0m19:52:12.917790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:12.917790 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m19:52:12.917790 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m19:52:12.917790 [info ] [MainThread]: 
[0m19:52:12.917790 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m19:52:12.933235 [debug] [MainThread]: Command end result
[0m19:52:12.984557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:52:12.984557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:52:12.984557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:52:12.984557 [info ] [MainThread]: 
[0m19:52:12.999872 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m19:52:13.000921 [info ] [MainThread]: 
[0m19:52:13.001778 [warn ] [MainThread]: [33mWarning in test unique_management_control_snapshot_control_id (snapshots\schema.yml)[0m
[0m19:52:13.002841 [warn ] [MainThread]: Got 51 results, configured to warn if != 0
[0m19:52:13.002841 [info ] [MainThread]: 
[0m19:52:13.002841 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m19:52:13.002841 [info ] [MainThread]: 
[0m19:52:13.002841 [info ] [MainThread]: Done. PASS=19 WARN=1 ERROR=0 SKIP=0 TOTAL=20
[0m19:52:13.002841 [debug] [MainThread]: Command `dbt test` succeeded at 19:52:13.002841 after 5.91 seconds
[0m19:52:13.010686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D5F64EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D8758050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187D8758170>]}
[0m19:52:13.010686 [debug] [MainThread]: Flushing usage events
[0m19:52:13.405158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:18.355316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898D9B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189875F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189875F740>]}


============================== 19:53:18.355316 | def707ce-f105-41fb-b602-2872b38ca758 ==============================
[0m19:53:18.355316 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:53:18.355316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:18.672894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898CAFD70>]}
[0m19:53:18.794788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898F297F0>]}
[0m19:53:18.794788 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:53:19.090827 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:53:19.398305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:19.398305 [debug] [MainThread]: Partial parsing: updated file: management_control_project://snapshots\schema.yml
[0m19:53:20.064695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189AF2D3A0>]}
[0m19:53:20.226604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:53:20.226604 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:53:20.273473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189B11B0E0>]}
[0m19:53:20.273473 [info ] [MainThread]: Found 9 models, 19 data tests, 1 seed, 1 snapshot, 1 source, 702 macros
[0m19:53:20.289079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189B0DDEE0>]}
[0m19:53:20.289079 [info ] [MainThread]: 
[0m19:53:20.289079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:20.289079 [info ] [MainThread]: 
[0m19:53:20.294747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:20.302230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m19:53:20.462972 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:53:20.462972 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m19:53:20.462972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:20.509862 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m19:53:20.525468 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m19:53:20.525468 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m19:53:20.525468 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:53:20.525468 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m19:53:20.525468 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m19:53:20.525468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m19:53:20.541094 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:53:20.541094 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m19:53:20.541094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:20.572354 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:53:20.587966 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m19:53:20.587966 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m19:53:20.587966 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:53:20.587966 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m19:53:20.587966 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m19:53:20.587966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m19:53:20.603589 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:53:20.603589 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m19:53:20.603589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:20.634835 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m19:53:20.634835 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m19:53:20.650459 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:53:20.650459 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:53:20.650459 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m19:53:20.650459 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m19:53:20.650459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m19:53:20.650459 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:53:20.666083 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m19:53:20.666083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:20.697341 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m19:53:20.697341 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m19:53:20.697341 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m19:53:20.712970 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:53:20.712970 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m19:53:20.712970 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m19:53:20.712970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m19:53:20.712970 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:53:20.712970 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m19:53:20.712970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:20.759826 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m19:53:20.759826 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m19:53:20.759826 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:53:20.775450 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:53:20.775450 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m19:53:20.775450 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m19:53:20.775450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public)
[0m19:53:20.775450 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:53:20.775450 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m19:53:20.791093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:20.832301 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m19:53:20.832301 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m19:53:20.832301 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:53:20.847262 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m19:53:20.848763 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m19:53:20.848763 [debug] [ThreadPool]: On list_gestion_public: Close
[0m19:53:20.848763 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:20.848763 [debug] [MainThread]: On master: BEGIN
[0m19:53:20.848763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:20.897759 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m19:53:20.897759 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:20.897759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:53:20.914542 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:53:20.914542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def707ce-f105-41fb-b602-2872b38ca758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189944AF90>]}
[0m19:53:20.914542 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:20.914542 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:20.914542 [debug] [MainThread]: On master: BEGIN
[0m19:53:20.914542 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:53:20.914542 [debug] [MainThread]: On master: COMMIT
[0m19:53:20.914542 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:20.914542 [debug] [MainThread]: On master: COMMIT
[0m19:53:20.914542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:53:20.914542 [debug] [MainThread]: On master: Close
[0m19:53:20.914542 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:53:20.914542 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m19:53:20.914542 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m19:53:20.930168 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:53:20.948070 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:53:20.948070 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:53:20.968899 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:53:20.980574 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:53:20.982867 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m19:53:20.982867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:21.022539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:53:21.022539 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m19:53:21.030538 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m19:53:21.030538 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:21.038538 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m19:53:21.038538 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m19:53:21.038538 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.12s]
[0m19:53:21.038538 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m19:53:21.038538 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m19:53:21.038538 [info ] [Thread-1 (]: 2 of 19 START test duplicate_control_entries ................................... [RUN]
[0m19:53:21.047212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m19:53:21.047212 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m19:53:21.047212 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m19:53:21.047212 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m19:53:21.047212 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m19:53:21.047212 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m19:53:21.047212 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m19:53:21.047212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.104737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m19:53:21.113872 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m19:53:21.116510 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m19:53:21.116510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:21.116510 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m19:53:21.116510 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m19:53:21.116510 [info ] [Thread-1 (]: 2 of 19 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.07s]
[0m19:53:21.116510 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m19:53:21.116510 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:53:21.116510 [info ] [Thread-1 (]: 3 of 19 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m19:53:21.116510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m19:53:21.116510 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:53:21.134251 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:53:21.134251 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:53:21.134251 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:53:21.147193 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:53:21.147193 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m19:53:21.150349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.197309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m19:53:21.205312 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m19:53:21.205312 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m19:53:21.205312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:21.205312 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m19:53:21.205312 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m19:53:21.205312 [info ] [Thread-1 (]: 3 of 19 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.09s]
[0m19:53:21.213327 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m19:53:21.214035 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:53:21.214035 [info ] [Thread-1 (]: 4 of 19 START test not_null_dim_status_status_code ............................. [RUN]
[0m19:53:21.214035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa)
[0m19:53:21.214035 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:53:21.214035 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:53:21.222035 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:53:21.223588 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:53:21.223588 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:53:21.223588 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: BEGIN
[0m19:53:21.223588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.272005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:53:21.272005 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m19:53:21.272005 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status_code
from "gestion"."public"."dim_status"
where status_code is null



      
    ) dbt_internal_test
[0m19:53:21.272005 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:21.280700 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: ROLLBACK
[0m19:53:21.280700 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: Close
[0m19:53:21.280700 [info ] [Thread-1 (]: 4 of 19 PASS not_null_dim_status_status_code ................................... [[32mPASS[0m in 0.07s]
[0m19:53:21.280700 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m19:53:21.280700 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:53:21.280700 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_time_calendar_date ............................. [RUN]
[0m19:53:21.280700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa, now test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3)
[0m19:53:21.280700 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:53:21.289539 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:53:21.289539 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:53:21.297058 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:53:21.299883 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:53:21.299883 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: BEGIN
[0m19:53:21.299883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.537897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m19:53:21.537897 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m19:53:21.537897 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select calendar_date
from "gestion"."public"."dim_time"
where calendar_date is null



      
    ) dbt_internal_test
[0m19:53:21.553509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:53:21.553509 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: ROLLBACK
[0m19:53:21.553509 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: Close
[0m19:53:21.553509 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_time_calendar_date ................................... [[32mPASS[0m in 0.27s]
[0m19:53:21.553509 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m19:53:21.553509 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:53:21.553509 [info ] [Thread-1 (]: 6 of 19 START test not_null_fact_management_control_department_id .............. [RUN]
[0m19:53:21.570768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3, now test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e)
[0m19:53:21.573292 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:53:21.584389 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:53:21.584389 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:53:21.602096 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:53:21.602096 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:53:21.602096 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: BEGIN
[0m19:53:21.602096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.687323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m19:53:21.687323 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m19:53:21.687323 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select department_id
from "gestion"."public"."fact_management_control"
where department_id is null



      
    ) dbt_internal_test
[0m19:53:21.687323 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:21.687323 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: ROLLBACK
[0m19:53:21.687323 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: Close
[0m19:53:21.687323 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fact_management_control_department_id .................... [[32mPASS[0m in 0.12s]
[0m19:53:21.687323 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m19:53:21.687323 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:53:21.687323 [info ] [Thread-1 (]: 7 of 19 START test not_null_fact_management_control_total_expenses ............. [RUN]
[0m19:53:21.702131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e, now test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b)
[0m19:53:21.702131 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:53:21.703938 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:53:21.703938 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:53:21.703938 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:53:21.715398 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:53:21.715398 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: BEGIN
[0m19:53:21.715398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.763876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:53:21.763876 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m19:53:21.763876 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_expenses
from "gestion"."public"."fact_management_control"
where total_expenses is null



      
    ) dbt_internal_test
[0m19:53:21.763876 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:21.763876 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: ROLLBACK
[0m19:53:21.771874 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: Close
[0m19:53:21.771874 [info ] [Thread-1 (]: 7 of 19 PASS not_null_fact_management_control_total_expenses ................... [[32mPASS[0m in 0.08s]
[0m19:53:21.771874 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m19:53:21.771874 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:53:21.771874 [info ] [Thread-1 (]: 8 of 19 START test not_null_fact_management_control_total_revenue .............. [RUN]
[0m19:53:21.771874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b, now test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6)
[0m19:53:21.771874 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:53:21.780832 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:53:21.780832 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:53:21.788835 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:53:21.788835 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:53:21.788835 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: BEGIN
[0m19:53:21.788835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.837450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m19:53:21.837450 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m19:53:21.837450 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "gestion"."public"."fact_management_control"
where total_revenue is null



      
    ) dbt_internal_test
[0m19:53:21.848707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:21.848707 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: ROLLBACK
[0m19:53:21.848707 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: Close
[0m19:53:21.848707 [info ] [Thread-1 (]: 8 of 19 PASS not_null_fact_management_control_total_revenue .................... [[32mPASS[0m in 0.08s]
[0m19:53:21.848707 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m19:53:21.848707 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:53:21.848707 [info ] [Thread-1 (]: 9 of 19 START test not_null_int_management_control_net_profit .................. [RUN]
[0m19:53:21.848707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m19:53:21.848707 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:53:21.848707 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:53:21.863651 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:53:21.868743 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:53:21.868743 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:53:21.868743 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m19:53:21.868743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:21.913759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:53:21.913759 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m19:53:21.913759 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m19:53:21.922645 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:21.922645 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m19:53:21.922645 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m19:53:21.922645 [info ] [Thread-1 (]: 9 of 19 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.07s]
[0m19:53:21.922645 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m19:53:21.922645 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:53:21.922645 [info ] [Thread-1 (]: 10 of 19 START test not_null_stg_management_control_control_date ............... [RUN]
[0m19:53:21.930285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m19:53:21.930285 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:53:21.930285 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:53:21.930285 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:53:21.930285 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:53:21.930285 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:53:21.930285 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m19:53:21.930285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.164236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m19:53:22.164236 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m19:53:22.164236 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m19:53:22.164236 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:53:22.179829 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m19:53:22.179829 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m19:53:22.179829 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stg_management_control_control_date ..................... [[32mPASS[0m in 0.25s]
[0m19:53:22.179829 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m19:53:22.179829 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:53:22.179829 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_management_control_control_id ................. [RUN]
[0m19:53:22.196248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m19:53:22.196248 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:53:22.204270 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:53:22.212251 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:53:22.220344 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:53:22.220344 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:53:22.220344 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m19:53:22.220344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.297196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m19:53:22.297196 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m19:53:22.297196 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m19:53:22.297196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:22.305200 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m19:53:22.305200 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m19:53:22.305200 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_management_control_control_id ....................... [[32mPASS[0m in 0.11s]
[0m19:53:22.305200 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m19:53:22.305200 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:53:22.305200 [info ] [Thread-1 (]: 12 of 19 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m19:53:22.313201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m19:53:22.313201 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:53:22.321259 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:53:22.321259 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:53:22.321259 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:53:22.321259 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:53:22.321259 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m19:53:22.321259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.573153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.248 seconds
[0m19:53:22.573153 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m19:53:22.573153 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m19:53:22.588777 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:53:22.588777 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m19:53:22.588777 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m19:53:22.588777 [info ] [Thread-1 (]: 12 of 19 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.28s]
[0m19:53:22.588777 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m19:53:22.588777 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:53:22.588777 [info ] [Thread-1 (]: 13 of 19 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m19:53:22.588777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m19:53:22.605098 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:53:22.615509 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:53:22.615509 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:53:22.615509 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:53:22.615509 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:53:22.615509 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m19:53:22.630314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.688522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m19:53:22.696522 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m19:53:22.696522 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m19:53:22.696522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:22.696522 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m19:53:22.704554 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m19:53:22.704554 [info ] [Thread-1 (]: 13 of 19 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.12s]
[0m19:53:22.704554 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m19:53:22.704554 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:53:22.704554 [info ] [Thread-1 (]: 14 of 19 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m19:53:22.704554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m19:53:22.712670 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:53:22.720669 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:53:22.720669 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:53:22.720669 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:53:22.728669 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:53:22.728669 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m19:53:22.728669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.884588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m19:53:22.884588 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m19:53:22.884588 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m19:53:22.884588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:53:22.900220 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m19:53:22.900220 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m19:53:22.900220 [info ] [Thread-1 (]: 14 of 19 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.20s]
[0m19:53:22.900220 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m19:53:22.900220 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:53:22.900220 [info ] [Thread-1 (]: 15 of 19 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m19:53:22.900220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m19:53:22.900220 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:53:22.923574 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:53:22.923574 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:53:22.932856 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:53:22.932856 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:53:22.932856 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m19:53:22.932856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:22.980212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:53:22.980212 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m19:53:22.980212 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:22.988233 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:22.988233 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m19:53:22.988233 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m19:53:22.988233 [info ] [Thread-1 (]: 15 of 19 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.09s]
[0m19:53:22.988233 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m19:53:22.988233 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:53:22.996213 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_status_status_code .............................. [RUN]
[0m19:53:22.996639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_dim_status_status_code.ce72371f5e)
[0m19:53:22.996639 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:53:22.996639 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:53:22.996639 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:53:22.996639 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:53:23.013643 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:53:23.016319 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: BEGIN
[0m19:53:23.016319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:23.063534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m19:53:23.063534 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m19:53:23.063534 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_status_status_code.ce72371f5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    status_code as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_status"
where status_code is not null
group by status_code
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:23.071534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:23.071534 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: ROLLBACK
[0m19:53:23.071534 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: Close
[0m19:53:23.071534 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_status_status_code .................................... [[32mPASS[0m in 0.07s]
[0m19:53:23.071534 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m19:53:23.071534 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:53:23.071534 [info ] [Thread-1 (]: 17 of 19 START test unique_dim_time_calendar_date .............................. [RUN]
[0m19:53:23.079535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_status_status_code.ce72371f5e, now test.management_control_project.unique_dim_time_calendar_date.4fe35b7375)
[0m19:53:23.079535 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:53:23.079535 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:53:23.079535 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:53:23.090511 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:53:23.090511 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:53:23.090511 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: BEGIN
[0m19:53:23.090511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:23.131910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m19:53:23.131910 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m19:53:23.131910 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    calendar_date as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_time"
where calendar_date is not null
group by calendar_date
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:23.146820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:53:23.146820 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: ROLLBACK
[0m19:53:23.146820 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: Close
[0m19:53:23.146820 [info ] [Thread-1 (]: 17 of 19 PASS unique_dim_time_calendar_date .................................... [[32mPASS[0m in 0.07s]
[0m19:53:23.146820 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m19:53:23.154823 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:53:23.154823 [info ] [Thread-1 (]: 18 of 19 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m19:53:23.154823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_time_calendar_date.4fe35b7375, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m19:53:23.154823 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:53:23.154823 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:53:23.154823 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:53:23.164073 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:53:23.164073 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:53:23.164073 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m19:53:23.164073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:23.213432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m19:53:23.213432 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m19:53:23.213432 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:23.221435 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:23.221435 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m19:53:23.221435 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m19:53:23.221435 [warn ] [Thread-1 (]: 18 of 19 WARN 51 unique_management_control_snapshot_control_id ................. [[33mWARN 51[0m in 0.07s]
[0m19:53:23.221435 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m19:53:23.221435 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:53:23.221435 [info ] [Thread-1 (]: 19 of 19 START test unique_stg_management_control_control_id ................... [RUN]
[0m19:53:23.229432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m19:53:23.230185 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:53:23.230185 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:53:23.230185 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:53:23.239151 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:53:23.239151 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:53:23.239151 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m19:53:23.239151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:23.281356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:53:23.281356 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m19:53:23.281356 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:23.281356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:53:23.297522 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m19:53:23.297522 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m19:53:23.297522 [info ] [Thread-1 (]: 19 of 19 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.07s]
[0m19:53:23.297522 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m19:53:23.297522 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:23.305540 [debug] [MainThread]: On master: BEGIN
[0m19:53:23.305540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:23.347970 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m19:53:23.347970 [debug] [MainThread]: On master: COMMIT
[0m19:53:23.347970 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:23.347970 [debug] [MainThread]: On master: COMMIT
[0m19:53:23.347970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:53:23.347970 [debug] [MainThread]: On master: Close
[0m19:53:23.347970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:23.347970 [debug] [MainThread]: Connection 'list_gestion_public' was properly closed.
[0m19:53:23.347970 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m19:53:23.347970 [info ] [MainThread]: 
[0m19:53:23.347970 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m19:53:23.363415 [debug] [MainThread]: Command end result
[0m19:53:23.414809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m19:53:23.414809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m19:53:23.414809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m19:53:23.414809 [info ] [MainThread]: 
[0m19:53:23.429860 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m19:53:23.430045 [info ] [MainThread]: 
[0m19:53:23.430045 [warn ] [MainThread]: [33mWarning in test unique_management_control_snapshot_control_id (snapshots\schema.yml)[0m
[0m19:53:23.430045 [warn ] [MainThread]: Got 51 results, configured to warn if != 0
[0m19:53:23.430045 [info ] [MainThread]: 
[0m19:53:23.430045 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m19:53:23.430045 [info ] [MainThread]: 
[0m19:53:23.430045 [info ] [MainThread]: Done. PASS=18 WARN=1 ERROR=0 SKIP=0 TOTAL=19
[0m19:53:23.438047 [debug] [MainThread]: Command `dbt test` succeeded at 19:53:23.438047 after 5.23 seconds
[0m19:53:23.441774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898F92270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189AC88C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189886A7E0>]}
[0m19:53:23.441774 [debug] [MainThread]: Flushing usage events
[0m19:53:23.858436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:19.922746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F242EDA060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24319A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D3E5820>]}


============================== 20:02:19.938379 | db413595-e9e2-4b56-996d-3de0ba7e1e8c ==============================
[0m20:02:19.938379 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:02:19.938379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m20:02:20.143406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db413595-e9e2-4b56-996d-3de0ba7e1e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2407997C0>]}
[0m20:02:20.212799 [debug] [MainThread]: Command `dbt clean` succeeded at 20:02:20.212799 after 0.43 seconds
[0m20:02:20.220797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F243206C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F242E12E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24057CE00>]}
[0m20:02:20.220797 [debug] [MainThread]: Flushing usage events
[0m20:02:20.662147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:28.243973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E9DFAFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E9DFAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E9DFBAA0>]}


============================== 20:02:28.259870 | 3d38ee95-4fc3-4406-b457-93986ae16f4f ==============================
[0m20:02:28.259870 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:02:28.260326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:28.560128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EA3F27B0>]}
[0m20:02:28.660131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EA419D60>]}
[0m20:02:28.660131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:02:28.955470 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:02:28.955470 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:02:28.968153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EA439790>]}
[0m20:02:32.041095 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m20:02:32.259297 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.relationships_fact_management_control_department_id__department_id__ref_dim_department_.7d77b4615d' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:02:32.259297 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.unique_dim_department_department_id.b30c62b76b' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:02:32.259297 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.not_null_dim_department_department_id.00afe97aab' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:02:32.392559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EBFFD7C0>]}
[0m20:02:32.666652 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:02:32.678530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:02:32.726072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EBFEB380>]}
[0m20:02:32.726072 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:02:32.726072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EBF89F70>]}
[0m20:02:32.726072 [info ] [MainThread]: 
[0m20:02:32.726072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:32.726072 [info ] [MainThread]: 
[0m20:02:32.726072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:32.726072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m20:02:32.842481 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:02:32.842481 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:02:32.842481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:33.059483 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.226 seconds
[0m20:02:33.075680 [debug] [ThreadPool]: On list_gestion: Close
[0m20:02:33.092122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_snapshots'
[0m20:02:33.139003 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:02:33.139003 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:02:33.139003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:33.260289 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m20:02:33.260289 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:02:33.260289 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:02:33.260289 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:02:33.275664 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:02:33.275664 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:02:33.275664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public)
[0m20:02:33.275664 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:02:33.275664 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:02:33.275664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:33.375711 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m20:02:33.375711 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:02:33.391338 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:33.392420 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m20:02:33.392420 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:02:33.392420 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:02:33.408046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_management_control)
[0m20:02:33.409151 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:02:33.409151 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:02:33.409151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:33.461825 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m20:02:33.461825 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:02:33.461825 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:02:33.478080 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:02:33.478080 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:02:33.478080 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:02:33.478080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m20:02:33.478080 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:02:33.478080 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:02:33.478080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:33.542749 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m20:02:33.542749 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:02:33.542749 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:02:33.550751 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:02:33.559307 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:02:33.561263 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:02:33.561263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m20:02:33.565492 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:02:33.565492 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:02:33.565492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:33.608510 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m20:02:33.608510 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:02:33.608510 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:02:33.624149 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:02:33.624149 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:02:33.624149 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:02:33.624149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_intermediate)
[0m20:02:33.624149 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:02:33.624149 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:02:33.624149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:33.671007 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m20:02:33.671007 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:02:33.671007 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:02:33.686647 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:02:33.686647 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:02:33.686647 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:02:33.702271 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:33.702271 [debug] [MainThread]: On master: BEGIN
[0m20:02:33.702271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:33.936614 [debug] [MainThread]: SQL status: BEGIN in 0.232 seconds
[0m20:02:33.936614 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:33.936614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:33.952237 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m20:02:33.952237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EBF1A3F0>]}
[0m20:02:33.967868 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:33.967868 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:33.967868 [debug] [MainThread]: On master: BEGIN
[0m20:02:33.967868 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:02:33.967868 [debug] [MainThread]: On master: COMMIT
[0m20:02:33.967868 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:33.983486 [debug] [MainThread]: On master: COMMIT
[0m20:02:33.983486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:33.983486 [debug] [MainThread]: On master: Close
[0m20:02:33.983486 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m20:02:33.983486 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m20:02:33.983486 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m20:02:33.999115 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m20:02:34.031701 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m20:02:34.125334 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.125334 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m20:02:34.125334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:02:34.175030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:02:34.175030 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.175030 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:02:34.191577 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.019 seconds
[0m20:02:34.254072 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.254072 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp200234238453"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:02:34.254072 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.009 seconds
[0m20:02:34.269714 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.269714 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200234238453'
        
      order by ordinal_position

  
[0m20:02:34.269714 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m20:02:34.269714 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.269714 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:02:34.285339 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m20:02:34.285339 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.285339 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200234238453'
        
      order by ordinal_position

  
[0m20:02:34.285339 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m20:02:34.285339 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.300945 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:02:34.300945 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m20:02:34.300945 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.300945 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200234238453'
        
      order by ordinal_position

  
[0m20:02:34.316587 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m20:02:34.332192 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.332192 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:34.332192 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m20:02:34.332192 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.332192 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:34.347816 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:02:34.347816 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.347816 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.347816 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp200234238453" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp200234238453" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:02:34.347816 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m20:02:34.363458 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m20:02:34.363458 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:02:34.363458 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m20:02:34.363458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:02:34.363458 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m20:02:34.379064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d38ee95-4fc3-4406-b457-93986ae16f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E76B8290>]}
[0m20:02:34.379064 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 51[0m in 0.40s]
[0m20:02:34.379064 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m20:02:34.379064 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.379064 [debug] [MainThread]: On master: BEGIN
[0m20:02:34.379064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:34.441847 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m20:02:34.441847 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.441847 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.441847 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.441847 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:34.441847 [debug] [MainThread]: On master: Close
[0m20:02:34.441847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:34.441847 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m20:02:34.441847 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m20:02:34.441847 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m20:02:34.441847 [info ] [MainThread]: 
[0m20:02:34.441847 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m20:02:34.449846 [debug] [MainThread]: Command end result
[0m20:02:34.494271 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:02:34.494271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:02:34.509863 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:02:34.509863 [info ] [MainThread]: 
[0m20:02:34.509863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:34.509863 [info ] [MainThread]: 
[0m20:02:34.509863 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:34.509863 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:02:34.509863 after 6.43 seconds
[0m20:02:34.509863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EA152BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E9ADA330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264EBD5D7C0>]}
[0m20:02:34.509863 [debug] [MainThread]: Flushing usage events
[0m20:02:34.925972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:43.965244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB00F63E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB02CBC200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB00EF4650>]}


============================== 20:02:43.965244 | ec58c9a3-1ab7-4215-8120-773bb4fdf385 ==============================
[0m20:02:43.965244 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:02:43.965244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:02:44.361969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03C95EE0>]}
[0m20:02:44.518210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03E6DE80>]}
[0m20:02:44.518210 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:02:44.817670 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:02:45.121733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:45.121733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:45.204050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB05141160>]}
[0m20:02:45.365516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:02:45.365516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:02:45.428030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB0584B380>]}
[0m20:02:45.428030 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:02:45.428030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03F1C1A0>]}
[0m20:02:45.428030 [info ] [MainThread]: 
[0m20:02:45.428030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:45.441578 [info ] [MainThread]: 
[0m20:02:45.441900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:45.441900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_seeds'
[0m20:02:45.560054 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:02:45.560054 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:02:45.560054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:45.621672 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m20:02:45.621672 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:02:45.621672 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:02:45.621672 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:02:45.621672 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:02:45.621672 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:02:45.621672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m20:02:45.637297 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:02:45.637297 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:02:45.637297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:45.789585 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m20:02:45.789585 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:02:45.789585 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:02:45.807507 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m20:02:45.815267 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:02:45.815397 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:02:45.815397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_staging)
[0m20:02:45.821871 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:02:45.822216 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:02:45.823415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:45.879584 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m20:02:45.879584 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:02:45.879584 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:02:45.889564 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:02:45.895567 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:02:45.895567 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:02:45.895567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_snapshots)
[0m20:02:45.903318 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:02:45.903318 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:02:45.903318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:45.946424 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m20:02:45.954438 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:02:45.954939 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:02:45.954939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:02:45.954939 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:02:45.954939 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:02:45.954939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public)
[0m20:02:45.970564 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:02:45.970564 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:02:45.970564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:46.017438 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m20:02:46.017438 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:02:46.017438 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:46.017438 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m20:02:46.033079 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:02:46.033079 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:02:46.033079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_intermediate)
[0m20:02:46.033079 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:02:46.033079 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:02:46.033079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:46.079934 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m20:02:46.079934 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:02:46.079934 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:02:46.095555 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:02:46.095555 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:02:46.095555 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:02:46.095555 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:46.095555 [debug] [MainThread]: On master: BEGIN
[0m20:02:46.095555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:46.158054 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:02:46.158054 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:46.173675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:46.173675 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m20:02:46.189300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec58c9a3-1ab7-4215-8120-773bb4fdf385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB0115A5D0>]}
[0m20:02:46.189300 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:46.189300 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:46.189300 [debug] [MainThread]: On master: BEGIN
[0m20:02:46.189300 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:02:46.189300 [debug] [MainThread]: On master: COMMIT
[0m20:02:46.189300 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:46.189300 [debug] [MainThread]: On master: COMMIT
[0m20:02:46.189300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:46.189300 [debug] [MainThread]: On master: Close
[0m20:02:46.189300 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:02:46.204923 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m20:02:46.204923 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m20:02:46.204923 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:02:46.237700 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:02:46.237700 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:02:46.271643 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:02:46.279645 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:02:46.279645 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m20:02:46.279645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:02:46.329580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m20:02:46.329580 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:02:46.329580 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m20:02:46.338317 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:46.346316 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m20:02:46.346316 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m20:02:46.346316 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.14s]
[0m20:02:46.346316 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:02:46.354776 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m20:02:46.354776 [info ] [Thread-1 (]: 2 of 19 START test duplicate_control_entries ................................... [RUN]
[0m20:02:46.354776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m20:02:46.354776 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m20:02:46.354776 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m20:02:46.354776 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m20:02:46.354776 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m20:02:46.354776 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:02:46.370400 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m20:02:46.372788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.406852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:02:46.421422 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:02:46.423292 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m20:02:46.423292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:02:46.423292 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m20:02:46.423292 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m20:02:46.423292 [info ] [Thread-1 (]: 2 of 19 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.07s]
[0m20:02:46.423292 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m20:02:46.423292 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:02:46.423292 [info ] [Thread-1 (]: 3 of 19 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m20:02:46.423292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m20:02:46.423292 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:02:46.440760 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:02:46.440760 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:02:46.440760 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:02:46.454768 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:02:46.456680 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m20:02:46.456680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.504727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:02:46.506589 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:02:46.506589 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m20:02:46.506589 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:46.506589 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m20:02:46.506589 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m20:02:46.506589 [info ] [Thread-1 (]: 3 of 19 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.08s]
[0m20:02:46.506589 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:02:46.506589 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:02:46.506589 [info ] [Thread-1 (]: 4 of 19 START test not_null_dim_status_status_code ............................. [RUN]
[0m20:02:46.506589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa)
[0m20:02:46.506589 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:02:46.521984 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:02:46.524566 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:02:46.524566 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:02:46.524566 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:02:46.524566 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: BEGIN
[0m20:02:46.524566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.573480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:02:46.573480 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:02:46.573480 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status_code
from "gestion"."public"."dim_status"
where status_code is null



      
    ) dbt_internal_test
[0m20:02:46.573480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:46.588831 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: ROLLBACK
[0m20:02:46.588831 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: Close
[0m20:02:46.588831 [info ] [Thread-1 (]: 4 of 19 PASS not_null_dim_status_status_code ................................... [[32mPASS[0m in 0.08s]
[0m20:02:46.588831 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:02:46.588831 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:02:46.588831 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_time_calendar_date ............................. [RUN]
[0m20:02:46.588831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa, now test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3)
[0m20:02:46.588831 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:02:46.596831 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:02:46.596831 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:02:46.606602 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:02:46.606602 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:02:46.606602 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: BEGIN
[0m20:02:46.606602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.654864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m20:02:46.654864 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:02:46.654864 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select calendar_date
from "gestion"."public"."dim_time"
where calendar_date is null



      
    ) dbt_internal_test
[0m20:02:46.662866 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:46.662866 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: ROLLBACK
[0m20:02:46.662866 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: Close
[0m20:02:46.662866 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_time_calendar_date ................................... [[32mPASS[0m in 0.07s]
[0m20:02:46.662866 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:02:46.662866 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:02:46.662866 [info ] [Thread-1 (]: 6 of 19 START test not_null_fact_management_control_department_id .............. [RUN]
[0m20:02:46.662866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3, now test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e)
[0m20:02:46.670866 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:02:46.672327 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:02:46.680330 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:02:46.681279 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:02:46.681279 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:02:46.681279 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: BEGIN
[0m20:02:46.681279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.723110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:02:46.723110 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:02:46.723110 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select department_id
from "gestion"."public"."fact_management_control"
where department_id is null



      
    ) dbt_internal_test
[0m20:02:46.723110 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:46.739139 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: ROLLBACK
[0m20:02:46.739139 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: Close
[0m20:02:46.739139 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fact_management_control_department_id .................... [[32mPASS[0m in 0.08s]
[0m20:02:46.739139 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:02:46.739139 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:02:46.739139 [info ] [Thread-1 (]: 7 of 19 START test not_null_fact_management_control_total_expenses ............. [RUN]
[0m20:02:46.739139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e, now test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b)
[0m20:02:46.747140 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:02:46.747140 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:02:46.754986 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:02:46.756966 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:02:46.756966 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:02:46.764967 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: BEGIN
[0m20:02:46.764967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.812864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:02:46.812864 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:02:46.812864 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_expenses
from "gestion"."public"."fact_management_control"
where total_expenses is null



      
    ) dbt_internal_test
[0m20:02:46.812864 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:46.812864 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: ROLLBACK
[0m20:02:46.812864 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: Close
[0m20:02:46.812864 [info ] [Thread-1 (]: 7 of 19 PASS not_null_fact_management_control_total_expenses ................... [[32mPASS[0m in 0.07s]
[0m20:02:46.822376 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:02:46.822455 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:02:46.822455 [info ] [Thread-1 (]: 8 of 19 START test not_null_fact_management_control_total_revenue .............. [RUN]
[0m20:02:46.822455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b, now test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6)
[0m20:02:46.822455 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:02:46.822455 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:02:46.831780 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:02:46.831780 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:02:46.831780 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:02:46.838108 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: BEGIN
[0m20:02:46.839556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.887950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m20:02:46.887950 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:02:46.887950 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "gestion"."public"."fact_management_control"
where total_revenue is null



      
    ) dbt_internal_test
[0m20:02:46.887950 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:46.895964 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: ROLLBACK
[0m20:02:46.895964 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: Close
[0m20:02:46.895964 [info ] [Thread-1 (]: 8 of 19 PASS not_null_fact_management_control_total_revenue .................... [[32mPASS[0m in 0.07s]
[0m20:02:46.895964 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:02:46.895964 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:02:46.895964 [info ] [Thread-1 (]: 9 of 19 START test not_null_int_management_control_net_profit .................. [RUN]
[0m20:02:46.895964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m20:02:46.895964 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:02:46.907828 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:02:46.907828 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:02:46.907828 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:02:46.907828 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:02:46.907828 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m20:02:46.907828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:46.956102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:02:46.956102 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:02:46.971504 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m20:02:46.971504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:46.971504 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m20:02:46.971504 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m20:02:46.971504 [info ] [Thread-1 (]: 9 of 19 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.08s]
[0m20:02:46.979504 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:02:46.979504 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:02:46.979504 [info ] [Thread-1 (]: 10 of 19 START test not_null_stg_management_control_control_date ............... [RUN]
[0m20:02:46.979504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m20:02:46.979504 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:02:46.987507 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:02:46.989162 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:02:46.989162 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:02:46.989162 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:02:46.997163 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m20:02:46.997163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.055299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m20:02:47.055299 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:02:47.055299 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:02:47.060900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:47.060900 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m20:02:47.060900 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m20:02:47.060900 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stg_management_control_control_date ..................... [[32mPASS[0m in 0.08s]
[0m20:02:47.060900 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:02:47.060900 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:02:47.060900 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_management_control_control_id ................. [RUN]
[0m20:02:47.068922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m20:02:47.068922 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:02:47.072303 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:02:47.072303 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:02:47.146155 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:02:47.146155 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:02:47.146155 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m20:02:47.146155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.194470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m20:02:47.194470 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:02:47.194470 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:02:47.194470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:47.194470 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m20:02:47.194470 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m20:02:47.194470 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_management_control_control_id ....................... [[32mPASS[0m in 0.13s]
[0m20:02:47.194470 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:02:47.194470 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:02:47.194470 [info ] [Thread-1 (]: 12 of 19 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m20:02:47.194470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m20:02:47.210112 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:02:47.210112 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:02:47.210112 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:02:47.210112 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:02:47.210112 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:02:47.210112 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m20:02:47.210112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.452574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m20:02:47.452574 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:02:47.452574 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m20:02:47.452574 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:02:47.468171 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m20:02:47.468171 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m20:02:47.468171 [info ] [Thread-1 (]: 12 of 19 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.27s]
[0m20:02:47.468171 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:02:47.468171 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:02:47.468171 [info ] [Thread-1 (]: 13 of 19 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m20:02:47.485406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m20:02:47.488723 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:02:47.504610 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:02:47.505826 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:02:47.521326 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:02:47.527627 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:02:47.527627 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m20:02:47.527627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.595584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m20:02:47.595584 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:02:47.595584 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:02:47.595584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:47.611227 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m20:02:47.611227 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m20:02:47.611227 [info ] [Thread-1 (]: 13 of 19 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.13s]
[0m20:02:47.611227 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:02:47.611227 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:02:47.611227 [info ] [Thread-1 (]: 14 of 19 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m20:02:47.623080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m20:02:47.624093 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:02:47.625953 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:02:47.625953 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:02:47.641363 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:02:47.641363 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:02:47.641363 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m20:02:47.641363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.704605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m20:02:47.704605 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:02:47.704605 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:02:47.712606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:47.712606 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m20:02:47.712606 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m20:02:47.712606 [info ] [Thread-1 (]: 14 of 19 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.10s]
[0m20:02:47.712606 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:02:47.720605 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:02:47.720605 [info ] [Thread-1 (]: 15 of 19 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m20:02:47.720605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m20:02:47.720605 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:02:47.731219 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:02:47.731219 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:02:47.739667 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:02:47.739667 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:02:47.739667 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m20:02:47.739667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.787877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:02:47.787877 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:02:47.787877 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:47.795878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:47.795878 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m20:02:47.795878 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m20:02:47.795878 [info ] [Thread-1 (]: 15 of 19 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.08s]
[0m20:02:47.795878 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:02:47.795878 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:02:47.795878 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_status_status_code .............................. [RUN]
[0m20:02:47.803877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_dim_status_status_code.ce72371f5e)
[0m20:02:47.804669 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:02:47.804669 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:02:47.804669 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:02:47.812669 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:02:47.812669 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:02:47.812669 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: BEGIN
[0m20:02:47.812669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.857528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m20:02:47.857528 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:02:47.857528 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_status_status_code.ce72371f5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    status_code as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_status"
where status_code is not null
group by status_code
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:47.871026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:47.872661 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: ROLLBACK
[0m20:02:47.872661 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: Close
[0m20:02:47.872661 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_status_status_code .................................... [[32mPASS[0m in 0.07s]
[0m20:02:47.872661 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:02:47.872661 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:02:47.872661 [info ] [Thread-1 (]: 17 of 19 START test unique_dim_time_calendar_date .............................. [RUN]
[0m20:02:47.872661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_status_status_code.ce72371f5e, now test.management_control_project.unique_dim_time_calendar_date.4fe35b7375)
[0m20:02:47.872661 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:02:47.891386 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:02:47.891386 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:02:47.891386 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:02:47.891386 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:02:47.891386 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: BEGIN
[0m20:02:47.891386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:47.939172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:02:47.939172 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:02:47.939172 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    calendar_date as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_time"
where calendar_date is not null
group by calendar_date
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:47.939172 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:02:47.954508 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: ROLLBACK
[0m20:02:47.954508 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: Close
[0m20:02:47.954508 [info ] [Thread-1 (]: 17 of 19 PASS unique_dim_time_calendar_date .................................... [[32mPASS[0m in 0.08s]
[0m20:02:47.954508 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:02:47.954508 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:02:47.954508 [info ] [Thread-1 (]: 18 of 19 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m20:02:47.954508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_time_calendar_date.4fe35b7375, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m20:02:47.954508 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:02:47.962508 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:02:47.962508 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:02:47.971829 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:02:47.971829 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:02:47.971829 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m20:02:47.971829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:48.022650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m20:02:48.022650 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:02:48.022650 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:48.022650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:48.022650 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m20:02:48.022650 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m20:02:48.022650 [warn ] [Thread-1 (]: 18 of 19 WARN 51 unique_management_control_snapshot_control_id ................. [[33mWARN 51[0m in 0.07s]
[0m20:02:48.022650 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:02:48.022650 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:02:48.022650 [info ] [Thread-1 (]: 19 of 19 START test unique_stg_management_control_control_id ................... [RUN]
[0m20:02:48.022650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m20:02:48.037903 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:02:48.037903 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:02:48.037903 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:02:48.045922 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:02:48.045922 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:02:48.045922 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m20:02:48.045922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:48.089113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:02:48.089113 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:02:48.089113 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:48.104477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:48.104477 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m20:02:48.104477 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m20:02:48.104477 [info ] [Thread-1 (]: 19 of 19 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.08s]
[0m20:02:48.104477 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:02:48.112478 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:48.112478 [debug] [MainThread]: On master: BEGIN
[0m20:02:48.112478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:48.155788 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m20:02:48.155788 [debug] [MainThread]: On master: COMMIT
[0m20:02:48.155788 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:48.155788 [debug] [MainThread]: On master: COMMIT
[0m20:02:48.155788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:48.155788 [debug] [MainThread]: On master: Close
[0m20:02:48.155788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:48.155788 [debug] [MainThread]: Connection 'list_gestion_public_intermediate' was properly closed.
[0m20:02:48.155788 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m20:02:48.155788 [info ] [MainThread]: 
[0m20:02:48.155788 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m20:02:48.171117 [debug] [MainThread]: Command end result
[0m20:02:48.222368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:02:48.222368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:02:48.222368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:02:48.222368 [info ] [MainThread]: 
[0m20:02:48.237763 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m20:02:48.237763 [info ] [MainThread]: 
[0m20:02:48.237763 [warn ] [MainThread]: [33mWarning in test unique_management_control_snapshot_control_id (snapshots\schema.yml)[0m
[0m20:02:48.237763 [warn ] [MainThread]: Got 51 results, configured to warn if != 0
[0m20:02:48.237763 [info ] [MainThread]: 
[0m20:02:48.237763 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m20:02:48.245150 [info ] [MainThread]: 
[0m20:02:48.245150 [info ] [MainThread]: Done. PASS=18 WARN=1 ERROR=0 SKIP=0 TOTAL=19
[0m20:02:48.245150 [debug] [MainThread]: Command `dbt test` succeeded at 20:02:48.245150 after 4.46 seconds
[0m20:02:48.245150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB033FA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB033F89E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB03F60590>]}
[0m20:02:48.245150 [debug] [MainThread]: Flushing usage events
[0m20:02:48.658766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:52.862337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7BD7006E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C1464800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C14648C0>]}


============================== 20:02:52.870208 | 39d14c84-1e8e-479a-a307-7f722653cd8a ==============================
[0m20:02:52.870208 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:02:52.870208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:02:53.095126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39d14c84-1e8e-479a-a307-7f722653cd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C1464830>]}
[0m20:02:53.155885 [debug] [MainThread]: Command `dbt clean` succeeded at 20:02:53.155885 after 0.45 seconds
[0m20:02:53.155885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C1551B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C0AAF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C0DF08F0>]}
[0m20:02:53.155885 [debug] [MainThread]: Flushing usage events
[0m20:02:53.596666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:07.240945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E6B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E6A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E1B6E0>]}


============================== 20:04:07.248839 | ecface82-702d-44df-b41b-70cb3d6e2342 ==============================
[0m20:04:07.248839 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:04:07.248839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m20:04:07.465345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecface82-702d-44df-b41b-70cb3d6e2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E1A3C0>]}
[0m20:04:07.503605 [debug] [MainThread]: Command `dbt clean` succeeded at 20:04:07.503605 after 0.42 seconds
[0m20:04:07.504290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E32660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020184E1A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018505CEF0>]}
[0m20:04:07.504290 [debug] [MainThread]: Flushing usage events
[0m20:04:07.932433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:24.610817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F48228530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F482285C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F48229BB0>]}


============================== 20:04:24.610817 | 58e227ba-f328-448b-8a9b-28ec5c0c145a ==============================
[0m20:04:24.610817 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:04:24.618817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:24.985080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F485FDA00>]}
[0m20:04:25.087239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F47DE3020>]}
[0m20:04:25.093858 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:04:25.513885 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:04:25.513885 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:04:25.513885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F485FF1A0>]}
[0m20:04:29.616455 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_department' in the 'models' section of file 'models\OLAP\schema.yaml'
[0m20:04:30.064416 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.relationships_fact_management_control_department_id__department_id__ref_dim_department_.7d77b4615d' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:04:30.064416 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.unique_dim_department_department_id.b30c62b76b' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:04:30.064416 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.management_control_project.not_null_dim_department_department_id.00afe97aab' (models\OLAP\schema.yaml) depends on a node named 'dim_department' in package '' which was not found
[0m20:04:30.344407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F4A06CAD0>]}
[0m20:04:30.584369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:04:30.597563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:04:30.645567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F4A126030>]}
[0m20:04:30.645567 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:04:30.645567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F4A06C3B0>]}
[0m20:04:30.653581 [info ] [MainThread]: 
[0m20:04:30.653581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:30.661562 [info ] [MainThread]: 
[0m20:04:30.661562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:30.661562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m20:04:30.797549 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:30.805549 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:30.805549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:30.885542 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.080 seconds
[0m20:04:30.885542 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:30.893541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m20:04:30.909539 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:30.909539 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:04:30.917538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:30.981533 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m20:04:30.981533 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:30.981533 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:04:30.989532 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:04:30.997534 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:04:30.997534 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:04:30.997534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_intermediate)
[0m20:04:31.005531 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:31.005531 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:04:31.005531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.210020 [debug] [ThreadPool]: SQL status: BEGIN in 0.204 seconds
[0m20:04:31.218006 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:31.218006 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:04:31.234003 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m20:04:31.234003 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:04:31.234003 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:04:31.234003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m20:04:31.242003 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:31.250006 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:04:31.250006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.477448 [debug] [ThreadPool]: SQL status: BEGIN in 0.231 seconds
[0m20:04:31.477448 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:31.485447 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:04:31.493448 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m20:04:31.493448 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:04:31.501447 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:04:31.501447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m20:04:31.501447 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:31.509446 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:04:31.509446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.590066 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m20:04:31.590066 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:31.590066 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:04:31.599205 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m20:04:31.607227 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:04:31.607227 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:04:31.607227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m20:04:31.615208 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:31.615208 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:04:31.615208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.695220 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m20:04:31.695220 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:31.695220 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:04:31.707790 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m20:04:31.707790 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:04:31.715813 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:04:31.715813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m20:04:31.715813 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:31.723795 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:04:31.723795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.795787 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m20:04:31.795787 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:31.803787 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:04:31.811789 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m20:04:31.811789 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:04:31.819803 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:04:31.827802 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:31.827802 [debug] [MainThread]: On master: BEGIN
[0m20:04:31.827802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:31.907776 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m20:04:31.907776 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:31.907776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:31.923973 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m20:04:31.923973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F4A218080>]}
[0m20:04:31.923973 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:31.923973 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:31.931982 [debug] [MainThread]: On master: BEGIN
[0m20:04:31.931982 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:31.931982 [debug] [MainThread]: On master: COMMIT
[0m20:04:31.931982 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:31.931982 [debug] [MainThread]: On master: COMMIT
[0m20:04:31.931982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:31.931982 [debug] [MainThread]: On master: Close
[0m20:04:31.939980 [debug] [Thread-1 (]: Began running node snapshot.management_control_project.management_control_snapshot
[0m20:04:31.939980 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.management_control_snapshot .................... [RUN]
[0m20:04:31.939980 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.management_control_project.management_control_snapshot'
[0m20:04:31.939980 [debug] [Thread-1 (]: Began compiling node snapshot.management_control_project.management_control_snapshot
[0m20:04:31.963975 [debug] [Thread-1 (]: Began executing node snapshot.management_control_project.management_control_snapshot
[0m20:04:32.075968 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.075968 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: BEGIN
[0m20:04:32.075968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:32.139976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m20:04:32.139976 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.139976 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:04:32.162548 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.018 seconds
[0m20:04:32.218563 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.218563 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

        
  
    

  create temporary table "management_control_snapshot__dbt_tmp200432210563"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:04:32.226543 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m20:04:32.234562 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.234562 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200432210563'
        
      order by ordinal_position

  
[0m20:04:32.234562 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m20:04:32.242542 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.242542 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:04:32.242542 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m20:04:32.250541 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.250541 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200432210563'
        
      order by ordinal_position

  
[0m20:04:32.258559 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m20:04:32.258559 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.258559 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m20:04:32.266560 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m20:04:32.274560 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.274560 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'management_control_snapshot__dbt_tmp200432210563'
        
      order by ordinal_position

  
[0m20:04:32.274560 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m20:04:32.298537 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.298537 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT 
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        status,
        updated_at::timestamp AS updated_at  
    FROM "gestion"."public_staging"."stg_management_control"

    ),

    snapshotted_data as (

        select *, 
    
        control_id as dbt_unique_key
    

        from "gestion"."snapshots"."management_control_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(updated_at::timestamp, updated_at::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(control_id as varchar ), '')
         || '|' || coalesce(cast(updated_at::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        control_id as dbt_unique_key
    
,
            updated_at::timestamp as dbt_updated_at,
            updated_at::timestamp as dbt_valid_from,
            updated_at::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at::timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m20:04:32.298537 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m20:04:32.306555 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.306555 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:04:32.306555 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:04:32.306555 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.306555 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.306555 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "snapshot.management_control_project.management_control_snapshot"} */

      update "gestion"."snapshots"."management_control_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "management_control_snapshot__dbt_tmp200432210563" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "gestion"."snapshots"."management_control_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "gestion"."snapshots"."management_control_snapshot".dbt_valid_to is null;
      


    insert into "gestion"."snapshots"."management_control_snapshot" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."control_id",DBT_INTERNAL_SOURCE."department_id",DBT_INTERNAL_SOURCE."control_date",DBT_INTERNAL_SOURCE."expenses",DBT_INTERNAL_SOURCE."revenue",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "management_control_snapshot__dbt_tmp200432210563" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:04:32.314554 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m20:04:32.330534 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m20:04:32.330534 [debug] [Thread-1 (]: Using postgres connection "snapshot.management_control_project.management_control_snapshot"
[0m20:04:32.330534 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: COMMIT
[0m20:04:32.330534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:04:32.338534 [debug] [Thread-1 (]: On snapshot.management_control_project.management_control_snapshot: Close
[0m20:04:32.338534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e227ba-f328-448b-8a9b-28ec5c0c145a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F457684D0>]}
[0m20:04:32.338534 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.management_control_snapshot .................... [[32mINSERT 0 0[0m in 0.40s]
[0m20:04:32.346536 [debug] [Thread-1 (]: Finished running node snapshot.management_control_project.management_control_snapshot
[0m20:04:32.346536 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:32.346536 [debug] [MainThread]: On master: BEGIN
[0m20:04:32.346536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:32.394546 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m20:04:32.394546 [debug] [MainThread]: On master: COMMIT
[0m20:04:32.402543 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:32.402543 [debug] [MainThread]: On master: COMMIT
[0m20:04:32.402543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:32.402543 [debug] [MainThread]: On master: Close
[0m20:04:32.402543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:32.402543 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m20:04:32.402543 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m20:04:32.402543 [debug] [MainThread]: Connection 'snapshot.management_control_project.management_control_snapshot' was properly closed.
[0m20:04:32.402543 [info ] [MainThread]: 
[0m20:04:32.402543 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m20:04:32.402543 [debug] [MainThread]: Command end result
[0m20:04:32.450523 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:04:32.458523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:04:32.466541 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:04:32.466541 [info ] [MainThread]: 
[0m20:04:32.466541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:32.466541 [info ] [MainThread]: 
[0m20:04:32.466541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:04:32.466541 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:04:32.466541 after 8.05 seconds
[0m20:04:32.466541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F49B4B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F48333C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F483316D0>]}
[0m20:04:32.474540 [debug] [MainThread]: Flushing usage events
[0m20:04:32.930758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:42.185441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983A5B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983A59340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983A5B170>]}


============================== 20:04:42.185441 | 076de68f-9b69-4c01-bcdb-3372b50c8e7a ==============================
[0m20:04:42.185441 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:04:42.193446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:42.493949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983EC33B0>]}
[0m20:04:42.581944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9832BA3F0>]}
[0m20:04:42.581944 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:04:42.861917 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:04:43.141872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:43.141872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:43.237870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983F07CB0>]}
[0m20:04:43.389850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:04:43.397849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:04:43.437865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9859691C0>]}
[0m20:04:43.437865 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:04:43.445847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983D1ADE0>]}
[0m20:04:43.445847 [info ] [MainThread]: 
[0m20:04:43.445847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:43.445847 [info ] [MainThread]: 
[0m20:04:43.445847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:43.453844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m20:04:43.549838 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:43.549838 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:43.549838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:43.597833 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.046 seconds
[0m20:04:43.597833 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:43.597833 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:43.605832 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:43.605832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:43.646206 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.044 seconds
[0m20:04:43.646206 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:43.654187 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:43.654187 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:43.654187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:43.855332 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.204 seconds
[0m20:04:43.863333 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:43.871333 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:43.871333 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:43.871333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:43.943754 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.069 seconds
[0m20:04:43.943754 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:43.951755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_management_control'
[0m20:04:43.959772 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:43.959772 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:04:43.959772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:44.039752 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m20:04:44.039752 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:44.039752 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:04:44.055745 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m20:04:44.055745 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:04:44.055745 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:04:44.055745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_intermediate)
[0m20:04:44.063744 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:44.063744 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:04:44.071744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:44.143754 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m20:04:44.143754 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:44.143754 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:04:44.159735 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m20:04:44.159735 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:04:44.159735 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:04:44.159735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_snapshots)
[0m20:04:44.167738 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:44.167738 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:04:44.175733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:44.239728 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m20:04:44.247745 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:44.247745 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:04:44.255726 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m20:04:44.263744 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:04:44.263744 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:04:44.263744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public)
[0m20:04:44.271725 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:44.271725 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:04:44.271725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:44.343717 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m20:04:44.343717 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:44.343717 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:04:44.354737 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m20:04:44.362770 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:04:44.362770 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:04:44.362770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_seeds)
[0m20:04:44.370769 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:44.370769 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:04:44.370769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:44.450761 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m20:04:44.450761 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:44.450761 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:04:44.458741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:04:44.466744 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:04:44.466744 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:04:44.466744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m20:04:44.482759 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:44.482759 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:04:44.482759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:44.714542 [debug] [ThreadPool]: SQL status: BEGIN in 0.231 seconds
[0m20:04:44.714542 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:44.714542 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:04:44.732383 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.017 seconds
[0m20:04:44.740390 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:04:44.740390 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:04:44.764388 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:44.764388 [debug] [MainThread]: On master: BEGIN
[0m20:04:44.764388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:45.007089 [debug] [MainThread]: SQL status: BEGIN in 0.237 seconds
[0m20:04:45.007089 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:45.007089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:45.023080 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m20:04:45.023080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985599AC0>]}
[0m20:04:45.023080 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:45.023080 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:45.023080 [debug] [MainThread]: On master: BEGIN
[0m20:04:45.023080 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:45.031080 [debug] [MainThread]: On master: COMMIT
[0m20:04:45.031080 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:45.031080 [debug] [MainThread]: On master: COMMIT
[0m20:04:45.031080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:45.031080 [debug] [MainThread]: On master: Close
[0m20:04:45.031080 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m20:04:45.039061 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_time ................................... [RUN]
[0m20:04:45.039061 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_time'
[0m20:04:45.039061 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m20:04:45.063059 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m20:04:45.063059 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m20:04:45.111054 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m20:04:45.119073 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.119073 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m20:04:45.119073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:45.170199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m20:04:45.170199 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.170199 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m20:04:45.186198 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.019 seconds
[0m20:04:45.194198 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.194198 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:04:45.202197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.202197 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.202197 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:04:45.202197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.242176 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m20:04:45.242176 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.242176 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m20:04:45.250175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:45.258192 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m20:04:45.266191 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:45.266191 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m20:04:45.266191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:04:45.274191 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m20:04:45.274191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985C04680>]}
[0m20:04:45.274191 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.24s]
[0m20:04:45.274191 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m20:04:45.282190 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m20:04:45.282190 [info ] [Thread-1 (]: 2 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m20:04:45.282190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m20:04:45.282190 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m20:04:45.282190 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m20:04:45.290171 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m20:04:45.330167 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.330167 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

    
  
    

  create temporary table "stg_management_control__dbt_tmp200445322168"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m20:04:45.330167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:45.386171 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.055 seconds
[0m20:04:45.402164 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.402164 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m20:04:45.410159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m20:04:45.410159 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.410159 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control__dbt_tmp200445322168'
        
      order by ordinal_position

  
[0m20:04:45.427262 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.017 seconds
[0m20:04:45.435285 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.435285 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:04:45.435285 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m20:04:45.443265 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.451265 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'stg_management_control'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:04:45.451265 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m20:04:45.467280 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m20:04:45.475262 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.475262 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
        
            delete from "gestion"."public_staging"."stg_management_control"
            where (
                control_id) in (
                select (control_id)
                from "stg_management_control__dbt_tmp200445322168"
            );

        
    

    insert into "gestion"."public_staging"."stg_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "stg_management_control__dbt_tmp200445322168"
    )
  
[0m20:04:45.475262 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m20:04:45.475262 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m20:04:45.475262 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:45.475262 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m20:04:45.483260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:04:45.483260 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m20:04:45.483260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9861183B0>]}
[0m20:04:45.483260 [info ] [Thread-1 (]: 2 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mINSERT 0 51[0m in 0.20s]
[0m20:04:45.491262 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m20:04:45.491262 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m20:04:45.491262 [info ] [Thread-1 (]: 3 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m20:04:45.494007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_departement)
[0m20:04:45.494007 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m20:04:45.494007 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m20:04:45.494007 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m20:04:45.502012 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m20:04:45.502012 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.502012 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m20:04:45.502012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:45.550006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:04:45.550006 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.558008 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m20:04:45.558008 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:04:45.566006 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.566006 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
alter table "gestion"."public"."dim_departement" rename to "dim_departement__dbt_backup"
[0m20:04:45.566006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.574006 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.574006 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
alter table "gestion"."public"."dim_departement__dbt_tmp" rename to "dim_departement"
[0m20:04:45.574006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.574006 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m20:04:45.574006 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.574006 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m20:04:45.582059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:04:45.582059 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_departement__dbt_backup"
[0m20:04:45.582059 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:45.582059 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
drop table if exists "gestion"."public"."dim_departement__dbt_backup" cascade
[0m20:04:45.590017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:04:45.590017 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m20:04:45.590017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985C07980>]}
[0m20:04:45.590017 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.dim_departement ....................... [[32mSELECT 5[0m in 0.10s]
[0m20:04:45.590017 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m20:04:45.590017 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m20:04:45.598010 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m20:04:45.598010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_status)
[0m20:04:45.598010 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m20:04:45.598010 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m20:04:45.598010 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m20:04:45.606000 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m20:04:45.606000 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.606000 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m20:04:45.606000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:45.662008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:04:45.662008 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.662008 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m20:04:45.669997 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m20:04:45.734010 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.734010 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m20:04:45.734010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.741991 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.741991 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m20:04:45.741991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.741991 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m20:04:45.749988 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.749988 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m20:04:45.749988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:04:45.749988 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m20:04:45.749988 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:45.758007 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m20:04:45.758007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:45.758007 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m20:04:45.758007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C986153C80>]}
[0m20:04:45.765986 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.16s]
[0m20:04:45.765986 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m20:04:45.765986 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m20:04:45.765986 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m20:04:45.765986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m20:04:45.765986 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m20:04:45.774004 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m20:04:45.774004 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m20:04:45.774004 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m20:04:45.774004 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.774004 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m20:04:45.781986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:45.829980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:04:45.829980 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.829980 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m20:04:45.837980 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.007 seconds
[0m20:04:45.845997 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.845997 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m20:04:45.845997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.845997 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.845997 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m20:04:45.853978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:45.853978 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m20:04:45.853978 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.853978 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m20:04:45.853978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:45.861979 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m20:04:45.861979 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:45.861979 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m20:04:45.861979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:04:45.869992 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m20:04:45.869992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985CAC380>]}
[0m20:04:45.869992 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.10s]
[0m20:04:45.869992 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m20:04:45.869992 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m20:04:45.869992 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m20:04:45.869992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m20:04:45.869992 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m20:04:45.877976 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m20:04:45.877976 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m20:04:45.885975 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:45.885975 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

    
  
    

  create temporary table "int_management_control__dbt_tmp200445885975"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m20:04:45.885975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:45.949988 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.063 seconds
[0m20:04:45.957974 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:45.957974 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m20:04:45.957974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m20:04:45.965986 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:45.965986 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp200445885975'
        
      order by ordinal_position

  
[0m20:04:45.981966 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.016 seconds
[0m20:04:45.981966 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:45.981966 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m20:04:45.989968 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m20:04:45.997968 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:45.997968 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control__dbt_tmp200445885975'
        
      order by ordinal_position

  
[0m20:04:46.005967 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m20:04:46.013966 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:46.013966 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'int_management_control'
        
        and table_schema = 'public_intermediate'
        
      order by ordinal_position

  
[0m20:04:46.013966 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m20:04:46.029982 [debug] [Thread-1 (]: 
    In "gestion"."public_intermediate"."int_management_control":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:04:46.029982 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m20:04:46.029982 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:46.029982 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
        
            delete from "gestion"."public_intermediate"."int_management_control"
            where (
                control_id) in (
                select (control_id)
                from "int_management_control__dbt_tmp200445885975"
            );

        
    

    insert into "gestion"."public_intermediate"."int_management_control" ("control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status")
    (
        select "control_id", "department_id", "control_date", "expenses", "revenue", "net_profit", "control_year", "control_month", "status"
        from "int_management_control__dbt_tmp200445885975"
    )
  
[0m20:04:46.037961 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.003 seconds
[0m20:04:46.037961 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m20:04:46.037961 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:46.037961 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m20:04:46.045976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:04:46.045976 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m20:04:46.045976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9860F0860>]}
[0m20:04:46.045976 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mINSERT 0 51[0m in 0.18s]
[0m20:04:46.045976 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m20:04:46.045976 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m20:04:46.045976 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m20:04:46.053960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m20:04:46.053960 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m20:04:46.077977 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m20:04:46.077977 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m20:04:46.085958 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.085958 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

    
  
    

  create temporary table "test_utils__dbt_tmp200446077977"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m20:04:46.085958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:46.134490 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.054 seconds
[0m20:04:46.142474 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.142474 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m20:04:46.142474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m20:04:46.142474 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.150492 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'test_utils__dbt_tmp200446077977'
        
      order by ordinal_position

  
[0m20:04:46.167071 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m20:04:46.167071 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.167071 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:04:46.175090 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m20:04:46.175090 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.175090 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'test_utils'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:04:46.183090 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m20:04:46.191072 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m20:04:46.191072 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.191072 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      insert into "gestion"."public_staging"."test_utils" ("unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at")
    (
        select "unique_key", "control_id", "department_id", "control_date", "expenses", "revenue", "status", "updated_at"
        from "test_utils__dbt_tmp200446077977"
    )


  
[0m20:04:46.191072 [debug] [Thread-1 (]: SQL status: INSERT 0 51 in 0.002 seconds
[0m20:04:46.199071 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m20:04:46.199071 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:46.199071 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m20:04:46.199071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:04:46.199071 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m20:04:46.199071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985D382C0>]}
[0m20:04:46.207068 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mINSERT 0 51[0m in 0.15s]
[0m20:04:46.207068 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m20:04:46.207068 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m20:04:46.207068 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m20:04:46.207068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m20:04:46.207068 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m20:04:46.215067 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m20:04:46.215067 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m20:04:46.223067 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.223067 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

    
  
    

  create temporary table "control_growth__dbt_tmp200446223067"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m20:04:46.223067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:46.465048 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.240 seconds
[0m20:04:46.473033 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.473033 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m20:04:46.481031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:04:46.481031 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.481031 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_growth__dbt_tmp200446223067'
        
      order by ordinal_position

  
[0m20:04:46.497027 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.019 seconds
[0m20:04:46.505044 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.505044 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m20:04:46.513028 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:04:46.521025 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.521025 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_growth'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m20:04:46.529024 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:04:46.529024 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m20:04:46.537023 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:46.537023 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
        
            delete from "gestion"."public_management_control"."control_growth"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_growth__dbt_tmp200446223067"
            );

        
    

    insert into "gestion"."public_management_control"."control_growth" ("control_year", "control_month", "monthly_net_profit", "growth_rate")
    (
        select "control_year", "control_month", "monthly_net_profit", "growth_rate"
        from "control_growth__dbt_tmp200446223067"
    )
  
[0m20:04:46.537023 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m20:04:46.537023 [debug] [Thread-1 (]: On model.management_control_project.control_growth: ROLLBACK
[0m20:04:46.545026 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m20:04:46.553023 [debug] [Thread-1 (]: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m20:04:46.553023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C985D42C00>]}
[0m20:04:46.553023 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model public_management_control.control_growth  [[31mERROR[0m in 0.35s]
[0m20:04:46.553023 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m20:04:46.561024 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_growth' to be skipped because of status 'error'.  Reason: Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql.
[0m20:04:46.561024 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m20:04:46.561024 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m20:04:46.561024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m20:04:46.561024 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m20:04:46.577020 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m20:04:46.585023 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m20:04:46.593036 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.593036 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

    
  
    

  create temporary table "control_summary__dbt_tmp200446585023"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
    WHERE (control_year, control_month) NOT IN (
        SELECT DISTINCT
            control_year,
            control_month
        FROM "gestion"."public_management_control"."control_summary"
    )
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m20:04:46.593036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:46.840822 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.245 seconds
[0m20:04:46.848848 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.848848 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m20:04:46.856847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:04:46.856847 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.864847 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'control_summary__dbt_tmp200446585023'
        
      order by ordinal_position

  
[0m20:04:46.904822 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.043 seconds
[0m20:04:46.912843 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.920819 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m20:04:46.928822 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m20:04:46.936816 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.936816 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "gestion".INFORMATION_SCHEMA.columns
      where table_name = 'control_summary'
        
        and table_schema = 'public_management_control'
        
      order by ordinal_position

  
[0m20:04:46.936816 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:04:46.944816 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m20:04:46.944816 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:04:46.944816 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
        
            delete from "gestion"."public_management_control"."control_summary"
            where (
                control_year, control_month) in (
                select (control_year, control_month)
                from "control_summary__dbt_tmp200446585023"
            );

        
    

    insert into "gestion"."public_management_control"."control_summary" ("control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit")
    (
        select "control_year", "control_month", "total_expenses", "total_revenue", "total_net_profit"
        from "control_summary__dbt_tmp200446585023"
    )
  
[0m20:04:46.952811 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la sous-requête n'a pas assez de colonnes
LINE 7:                 control_year, control_month) in (
                                                     ^

[0m20:04:46.952811 [debug] [Thread-1 (]: On model.management_control_project.control_summary: ROLLBACK
[0m20:04:46.952811 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m20:04:46.960811 [debug] [Thread-1 (]: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m20:04:46.960811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076de68f-9b69-4c01-bcdb-3372b50c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9860E15B0>]}
[0m20:04:46.960811 [error] [Thread-1 (]: 9 of 9 ERROR creating sql incremental model public_management_control.control_summary  [[31mERROR[0m in 0.40s]
[0m20:04:46.960811 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m20:04:46.960811 [debug] [Thread-4 (]: Marking all children of 'model.management_control_project.control_summary' to be skipped because of status 'error'.  Reason: Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql.
[0m20:04:46.968810 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:46.968810 [debug] [MainThread]: On master: BEGIN
[0m20:04:46.968810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:47.032820 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:04:47.032820 [debug] [MainThread]: On master: COMMIT
[0m20:04:47.032820 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:47.032820 [debug] [MainThread]: On master: COMMIT
[0m20:04:47.032820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:47.032820 [debug] [MainThread]: On master: Close
[0m20:04:47.032820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:47.032820 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m20:04:47.032820 [debug] [MainThread]: Connection 'list_gestion_public_staging' was properly closed.
[0m20:04:47.032820 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m20:04:47.032820 [info ] [MainThread]: 
[0m20:04:47.040803 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m20:04:47.040803 [debug] [MainThread]: Command end result
[0m20:04:47.080818 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:04:47.088819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:04:47.096800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:04:47.096800 [info ] [MainThread]: 
[0m20:04:47.096800 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:04:47.096800 [info ] [MainThread]: 
[0m20:04:47.096800 [error] [MainThread]:   Database Error in model control_growth (models\marts\management_control\control_growth.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_growth.sql
[0m20:04:47.104798 [info ] [MainThread]: 
[0m20:04:47.104798 [error] [MainThread]:   Database Error in model control_summary (models\marts\management_control\control_summary.sql)
  ERREUR:  la sous-requête n'a pas assez de colonnes
  LINE 7:                 control_year, control_month) in (
                                                       ^
  compiled code at target\run\management_control_project\models\marts\management_control\control_summary.sql
[0m20:04:47.104798 [info ] [MainThread]: 
[0m20:04:47.104798 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:04:47.112814 [debug] [MainThread]: Command `dbt run` failed at 20:04:47.112814 after 5.06 seconds
[0m20:04:47.112814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9837F03B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9855C2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C983344710>]}
[0m20:04:47.112814 [debug] [MainThread]: Flushing usage events
[0m20:04:47.636252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:55.259791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDD04FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD1774830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD1377890>]}


============================== 20:04:55.262345 | 77910a09-1802-45fe-8c61-fa71986b1c4a ==============================
[0m20:04:55.262345 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:04:55.262345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:55.615866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD1751160>]}
[0m20:04:55.775852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCEB38D40>]}
[0m20:04:55.775852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:04:56.143815 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:04:56.543779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:56.543779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:56.671768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD2BB1640>]}
[0m20:04:56.903746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:04:56.911746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:04:56.959742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD3109310>]}
[0m20:04:56.959742 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:04:56.959742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD30FB2F0>]}
[0m20:04:56.967741 [info ] [MainThread]: 
[0m20:04:56.967741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:56.967741 [info ] [MainThread]: 
[0m20:04:56.967741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:56.975740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion'
[0m20:04:57.079732 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:57.079732 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:57.079732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:57.135725 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.058 seconds
[0m20:04:57.143725 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:57.143725 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:57.151723 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:57.151723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.303710 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.156 seconds
[0m20:04:57.303710 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:57.311709 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:57.311709 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:57.311709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.375705 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.057 seconds
[0m20:04:57.375705 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:57.383703 [debug] [ThreadPool]: Using postgres connection "list_gestion"
[0m20:04:57.383703 [debug] [ThreadPool]: On list_gestion: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion"} */

    select distinct nspname from pg_namespace
  
[0m20:04:57.383703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.431700 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.049 seconds
[0m20:04:57.439698 [debug] [ThreadPool]: On list_gestion: Close
[0m20:04:57.439698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m20:04:57.447698 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:57.455697 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:04:57.455697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:57.503693 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m20:04:57.503693 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:04:57.511691 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:04:57.519691 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m20:04:57.527690 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:04:57.527690 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:04:57.527690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_management_control)
[0m20:04:57.535689 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:57.535689 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:04:57.535689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.599686 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m20:04:57.607682 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:04:57.607682 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:04:57.615682 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m20:04:57.615682 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:04:57.615682 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:04:57.615682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public_seeds)
[0m20:04:57.623681 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:57.623681 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:04:57.623681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.671677 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m20:04:57.671677 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:04:57.671677 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:04:57.679675 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:04:57.687676 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:04:57.687676 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:04:57.687676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_staging)
[0m20:04:57.687676 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:57.687676 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:04:57.687676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:57.966897 [debug] [ThreadPool]: SQL status: BEGIN in 0.280 seconds
[0m20:04:57.974898 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:04:57.974898 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:04:58.006886 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.029 seconds
[0m20:04:58.014922 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:04:58.014922 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:04:58.022921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public)
[0m20:04:58.038893 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:58.046883 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:04:58.046883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:58.190892 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m20:04:58.190892 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:04:58.190892 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:04:58.214889 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m20:04:58.214889 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:04:58.222890 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:04:58.222890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_snapshots)
[0m20:04:58.230888 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:58.230888 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:04:58.238869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:58.342877 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m20:04:58.342877 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:04:58.350855 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:04:58.358852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:04:58.358852 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:04:58.358852 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:04:58.374868 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:58.374868 [debug] [MainThread]: On master: BEGIN
[0m20:04:58.374868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:58.438859 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m20:04:58.438859 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:58.438859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:58.454842 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m20:04:58.454842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD34695E0>]}
[0m20:04:58.454842 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:58.454842 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:58.462841 [debug] [MainThread]: On master: BEGIN
[0m20:04:58.462841 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:58.462841 [debug] [MainThread]: On master: COMMIT
[0m20:04:58.462841 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:58.462841 [debug] [MainThread]: On master: COMMIT
[0m20:04:58.462841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:58.462841 [debug] [MainThread]: On master: Close
[0m20:04:58.470841 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_time
[0m20:04:58.470841 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_time ................................... [RUN]
[0m20:04:58.470841 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.management_control_project.dim_time'
[0m20:04:58.470841 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_time
[0m20:04:58.494839 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_time"
[0m20:04:58.494839 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_time
[0m20:04:58.558839 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_time"
[0m20:04:58.558839 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.558839 [debug] [Thread-1 (]: On model.management_control_project.dim_time: BEGIN
[0m20:04:58.558839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:58.734818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.170 seconds
[0m20:04:58.734818 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.734818 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */

  
    

  create  table "gestion"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

WITH calendar AS (
    SELECT
        day::date AS calendar_date,
        EXTRACT(year FROM day) AS year,
        EXTRACT(month FROM day) AS month,
        EXTRACT(quarter FROM day) AS quarter,
        EXTRACT(week FROM day) AS week,
        TO_CHAR(day, 'Day') AS day_name
    FROM GENERATE_SERIES(
        '2020-01-01'::DATE,
        '2030-12-31'::DATE,
        '1 day'::INTERVAL
    ) day
)

SELECT *
FROM calendar
  );
  
[0m20:04:58.758815 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.028 seconds
[0m20:04:58.774814 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.774814 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m20:04:58.774814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:58.782813 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.782813 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
alter table "gestion"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m20:04:58.782813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:58.806815 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m20:04:58.806815 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.814811 [debug] [Thread-1 (]: On model.management_control_project.dim_time: COMMIT
[0m20:04:58.814811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:04:58.822813 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_time__dbt_backup"
[0m20:04:58.830812 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_time"
[0m20:04:58.830812 [debug] [Thread-1 (]: On model.management_control_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_time"} */
drop table if exists "gestion"."public"."dim_time__dbt_backup" cascade
[0m20:04:58.830812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:04:58.838812 [debug] [Thread-1 (]: On model.management_control_project.dim_time: Close
[0m20:04:58.838812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD3887DD0>]}
[0m20:04:58.838812 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_time .............................. [[32mSELECT 4018[0m in 0.37s]
[0m20:04:58.838812 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_time
[0m20:04:58.838812 [debug] [Thread-1 (]: Began running node model.management_control_project.stg_management_control
[0m20:04:58.838812 [info ] [Thread-1 (]: 2 of 9 START sql incremental model public_staging.stg_management_control ....... [RUN]
[0m20:04:58.846806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_time, now model.management_control_project.stg_management_control)
[0m20:04:58.846806 [debug] [Thread-1 (]: Began compiling node model.management_control_project.stg_management_control
[0m20:04:58.846806 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.stg_management_control"
[0m20:04:58.846806 [debug] [Thread-1 (]: Began executing node model.management_control_project.stg_management_control
[0m20:04:58.902802 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.stg_management_control"
[0m20:04:58.902802 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.902802 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: BEGIN
[0m20:04:58.902802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:58.958795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m20:04:58.958795 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.958795 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */

      
  
    

  create  table "gestion"."public_staging"."stg_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        UPPER(status) AS status,
        CURRENT_TIMESTAMP::timestamp AS updated_at 
    FROM "gestion"."public_seeds"."management_control"
)

SELECT
    control_id,
    department_id,
    control_date,
    expenses,
    revenue,
    status,
    updated_at
FROM raw_data
WHERE status NOT IN ('CANCELLED', 'FAILED')
  );
  
  
[0m20:04:58.974796 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.009 seconds
[0m20:04:58.982797 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.982797 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control" rename to "stg_management_control__dbt_backup"
[0m20:04:58.982797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:58.990795 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.990795 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
alter table "gestion"."public_staging"."stg_management_control__dbt_tmp" rename to "stg_management_control"
[0m20:04:58.990795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:58.990795 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m20:04:58.998794 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.998794 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: COMMIT
[0m20:04:58.998794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:58.998794 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."stg_management_control__dbt_backup"
[0m20:04:58.998794 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.stg_management_control"
[0m20:04:58.998794 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.stg_management_control"} */
drop table if exists "gestion"."public_staging"."stg_management_control__dbt_backup" cascade
[0m20:04:59.006792 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:59.006792 [debug] [Thread-1 (]: On model.management_control_project.stg_management_control: Close
[0m20:04:59.014792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD387EB40>]}
[0m20:04:59.014792 [info ] [Thread-1 (]: 2 of 9 OK created sql incremental model public_staging.stg_management_control .. [[32mSELECT 51[0m in 0.16s]
[0m20:04:59.014792 [debug] [Thread-1 (]: Finished running node model.management_control_project.stg_management_control
[0m20:04:59.014792 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_departement
[0m20:04:59.014792 [info ] [Thread-1 (]: 3 of 9 START sql table model public.dim_departement ............................ [RUN]
[0m20:04:59.014792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.stg_management_control, now model.management_control_project.dim_departement)
[0m20:04:59.022792 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_departement
[0m20:04:59.022792 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_departement"
[0m20:04:59.030792 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_departement
[0m20:04:59.030792 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_departement"
[0m20:04:59.038789 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.038789 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: BEGIN
[0m20:04:59.038789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.086786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:04:59.094786 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.094786 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */

  
    

  create  table "gestion"."public"."dim_departement__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    department_id
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m20:04:59.094786 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:04:59.102785 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.110783 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
alter table "gestion"."public"."dim_departement" rename to "dim_departement__dbt_backup"
[0m20:04:59.110783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.110783 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.110783 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
alter table "gestion"."public"."dim_departement__dbt_tmp" rename to "dim_departement"
[0m20:04:59.110783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:59.118781 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m20:04:59.118781 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.118781 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: COMMIT
[0m20:04:59.118781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:59.126785 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_departement__dbt_backup"
[0m20:04:59.126785 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_departement"
[0m20:04:59.126785 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_departement"} */
drop table if exists "gestion"."public"."dim_departement__dbt_backup" cascade
[0m20:04:59.126785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:04:59.134781 [debug] [Thread-1 (]: On model.management_control_project.dim_departement: Close
[0m20:04:59.134781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD34DF290>]}
[0m20:04:59.134781 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.dim_departement ....................... [[32mSELECT 5[0m in 0.12s]
[0m20:04:59.134781 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_departement
[0m20:04:59.134781 [debug] [Thread-1 (]: Began running node model.management_control_project.dim_status
[0m20:04:59.134781 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_status ................................. [RUN]
[0m20:04:59.142781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_departement, now model.management_control_project.dim_status)
[0m20:04:59.142781 [debug] [Thread-1 (]: Began compiling node model.management_control_project.dim_status
[0m20:04:59.142781 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.dim_status"
[0m20:04:59.142781 [debug] [Thread-1 (]: Began executing node model.management_control_project.dim_status
[0m20:04:59.150779 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.dim_status"
[0m20:04:59.150779 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.158778 [debug] [Thread-1 (]: On model.management_control_project.dim_status: BEGIN
[0m20:04:59.158778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.214774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m20:04:59.214774 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.214774 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */

  
    

  create  table "gestion"."public"."dim_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    status AS status_code,
    CASE
        WHEN status = 'VALIDATED' THEN 'Validé'
        WHEN status = 'PENDING' THEN 'En attente'
        WHEN status = 'FAILED' THEN 'Échec'
        WHEN status = 'CANCELLED' THEN 'Annulé'
        ELSE 'Inconnu'
    END AS status_description
FROM "gestion"."public_staging"."stg_management_control"
  );
  
[0m20:04:59.222773 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m20:04:59.310766 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.310766 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status" rename to "dim_status__dbt_backup"
[0m20:04:59.310766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.318763 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.318763 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
alter table "gestion"."public"."dim_status__dbt_tmp" rename to "dim_status"
[0m20:04:59.318763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.318763 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m20:04:59.318763 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.318763 [debug] [Thread-1 (]: On model.management_control_project.dim_status: COMMIT
[0m20:04:59.326763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:59.326763 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."dim_status__dbt_backup"
[0m20:04:59.334762 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.dim_status"
[0m20:04:59.334762 [debug] [Thread-1 (]: On model.management_control_project.dim_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.dim_status"} */
drop table if exists "gestion"."public"."dim_status__dbt_backup" cascade
[0m20:04:59.334762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:59.334762 [debug] [Thread-1 (]: On model.management_control_project.dim_status: Close
[0m20:04:59.342766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD3938AD0>]}
[0m20:04:59.342766 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_status ............................ [[32mSELECT 2[0m in 0.20s]
[0m20:04:59.342766 [debug] [Thread-1 (]: Finished running node model.management_control_project.dim_status
[0m20:04:59.342766 [debug] [Thread-1 (]: Began running node model.management_control_project.fact_management_control
[0m20:04:59.342766 [info ] [Thread-1 (]: 5 of 9 START sql table model public.fact_management_control .................... [RUN]
[0m20:04:59.342766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.dim_status, now model.management_control_project.fact_management_control)
[0m20:04:59.350761 [debug] [Thread-1 (]: Began compiling node model.management_control_project.fact_management_control
[0m20:04:59.350761 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.fact_management_control"
[0m20:04:59.350761 [debug] [Thread-1 (]: Began executing node model.management_control_project.fact_management_control
[0m20:04:59.358763 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.fact_management_control"
[0m20:04:59.358763 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.358763 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: BEGIN
[0m20:04:59.358763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.414755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m20:04:59.422754 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.422754 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */

  
    

  create  table "gestion"."public"."fact_management_control__dbt_tmp"
  
  
    as
  
  (
    
WITH base_data AS (
    SELECT
        mc.control_id,
        mc.department_id,
        mc.control_date,
        mc.expenses,
        mc.revenue,
        (mc.revenue - mc.expenses) AS net_profit,
        mc.status,
        mc.updated_at
    FROM "gestion"."public_staging"."stg_management_control" mc
),

aggregated_data AS (
    SELECT
        control_id,
        department_id,
        DATE_TRUNC('month', control_date) AS control_month,
        DATE_TRUNC('year', control_date) AS control_year,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(revenue - expenses) AS total_net_profit
    FROM base_data
    GROUP BY control_id, department_id, control_month, control_year
)

SELECT
    control_id,
    department_id,
    control_year,
    control_month,
    total_expenses,
    total_revenue,
    total_net_profit
FROM aggregated_data
  );
  
[0m20:04:59.430754 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m20:04:59.438753 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.438753 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control" rename to "fact_management_control__dbt_backup"
[0m20:04:59.438753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.446752 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.446752 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
alter table "gestion"."public"."fact_management_control__dbt_tmp" rename to "fact_management_control"
[0m20:04:59.454752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:59.454752 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m20:04:59.454752 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.454752 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: COMMIT
[0m20:04:59.454752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:59.462752 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public"."fact_management_control__dbt_backup"
[0m20:04:59.462752 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.fact_management_control"
[0m20:04:59.462752 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.fact_management_control"} */
drop table if exists "gestion"."public"."fact_management_control__dbt_backup" cascade
[0m20:04:59.462752 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:04:59.470751 [debug] [Thread-1 (]: On model.management_control_project.fact_management_control: Close
[0m20:04:59.470751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD34F4F50>]}
[0m20:04:59.470751 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.fact_management_control ............... [[32mSELECT 51[0m in 0.13s]
[0m20:04:59.470751 [debug] [Thread-1 (]: Finished running node model.management_control_project.fact_management_control
[0m20:04:59.470751 [debug] [Thread-1 (]: Began running node model.management_control_project.int_management_control
[0m20:04:59.470751 [info ] [Thread-1 (]: 6 of 9 START sql incremental model public_intermediate.int_management_control .. [RUN]
[0m20:04:59.470751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.fact_management_control, now model.management_control_project.int_management_control)
[0m20:04:59.478748 [debug] [Thread-1 (]: Began compiling node model.management_control_project.int_management_control
[0m20:04:59.478748 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.int_management_control"
[0m20:04:59.478748 [debug] [Thread-1 (]: Began executing node model.management_control_project.int_management_control
[0m20:04:59.486749 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.int_management_control"
[0m20:04:59.486749 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.494749 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: BEGIN
[0m20:04:59.494749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.542745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m20:04:59.542745 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.542745 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */

      
  
    

  create  table "gestion"."public_intermediate"."int_management_control__dbt_tmp"
  
  
    as
  
  (
    

WITH enriched_control AS (
    SELECT
        control_id,
        department_id,
        control_date,
        expenses,
        revenue,
        revenue - expenses AS net_profit,
        EXTRACT(YEAR FROM control_date) AS control_year,
        EXTRACT(MONTH FROM control_date) AS control_month,
        status
    FROM "gestion"."public_staging"."stg_management_control"
)

SELECT *
FROM enriched_control
  );
  
  
[0m20:04:59.550742 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.008 seconds
[0m20:04:59.558760 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.558760 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control" rename to "int_management_control__dbt_backup"
[0m20:04:59.558760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.558760 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.558760 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
alter table "gestion"."public_intermediate"."int_management_control__dbt_tmp" rename to "int_management_control"
[0m20:04:59.558760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:59.566743 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m20:04:59.566743 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.566743 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: COMMIT
[0m20:04:59.566743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:59.574759 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_intermediate"."int_management_control__dbt_backup"
[0m20:04:59.574759 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.int_management_control"
[0m20:04:59.574759 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.int_management_control"} */
drop table if exists "gestion"."public_intermediate"."int_management_control__dbt_backup" cascade
[0m20:04:59.574759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:59.582754 [debug] [Thread-1 (]: On model.management_control_project.int_management_control: Close
[0m20:04:59.582754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD34E3D40>]}
[0m20:04:59.582754 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model public_intermediate.int_management_control  [[32mSELECT 51[0m in 0.11s]
[0m20:04:59.582754 [debug] [Thread-1 (]: Finished running node model.management_control_project.int_management_control
[0m20:04:59.582754 [debug] [Thread-1 (]: Began running node model.management_control_project.test_utils
[0m20:04:59.582754 [info ] [Thread-1 (]: 7 of 9 START sql incremental model public_staging.test_utils ................... [RUN]
[0m20:04:59.582754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.int_management_control, now model.management_control_project.test_utils)
[0m20:04:59.582754 [debug] [Thread-1 (]: Began compiling node model.management_control_project.test_utils
[0m20:04:59.606740 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.test_utils"
[0m20:04:59.606740 [debug] [Thread-1 (]: Began executing node model.management_control_project.test_utils
[0m20:04:59.606740 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.test_utils"
[0m20:04:59.614740 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.614740 [debug] [Thread-1 (]: On model.management_control_project.test_utils: BEGIN
[0m20:04:59.614740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.818802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m20:04:59.818802 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.818802 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */

      
  
    

  create  table "gestion"."public_staging"."test_utils__dbt_tmp"
  
  
    as
  
  (
    SELECT
    md5(cast(coalesce(cast(control_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(department_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS unique_key,
    *
FROM "gestion"."public_staging"."stg_management_control"
  );
  
  
[0m20:04:59.826802 [debug] [Thread-1 (]: SQL status: SELECT 51 in 0.011 seconds
[0m20:04:59.834801 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.842803 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils" rename to "test_utils__dbt_backup"
[0m20:04:59.842803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:59.842803 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.850804 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
alter table "gestion"."public_staging"."test_utils__dbt_tmp" rename to "test_utils"
[0m20:04:59.850804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:59.850804 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m20:04:59.850804 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.850804 [debug] [Thread-1 (]: On model.management_control_project.test_utils: COMMIT
[0m20:04:59.859646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:04:59.859646 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_staging"."test_utils__dbt_backup"
[0m20:04:59.859646 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.test_utils"
[0m20:04:59.859646 [debug] [Thread-1 (]: On model.management_control_project.test_utils: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.test_utils"} */
drop table if exists "gestion"."public_staging"."test_utils__dbt_backup" cascade
[0m20:04:59.867651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:04:59.875651 [debug] [Thread-1 (]: On model.management_control_project.test_utils: Close
[0m20:04:59.875651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD38868D0>]}
[0m20:04:59.875651 [info ] [Thread-1 (]: 7 of 9 OK created sql incremental model public_staging.test_utils .............. [[32mSELECT 51[0m in 0.29s]
[0m20:04:59.875651 [debug] [Thread-1 (]: Finished running node model.management_control_project.test_utils
[0m20:04:59.875651 [debug] [Thread-1 (]: Began running node model.management_control_project.control_growth
[0m20:04:59.883651 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_management_control.control_growth .... [RUN]
[0m20:04:59.883651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.test_utils, now model.management_control_project.control_growth)
[0m20:04:59.883651 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_growth
[0m20:04:59.891668 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_growth"
[0m20:04:59.899649 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_growth
[0m20:04:59.907647 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_growth"
[0m20:04:59.907647 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:59.907647 [debug] [Thread-1 (]: On model.management_control_project.control_growth: BEGIN
[0m20:04:59.907647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:59.971660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m20:04:59.971660 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:59.971660 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */

      
  
    

  create  table "gestion"."public_management_control"."control_growth__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_summary AS (
    SELECT
        control_year,
        control_month,
        SUM(net_profit) AS monthly_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

growth_calculation AS (
    SELECT
        control_year,
        control_month,
        monthly_net_profit,
        LAG(monthly_net_profit) OVER (ORDER BY control_year, control_month) AS previous_month_net_profit
    FROM monthly_summary
)

SELECT
    control_year,
    control_month,
    monthly_net_profit,
    
CASE
    WHEN CAST(previous_month_net_profit AS NUMERIC) IS NULL THEN NULL
    WHEN CAST(previous_month_net_profit AS NUMERIC) = 0 THEN NULL
    ELSE ROUND((CAST(monthly_net_profit AS NUMERIC) - CAST(previous_month_net_profit AS NUMERIC)) / CAST(previous_month_net_profit AS NUMERIC) * 100, 2)
END
 AS growth_rate
FROM growth_calculation
  );
  
  
[0m20:04:59.987643 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.014 seconds
[0m20:04:59.995641 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:04:59.995641 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth" rename to "control_growth__dbt_backup"
[0m20:05:00.003639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:00.011641 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:05:00.011641 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
alter table "gestion"."public_management_control"."control_growth__dbt_tmp" rename to "control_growth"
[0m20:05:00.019638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:00.019638 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m20:05:00.019638 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:05:00.019638 [debug] [Thread-1 (]: On model.management_control_project.control_growth: COMMIT
[0m20:05:00.027642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:05:00.027642 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_growth__dbt_backup"
[0m20:05:00.035655 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_growth"
[0m20:05:00.035655 [debug] [Thread-1 (]: On model.management_control_project.control_growth: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_growth"} */
drop table if exists "gestion"."public_management_control"."control_growth__dbt_backup" cascade
[0m20:05:00.035655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:05:00.043635 [debug] [Thread-1 (]: On model.management_control_project.control_growth: Close
[0m20:05:00.043635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD34F5880>]}
[0m20:05:00.043635 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_management_control.control_growth  [[32mSELECT 12[0m in 0.16s]
[0m20:05:00.043635 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_growth
[0m20:05:00.051652 [debug] [Thread-1 (]: Began running node model.management_control_project.control_summary
[0m20:05:00.051652 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_management_control.control_summary ... [RUN]
[0m20:05:00.051652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.management_control_project.control_growth, now model.management_control_project.control_summary)
[0m20:05:00.051652 [debug] [Thread-1 (]: Began compiling node model.management_control_project.control_summary
[0m20:05:00.075651 [debug] [Thread-1 (]: Writing injected SQL for node "model.management_control_project.control_summary"
[0m20:05:00.075651 [debug] [Thread-1 (]: Began executing node model.management_control_project.control_summary
[0m20:05:00.083649 [debug] [Thread-1 (]: Writing runtime sql for node "model.management_control_project.control_summary"
[0m20:05:00.091634 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.091634 [debug] [Thread-1 (]: On model.management_control_project.control_summary: BEGIN
[0m20:05:00.091634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:00.352134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.258 seconds
[0m20:05:00.352134 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.352134 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */

      
  
    

  create  table "gestion"."public_management_control"."control_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH monthly_control AS (
    SELECT
        control_year,
        control_month,
        SUM(expenses) AS total_expenses,
        SUM(revenue) AS total_revenue,
        SUM(net_profit) AS total_net_profit
    FROM "gestion"."public_intermediate"."int_management_control"
    GROUP BY control_year, control_month
),

summary_with_validation AS (
    SELECT
        control_year,
        control_month,
        total_expenses,
        total_revenue,
        total_net_profit
    FROM monthly_control
    
)

SELECT *
FROM summary_with_validation
ORDER BY control_year, control_month
  );
  
  
[0m20:05:00.368156 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.017 seconds
[0m20:05:00.384135 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.384135 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary" rename to "control_summary__dbt_backup"
[0m20:05:00.384135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:00.400136 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.400136 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
alter table "gestion"."public_management_control"."control_summary__dbt_tmp" rename to "control_summary"
[0m20:05:00.400136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:00.408135 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m20:05:00.408135 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.408135 [debug] [Thread-1 (]: On model.management_control_project.control_summary: COMMIT
[0m20:05:00.416127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:05:00.424128 [debug] [Thread-1 (]: Applying DROP to: "gestion"."public_management_control"."control_summary__dbt_backup"
[0m20:05:00.424128 [debug] [Thread-1 (]: Using postgres connection "model.management_control_project.control_summary"
[0m20:05:00.424128 [debug] [Thread-1 (]: On model.management_control_project.control_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "model.management_control_project.control_summary"} */
drop table if exists "gestion"."public_management_control"."control_summary__dbt_backup" cascade
[0m20:05:00.440127 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m20:05:00.440127 [debug] [Thread-1 (]: On model.management_control_project.control_summary: Close
[0m20:05:00.448125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77910a09-1802-45fe-8c61-fa71986b1c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD389AD20>]}
[0m20:05:00.448125 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_management_control.control_summary  [[32mSELECT 12[0m in 0.40s]
[0m20:05:00.448125 [debug] [Thread-1 (]: Finished running node model.management_control_project.control_summary
[0m20:05:00.456130 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:00.456130 [debug] [MainThread]: On master: BEGIN
[0m20:05:00.456130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:00.722947 [debug] [MainThread]: SQL status: BEGIN in 0.263 seconds
[0m20:05:00.722947 [debug] [MainThread]: On master: COMMIT
[0m20:05:00.722947 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:00.722947 [debug] [MainThread]: On master: COMMIT
[0m20:05:00.722947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:00.730965 [debug] [MainThread]: On master: Close
[0m20:05:00.730965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:00.730965 [debug] [MainThread]: Connection 'list_gestion' was properly closed.
[0m20:05:00.730965 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m20:05:00.738964 [debug] [MainThread]: Connection 'model.management_control_project.control_summary' was properly closed.
[0m20:05:00.738964 [info ] [MainThread]: 
[0m20:05:00.746939 [info ] [MainThread]: Finished running 5 incremental models, 4 table models in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m20:05:00.754962 [debug] [MainThread]: Command end result
[0m20:05:00.850928 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:05:00.850928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:05:00.866927 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:05:00.866927 [info ] [MainThread]: 
[0m20:05:00.866927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:00.866927 [info ] [MainThread]: 
[0m20:05:00.866927 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:05:00.866927 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:00.866927 after 5.76 seconds
[0m20:05:00.874943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD158A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD18830B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD3070C50>]}
[0m20:05:00.874943 [debug] [MainThread]: Flushing usage events
[0m20:05:01.430552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:09.651834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE085C2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE082EA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE085C2060>]}


============================== 20:05:09.651834 | 3fa5ae86-3a5a-443d-86fc-2035a6cf748f ==============================
[0m20:05:09.651834 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:05:09.651834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:05:09.948443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE07FB7470>]}
[0m20:05:10.044433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE05AA6600>]}
[0m20:05:10.044433 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:05:10.332407 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:05:10.612383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:10.612383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:10.708378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE089390A0>]}
[0m20:05:10.860358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:05:10.868378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:05:10.918031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0A17F350>]}
[0m20:05:10.926031 [info ] [MainThread]: Found 9 models, 1 snapshot, 19 data tests, 1 seed, 1 source, 702 macros
[0m20:05:10.926031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE08637BC0>]}
[0m20:05:10.926031 [info ] [MainThread]: 
[0m20:05:10.926031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:10.934028 [info ] [MainThread]: 
[0m20:05:10.934028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:05:10.942027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public_intermediate'
[0m20:05:11.027959 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:05:11.027959 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:05:11.027959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:11.076808 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m20:05:11.076808 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:05:11.076808 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:05:11.084808 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m20:05:11.092823 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:05:11.092823 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:05:11.092823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m20:05:11.092823 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:05:11.092823 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:05:11.092823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:11.140803 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m20:05:11.140803 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:05:11.140803 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:05:11.149256 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:05:11.149256 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:05:11.149256 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:05:11.149256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_seeds)
[0m20:05:11.157258 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:05:11.157258 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:05:11.157258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:11.197256 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m20:05:11.205254 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:05:11.205254 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:05:11.213270 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m20:05:11.213270 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:05:11.213270 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:05:11.213270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_seeds, now list_gestion_public_management_control)
[0m20:05:11.221255 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:05:11.221255 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:05:11.221255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:11.453973 [debug] [ThreadPool]: SQL status: BEGIN in 0.232 seconds
[0m20:05:11.453973 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:05:11.453973 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:05:11.465603 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m20:05:11.465603 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:05:11.473627 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:05:11.473627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_public)
[0m20:05:11.481607 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:05:11.481607 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:05:11.489625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:11.737345 [debug] [ThreadPool]: SQL status: BEGIN in 0.250 seconds
[0m20:05:11.737345 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:05:11.737345 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:05:11.755940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m20:05:11.763946 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:05:11.763946 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:05:11.763946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_snapshots)
[0m20:05:11.779946 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:05:11.779946 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:05:11.779946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:11.859940 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m20:05:11.859940 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:05:11.859940 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:05:11.875938 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:05:11.875938 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:05:11.875938 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:05:11.883936 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:11.883936 [debug] [MainThread]: On master: BEGIN
[0m20:05:11.883936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:11.955928 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m20:05:11.955928 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:11.955928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:05:11.971927 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m20:05:11.971927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa5ae86-3a5a-443d-86fc-2035a6cf748f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0A4E6BA0>]}
[0m20:05:11.971927 [debug] [MainThread]: On master: ROLLBACK
[0m20:05:11.979927 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:11.979927 [debug] [MainThread]: On master: BEGIN
[0m20:05:11.979927 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:05:11.979927 [debug] [MainThread]: On master: COMMIT
[0m20:05:11.979927 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:11.979927 [debug] [MainThread]: On master: COMMIT
[0m20:05:11.979927 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:11.979927 [debug] [MainThread]: On master: Close
[0m20:05:11.987943 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:11.987943 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m20:05:11.987943 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m20:05:11.987943 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:12.035921 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:12.035921 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:12.075934 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:12.077630 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:12.077630 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m20:05:12.077630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:12.141629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m20:05:12.141629 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:12.149630 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m20:05:12.149630 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:12.149630 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m20:05:12.157647 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m20:05:12.157647 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.17s]
[0m20:05:12.157647 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:12.157647 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m20:05:12.157647 [info ] [Thread-1 (]: 2 of 19 START test duplicate_control_entries ................................... [RUN]
[0m20:05:12.157647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m20:05:12.157647 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m20:05:12.165641 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m20:05:12.165641 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m20:05:12.173645 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m20:05:12.173645 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:05:12.173645 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m20:05:12.173645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.221621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:05:12.221621 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:05:12.221621 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m20:05:12.229639 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:12.229639 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m20:05:12.229639 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m20:05:12.229639 [info ] [Thread-1 (]: 2 of 19 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.07s]
[0m20:05:12.229639 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m20:05:12.229639 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:12.237623 [info ] [Thread-1 (]: 3 of 19 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m20:05:12.237623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m20:05:12.237623 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:12.245638 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:12.245638 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:12.245638 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:12.253654 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:12.253654 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m20:05:12.253654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.301631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:05:12.301631 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:12.301631 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m20:05:12.301631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:12.309629 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m20:05:12.309629 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m20:05:12.309629 [info ] [Thread-1 (]: 3 of 19 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.07s]
[0m20:05:12.309629 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:12.309629 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:12.309629 [info ] [Thread-1 (]: 4 of 19 START test not_null_dim_status_status_code ............................. [RUN]
[0m20:05:12.309629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa)
[0m20:05:12.317615 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:12.317615 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:12.317615 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:12.325630 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:12.325630 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:12.325630 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: BEGIN
[0m20:05:12.325630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.373623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:05:12.373623 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:12.373623 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status_code
from "gestion"."public"."dim_status"
where status_code is null



      
    ) dbt_internal_test
[0m20:05:12.373623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:12.381611 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: ROLLBACK
[0m20:05:12.381611 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: Close
[0m20:05:12.381611 [info ] [Thread-1 (]: 4 of 19 PASS not_null_dim_status_status_code ................................... [[32mPASS[0m in 0.07s]
[0m20:05:12.381611 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:12.381611 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:12.381611 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_time_calendar_date ............................. [RUN]
[0m20:05:12.381611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa, now test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3)
[0m20:05:12.381611 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:12.389609 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:12.389609 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:12.397607 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:12.397607 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:12.397607 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: BEGIN
[0m20:05:12.397607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.453616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:05:12.453616 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:12.453616 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select calendar_date
from "gestion"."public"."dim_time"
where calendar_date is null



      
    ) dbt_internal_test
[0m20:05:12.453616 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:12.453616 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: ROLLBACK
[0m20:05:12.461618 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: Close
[0m20:05:12.461618 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_time_calendar_date ................................... [[32mPASS[0m in 0.08s]
[0m20:05:12.461618 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:12.461618 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:12.461618 [info ] [Thread-1 (]: 6 of 19 START test not_null_fact_management_control_department_id .............. [RUN]
[0m20:05:12.461618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3, now test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e)
[0m20:05:12.461618 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:12.469601 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:12.469601 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:12.477599 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:12.477599 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:12.477599 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: BEGIN
[0m20:05:12.477599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.526150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:05:12.526150 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:12.526150 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select department_id
from "gestion"."public"."fact_management_control"
where department_id is null



      
    ) dbt_internal_test
[0m20:05:12.535088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:12.535088 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: ROLLBACK
[0m20:05:12.535088 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: Close
[0m20:05:12.535088 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fact_management_control_department_id .................... [[32mPASS[0m in 0.07s]
[0m20:05:12.535088 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:12.535088 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:12.535088 [info ] [Thread-1 (]: 7 of 19 START test not_null_fact_management_control_total_expenses ............. [RUN]
[0m20:05:12.535088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e, now test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b)
[0m20:05:12.543109 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:12.543109 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:12.551091 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:12.551091 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:12.559090 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:12.559090 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: BEGIN
[0m20:05:12.559090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.607087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m20:05:12.607087 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:12.607087 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_expenses
from "gestion"."public"."fact_management_control"
where total_expenses is null



      
    ) dbt_internal_test
[0m20:05:12.607087 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:12.615103 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: ROLLBACK
[0m20:05:12.615103 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: Close
[0m20:05:12.615103 [info ] [Thread-1 (]: 7 of 19 PASS not_null_fact_management_control_total_expenses ................... [[32mPASS[0m in 0.08s]
[0m20:05:12.615103 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:12.615103 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:12.615103 [info ] [Thread-1 (]: 8 of 19 START test not_null_fact_management_control_total_revenue .............. [RUN]
[0m20:05:12.623084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b, now test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6)
[0m20:05:12.623084 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:12.623084 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:12.623084 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:12.631084 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:12.631084 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:12.631084 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: BEGIN
[0m20:05:12.639101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.687094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m20:05:12.687094 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:12.687094 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "gestion"."public"."fact_management_control"
where total_revenue is null



      
    ) dbt_internal_test
[0m20:05:12.687094 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:12.695080 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: ROLLBACK
[0m20:05:12.695080 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: Close
[0m20:05:12.695080 [info ] [Thread-1 (]: 8 of 19 PASS not_null_fact_management_control_total_revenue .................... [[32mPASS[0m in 0.07s]
[0m20:05:12.695080 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:12.695080 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:12.695080 [info ] [Thread-1 (]: 9 of 19 START test not_null_int_management_control_net_profit .................. [RUN]
[0m20:05:12.695080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m20:05:12.703091 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:12.703091 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:12.703091 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:12.711095 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:12.711095 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:12.711095 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m20:05:12.711095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:12.956062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m20:05:12.956062 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:12.956062 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m20:05:12.964061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:12.964061 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m20:05:12.972042 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m20:05:12.972042 [info ] [Thread-1 (]: 9 of 19 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.28s]
[0m20:05:12.972042 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:12.972042 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:12.980036 [info ] [Thread-1 (]: 10 of 19 START test not_null_stg_management_control_control_date ............... [RUN]
[0m20:05:12.980036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m20:05:12.980036 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:12.988060 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:12.996059 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:13.004036 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:13.012034 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:13.012034 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m20:05:13.012034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:13.290032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.274 seconds
[0m20:05:13.290032 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:13.290032 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:05:13.302306 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:13.302306 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m20:05:13.310339 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m20:05:13.310339 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stg_management_control_control_date ..................... [[32mPASS[0m in 0.33s]
[0m20:05:13.318339 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:13.318339 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:13.318339 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_management_control_control_id ................. [RUN]
[0m20:05:13.318339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m20:05:13.326338 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:13.350312 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:13.358309 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:13.438301 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:13.446301 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:13.446301 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m20:05:13.446301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:13.502310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:05:13.502310 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:13.502310 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:05:13.502310 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:13.502310 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m20:05:13.502310 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m20:05:13.510309 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_management_control_control_id ....................... [[32mPASS[0m in 0.19s]
[0m20:05:13.510309 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:13.510309 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:13.510309 [info ] [Thread-1 (]: 12 of 19 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m20:05:13.510309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m20:05:13.518293 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:13.518293 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:13.526294 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:13.526294 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:13.526294 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:13.534296 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m20:05:13.534296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:13.590286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m20:05:13.590286 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:13.590286 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m20:05:13.590286 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:13.598289 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m20:05:13.598289 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m20:05:13.598289 [info ] [Thread-1 (]: 12 of 19 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.09s]
[0m20:05:13.598289 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:13.606300 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:13.606300 [info ] [Thread-1 (]: 13 of 19 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m20:05:13.606300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m20:05:13.606300 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:13.614288 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:13.614288 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:13.622285 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:13.622285 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:13.622285 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m20:05:13.622285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:13.686277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m20:05:13.686277 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:13.686277 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:05:13.686277 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:13.694292 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m20:05:13.694292 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m20:05:13.694292 [info ] [Thread-1 (]: 13 of 19 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.09s]
[0m20:05:13.702277 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:13.702277 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:13.702277 [info ] [Thread-1 (]: 14 of 19 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m20:05:13.702277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m20:05:13.702277 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:13.718275 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:13.718275 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:13.726275 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:13.726275 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:13.734274 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m20:05:13.734274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:13.920307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.186 seconds
[0m20:05:13.920307 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:13.920307 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:05:13.928324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:13.928324 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m20:05:13.928324 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m20:05:13.936307 [info ] [Thread-1 (]: 14 of 19 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.23s]
[0m20:05:13.936307 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:13.936307 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:13.936307 [info ] [Thread-1 (]: 15 of 19 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m20:05:13.944306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m20:05:13.944306 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:13.960321 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:13.960321 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:13.976305 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:13.976305 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:13.984301 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m20:05:13.984301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:14.056295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m20:05:14.056295 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:14.056295 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:14.064294 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:14.064294 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m20:05:14.064294 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m20:05:14.064294 [info ] [Thread-1 (]: 15 of 19 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.13s]
[0m20:05:14.072292 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:14.072292 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:14.072292 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_status_status_code .............................. [RUN]
[0m20:05:14.072292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_dim_status_status_code.ce72371f5e)
[0m20:05:14.072292 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:14.080292 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:14.080292 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:14.088293 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:14.088293 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:14.088293 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: BEGIN
[0m20:05:14.088293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:14.152285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m20:05:14.152285 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:14.152285 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_status_status_code.ce72371f5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    status_code as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_status"
where status_code is not null
group by status_code
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:14.152285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:14.152285 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: ROLLBACK
[0m20:05:14.152285 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: Close
[0m20:05:14.160284 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_status_status_code .................................... [[32mPASS[0m in 0.08s]
[0m20:05:14.160284 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:14.160284 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:14.160284 [info ] [Thread-1 (]: 17 of 19 START test unique_dim_time_calendar_date .............................. [RUN]
[0m20:05:14.160284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_status_status_code.ce72371f5e, now test.management_control_project.unique_dim_time_calendar_date.4fe35b7375)
[0m20:05:14.160284 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:14.168284 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:14.168284 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:14.176283 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:14.176283 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:14.176283 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: BEGIN
[0m20:05:14.176283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:14.232280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m20:05:14.232280 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:14.232280 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    calendar_date as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_time"
where calendar_date is not null
group by calendar_date
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:14.240296 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:05:14.240296 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: ROLLBACK
[0m20:05:14.240296 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: Close
[0m20:05:14.240296 [info ] [Thread-1 (]: 17 of 19 PASS unique_dim_time_calendar_date .................................... [[32mPASS[0m in 0.08s]
[0m20:05:14.240296 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:14.240296 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:05:14.248282 [info ] [Thread-1 (]: 18 of 19 START test unique_management_control_snapshot_control_id .............. [RUN]
[0m20:05:14.248282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_time_calendar_date.4fe35b7375, now test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43)
[0m20:05:14.248282 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:05:14.256294 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:05:14.256294 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:05:14.256294 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:05:14.256294 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:05:14.264276 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: BEGIN
[0m20:05:14.264276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:14.312270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:05:14.312270 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"
[0m20:05:14.312270 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."snapshots"."management_control_snapshot"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:14.320269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:14.320269 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: ROLLBACK
[0m20:05:14.320269 [debug] [Thread-1 (]: On test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43: Close
[0m20:05:14.320269 [warn ] [Thread-1 (]: 18 of 19 WARN 51 unique_management_control_snapshot_control_id ................. [[33mWARN 51[0m in 0.07s]
[0m20:05:14.320269 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43
[0m20:05:14.320269 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:14.320269 [info ] [Thread-1 (]: 19 of 19 START test unique_stg_management_control_control_id ................... [RUN]
[0m20:05:14.328271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_management_control_snapshot_control_id.02955a6a43, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m20:05:14.328271 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:14.328271 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:14.336271 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:14.336271 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:14.336271 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:14.336271 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m20:05:14.336271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:14.549672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.213 seconds
[0m20:05:14.557696 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:14.557696 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:14.565675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:05:14.565675 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m20:05:14.565675 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m20:05:14.573694 [info ] [Thread-1 (]: 19 of 19 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.25s]
[0m20:05:14.581672 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:14.581672 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:14.581672 [debug] [MainThread]: On master: BEGIN
[0m20:05:14.581672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:14.685662 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m20:05:14.685662 [debug] [MainThread]: On master: COMMIT
[0m20:05:14.685662 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:14.685662 [debug] [MainThread]: On master: COMMIT
[0m20:05:14.685662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:14.685662 [debug] [MainThread]: On master: Close
[0m20:05:14.685662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:14.685662 [debug] [MainThread]: Connection 'list_gestion_snapshots' was properly closed.
[0m20:05:14.693661 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m20:05:14.693661 [info ] [MainThread]: 
[0m20:05:14.693661 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m20:05:14.701675 [debug] [MainThread]: Command end result
[0m20:05:14.773669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:05:14.773669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:05:14.781649 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:05:14.781649 [info ] [MainThread]: 
[0m20:05:14.789649 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m20:05:14.789649 [info ] [MainThread]: 
[0m20:05:14.789649 [warn ] [MainThread]: [33mWarning in test unique_management_control_snapshot_control_id (snapshots\schema.yml)[0m
[0m20:05:14.789649 [warn ] [MainThread]: Got 51 results, configured to warn if != 0
[0m20:05:14.789649 [info ] [MainThread]: 
[0m20:05:14.789649 [info ] [MainThread]:   compiled code at target\compiled\management_control_project\snapshots\schema.yml\unique_management_control_snapshot_control_id.sql
[0m20:05:14.789649 [info ] [MainThread]: 
[0m20:05:14.797653 [info ] [MainThread]: Done. PASS=18 WARN=1 ERROR=0 SKIP=0 TOTAL=19
[0m20:05:14.797653 [debug] [MainThread]: Command `dbt test` succeeded at 20:05:14.797653 after 5.28 seconds
[0m20:05:14.797653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0587C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE08373860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE084831D0>]}
[0m20:05:14.797653 [debug] [MainThread]: Flushing usage events
[0m20:05:15.262773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:34.338560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6C5A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6C59A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6C580B0>]}


============================== 20:05:34.346557 | 071787a8-7eaf-40e0-88eb-2b1394b5209e ==============================
[0m20:05:34.346557 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:05:34.346557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\controle_gestion_dbt\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:34.642547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC727A990>]}
[0m20:05:34.738522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC7106420>]}
[0m20:05:34.738522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:05:35.018499 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:05:35.330485 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:05:35.778445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC722EA20>]}
[0m20:05:35.930415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:05:35.938416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:05:35.995541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC8E2ED50>]}
[0m20:05:35.995541 [info ] [MainThread]: Found 9 models, 18 data tests, 1 seed, 1 snapshot, 1 source, 702 macros
[0m20:05:35.995541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC8DFBBF0>]}
[0m20:05:35.995541 [info ] [MainThread]: 
[0m20:05:35.995541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:35.995541 [info ] [MainThread]: 
[0m20:05:36.003543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:05:36.003543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_gestion_public'
[0m20:05:36.099550 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:05:36.099550 [debug] [ThreadPool]: On list_gestion_public: BEGIN
[0m20:05:36.099550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:36.343328 [debug] [ThreadPool]: SQL status: BEGIN in 0.242 seconds
[0m20:05:36.343328 [debug] [ThreadPool]: Using postgres connection "list_gestion_public"
[0m20:05:36.343328 [debug] [ThreadPool]: On list_gestion_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:05:36.351307 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:05:36.359324 [debug] [ThreadPool]: On list_gestion_public: ROLLBACK
[0m20:05:36.359324 [debug] [ThreadPool]: On list_gestion_public: Close
[0m20:05:36.359324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public, now list_gestion_public_intermediate)
[0m20:05:36.367325 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:05:36.367325 [debug] [ThreadPool]: On list_gestion_public_intermediate: BEGIN
[0m20:05:36.367325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:36.431312 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m20:05:36.431312 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_intermediate"
[0m20:05:36.431312 [debug] [ThreadPool]: On list_gestion_public_intermediate: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_intermediate"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m20:05:36.439315 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m20:05:36.439315 [debug] [ThreadPool]: On list_gestion_public_intermediate: ROLLBACK
[0m20:05:36.439315 [debug] [ThreadPool]: On list_gestion_public_intermediate: Close
[0m20:05:36.439315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_intermediate, now list_gestion_public_staging)
[0m20:05:36.447317 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:05:36.447317 [debug] [ThreadPool]: On list_gestion_public_staging: BEGIN
[0m20:05:36.447317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:36.487294 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m20:05:36.495297 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_staging"
[0m20:05:36.495297 [debug] [ThreadPool]: On list_gestion_public_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_staging"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:05:36.503309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:05:36.503309 [debug] [ThreadPool]: On list_gestion_public_staging: ROLLBACK
[0m20:05:36.503309 [debug] [ThreadPool]: On list_gestion_public_staging: Close
[0m20:05:36.503309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_staging, now list_gestion_public_management_control)
[0m20:05:36.511293 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:05:36.511293 [debug] [ThreadPool]: On list_gestion_public_management_control: BEGIN
[0m20:05:36.511293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:36.559293 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m20:05:36.559293 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_management_control"
[0m20:05:36.559293 [debug] [ThreadPool]: On list_gestion_public_management_control: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_management_control"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_management_control'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_management_control'
  
[0m20:05:36.567288 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:05:36.567288 [debug] [ThreadPool]: On list_gestion_public_management_control: ROLLBACK
[0m20:05:36.567288 [debug] [ThreadPool]: On list_gestion_public_management_control: Close
[0m20:05:36.567288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_public_management_control, now list_gestion_snapshots)
[0m20:05:36.575290 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:05:36.575290 [debug] [ThreadPool]: On list_gestion_snapshots: BEGIN
[0m20:05:36.575290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:36.624738 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m20:05:36.624738 [debug] [ThreadPool]: Using postgres connection "list_gestion_snapshots"
[0m20:05:36.624738 [debug] [ThreadPool]: On list_gestion_snapshots: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_snapshots"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:05:36.633306 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m20:05:36.641312 [debug] [ThreadPool]: On list_gestion_snapshots: ROLLBACK
[0m20:05:36.641312 [debug] [ThreadPool]: On list_gestion_snapshots: Close
[0m20:05:36.641312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_gestion_snapshots, now list_gestion_public_seeds)
[0m20:05:36.641312 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:05:36.641312 [debug] [ThreadPool]: On list_gestion_public_seeds: BEGIN
[0m20:05:36.641312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:36.906090 [debug] [ThreadPool]: SQL status: BEGIN in 0.263 seconds
[0m20:05:36.914060 [debug] [ThreadPool]: Using postgres connection "list_gestion_public_seeds"
[0m20:05:36.914060 [debug] [ThreadPool]: On list_gestion_public_seeds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "list_gestion_public_seeds"} */
select
      'gestion' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_seeds'
    union all
    select
      'gestion' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_seeds'
  
[0m20:05:36.947548 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m20:05:36.947548 [debug] [ThreadPool]: On list_gestion_public_seeds: ROLLBACK
[0m20:05:36.955521 [debug] [ThreadPool]: On list_gestion_public_seeds: Close
[0m20:05:36.987509 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:36.987509 [debug] [MainThread]: On master: BEGIN
[0m20:05:36.995509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:37.234555 [debug] [MainThread]: SQL status: BEGIN in 0.238 seconds
[0m20:05:37.234555 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:37.234555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:05:37.258556 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m20:05:37.258556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071787a8-7eaf-40e0-88eb-2b1394b5209e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9239CD0>]}
[0m20:05:37.266555 [debug] [MainThread]: On master: ROLLBACK
[0m20:05:37.266555 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:37.266555 [debug] [MainThread]: On master: BEGIN
[0m20:05:37.266555 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:05:37.266555 [debug] [MainThread]: On master: COMMIT
[0m20:05:37.274555 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:37.274555 [debug] [MainThread]: On master: COMMIT
[0m20:05:37.274555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:37.274555 [debug] [MainThread]: On master: Close
[0m20:05:37.282555 [debug] [Thread-1 (]: Began running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:37.282555 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [RUN]
[0m20:05:37.290550 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c'
[0m20:05:37.290550 [debug] [Thread-1 (]: Began compiling node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:37.362547 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:37.370548 [debug] [Thread-1 (]: Began executing node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:37.466532 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:37.466532 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:37.466532 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: BEGIN
[0m20:05:37.466532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:37.514548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m20:05:37.514548 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"
[0m20:05:37.514548 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_staging"."stg_management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','CANCELLED','FAILED'
)



      
    ) dbt_internal_test
[0m20:05:37.514548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:37.522542 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: ROLLBACK
[0m20:05:37.522542 [debug] [Thread-1 (]: On test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c: Close
[0m20:05:37.522542 [info ] [Thread-1 (]: 1 of 18 PASS accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED  [[32mPASS[0m in 0.23s]
[0m20:05:37.530526 [debug] [Thread-1 (]: Finished running node test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c
[0m20:05:37.530526 [debug] [Thread-1 (]: Began running node test.management_control_project.duplicate_control_entries
[0m20:05:37.530526 [info ] [Thread-1 (]: 2 of 18 START test duplicate_control_entries ................................... [RUN]
[0m20:05:37.532483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.accepted_values_stg_management_control_status__VALIDATED__PENDING__CANCELLED__FAILED.98f19b559c, now test.management_control_project.duplicate_control_entries)
[0m20:05:37.532483 [debug] [Thread-1 (]: Began compiling node test.management_control_project.duplicate_control_entries
[0m20:05:37.532483 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.duplicate_control_entries"
[0m20:05:37.532483 [debug] [Thread-1 (]: Began executing node test.management_control_project.duplicate_control_entries
[0m20:05:37.540505 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.duplicate_control_entries"
[0m20:05:37.540505 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:05:37.540505 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: BEGIN
[0m20:05:37.540505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:37.590303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m20:05:37.590303 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.duplicate_control_entries"
[0m20:05:37.590303 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.duplicate_control_entries"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT control_month, COUNT(*)
FROM "gestion"."public_management_control"."control_summary"
GROUP BY control_month
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m20:05:37.598723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:37.598723 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: ROLLBACK
[0m20:05:37.598723 [debug] [Thread-1 (]: On test.management_control_project.duplicate_control_entries: Close
[0m20:05:37.598723 [info ] [Thread-1 (]: 2 of 18 PASS duplicate_control_entries ......................................... [[32mPASS[0m in 0.07s]
[0m20:05:37.598723 [debug] [Thread-1 (]: Finished running node test.management_control_project.duplicate_control_entries
[0m20:05:37.598723 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:37.606726 [info ] [Thread-1 (]: 3 of 18 START test not_null_control_growth_monthly_net_profit .................. [RUN]
[0m20:05:37.606726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.duplicate_control_entries, now test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003)
[0m20:05:37.606726 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:37.614745 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:37.614745 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:37.622744 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:37.622744 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:37.622744 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: BEGIN
[0m20:05:37.622744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:37.670735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:05:37.670735 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"
[0m20:05:37.670735 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select monthly_net_profit
from "gestion"."public_management_control"."control_growth"
where monthly_net_profit is null



      
    ) dbt_internal_test
[0m20:05:37.670735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:37.678735 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: ROLLBACK
[0m20:05:37.678735 [debug] [Thread-1 (]: On test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003: Close
[0m20:05:37.678735 [info ] [Thread-1 (]: 3 of 18 PASS not_null_control_growth_monthly_net_profit ........................ [[32mPASS[0m in 0.07s]
[0m20:05:37.678735 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003
[0m20:05:37.678735 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:37.678735 [info ] [Thread-1 (]: 4 of 18 START test not_null_dim_status_status_code ............................. [RUN]
[0m20:05:37.678735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_control_growth_monthly_net_profit.c44bd61003, now test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa)
[0m20:05:37.678735 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:37.686738 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:37.686738 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:37.694718 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:37.694718 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:37.694718 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: BEGIN
[0m20:05:37.694718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:37.742735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:05:37.742735 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"
[0m20:05:37.742735 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status_code
from "gestion"."public"."dim_status"
where status_code is null



      
    ) dbt_internal_test
[0m20:05:37.750713 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:37.750713 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: ROLLBACK
[0m20:05:37.750713 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa: Close
[0m20:05:37.750713 [info ] [Thread-1 (]: 4 of 18 PASS not_null_dim_status_status_code ................................... [[32mPASS[0m in 0.07s]
[0m20:05:37.750713 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa
[0m20:05:37.758713 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:37.758713 [info ] [Thread-1 (]: 5 of 18 START test not_null_dim_time_calendar_date ............................. [RUN]
[0m20:05:37.758713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_status_status_code.5d9cfdd3aa, now test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3)
[0m20:05:37.758713 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:37.766714 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:37.766714 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:37.774712 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:37.774712 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:37.774712 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: BEGIN
[0m20:05:37.774712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:37.818268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:05:37.826270 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"
[0m20:05:37.826270 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select calendar_date
from "gestion"."public"."dim_time"
where calendar_date is null



      
    ) dbt_internal_test
[0m20:05:37.826270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:37.826270 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: ROLLBACK
[0m20:05:37.826270 [debug] [Thread-1 (]: On test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3: Close
[0m20:05:37.826270 [info ] [Thread-1 (]: 5 of 18 PASS not_null_dim_time_calendar_date ................................... [[32mPASS[0m in 0.07s]
[0m20:05:37.834270 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3
[0m20:05:37.834270 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:37.834270 [info ] [Thread-1 (]: 6 of 18 START test not_null_fact_management_control_department_id .............. [RUN]
[0m20:05:37.834270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_dim_time_calendar_date.6536ae56b3, now test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e)
[0m20:05:37.834270 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:37.842266 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:37.842266 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:37.842266 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:37.842266 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:37.850266 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: BEGIN
[0m20:05:37.850266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:37.893874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:05:37.893874 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"
[0m20:05:37.893874 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select department_id
from "gestion"."public"."fact_management_control"
where department_id is null



      
    ) dbt_internal_test
[0m20:05:37.901887 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:37.901887 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: ROLLBACK
[0m20:05:37.901887 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e: Close
[0m20:05:37.901887 [info ] [Thread-1 (]: 6 of 18 PASS not_null_fact_management_control_department_id .................... [[32mPASS[0m in 0.07s]
[0m20:05:37.901887 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e
[0m20:05:37.901887 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:37.909871 [info ] [Thread-1 (]: 7 of 18 START test not_null_fact_management_control_total_expenses ............. [RUN]
[0m20:05:37.909871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_department_id.c2cbdfa14e, now test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b)
[0m20:05:37.909871 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:37.909871 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:37.909871 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:37.917871 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:37.917871 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:37.925873 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: BEGIN
[0m20:05:37.925873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.150193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m20:05:38.150193 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"
[0m20:05:38.158171 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_expenses
from "gestion"."public"."fact_management_control"
where total_expenses is null



      
    ) dbt_internal_test
[0m20:05:38.158171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:38.166192 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: ROLLBACK
[0m20:05:38.166192 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b: Close
[0m20:05:38.166192 [info ] [Thread-1 (]: 7 of 18 PASS not_null_fact_management_control_total_expenses ................... [[32mPASS[0m in 0.26s]
[0m20:05:38.174169 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b
[0m20:05:38.174169 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:38.174169 [info ] [Thread-1 (]: 8 of 18 START test not_null_fact_management_control_total_revenue .............. [RUN]
[0m20:05:38.182169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_expenses.919afa0f7b, now test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6)
[0m20:05:38.182169 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:38.198172 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:38.198172 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:38.206171 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:38.206171 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:38.214167 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: BEGIN
[0m20:05:38.214167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.435975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:05:38.435975 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"
[0m20:05:38.435975 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "gestion"."public"."fact_management_control"
where total_revenue is null



      
    ) dbt_internal_test
[0m20:05:38.435975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:38.443989 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: ROLLBACK
[0m20:05:38.443989 [debug] [Thread-1 (]: On test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6: Close
[0m20:05:38.443989 [info ] [Thread-1 (]: 8 of 18 PASS not_null_fact_management_control_total_revenue .................... [[32mPASS[0m in 0.27s]
[0m20:05:38.443989 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6
[0m20:05:38.443989 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:38.451975 [info ] [Thread-1 (]: 9 of 18 START test not_null_int_management_control_net_profit .................. [RUN]
[0m20:05:38.452680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_fact_management_control_total_revenue.46d1ff78b6, now test.management_control_project.not_null_int_management_control_net_profit.3f78349be3)
[0m20:05:38.452680 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:38.460700 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:38.460700 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:38.460700 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:38.468701 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:38.468701 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: BEGIN
[0m20:05:38.468701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.540688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m20:05:38.540688 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"
[0m20:05:38.540688 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_int_management_control_net_profit.3f78349be3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select net_profit
from "gestion"."public_intermediate"."int_management_control"
where net_profit is null



      
    ) dbt_internal_test
[0m20:05:38.540688 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:38.548704 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: ROLLBACK
[0m20:05:38.548704 [debug] [Thread-1 (]: On test.management_control_project.not_null_int_management_control_net_profit.3f78349be3: Close
[0m20:05:38.548704 [info ] [Thread-1 (]: 9 of 18 PASS not_null_int_management_control_net_profit ........................ [[32mPASS[0m in 0.10s]
[0m20:05:38.548704 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_int_management_control_net_profit.3f78349be3
[0m20:05:38.548704 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:38.548704 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_management_control_control_date ............... [RUN]
[0m20:05:38.548704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_int_management_control_net_profit.3f78349be3, now test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67)
[0m20:05:38.556690 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:38.556690 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:38.556690 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:38.564705 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:38.564705 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:38.564705 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: BEGIN
[0m20:05:38.564705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.613381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m20:05:38.613381 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"
[0m20:05:38.613381 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_staging"."stg_management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:05:38.621396 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:38.621396 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: ROLLBACK
[0m20:05:38.621396 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67: Close
[0m20:05:38.621396 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_management_control_control_date ..................... [[32mPASS[0m in 0.07s]
[0m20:05:38.621396 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67
[0m20:05:38.621396 [debug] [Thread-1 (]: Began running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:38.629378 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_management_control_control_id ................. [RUN]
[0m20:05:38.629378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_date.ce05b7cd67, now test.management_control_project.not_null_stg_management_control_control_id.ac54672dee)
[0m20:05:38.629378 [debug] [Thread-1 (]: Began compiling node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:38.629378 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:38.629378 [debug] [Thread-1 (]: Began executing node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:38.637377 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:38.637377 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:38.637377 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: BEGIN
[0m20:05:38.637377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.684425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m20:05:38.684425 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"
[0m20:05:38.684425 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.not_null_stg_management_control_control_id.ac54672dee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_staging"."stg_management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:05:38.692407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:05:38.692407 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: ROLLBACK
[0m20:05:38.692407 [debug] [Thread-1 (]: On test.management_control_project.not_null_stg_management_control_control_id.ac54672dee: Close
[0m20:05:38.692407 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_management_control_control_id ....................... [[32mPASS[0m in 0.06s]
[0m20:05:38.692407 [debug] [Thread-1 (]: Finished running node test.management_control_project.not_null_stg_management_control_control_id.ac54672dee
[0m20:05:38.692407 [debug] [Thread-1 (]: Began running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:38.700406 [info ] [Thread-1 (]: 12 of 18 START test source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [RUN]
[0m20:05:38.700406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.not_null_stg_management_control_control_id.ac54672dee, now test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8)
[0m20:05:38.700406 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:38.700406 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:38.708425 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:38.708425 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:38.708425 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:38.716407 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: BEGIN
[0m20:05:38.716407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.764400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m20:05:38.764400 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"
[0m20:05:38.764400 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "gestion"."public_seeds"."management_control"
    group by status

)

select *
from all_values
where value_field not in (
    'VALIDATED','PENDING','FAILED','CANCELLED'
)



      
    ) dbt_internal_test
[0m20:05:38.764400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:38.764400 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: ROLLBACK
[0m20:05:38.772418 [debug] [Thread-1 (]: On test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8: Close
[0m20:05:38.772418 [info ] [Thread-1 (]: 12 of 18 PASS source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED  [[32mPASS[0m in 0.07s]
[0m20:05:38.772418 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8
[0m20:05:38.772418 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:38.772418 [info ] [Thread-1 (]: 13 of 18 START test source_not_null_raw_management_control_control_date ........ [RUN]
[0m20:05:38.772418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_accepted_values_raw_management_control_status__VALIDATED__PENDING__FAILED__CANCELLED.999394a8f8, now test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae)
[0m20:05:38.772418 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:38.780399 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:38.780399 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:38.788399 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:38.788399 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:38.788399 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: BEGIN
[0m20:05:38.788399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.836411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m20:05:38.836411 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"
[0m20:05:38.836411 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_date
from "gestion"."public_seeds"."management_control"
where control_date is null



      
    ) dbt_internal_test
[0m20:05:38.844393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:38.844393 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: ROLLBACK
[0m20:05:38.844393 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae: Close
[0m20:05:38.844393 [info ] [Thread-1 (]: 13 of 18 PASS source_not_null_raw_management_control_control_date .............. [[32mPASS[0m in 0.07s]
[0m20:05:38.844393 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae
[0m20:05:38.844393 [debug] [Thread-1 (]: Began running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:38.844393 [info ] [Thread-1 (]: 14 of 18 START test source_not_null_raw_management_control_control_id .......... [RUN]
[0m20:05:38.844393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_date.232af890ae, now test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c)
[0m20:05:38.852393 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:38.852393 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:38.860411 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:38.860411 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:38.860411 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:38.860411 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: BEGIN
[0m20:05:38.860411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:39.084777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m20:05:39.084777 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"
[0m20:05:39.084777 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select control_id
from "gestion"."public_seeds"."management_control"
where control_id is null



      
    ) dbt_internal_test
[0m20:05:39.095165 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:39.095165 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: ROLLBACK
[0m20:05:39.095165 [debug] [Thread-1 (]: On test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c: Close
[0m20:05:39.103171 [info ] [Thread-1 (]: 14 of 18 PASS source_not_null_raw_management_control_control_id ................ [[32mPASS[0m in 0.26s]
[0m20:05:39.103171 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c
[0m20:05:39.103171 [debug] [Thread-1 (]: Began running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:39.103171 [info ] [Thread-1 (]: 15 of 18 START test source_unique_raw_management_control_control_id ............ [RUN]
[0m20:05:39.111169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_not_null_raw_management_control_control_id.9c703b750c, now test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c)
[0m20:05:39.111169 [debug] [Thread-1 (]: Began compiling node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:39.135190 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:39.135190 [debug] [Thread-1 (]: Began executing node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:39.143167 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:39.143167 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:39.143167 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: BEGIN
[0m20:05:39.151181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:39.350534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m20:05:39.350534 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"
[0m20:05:39.350534 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_seeds"."management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:39.350534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:39.358515 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: ROLLBACK
[0m20:05:39.358515 [debug] [Thread-1 (]: On test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c: Close
[0m20:05:39.358515 [info ] [Thread-1 (]: 15 of 18 PASS source_unique_raw_management_control_control_id .................. [[32mPASS[0m in 0.25s]
[0m20:05:39.358515 [debug] [Thread-1 (]: Finished running node test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c
[0m20:05:39.358515 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:39.358515 [info ] [Thread-1 (]: 16 of 18 START test unique_dim_status_status_code .............................. [RUN]
[0m20:05:39.358515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.source_unique_raw_management_control_control_id.61872fc33c, now test.management_control_project.unique_dim_status_status_code.ce72371f5e)
[0m20:05:39.358515 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:39.366531 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:39.366531 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:39.374530 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:39.374530 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:39.374530 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: BEGIN
[0m20:05:39.374530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:39.422508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m20:05:39.422508 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_status_status_code.ce72371f5e"
[0m20:05:39.422508 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_status_status_code.ce72371f5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    status_code as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_status"
where status_code is not null
group by status_code
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:39.422508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:39.430509 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: ROLLBACK
[0m20:05:39.430509 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_status_status_code.ce72371f5e: Close
[0m20:05:39.430509 [info ] [Thread-1 (]: 16 of 18 PASS unique_dim_status_status_code .................................... [[32mPASS[0m in 0.07s]
[0m20:05:39.430509 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_status_status_code.ce72371f5e
[0m20:05:39.430509 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:39.430509 [info ] [Thread-1 (]: 17 of 18 START test unique_dim_time_calendar_date .............................. [RUN]
[0m20:05:39.430509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_status_status_code.ce72371f5e, now test.management_control_project.unique_dim_time_calendar_date.4fe35b7375)
[0m20:05:39.430509 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:39.438507 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:39.438507 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:39.446515 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:39.446515 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:39.446515 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: BEGIN
[0m20:05:39.446515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:39.495150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m20:05:39.495150 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"
[0m20:05:39.503131 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_dim_time_calendar_date.4fe35b7375"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    calendar_date as unique_field,
    count(*) as n_records

from "gestion"."public"."dim_time"
where calendar_date is not null
group by calendar_date
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:39.503131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:05:39.503131 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: ROLLBACK
[0m20:05:39.503131 [debug] [Thread-1 (]: On test.management_control_project.unique_dim_time_calendar_date.4fe35b7375: Close
[0m20:05:39.503131 [info ] [Thread-1 (]: 17 of 18 PASS unique_dim_time_calendar_date .................................... [[32mPASS[0m in 0.07s]
[0m20:05:39.511131 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_dim_time_calendar_date.4fe35b7375
[0m20:05:39.511131 [debug] [Thread-1 (]: Began running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:39.511131 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_management_control_control_id ................... [RUN]
[0m20:05:39.511131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.management_control_project.unique_dim_time_calendar_date.4fe35b7375, now test.management_control_project.unique_stg_management_control_control_id.6000ea497a)
[0m20:05:39.511131 [debug] [Thread-1 (]: Began compiling node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:39.519150 [debug] [Thread-1 (]: Writing injected SQL for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:39.519150 [debug] [Thread-1 (]: Began executing node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:39.519150 [debug] [Thread-1 (]: Writing runtime sql for node "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:39.519150 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:39.527130 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: BEGIN
[0m20:05:39.527130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:39.727798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m20:05:39.727798 [debug] [Thread-1 (]: Using postgres connection "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"
[0m20:05:39.727798 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "controle_gestion_dbt", "target_name": "dev", "node_id": "test.management_control_project.unique_stg_management_control_control_id.6000ea497a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    control_id as unique_field,
    count(*) as n_records

from "gestion"."public_staging"."stg_management_control"
where control_id is not null
group by control_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:05:39.735820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:05:39.735820 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: ROLLBACK
[0m20:05:39.735820 [debug] [Thread-1 (]: On test.management_control_project.unique_stg_management_control_control_id.6000ea497a: Close
[0m20:05:39.735820 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_management_control_control_id ......................... [[32mPASS[0m in 0.22s]
[0m20:05:39.743803 [debug] [Thread-1 (]: Finished running node test.management_control_project.unique_stg_management_control_control_id.6000ea497a
[0m20:05:39.745775 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:39.745775 [debug] [MainThread]: On master: BEGIN
[0m20:05:39.745775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:39.970532 [debug] [MainThread]: SQL status: BEGIN in 0.222 seconds
[0m20:05:39.970532 [debug] [MainThread]: On master: COMMIT
[0m20:05:39.970532 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:39.970532 [debug] [MainThread]: On master: COMMIT
[0m20:05:39.970532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:39.970532 [debug] [MainThread]: On master: Close
[0m20:05:39.970532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:39.970532 [debug] [MainThread]: Connection 'list_gestion_public_seeds' was properly closed.
[0m20:05:39.978515 [debug] [MainThread]: Connection 'test.management_control_project.unique_stg_management_control_control_id.6000ea497a' was properly closed.
[0m20:05:39.978515 [info ] [MainThread]: 
[0m20:05:39.978515 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m20:05:39.981465 [debug] [MainThread]: Command end result
[0m20:05:40.053481 [debug] [MainThread]: Wrote artifact WritableManifest to C:\controle_gestion_dbt\target\manifest.json
[0m20:05:40.061463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\controle_gestion_dbt\target\semantic_manifest.json
[0m20:05:40.077461 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\controle_gestion_dbt\target\run_results.json
[0m20:05:40.077461 [info ] [MainThread]: 
[0m20:05:40.077461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:40.077461 [info ] [MainThread]: 
[0m20:05:40.077461 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m20:05:40.085464 [debug] [MainThread]: Command `dbt test` succeeded at 20:05:40.085464 after 5.88 seconds
[0m20:05:40.085464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6A57C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC8BF25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC6864EF0>]}
[0m20:05:40.085464 [debug] [MainThread]: Flushing usage events
[0m20:05:40.534227 [debug] [MainThread]: An error was encountered while trying to flush usage events
